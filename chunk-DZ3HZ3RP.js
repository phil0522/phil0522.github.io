import{a as ee}from"./chunk-FP2O5KEE.js";import{a as X,d as Z}from"./chunk-RYIKU5Y3.js";import{a as Q}from"./chunk-H7CIGVSP.js";import{aa as J,ba as q,ca as U,da as Y,ea as N,ga as K,h as z,n as A}from"./chunk-BYFRXP3Z.js";import"./chunk-UYHN5VVP.js";import{$a as c,Bb as y,Db as r,Ea as a,Eb as v,Fb as w,Gb as G,N as x,Ob as $,Qa as I,S as _,T as f,Tb as P,U as h,V as k,Vb as W,Wb as M,_a as F,ab as m,da as b,db as O,ea as H,eb as T,fb as L,gb as s,hb as l,ib as E,jb as u,kb as p,lb as V,ob as C,pb as j,qb as S,rb as D,sb as d}from"./chunk-5O64VQN5.js";import"./chunk-Q7L6LLAK.js";var re=(t,n)=>n.id;function ae(t,n){if(t&1&&(u(0,"div",6),h(),u(1,"svg",4),V(2,"path",13),p(),k(),u(3,"span"),r(4),p()()),t&2){let e=d();a(4),v(e.classData().location)}}function se(t,n){t&1&&(u(0,"div",9)(1,"span",14),r(2,"celebration"),p(),r(3," Early Bird "),p())}function le(t,n){t&1&&(h(),u(0,"svg",20),V(1,"path",21),p())}function de(t,n){if(t&1){let e=C();u(0,"label",17)(1,"input",18),D("change",function(o){let g=_(e).$implicit,B=d(2);return f(B.toggleStudent(g.id,o))}),p(),u(2,"span",19),r(3),p(),c(4,le,2,0,":svg:svg",20),p()}if(t&2){let e=n.$implicit,i=d(2),o=i.reservedStudentIds().includes(e.id),g=i.selectedStudentIds().includes(e.id),B=o||i.status()==="full";y("reserved",o)("selected",g&&!o)("disabled",i.status()==="full"&&!o),a(),j("checked",o||g)("disabled",B),a(2),G("",e.firstName," ",e.lastName),a(),m(o?4:-1)}}function ce(t,n){if(t&1){let e=C();u(0,"div",15),D("click",function(o){return _(e),f(o.stopPropagation())}),O(1,de,5,11,"label",16,re),p()}if(t&2){let e=d();a(),T(e.students())}}function me(t,n){t&1&&(u(0,"button",12),r(1,"All Students Enrolled"),p())}function ge(t,n){t&1&&(u(0,"button",22),r(1,"Add Student to Enroll"),p())}function pe(t,n){t&1&&(u(0,"button",22),r(1,"Complete Profile to Enroll"),p())}function ue(t,n){if(t&1){let e=C();u(0,"button",24),D("click",function(o){_(e);let g=d(2);return f(g.onReserveClick(o))}),r(1," Reserve Now "),p()}if(t&2){let e=d(2);y("active",e.hasNewSelection()),j("disabled",!e.hasNewSelection())}}function _e(t,n){if(t&1&&c(0,ge,2,0,"button",22)(1,pe,2,0,"button",22)(2,ue,2,3,"button",23),t&2){let e=d();m(e.hasStudents()?e.isProfileComplete()?2:1:0)}}function fe(t,n){t&1&&(u(0,"button",25),r(1,"On Waitlist"),p())}function Ce(t,n){if(t&1){let e=C();u(0,"button",27),D("click",function(o){_(e);let g=d(2);return f(g.onWaitlistClick(o))}),r(1,"Join Waitlist"),p()}}function ve(t,n){if(t&1&&c(0,fe,2,0,"button",25)(1,Ce,2,0,"button",26),t&2){let e=d();m(e.isOnWaitlist()?0:1)}}var R=class t{userService=x(N);classData=M.required();currentPrice=M.required();status=M.required();showEarlyBird=M(!1);isOnWaitlist=M(!1);students=M([]);reservedStudentIds=M([]);cardClick=W();waitlistClick=W();reserveClick=W();_selectedStudentIds=b([]);selectedStudentIds=this._selectedStudentIds.asReadonly();isProfileComplete=P(()=>this.userService.isProfileComplete());hasStudents=P(()=>this.students().length>0);allStudentsReserved=P(()=>{let n=this.students(),e=this.reservedStudentIds();return n.length===0?!1:n.every(i=>e.includes(i.id))});hasNewSelection=P(()=>{let n=this._selectedStudentIds(),e=this.reservedStudentIds();return n.some(i=>!e.includes(i))});getStatusText(){switch(this.status()){case"available":let n=this.classData().available;return n>5?"5+ spots":`${n} spots`;case"full":return"Full";default:return"Unknown"}}formatDateRange=Z;toggleStudent(n,e){e.stopPropagation();let i=e.target;this._selectedStudentIds.update(o=>i.checked?o.includes(n)?o:[...o,n]:o.filter(g=>g!==n))}onReserveClick(n){n.stopPropagation();let e=this._selectedStudentIds().filter(i=>!this.reservedStudentIds().includes(i));e.length>0&&(this.reserveClick.emit({sessionId:this.classData().id,studentIds:e}),this._selectedStudentIds.set([]))}onWaitlistClick(n){n.stopPropagation(),this.waitlistClick.emit(this.classData())}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=I({type:t,selectors:[["app-class-card"]],inputs:{classData:[1,"classData"],currentPrice:[1,"currentPrice"],status:[1,"status"],showEarlyBird:[1,"showEarlyBird"],isOnWaitlist:[1,"isOnWaitlist"],students:[1,"students"],reservedStudentIds:[1,"reservedStudentIds"]},outputs:{cardClick:"cardClick",waitlistClick:"waitlistClick",reserveClick:"reserveClick"},decls:21,vars:14,consts:[[1,"class-card"],[1,"class-header"],[1,"status-badge"],[1,"class-dates"],["width","16","height","16","viewBox","0 0 24 24","fill","currentColor"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"],[1,"class-location"],[1,"class-pricing"],[1,"price-value"],[1,"early-bird-badge"],[1,"student-selection"],[1,"class-action"],["disabled","",1,"btn-all-enrolled"],["d","M12 2c-3.31 0-6 2.69-6 6 0 4.5 6 14 6 14s6-9.5 6-14c0-3.31-2.69-6-6-6zm0 8c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"],["aria-hidden","true",1,"material-symbols-rounded","icon-sm"],[1,"student-selection",3,"click"],[1,"student-checkbox",3,"reserved","selected","disabled"],[1,"student-checkbox"],["type","checkbox",3,"change","checked","disabled"],[1,"student-name"],["width","16","height","16","viewBox","0 0 24 24","fill","currentColor",1,"check-icon"],["d","M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"],["disabled","",1,"btn-profile-incomplete"],[1,"btn-reserve",3,"active","disabled"],[1,"btn-reserve",3,"click","disabled"],["disabled","",1,"btn-on-waitlist"],[1,"btn-waitlist"],[1,"btn-waitlist",3,"click"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div",1)(2,"h3"),r(3),p(),u(4,"div",2),r(5),p()(),u(6,"div",3),h(),u(7,"svg",4),V(8,"path",5),p(),k(),u(9,"span"),r(10),p()(),c(11,ae,5,1,"div",6),u(12,"div",7)(13,"span",8),r(14),p(),c(15,se,4,0,"div",9),p(),c(16,ce,3,0,"div",10),u(17,"div",11),c(18,me,2,0,"button",12)(19,_e,3,1)(20,ve,2,1),p()()),e&2&&(y("all-reserved",i.allStudentsReserved()),a(3),v(i.classData().name),a(),y("available",i.status()==="available")("full",i.status()==="full"),a(),w(" ",i.getStatusText()," "),a(5),v(i.formatDateRange(i.classData().startDate,i.classData().endDate)),a(),m(i.classData().location?11:-1),a(3),v(i.currentPrice()),a(),m(i.showEarlyBird()?15:-1),a(),m(i.students().length>0?16:-1),a(2),m(i.allStudentsReserved()?18:i.status()==="available"?19:i.status()==="full"?20:-1))},dependencies:[z],styles:['.class-card[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline, #e0e0e0);border-radius:12px;padding:1.25rem;transition:all .2s ease;display:flex;flex-direction:column;gap:.75rem}.class-card[_ngcontent-%COMP%]:hover{border-color:var(--sys-primary, #c62828);box-shadow:0 4px 12px #0000001a}.class-card.all-reserved[_ngcontent-%COMP%]{border-color:var(--sys-tertiary, #2e7d32);background:linear-gradient(135deg,#fff,#f1f8e9)}.class-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:.75rem}.class-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.05rem;color:var(--sys-on-surface, #212121);flex:1;font-weight:600}.status-badge[_ngcontent-%COMP%]{padding:.2rem .6rem;border-radius:12px;font-size:.7rem;font-weight:600;white-space:nowrap;text-transform:uppercase;letter-spacing:.02em}.status-badge.available[_ngcontent-%COMP%]{background-color:var(--sys-secondary-container, #e8f5e9);color:var(--sys-on-secondary-container, #1b5e20)}.status-badge.full[_ngcontent-%COMP%]{background-color:var(--sys-error-container, #ffebee);color:var(--sys-on-error-container, #b71c1c)}.class-dates[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:var(--sys-on-surface-variant, #666);font-size:.85rem}.class-dates[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;opacity:.7}.class-location[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:var(--sys-on-surface-variant, #666);font-size:.85rem}.class-location[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;opacity:.7}.class-pricing[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.price-value[_ngcontent-%COMP%]{font-size:1.35rem;font-weight:700;color:var(--sys-primary, #c62828)}.early-bird-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,gold,orange);color:#333;padding:.2rem .6rem;border-radius:4px;font-size:.7rem;font-weight:600}.student-selection[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;padding:.75rem 0;border-top:1px solid var(--sys-outline-variant, #f0f0f0)}.student-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem .75rem;background:var(--sys-surface-variant, #f5f5f5);border-radius:8px;cursor:pointer;transition:all .15s ease;-webkit-user-select:none;user-select:none;border:1px solid transparent}.student-checkbox[_ngcontent-%COMP%]:hover:not(.reserved):not(.disabled){background:var(--sys-primary-container, #ffebee)}.student-checkbox.disabled[_ngcontent-%COMP%]{cursor:default}.student-checkbox.selected[_ngcontent-%COMP%]{background:var(--sys-primary-container, #ffebee);border:1px solid var(--sys-primary, #c62828)}.student-checkbox.reserved[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e8f5e9,#c8e6c9);border:1px solid var(--sys-tertiary, #2e7d32);cursor:default;position:relative}.student-checkbox.reserved[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:var(--sys-tertiary, #2e7d32);border-radius:8px 0 0 8px}.student-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--sys-primary, #c62828);cursor:pointer}.student-checkbox.reserved[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{accent-color:var(--sys-tertiary, #2e7d32);cursor:default}.student-name[_ngcontent-%COMP%]{flex:1;font-size:.9rem;color:var(--sys-on-surface, #333)}.student-checkbox.reserved[_ngcontent-%COMP%]   .student-name[_ngcontent-%COMP%]{font-weight:600;color:var(--sys-tertiary, #2e7d32)}.check-icon[_ngcontent-%COMP%]{color:var(--sys-tertiary, #2e7d32)}.class-action[_ngcontent-%COMP%]{margin-top:auto}.class-action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:none;border-radius:8px;font-size:.9rem;font-weight:600;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn-reserve[_ngcontent-%COMP%]{background-color:var(--sys-outline, #e0e0e0);color:var(--sys-on-surface-variant, #999)}.btn-reserve.active[_ngcontent-%COMP%]{background-color:var(--sys-primary, #c62828);color:#fff}.btn-reserve.active[_ngcontent-%COMP%]:hover{background-color:var(--sys-primary-dark, #8e0000)}.btn-reserve[_ngcontent-%COMP%]:disabled{cursor:default}.btn-waitlist[_ngcontent-%COMP%]{background-color:var(--sys-tertiary, #1976d2);color:#fff}.btn-waitlist[_ngcontent-%COMP%]:hover{background-color:var(--sys-tertiary-dark, #0d47a1)}.btn-on-waitlist[_ngcontent-%COMP%]{background-color:var(--sys-tertiary-container, #e3f2fd);color:var(--sys-tertiary, #1976d2)}.btn-on-waitlist[_ngcontent-%COMP%]:disabled{cursor:default;opacity:1}.btn-all-enrolled[_ngcontent-%COMP%]{background-color:var(--sys-secondary-container, #e8f5e9);color:var(--sys-on-secondary-container, #1b5e20)}.btn-all-enrolled[_ngcontent-%COMP%]:disabled{cursor:default;opacity:1}.btn-profile-incomplete[_ngcontent-%COMP%]{background-color:var(--sys-surface-variant, #f5f5f5);color:var(--sys-on-surface-variant, #666);font-size:.85rem}.btn-profile-incomplete[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.8}']})};var xe=()=>({includeLunch:!1,includeExtendedCare:!1}),ne=(t,n)=>n.id;function be(t,n){t&1&&(s(0,"div",2),r(1,"Loading..."),l())}function Se(t,n){if(t&1){let e=C();s(0,"div",3)(1,"strong"),r(2,"Error:"),l(),r(3),s(4,"button",10),S("click",function(){_(e);let o=d();return f(o.seasonService.clearError())}),r(5,"Close"),l()()}if(t&2){let e=d();a(3),w(" ",e.seasonService.error()," ")}}function he(t,n){t&1&&(s(0,"div",11)(1,"p"),r(2,"No seasons available"),l()())}function ye(t,n){if(t&1){let e=C();s(0,"div",14),S("click",function(){let o=_(e).$implicit,g=d(3);return f(g.onSeasonClick(o))}),s(1,"h3"),r(2),l(),s(3,"div",15)(4,"span"),r(5),l(),s(6,"span"),r(7," - "),l(),s(8,"span"),r(9),l()(),s(10,"div",16),r(11),l()()}if(t&2){let e,i=n.$implicit,o=d(3);y("selected",((e=o.seasonService.selectedSeason())==null?null:e.id)===i.id),a(2),v(i.name),a(3),v(o.formatDate(i.startDate)),a(4),v(o.formatDate(i.endDate)),a(2),v(i.year)}}function Pe(t,n){if(t&1&&(s(0,"div",12),O(1,ye,12,6,"div",13,ne),l()),t&2){let e=d();a(),T(e)}}function Me(t,n){if(t&1&&c(0,he,3,0,"div",11)(1,Pe,3,0,"div",12),t&2){let e=d();m(n.length===0&&!e.seasonService.loading()?0:1)}}function Ee(t,n){if(t&1&&(s(0,"div",20),E(1,"app-markdown-renderer",21),l()),t&2){let e,i=d(2);a(),L("content",((e=i.seasonService.selectedSeason())==null?null:e.description)||"")}}function we(t,n){if(t&1){let e=C();s(0,"div",4)(1,"div",17),S("click",function(){_(e);let o=d();return f(o.toggleDescription())}),s(2,"h2"),r(3),l(),s(4,"button",18),r(5),s(6,"span",19),r(7,"\u25BC"),l()()(),c(8,Ee,2,1,"div",20),l()}if(t&2){let e,i=d();a(3),w("",(e=i.seasonService.selectedSeason())==null?null:e.name," - Details"),a(),F("aria-expanded",i.descriptionExpanded()),a(),w(" ",i.descriptionExpanded()?"Collapse":"Expand"," "),a(),y("expanded",i.descriptionExpanded()),a(2),m(i.descriptionExpanded()?8:-1)}}function ke(t,n){t&1&&(s(0,"strong"),r(1,"Add a student to enroll"),l(),s(2,"p"),r(3,"Please add your child's information before registering for camp sessions."),l())}function Oe(t,n){t&1&&(s(0,"strong"),r(1,"Complete your profile to enroll"),l(),s(2,"p"),r(3,"Please fill in your contact information (phone, WeChat, address, emergency contact) before registering."),l())}function Te(t,n){if(t&1){let e=C();s(0,"div",22)(1,"div",23),h(),s(2,"svg",24),E(3,"path",25),l()(),k(),s(4,"div",26),c(5,ke,4,0)(6,Oe,4,0),l(),s(7,"button",27),S("click",function(){_(e);let o=d(2);return f(o.goToProfile())}),r(8," Go to Profile "),h(),s(9,"svg",28),E(10,"path",29),l()()()}if(t&2){let e=d(2);a(5),m(e.userService.hasStudents()?6:5)}}function De(t,n){t&1&&(s(0,"div",30)(1,"p"),r(2,"No classes available for this season"),l()())}function Ie(t,n){if(t&1){let e=C();s(0,"app-class-card",33),S("cardClick",function(){_(e);let o=d(4);return f(o.onClassClick())})("waitlistClick",function(o){_(e);let g=d(4);return f(g.onWaitlistClick(o))})("reserveClick",function(o){_(e);let g=d(4);return f(g.onReserveClick(o))}),l()}if(t&2){let e=n.$implicit,i=d(4);L("classData",e)("currentPrice",i.seasonService.formatPrice(i.seasonService.calculatePrice(e,$(7,xe))))("status",i.getClassStatus(e))("showEarlyBird",i.isEarlyBird(e))("isOnWaitlist",i.isOnWaitlist(e.id))("students",i.students())("reservedStudentIds",i.getReservedStudentIds(e.id))}}function Le(t,n){if(t&1&&(s(0,"div",31),O(1,Ie,1,8,"app-class-card",32,ne),l()),t&2){let e=d();a(),T(e)}}function Ve(t,n){if(t&1&&c(0,De,3,0,"div",30)(1,Le,3,0,"div",31),t&2){let e=d(2);m(n.length===0&&!e.seasonService.loading()?0:1)}}function We(t,n){if(t&1&&(s(0,"div",5)(1,"h2",1),r(2),l(),c(3,Te,11,1,"div",22),c(4,Ve,2,1),l()),t&2){let e,i,o=d();a(2),w("Select Session - ",(e=o.seasonService.selectedSeason())==null?null:e.name),a(),m(!o.userService.hasStudents()||!o.userService.isProfileComplete()?3:-1),a(),m((i=o.registrationService.classesWithEnrollment())?4:-1,i)}}function ze(t,n){if(t&1){let e=C();s(0,"div",6)(1,"div",34)(2,"span",35),r(3),l(),s(4,"span",36),r(5,"item(s) in ledger"),l()(),s(6,"button",37),S("click",function(){_(e);let o=d();return f(o.goToLedger())}),r(7," Proceed to Ledger "),h(),s(8,"svg",38),E(9,"path",29),l()()()}if(t&2){let e=d();a(3),v(e.ledgerItemCount())}}function Ne(t,n){t&1&&(s(0,"div",7)(1,"div",39),E(2,"div",40),s(3,"span"),r(4,"Reserving spot..."),l()()())}function Re(t,n){if(t&1){let e=C();s(0,"div",41),S("click",function(){_(e);let o=d();return f(o.clearReservationError())}),s(1,"span"),r(2),l(),s(3,"button"),r(4,"Dismiss"),l()()}if(t&2){let e=d();a(2),v(e.reservationError())}}function Be(t,n){t&1&&(s(0,"div",44),E(1,"div",40),s(2,"span"),r(3,"Processing..."),l()())}function je(t,n){if(t&1&&(s(0,"div",45),r(1),l()),t&2){let e=d(2);a(),v(e.waitlistError())}}function He(t,n){if(t&1){let e=C();s(0,"div",9)(1,"div",42)(2,"h3"),r(3,"Join Waitlist"),l(),s(4,"p"),r(5," Join the waitlist for "),s(6,"strong"),r(7),l(),r(8,"? "),l(),s(9,"p",43),r(10," You'll be notified when a spot becomes available. Student selection happens at checkout. "),l(),c(11,Be,4,0,"div",44),c(12,je,2,1,"div",45),s(13,"div",46)(14,"button",47),S("click",function(){_(e);let o=d();return f(o.closeWaitlistDialog())}),r(15,"Cancel"),l(),s(16,"button",48),S("click",function(){_(e);let o=d();return f(o.joinWaitlistForClass())}),r(17," Join Waitlist "),l()()()()}if(t&2){let e,i=d();a(7),v((e=i.selectedClassForWaitlist())==null?null:e.name),a(4),m(i.joiningWaitlist()?11:-1),a(),m(i.waitlistError()?12:-1),a(4),L("disabled",i.joiningWaitlist())}}var te=class t{seasonService=x(U);registrationService=x(Q);orderService=x(Y);acknowledgementService=x(K);configService=x(q);orderRpc=x(J);userService=x(N);router=x(A);descriptionExpanded=b(!0);constructor(){H(()=>{this.loadSeasonsAndSelectLatest()})}async loadSeasonsAndSelectLatest(){await this.seasonService.loadSeasons();let n=this.seasonService.seasons();if(n.length>0){let e=this.seasonService.getLastSelectedSeasonId(),o=(e?n.find(g=>g.id===e):null)??n[n.length-1];await this.onSeasonClick(o)}}reserving=b(!1);reservationError=b(null);showWaitlistDialog=b(!1);selectedClassForWaitlist=b(null);waitlistError=b(null);joiningWaitlist=b(!1);students=this.userService.students;ledgerItemCount=P(()=>this.orderService.lockedItems().length+this.orderService.submittedItems().length);registeredStudentsByClass=P(()=>{let n=this.orderService.items(),e=new Map;for(let i of n){let o=e.get(i.sessionId)||[];o.includes(i.studentId)||o.push(i.studentId),e.set(i.sessionId,o)}return e});async onSeasonClick(n){this.seasonService.selectSeason(n),await this.seasonService.loadClassesBySeason(n.id)}onClassClick(){}getClassStatus(n){let e=this.registrationService.getEnrollmentStatus(n);return e==="open"||e==="almost-full"?"available":"full"}isOnWaitlist(n){return this.orderService.isOnWaitlist(n)}isEarlyBird(n){if(!n.earlyBirdTiers||n.earlyBirdTiers.length===0)return!1;let e=this.configService.currentDate();return e?n.earlyBirdTiers.some(i=>e<=i.deadline):!1}getReservedStudentIds(n){return this.registeredStudentsByClass().get(n)||[]}async onReserveClick(n){let e=this.seasonService.selectedSeason()?.id;if(!e){this.reservationError.set("No season selected");return}let i=n.studentIds.filter(o=>!this.getReservedStudentIds(n.sessionId).includes(o));this.reserving.set(!0),this.reservationError.set(null);try{let o=i.map(g=>({sessionId:n.sessionId,studentId:g,options:{lunch:!0,extendedCare:!1}}));await this.orderRpc.lockSessions({seasonId:e,items:o,selectedCouponIds:[]}),this.acknowledgementService.clearAcknowledgement(e)}catch(o){let g=o instanceof Error?o.message:String(o);this.reservationError.set(g),setTimeout(()=>this.clearReservationError(),5e3)}finally{this.reserving.set(!1)}}clearReservationError(){this.reservationError.set(null)}goToLedger(){this.router.navigate(["/ledger"])}goToProfile(){this.router.navigate(["/profile"])}formatDate(n){return X(n,{month:"long",day:"numeric"})}toggleDescription(){this.descriptionExpanded.update(n=>!n)}onWaitlistClick(n){this.selectedClassForWaitlist.set(n),this.waitlistError.set(null),this.showWaitlistDialog.set(!0)}closeWaitlistDialog(){this.showWaitlistDialog.set(!1),this.selectedClassForWaitlist.set(null),this.waitlistError.set(null)}async joinWaitlistForClass(){let n=this.selectedClassForWaitlist();if(n){this.waitlistError.set(null),this.joiningWaitlist.set(!0);try{await this.orderService.joinWaitlist(n.id),this.closeWaitlistDialog(),this.router.navigate(["/waitlist"])}catch(e){let i=e instanceof Error?e.message:String(e);this.waitlistError.set(i)}finally{this.joiningWaitlist.set(!1)}}}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=I({type:t,selectors:[["app-season-list"]],decls:12,vars:9,consts:[[1,"season-list"],[1,"catalog-select-title"],[1,"loading"],[1,"error-message"],[1,"description-section"],[1,"classes-section"],[1,"floating-ledger-bar"],[1,"reservation-overlay"],[1,"error-toast"],[1,"dialog-overlay"],[3,"click"],[1,"no-seasons"],[1,"seasons-grid"],[1,"season-card",3,"selected"],[1,"season-card",3,"click"],[1,"season-dates"],[1,"season-year"],[1,"description-header",3,"click"],[1,"toggle-btn"],[1,"toggle-icon"],[1,"description-content"],[3,"content"],[1,"profile-alert"],[1,"alert-icon"],["width","24","height","24","viewBox","0 0 24 24","fill","currentColor"],["d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"],[1,"alert-content"],[1,"btn-go-profile",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","currentColor"],["d","M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"],[1,"no-classes"],[1,"classes-grid"],[3,"classData","currentPrice","status","showEarlyBird","isOnWaitlist","students","reservedStudentIds"],[3,"cardClick","waitlistClick","reserveClick","classData","currentPrice","status","showEarlyBird","isOnWaitlist","students","reservedStudentIds"],[1,"ledger-info"],[1,"ledger-count"],[1,"ledger-label"],[1,"btn-proceed-ledger",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","currentColor"],[1,"reservation-dialog"],[1,"spinner"],[1,"error-toast",3,"click"],[1,"dialog"],[1,"dialog-note"],[1,"dialog-loading"],[1,"dialog-error"],[1,"dialog-actions"],[1,"btn-cancel",3,"click"],[1,"btn-waitlist",3,"click","disabled"]],template:function(e,i){if(e&1&&(s(0,"div",0)(1,"h2",1),r(2,"Select Season"),l(),c(3,be,2,0,"div",2),c(4,Se,6,1,"div",3),c(5,Me,2,1),c(6,we,9,6,"div",4),c(7,We,5,3,"div",5),c(8,ze,10,1,"div",6),c(9,Ne,5,0,"div",7),c(10,Re,5,1,"div",8),c(11,He,18,4,"div",9),l()),e&2){let o,g;a(3),m(i.seasonService.loading()?3:-1),a(),m(i.seasonService.error()?4:-1),a(),m((o=i.seasonService.seasons())?5:-1,o),a(),m((g=i.seasonService.selectedSeason())!=null&&g.description?6:-1),a(),m(i.seasonService.selectedSeason()?7:-1),a(),m(i.orderService.hasLockedItems()||i.orderService.hasSubmittedItems()?8:-1),a(),m(i.reserving()?9:-1),a(),m(i.reservationError()?10:-1),a(),m(i.showWaitlistDialog()?11:-1)}},dependencies:[z,R,ee],styles:[".season-list[_ngcontent-%COMP%]{padding:1rem}h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;color:var(--sys-secondary, #2e7d32)}.catalog-select-title[_ngcontent-%COMP%]{font-family:Georgia,Times New Roman,serif;color:#2f9d59;font-weight:700;letter-spacing:-.01em}.loading[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--sys-on-surface-variant, #666)}.error-message[_ngcontent-%COMP%]{background-color:var(--sys-error-container, #ffebee);color:var(--sys-on-error-container, #b71c1c);padding:1rem;border-radius:8px;margin-bottom:1rem;display:flex;justify-content:space-between;align-items:center}.error-message[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:var(--sys-on-error-container, #b71c1c);cursor:pointer;text-decoration:underline}.no-seasons[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:var(--sys-on-surface-variant, #666)}.seasons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem}.season-card[_ngcontent-%COMP%]{background:#fff;border:2px solid var(--sys-outline, #ccc);border-radius:12px;padding:1.5rem;cursor:pointer;transition:all .2s ease}.season-card[_ngcontent-%COMP%]:hover{border-color:var(--sys-primary, #c62828);box-shadow:0 4px 8px #0000001a;transform:translateY(-2px)}.season-card.selected[_ngcontent-%COMP%]{border-color:var(--sys-primary, #c62828);background-color:var(--sys-primary-container, #ffebee)}.season-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .75rem;color:#111;font-size:1.25rem}.season-dates[_ngcontent-%COMP%]{color:#111;font-size:.95rem;margin-bottom:.5rem}.season-year[_ngcontent-%COMP%]{color:#111;font-size:.875rem;margin-top:.5rem}.classes-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:2rem;border-top:1px solid var(--sys-outline-variant, #e0e0e0)}.no-classes[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:var(--sys-on-surface-variant, #666)}.profile-alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem 1.25rem;background:linear-gradient(135deg,#fff3e0,#ffe0b2);border:1px solid #ffb74d;border-radius:12px;margin-bottom:1.5rem}.alert-icon[_ngcontent-%COMP%]{flex-shrink:0;color:#f57c00}.alert-content[_ngcontent-%COMP%]{flex:1}.alert-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;color:#e65100;font-size:.95rem;margin-bottom:.25rem}.alert-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#bf360c;font-size:.85rem;line-height:1.4}.btn-go-profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;padding:.6rem 1rem;background:#f57c00;color:#fff;border:none;border-radius:8px;font-weight:600;font-size:.85rem;cursor:pointer;white-space:nowrap;transition:background .2s}.btn-go-profile[_ngcontent-%COMP%]:hover{background:#e65100}@media(max-width:600px){.profile-alert[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;text-align:left}.btn-go-profile[_ngcontent-%COMP%]{width:100%;justify-content:center}}.classes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem}.description-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--sys-outline-variant, #e0e0e0)}.description-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;cursor:pointer;padding:.5rem 0;margin-bottom:1rem}.description-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem}.toggle-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:var(--sys-primary-container, #ffebee);color:var(--sys-on-primary-container, #c62828);border:none;padding:.5rem 1rem;border-radius:8px;cursor:pointer;font-size:.875rem;font-weight:500;transition:background-color .2s ease}.toggle-btn[_ngcontent-%COMP%]:hover{background:var(--sys-primary, #c62828);color:#fff}.toggle-icon[_ngcontent-%COMP%]{transition:transform .3s ease;font-size:.75rem}.toggle-icon.expanded[_ngcontent-%COMP%]{transform:rotate(180deg)}.description-content[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline-variant, #e0e0e0);border-radius:12px;padding:1.5rem 2rem;max-height:70vh;overflow-y:auto;line-height:1.7;font-size:1rem;color:var(--sys-on-surface, #333)}.dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.dialog[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;max-width:400px;width:100%;box-shadow:0 8px 32px #0003}.dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-on-surface, #212121)}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-on-surface-variant, #666)}.dialog-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.75rem;padding:2rem;color:var(--sys-on-surface-variant, #666)}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:2px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.dialog-empty[_ngcontent-%COMP%]{text-align:center;padding:1rem}.dialog-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem}.student-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:1rem}.student-option[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:var(--sys-surface-variant, #f5f5f5);border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;cursor:pointer;transition:all .2s ease}.student-option[_ngcontent-%COMP%]:hover{background:var(--sys-tertiary-container, #e3f2fd);border-color:var(--sys-tertiary, #1976d2)}.student-name[_ngcontent-%COMP%]{font-weight:500;color:var(--sys-on-surface, #212121)}.student-age[_ngcontent-%COMP%]{font-size:.875rem;color:var(--sys-on-surface-variant, #666)}.dialog-error[_ngcontent-%COMP%]{background:var(--sys-error-container, #ffebee);color:var(--sys-on-error-container, #b71c1c);padding:.75rem 1rem;border-radius:8px;margin-bottom:1rem;font-size:.875rem}.dialog-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-top:1rem}.btn-secondary[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--sys-tertiary, #1976d2);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:500}.btn-secondary[_ngcontent-%COMP%]:hover{background:var(--sys-tertiary-dark, #0d47a1)}.btn-cancel[_ngcontent-%COMP%]{flex:1;padding:.75rem 1rem;background:#fff;color:var(--sys-on-surface-variant, #666);border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}.btn-waitlist[_ngcontent-%COMP%]{flex:1;padding:.75rem 1rem;background:var(--sys-tertiary, #1976d2);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:500}.btn-waitlist[_ngcontent-%COMP%]:hover{background:var(--sys-tertiary-dark, #0d47a1)}.btn-waitlist[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.floating-ledger-bar[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:1px solid var(--sys-outline-variant, #e0e0e0);box-shadow:0 -4px 20px #00000026;padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;z-index:100}.ledger-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.ledger-count[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);color:#fff;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.9rem}.ledger-label[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #666);font-size:.95rem}.btn-proceed-ledger[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:background .2s}.btn-proceed-ledger[_ngcontent-%COMP%]:hover{background:var(--sys-primary-dark, #8e0000)}.reservation-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0006;display:flex;align-items:center;justify-content:center;z-index:1000}.reservation-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;display:flex;align-items:center;gap:1rem;box-shadow:0 8px 32px #0003}.error-toast[_ngcontent-%COMP%]{position:fixed;bottom:80px;left:50%;transform:translate(-50%);background:var(--sys-error, #c62828);color:#fff;padding:.75rem 1.25rem;border-radius:8px;display:flex;align-items:center;gap:1rem;z-index:200;box-shadow:0 4px 12px #0003;cursor:pointer}.error-toast[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#fff3;border:none;color:#fff;padding:.25rem .75rem;border-radius:4px;cursor:pointer}@media(max-width:600px){.description-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.75rem}.description-content[_ngcontent-%COMP%]{padding:1rem;max-height:60vh}.markdown-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5em}.markdown-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.3em}.markdown-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.15em}}"]})};export{te as SeasonListComponent};
