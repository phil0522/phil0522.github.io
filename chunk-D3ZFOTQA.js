import{a as G}from"./chunk-ZOSAT4LO.js";import{a as Y}from"./chunk-WLDXJINR.js";import{a as q}from"./chunk-MSLYVGOV.js";import{a as R,b as D,c as N,f as F,q as B}from"./chunk-R4AUDQKA.js";import"./chunk-RYIKU5Y3.js";import{ba as L,ea as j,h as P,n as W,o as U}from"./chunk-OAK6GNDD.js";import"./chunk-V7S2OHSY.js";import{$a as g,Bb as A,Db as t,Ea as a,Eb as v,Fb as w,Jb as y,Kb as b,Lb as M,N as h,Qa as S,S as s,T as m,ab as p,da as V,gb as o,hb as n,ib as k,jb as _,kb as C,lb as T,ob as u,pb as I,qb as x,rb as z,sb as d}from"./chunk-CUUVOQQ5.js";import{a as O}from"./chunk-Q7L6LLAK.js";function Q(i,c){i&1&&(_(0,"div",2)(1,"span",4),t(2,"Loading cache info..."),C()())}function X(i,c){if(i&1&&(_(0,"div",8),t(1),C()),i&2){let e=d(2);a(),w(" ",e.cacheService.error()," ")}}function Z(i,c){i&1&&(T(0,"span",12),t(1," Rebuilding... "))}function $(i,c){i&1&&t(0," Rebuild Cache ")}function ee(i,c){if(i&1){let e=u();_(0,"div",3)(1,"div",5)(2,"span",6),t(3,"Cached Users:"),C(),_(4,"span",7),t(5),C()(),_(6,"div",5)(7,"span",6),t(8,"Last Rebuilt:"),C(),_(9,"span",7),t(10),C()(),g(11,X,2,1,"div",8),_(12,"div",9)(13,"button",10),z("click",function(){s(e);let r=d();return m(r.onRebuildClick())}),g(14,Z,2,0)(15,$,1,0),C(),_(16,"small",11),t(17," Rebuilds the user directory cache from all user accounts "),C()()()}if(i&2){let e=d();a(5),v(e.cacheService.userCount()),a(5),v(e.cacheService.rebuiltAtFormatted()||"Never"),a(),p(e.cacheService.error()?11:-1),a(2),I("disabled",e.cacheService.rebuilding()),a(),p(e.cacheService.rebuilding()?14:15)}}var E=class i{cacheService=h(G);ngOnInit(){this.cacheService.loadCache()}async onRebuildClick(){await this.cacheService.rebuildCache()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=S({type:i,selectors:[["app-admin-user-cache-card"]],decls:6,vars:1,consts:[[1,"config-card"],[1,"card-header"],[1,"card-content","loading"],[1,"card-content"],[1,"loading-text"],[1,"info-row"],[1,"label"],[1,"value"],[1,"error-message"],[1,"action-row"],[1,"btn-rebuild",3,"click","disabled"],[1,"help-text"],[1,"spinner-small"]],template:function(e,l){e&1&&(_(0,"div",0)(1,"div",1)(2,"h3"),t(3,"User Cache"),C()(),g(4,Q,3,0,"div",2)(5,ee,18,5,"div",3),C()),e&2&&(a(4),p(l.cacheService.loading()?4:5))},dependencies:[P],styles:[".config-card[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline-variant, #f0f0f0);border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000000d;position:relative}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:.75rem;border-bottom:1px solid var(--sys-outline-variant, #f0f0f0)}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;color:var(--sys-on-surface, #212121)}.card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.card-content.loading[_ngcontent-%COMP%]{padding:1rem 0;text-align:center;color:var(--sys-on-surface-variant, #666)}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem}.info-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:var(--sys-on-surface-variant, #666)}.info-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--sys-on-surface, #212121);font-weight:500}.error-message[_ngcontent-%COMP%]{padding:.75rem;background:var(--sys-error-container, #ffebee);color:var(--sys-error, #c62828);border-radius:6px;font-size:.875rem}.action-row[_ngcontent-%COMP%]{margin-top:.5rem;display:flex;flex-direction:column;gap:.5rem}.btn-rebuild[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;padding:.75rem 1.25rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:8px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease}.btn-rebuild[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-primary-dark, #a51c1c)}.btn-rebuild[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.spinner-small[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.help-text[_ngcontent-%COMP%]{font-size:.75rem;color:var(--sys-on-surface-variant, #999);text-align:center}.dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.confirm-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;max-width:400px;width:90%;box-shadow:0 4px 20px #00000026}.confirm-dialog[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem;color:var(--sys-on-surface, #212121)}.confirm-dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:var(--sys-on-surface-variant, #666);font-size:.875rem;line-height:1.5}.dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem}.btn-cancel[_ngcontent-%COMP%], .btn-confirm[_ngcontent-%COMP%]{padding:.625rem 1.25rem;border-radius:6px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease}.btn-cancel[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--sys-outline, #e0e0e0);color:var(--sys-on-surface-variant, #666)}.btn-cancel[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}.btn-confirm[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);border:none;color:#fff}.btn-confirm[_ngcontent-%COMP%]:hover{background:var(--sys-primary-dark, #a51c1c)}"]})};function ne(i,c){i&1&&(o(0,"div",2),k(1,"div",5),o(2,"p"),t(3,"Loading configuration..."),n()())}function te(i,c){if(i&1){let e=u();o(0,"div",3)(1,"div",6),t(2,"!"),n(),o(3,"p"),t(4),n(),o(5,"button",7),x("click",function(){s(e);let r=d();return m(r.loadConfig())}),t(6,"Retry"),n()()}if(i&2){let e=d();a(4),v(e.configService.error())}}function ie(i,c){if(i&1){let e=u();o(0,"button",17),x("click",function(){s(e);let r=d(2);return m(r.startEdit("switches"))}),t(1,"Edit"),n()}}function oe(i,c){if(i&1){let e=u();o(0,"div",11)(1,"div",18)(2,"label",19)(3,"input",20),M("ngModelChange",function(r){s(e);let f=d(2);return b(f.formSwitches.allowEnrollment,r)||(f.formSwitches.allowEnrollment=r),m(r)}),n(),t(4," Allow Enrollment "),n(),o(5,"small"),t(6,"When disabled, users cannot submit new orders"),n()(),o(7,"div",18)(8,"label",19)(9,"input",20),M("ngModelChange",function(r){s(e);let f=d(2);return b(f.formSwitches.maintenanceMode,r)||(f.formSwitches.maintenanceMode=r),m(r)}),n(),t(10," Maintenance Mode "),n(),o(11,"small"),t(12,"Read-only mode for users"),n()(),o(13,"div",21)(14,"button",22),x("click",function(){s(e);let r=d(2);return m(r.saveSystemSwitch())}),t(15,"Save"),n(),o(16,"button",23),x("click",function(){s(e);let r=d(2);return m(r.cancelEdit())}),t(17,"Cancel"),n()()()}if(i&2){let e=d(2);a(3),y("ngModel",e.formSwitches.allowEnrollment),a(6),y("ngModel",e.formSwitches.maintenanceMode)}}function re(i,c){if(i&1&&(o(0,"div",12)(1,"div",24)(2,"span",25),t(3,"Allow Enrollment:"),n(),o(4,"span",26),t(5),n()(),o(6,"div",24)(7,"span",25),t(8,"Maintenance Mode:"),n(),o(9,"span",26),t(10),n()()()),i&2){let e=d(2);a(4),A("status-active",e.configService.systemSwitch().allowEnrollment)("status-inactive",!e.configService.systemSwitch().allowEnrollment),a(),w(" ",e.configService.systemSwitch().allowEnrollment?"Enabled":"Disabled"," "),a(4),A("status-active",e.configService.systemSwitch().maintenanceMode)("status-inactive",!e.configService.systemSwitch().maintenanceMode),a(),w(" ",e.configService.systemSwitch().maintenanceMode?"Active":"Inactive"," ")}}function ae(i,c){if(i&1){let e=u();o(0,"button",17),x("click",function(){s(e);let r=d(2);return m(r.startEdit("contact"))}),t(1,"Edit"),n()}}function ce(i,c){if(i&1){let e=u();o(0,"div",11)(1,"div",18)(2,"label",27),t(3,"Email"),n(),o(4,"input",28),M("ngModelChange",function(r){s(e);let f=d(2);return b(f.formContact.email,r)||(f.formContact.email=r),m(r)}),n()(),o(5,"div",18)(6,"label",29),t(7,"Phone"),n(),o(8,"input",30),M("ngModelChange",function(r){s(e);let f=d(2);return b(f.formContact.phone,r)||(f.formContact.phone=r),m(r)}),n()(),o(9,"div",18)(10,"label",31),t(11,"Address (Optional)"),n(),o(12,"textarea",32),M("ngModelChange",function(r){s(e);let f=d(2);return b(f.formContact.address,r)||(f.formContact.address=r),m(r)}),n()(),o(13,"div",21)(14,"button",22),x("click",function(){s(e);let r=d(2);return m(r.saveContactInfo())}),t(15,"Save"),n(),o(16,"button",23),x("click",function(){s(e);let r=d(2);return m(r.cancelEdit())}),t(17,"Cancel"),n()()()}if(i&2){let e=d(2);a(4),y("ngModel",e.formContact.email),a(4),y("ngModel",e.formContact.phone),a(4),y("ngModel",e.formContact.address)}}function de(i,c){if(i&1&&(o(0,"div",24)(1,"span",25),t(2,"Address:"),n(),o(3,"span",33),t(4),n()()),i&2){let e=d(3);a(4),v(e.configService.contactInfo().address)}}function le(i,c){if(i&1&&(o(0,"div",12)(1,"div",24)(2,"span",25),t(3,"Email:"),n(),o(4,"span",33),t(5),n()(),o(6,"div",24)(7,"span",25),t(8,"Phone:"),n(),o(9,"span",33),t(10),n()(),g(11,de,5,1,"div",24),n()),i&2){let e=d(2);a(5),v(e.configService.contactInfo().email),a(5),v(e.configService.contactInfo().phone),a(),p(e.configService.contactInfo().address?11:-1)}}function se(i,c){if(i&1&&(o(0,"div",4)(1,"div",8)(2,"div",9)(3,"h3"),t(4,"System Switches"),n(),g(5,ie,2,0,"button",10),n(),g(6,oe,18,2,"div",11)(7,re,11,10,"div",12),n(),o(8,"div",13)(9,"div",9)(10,"h3"),t(11,"Content Editor"),n(),o(12,"a",14),t(13,"Open Editor"),n()(),o(14,"div",12)(15,"p",15),t(16," Manage all markdown-based content in one place: "),n(),o(17,"ul",16)(18,"li"),t(19,"Payment Instructions"),n(),o(20,"li"),t(21,"Liability Release Agreement"),n(),o(22,"li"),t(23,"Financial Terms (Refund Policy)"),n(),o(24,"li"),t(25,"Media Policy (Photo/Video Consent)"),n(),o(26,"li"),t(27,"Forms Page Content"),n()()()(),k(28,"app-admin-user-cache-card"),o(29,"div",8)(30,"div",9)(31,"h3"),t(32,"Contact Information"),n(),g(33,ae,2,0,"button",10),n(),g(34,ce,18,3,"div",11)(35,le,12,3,"div",12),n()()),i&2){let e=d();a(5),p(e.editMode()!=="switches"?5:-1),a(),p(e.editMode()==="switches"?6:7),a(27),p(e.editMode()!=="contact"?33:-1),a(),p(e.editMode()==="contact"?34:35)}}var H=class i{configService=h(L);userService=h(j);router=h(W);notificationService=h(q);editMode=V(null);formYear=2025;formSwitches={allowEnrollment:!0,maintenanceMode:!1};formContact={email:"",phone:"",address:""};async ngOnInit(){if(!this.userService.isAuthenticated()){this.router.navigate(["/login"]);return}if(!this.userService.isAdmin()){this.router.navigate(["/"]);return}await this.loadConfig()}async loadConfig(){try{await this.configService.fetchConfig()}catch{}}startEdit(c){this.editMode.set(c);let e=this.configService.config();switch(c){case"switches":this.formSwitches=O({},e.systemSwitch);break;case"contact":this.formContact=O({},e.contactInfo);break}}cancelEdit(){this.editMode.set(null)}async saveSystemSwitch(){try{await this.configService.updateSystemSwitch(this.formSwitches),this.editMode.set(null)}catch(c){this.notificationService.error("Failed to update system switches: "+c.message)}}async saveContactInfo(){if(!this.formContact.email||!this.formContact.phone){this.notificationService.warning("Email and phone are required");return}try{await this.configService.updateContactInfo(this.formContact),this.editMode.set(null)}catch(c){this.notificationService.error("Failed to update contact information: "+c.message)}}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=S({type:i,selectors:[["app-admin-config"]],decls:5,vars:3,consts:[["pageTitle","System Configuration","pageSubtitle","Manage global settings"],[1,"admin-config"],[1,"loading-container"],[1,"error-container"],[1,"config-grid"],[1,"spinner"],[1,"error-icon"],[1,"btn-retry",3,"click"],[1,"config-card"],[1,"card-header"],[1,"btn-edit"],[1,"edit-form"],[1,"card-content"],[1,"config-card","content-editor-card"],["routerLink","/admin/content",1,"btn-edit"],[1,"content-description"],[1,"content-list"],[1,"btn-edit",3,"click"],[1,"form-group"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"form-actions"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-outline",3,"click"],[1,"info-row"],[1,"label"],[1,"status-badge"],["for","contactEmail"],["type","email","id","contactEmail","placeholder","info@example.com",3,"ngModelChange","ngModel"],["for","contactPhone"],["type","tel","id","contactPhone","placeholder","(555) 123-4567",3,"ngModelChange","ngModel"],["for","contactAddress"],["id","contactAddress","rows","3","placeholder","Street address",3,"ngModelChange","ngModel"],[1,"value"]],template:function(e,l){e&1&&(o(0,"app-admin-layout",0)(1,"div",1),g(2,ne,4,0,"div",2),g(3,te,7,1,"div",3),g(4,se,36,4,"div",4),n()()),e&2&&(a(2),p(l.configService.loading()?2:-1),a(),p(l.configService.error()?3:-1),a(),p(!l.configService.loading()&&!l.configService.error()?4:-1))},dependencies:[P,B,D,R,N,F,U,E,Y],styles:[".admin-config[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:1.5rem}.loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{background:var(--sys-error-container, #ffebee);border-radius:12px}.error-icon[_ngcontent-%COMP%]{width:48px;height:48px;background:var(--sys-error, #c62828);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;margin-bottom:1rem}.btn-retry[_ngcontent-%COMP%]{padding:.5rem 1.5rem;background:var(--sys-error, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer}.config-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:1.5rem}.config-card[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline-variant, #f0f0f0);border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000000d}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:.75rem;border-bottom:1px solid var(--sys-outline-variant, #f0f0f0)}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;color:var(--sys-on-surface, #212121)}.btn-edit[_ngcontent-%COMP%]{padding:.375rem .875rem;background:transparent;border:1px solid var(--sys-primary, #c62828);border-radius:6px;color:var(--sys-primary, #c62828);font-size:.875rem;cursor:pointer;transition:all .2s ease}.btn-edit[_ngcontent-%COMP%]:hover{background:var(--sys-primary, #c62828);color:#fff}.card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem}.info-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:var(--sys-on-surface-variant, #666);flex-shrink:0}.info-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--sys-on-surface, #212121);text-align:right}.status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.75rem;font-weight:500}.status-active[_ngcontent-%COMP%]{background:var(--sys-tertiary-container, #e8f5e9);color:var(--sys-tertiary, #2e7d32)}.status-inactive[_ngcontent-%COMP%]{background:var(--sys-error-container, #ffebee);color:var(--sys-error, #c62828)}.discount-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.discount-item[_ngcontent-%COMP%]{color:var(--sys-on-surface, #212121);font-size:.875rem}.markdown-preview[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0;white-space:pre-wrap;font-family:monospace;font-size:.875rem;color:var(--sys-on-surface, #212121)}.content-editor-card[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding-top:.5rem}.content-description[_ngcontent-%COMP%]{margin:0 0 .75rem;font-size:.875rem;color:var(--sys-on-surface-variant, #666)}.content-list[_ngcontent-%COMP%]{margin:0;padding-left:1.25rem;display:flex;flex-direction:column;gap:.25rem}.content-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.875rem;color:var(--sys-on-surface, #212121)}.edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:.875rem;color:var(--sys-on-surface, #212121)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.75rem;border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-size:.875rem;font-family:inherit}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--sys-primary, #c62828)}.form-group[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.75rem;color:var(--sys-on-surface-variant, #999)}.info-note[_ngcontent-%COMP%]{font-size:.875rem;color:var(--sys-on-surface-variant, #666);margin:.5rem 0 0;font-style:italic}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto;cursor:pointer}.form-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:flex-end;margin-top:.5rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1.25rem;border-radius:8px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease;border:none}.btn-primary[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--sys-primary-dark, #a51c1c)}.btn-outline[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--sys-outline, #e0e0e0);color:var(--sys-on-surface-variant, #666)}.btn-outline[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}@media(max-width:768px){.config-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{H as AdminConfigComponent};
