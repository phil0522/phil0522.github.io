import{a as I,b as W,c as Y,f as z,h as L,l as B,m as D,r as j}from"./chunk-HIR6W5ZO.js";import{b as T}from"./chunk-UWXZ74AC.js";import{a as V}from"./chunk-JXJ4MRT4.js";import{d as k,j as O,k as A}from"./chunk-ODOFH7NK.js";import{$a as C,Ab as y,Bb as b,Fb as u,Ga as c,Gb as x,Hb as v,Q as w,Ra as E,V as s,W as m,a as h,ab as g,fb as i,ga as S,gb as t,hb as P,lb as p,nb as f,pb as a,xb as M,zb as o}from"./chunk-C26OXKSD.js";function N(r,l){r&1&&(i(0,"div",4),P(1,"div",7),i(2,"p"),o(3,"Loading configuration..."),t()())}function R(r,l){if(r&1){let e=p();i(0,"div",5)(1,"div",8),o(2,"!"),t(),i(3,"p"),o(4),t(),i(5,"button",9),f("click",function(){s(e);let n=a();return m(n.loadConfig())}),o(6,"Retry"),t()()}if(r&2){let e=a();c(4),y(e.configService.error())}}function q(r,l){if(r&1){let e=p();i(0,"button",15),f("click",function(){s(e);let n=a(2);return m(n.startEdit("year"))}),o(1,"Edit"),t()}}function U(r,l){if(r&1){let e=p();i(0,"div",13)(1,"div",16)(2,"label",17),o(3,"Year"),t(),i(4,"input",18),v("ngModelChange",function(n){s(e);let _=a(2);return x(_.formYear,n)||(_.formYear=n),m(n)}),t()(),i(5,"div",19)(6,"button",20),f("click",function(){s(e);let n=a(2);return m(n.saveActiveYear())}),o(7,"Save"),t(),i(8,"button",21),f("click",function(){s(e);let n=a(2);return m(n.cancelEdit())}),o(9,"Cancel"),t()()()}if(r&2){let e=a(2);c(4),u("ngModel",e.formYear)}}function G(r,l){if(r&1&&(i(0,"div",14)(1,"div",22)(2,"span",23),o(3,"Current Year:"),t(),i(4,"span",24),o(5),t()()()),r&2){let e=a(2);c(5),y(e.configService.currentActiveYear())}}function H(r,l){if(r&1){let e=p();i(0,"button",15),f("click",function(){s(e);let n=a(2);return m(n.startEdit("switches"))}),o(1,"Edit"),t()}}function J(r,l){if(r&1){let e=p();i(0,"div",13)(1,"div",16)(2,"label",25)(3,"input",26),v("ngModelChange",function(n){s(e);let _=a(2);return x(_.formSwitches.allowEnrollment,n)||(_.formSwitches.allowEnrollment=n),m(n)}),t(),o(4," Allow Enrollment "),t(),i(5,"small"),o(6,"When disabled, users cannot submit new orders"),t()(),i(7,"div",16)(8,"label",25)(9,"input",26),v("ngModelChange",function(n){s(e);let _=a(2);return x(_.formSwitches.maintenanceMode,n)||(_.formSwitches.maintenanceMode=n),m(n)}),t(),o(10," Maintenance Mode "),t(),i(11,"small"),o(12,"Read-only mode for users"),t()(),i(13,"div",19)(14,"button",20),f("click",function(){s(e);let n=a(2);return m(n.saveSystemSwitch())}),o(15,"Save"),t(),i(16,"button",21),f("click",function(){s(e);let n=a(2);return m(n.cancelEdit())}),o(17,"Cancel"),t()()()}if(r&2){let e=a(2);c(3),u("ngModel",e.formSwitches.allowEnrollment),c(6),u("ngModel",e.formSwitches.maintenanceMode)}}function K(r,l){if(r&1&&(i(0,"div",14)(1,"div",22)(2,"span",23),o(3,"Allow Enrollment:"),t(),i(4,"span",27),o(5),t()(),i(6,"div",22)(7,"span",23),o(8,"Maintenance Mode:"),t(),i(9,"span",27),o(10),t()()()),r&2){let e=a(2);c(4),M("status-active",e.configService.systemSwitch().allowEnrollment)("status-inactive",!e.configService.systemSwitch().allowEnrollment),c(),b(" ",e.configService.systemSwitch().allowEnrollment?"Enabled":"Disabled"," "),c(4),M("status-active",e.configService.systemSwitch().maintenanceMode)("status-inactive",!e.configService.systemSwitch().maintenanceMode),c(),b(" ",e.configService.systemSwitch().maintenanceMode?"Active":"Inactive"," ")}}function Q(r,l){if(r&1){let e=p();i(0,"button",15),f("click",function(){s(e);let n=a(2);return m(n.startEdit("payment"))}),o(1,"Edit"),t()}}function X(r,l){if(r&1){let e=p();i(0,"div",13)(1,"div",16)(2,"label",28),o(3,"Instructions (Markdown)"),t(),i(4,"textarea",29),v("ngModelChange",function(n){s(e);let _=a(2);return x(_.formPayment.content,n)||(_.formPayment.content=n),m(n)}),t(),i(5,"small"),o(6,"Supports Markdown formatting"),t()(),i(7,"div",19)(8,"button",20),f("click",function(){s(e);let n=a(2);return m(n.savePaymentInstructions())}),o(9,"Save"),t(),i(10,"button",21),f("click",function(){s(e);let n=a(2);return m(n.cancelEdit())}),o(11,"Cancel"),t()()()}if(r&2){let e=a(2);c(4),u("ngModel",e.formPayment.content)}}function Z(r,l){if(r&1&&(i(0,"div",14)(1,"div",30)(2,"pre"),o(3),t()()()),r&2){let e=a(2);c(3),y(e.configService.paymentInstructions().content)}}function $(r,l){if(r&1){let e=p();i(0,"button",15),f("click",function(){s(e);let n=a(2);return m(n.startEdit("contact"))}),o(1,"Edit"),t()}}function ee(r,l){if(r&1){let e=p();i(0,"div",13)(1,"div",16)(2,"label",31),o(3,"Email"),t(),i(4,"input",32),v("ngModelChange",function(n){s(e);let _=a(2);return x(_.formContact.email,n)||(_.formContact.email=n),m(n)}),t()(),i(5,"div",16)(6,"label",33),o(7,"Phone"),t(),i(8,"input",34),v("ngModelChange",function(n){s(e);let _=a(2);return x(_.formContact.phone,n)||(_.formContact.phone=n),m(n)}),t()(),i(9,"div",16)(10,"label",35),o(11,"Address (Optional)"),t(),i(12,"textarea",36),v("ngModelChange",function(n){s(e);let _=a(2);return x(_.formContact.address,n)||(_.formContact.address=n),m(n)}),t()(),i(13,"div",19)(14,"button",20),f("click",function(){s(e);let n=a(2);return m(n.saveContactInfo())}),o(15,"Save"),t(),i(16,"button",21),f("click",function(){s(e);let n=a(2);return m(n.cancelEdit())}),o(17,"Cancel"),t()()()}if(r&2){let e=a(2);c(4),u("ngModel",e.formContact.email),c(4),u("ngModel",e.formContact.phone),c(4),u("ngModel",e.formContact.address)}}function te(r,l){if(r&1&&(i(0,"div",22)(1,"span",23),o(2,"Address:"),t(),i(3,"span",24),o(4),t()()),r&2){let e=a(3);c(4),y(e.configService.contactInfo().address)}}function ne(r,l){if(r&1&&(i(0,"div",14)(1,"div",22)(2,"span",23),o(3,"Email:"),t(),i(4,"span",24),o(5),t()(),i(6,"div",22)(7,"span",23),o(8,"Phone:"),t(),i(9,"span",24),o(10),t()(),C(11,te,5,1,"div",22),t()),r&2){let e=a(2);c(5),y(e.configService.contactInfo().email),c(5),y(e.configService.contactInfo().phone),c(),g(e.configService.contactInfo().address?11:-1)}}function ie(r,l){if(r&1&&(i(0,"div",6)(1,"div",10)(2,"div",11)(3,"h3"),o(4,"Active Year"),t(),C(5,q,2,0,"button",12),t(),C(6,U,10,1,"div",13)(7,G,6,1,"div",14),t(),i(8,"div",10)(9,"div",11)(10,"h3"),o(11,"System Switches"),t(),C(12,H,2,0,"button",12),t(),C(13,J,18,2,"div",13)(14,K,11,10,"div",14),t(),i(15,"div",10)(16,"div",11)(17,"h3"),o(18,"Payment Instructions"),t(),C(19,Q,2,0,"button",12),t(),C(20,X,12,1,"div",13)(21,Z,4,1,"div",14),t(),i(22,"div",10)(23,"div",11)(24,"h3"),o(25,"Contact Information"),t(),C(26,$,2,0,"button",12),t(),C(27,ee,18,3,"div",13)(28,ne,12,3,"div",14),t()()),r&2){let e=a();c(5),g(e.editMode()!=="year"?5:-1),c(),g(e.editMode()==="year"?6:7),c(6),g(e.editMode()!=="switches"?12:-1),c(),g(e.editMode()==="switches"?13:14),c(6),g(e.editMode()!=="payment"?19:-1),c(),g(e.editMode()==="payment"?20:21),c(6),g(e.editMode()!=="contact"?26:-1),c(),g(e.editMode()==="contact"?27:28)}}var F=class r{configService=w(V);userService=w(T);router=w(O);editMode=S(null);formYear=2025;formSwitches={allowEnrollment:!0,maintenanceMode:!1};formPayment={content:""};formContact={email:"",phone:"",address:""};async ngOnInit(){if(!this.userService.isAuthenticated()){this.router.navigate(["/login"]);return}if(!this.userService.isAdmin()){this.router.navigate(["/"]);return}await this.loadConfig()}async loadConfig(){try{await this.configService.fetchConfig()}catch{}}startEdit(l){this.editMode.set(l);let e=this.configService.config();switch(l){case"year":this.formYear=e.currentActiveYear;break;case"switches":this.formSwitches=h({},e.systemSwitch);break;case"payment":this.formPayment=h({},e.paymentInstructions);break;case"contact":this.formContact=h({},e.contactInfo);break}}cancelEdit(){this.editMode.set(null)}async saveActiveYear(){if(this.formYear<2020||this.formYear>2100){alert("Year must be between 2020 and 2100");return}try{await this.configService.updateActiveYear(this.formYear),this.editMode.set(null)}catch(l){alert("Failed to update active year: "+l.message)}}async saveSystemSwitch(){try{await this.configService.updateSystemSwitch(this.formSwitches),this.editMode.set(null)}catch(l){alert("Failed to update system switches: "+l.message)}}async savePaymentInstructions(){try{await this.configService.updatePaymentInstructions(this.formPayment),this.editMode.set(null)}catch(l){alert("Failed to update payment instructions: "+l.message)}}async saveContactInfo(){if(!this.formContact.email||!this.formContact.phone){alert("Email and phone are required");return}try{await this.configService.updateContactInfo(this.formContact),this.editMode.set(null)}catch(l){alert("Failed to update contact information: "+l.message)}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=E({type:r,selectors:[["app-admin-config"]],decls:11,vars:3,consts:[[1,"admin-config"],[1,"page-header"],["routerLink","/admin",1,"back-link"],[1,"subtitle"],[1,"loading-container"],[1,"error-container"],[1,"config-grid"],[1,"spinner"],[1,"error-icon"],[1,"btn-retry",3,"click"],[1,"config-card"],[1,"card-header"],[1,"btn-edit"],[1,"edit-form"],[1,"card-content"],[1,"btn-edit",3,"click"],[1,"form-group"],["for","activeYear"],["type","number","id","activeYear","min","2020","max","2100",3,"ngModelChange","ngModel"],[1,"form-actions"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-outline",3,"click"],[1,"info-row"],[1,"label"],[1,"value"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"status-badge"],["for","paymentContent"],["id","paymentContent","rows","8","placeholder","Enter payment instructions in Markdown format",3,"ngModelChange","ngModel"],[1,"markdown-preview"],["for","contactEmail"],["type","email","id","contactEmail","placeholder","info@example.com",3,"ngModelChange","ngModel"],["for","contactPhone"],["type","tel","id","contactPhone","placeholder","(555) 123-4567",3,"ngModelChange","ngModel"],["for","contactAddress"],["id","contactAddress","rows","3","placeholder","Street address",3,"ngModelChange","ngModel"]],template:function(e,d){e&1&&(i(0,"div",0)(1,"header",1)(2,"a",2),o(3,"\u2190 Back to Dashboard"),t(),i(4,"h1"),o(5,"System Configuration"),t(),i(6,"p",3),o(7,"Manage global settings"),t()(),C(8,N,4,0,"div",4),C(9,R,7,1,"div",5),C(10,ie,29,8,"div",6),t()),e&2&&(c(8),g(d.configService.loading()?8:-1),c(),g(d.configService.error()?9:-1),c(),g(!d.configService.loading()&&!d.configService.error()?10:-1))},dependencies:[k,j,W,L,I,Y,D,B,z,A],styles:[".admin-config[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:1.5rem}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.back-link[_ngcontent-%COMP%]{display:inline-block;color:var(--sys-primary, #c62828);text-decoration:none;font-size:.875rem;margin-bottom:.5rem}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.75rem;color:var(--sys-on-surface, #212121)}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;color:var(--sys-on-surface-variant, #666)}.loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{background:var(--sys-error-container, #ffebee);border-radius:12px}.error-icon[_ngcontent-%COMP%]{width:48px;height:48px;background:var(--sys-error, #c62828);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;margin-bottom:1rem}.btn-retry[_ngcontent-%COMP%]{padding:.5rem 1.5rem;background:var(--sys-error, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer}.config-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:1.5rem}.config-card[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline-variant, #f0f0f0);border-radius:12px;padding:1.5rem;box-shadow:0 2px 8px #0000000d}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;padding-bottom:.75rem;border-bottom:1px solid var(--sys-outline-variant, #f0f0f0)}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;color:var(--sys-on-surface, #212121)}.btn-edit[_ngcontent-%COMP%]{padding:.375rem .875rem;background:transparent;border:1px solid var(--sys-primary, #c62828);border-radius:6px;color:var(--sys-primary, #c62828);font-size:.875rem;cursor:pointer;transition:all .2s ease}.btn-edit[_ngcontent-%COMP%]:hover{background:var(--sys-primary, #c62828);color:#fff}.card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:1rem}.info-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:var(--sys-on-surface-variant, #666);flex-shrink:0}.info-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:var(--sys-on-surface, #212121);text-align:right}.status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.75rem;font-weight:500}.status-active[_ngcontent-%COMP%]{background:var(--sys-tertiary-container, #e8f5e9);color:var(--sys-tertiary, #2e7d32)}.status-inactive[_ngcontent-%COMP%]{background:var(--sys-error-container, #ffebee);color:var(--sys-error, #c62828)}.discount-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.discount-item[_ngcontent-%COMP%]{color:var(--sys-on-surface, #212121);font-size:.875rem}.markdown-preview[_ngcontent-%COMP%]   pre[_ngcontent-%COMP%]{margin:0;white-space:pre-wrap;font-family:monospace;font-size:.875rem;color:var(--sys-on-surface, #212121)}.edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:.875rem;color:var(--sys-on-surface, #212121)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.75rem;border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-size:.875rem;font-family:inherit}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--sys-primary, #c62828)}.form-group[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.75rem;color:var(--sys-on-surface-variant, #999)}.info-note[_ngcontent-%COMP%]{font-size:.875rem;color:var(--sys-on-surface-variant, #666);margin:.5rem 0 0;font-style:italic}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto;cursor:pointer}.form-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:flex-end;margin-top:.5rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1.25rem;border-radius:8px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease;border:none}.btn-primary[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--sys-primary-dark, #a51c1c)}.btn-outline[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--sys-outline, #e0e0e0);color:var(--sys-on-surface-variant, #666)}.btn-outline[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}@media(max-width:768px){.config-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{F as AdminConfigComponent};
