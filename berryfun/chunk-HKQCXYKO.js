import{a as N}from"./chunk-BXXBHAYP.js";import{b as F}from"./chunk-ZWPM7P6E.js";import{h as L}from"./chunk-LUIRMBOE.js";import"./chunk-FWPBDQV6.js";import"./chunk-WG3KNEG3.js";import{z as T}from"./chunk-6E4VX3TQ.js";import{d as D,j as k}from"./chunk-NA25QKA5.js";import{$a as m,Ab as p,Bb as g,Ga as d,Q as C,Qb as c,Ra as M,V as y,W as x,a as S,ab as u,b as h,cb as E,db as I,eb as w,fb as n,ga as P,gb as r,hb as b,lb as O,nb as v,pb as l,xb as _,zb as a}from"./chunk-C26OXKSD.js";var R=(i,o)=>o.sessionId;function z(i,o){if(i&1&&(n(0,"div",12)(1,"span",13),a(2,"\u26A0\uFE0F"),r(),n(3,"div",14)(4,"strong"),a(5,"Payment deadline has passed"),r(),n(6,"span",15),a(7),r()()()),i&2){let t=l(2);d(7),g(" Deadline was: ",t.formatDeadline(t.orderService.lockExpiresAt())," ")}}function G(i,o){if(i&1&&(n(0,"div",12)(1,"span",13),a(2,"\u23F0"),r(),n(3,"div",14)(4,"strong"),a(5),r(),n(6,"span",15),a(7),r()()()),i&2){let t=l(2);d(5),p(t.daysRemainingText()),d(2),g(" Deadline: ",t.formatDeadline(t.orderService.lockExpiresAt())," ")}}function V(i,o){if(i&1&&(n(0,"div",11),m(1,z,8,1,"div",12)(2,G,8,2,"div",12),r()),i&2){let t=l();_("overdue",t.orderService.isOverdue()),d(),u(t.orderService.isOverdue()?1:2)}}function $(i,o){i&1&&(n(0,"div",6),b(1,"div",16),n(2,"p"),a(3,"Loading..."),r()())}function j(i,o){if(i&1){let t=O();n(0,"div",7)(1,"div",17),a(2,"!"),r(),n(3,"p"),a(4),r(),n(5,"button",18),v("click",function(){y(t);let s=l();return x(s.orderService.clearError())}),a(6,"Retry"),r()()}if(i&2){let t=l();d(4),p(t.orderService.error())}}function B(i,o){if(i&1){let t=O();n(0,"div",19),a(1,"\u{1F4E6}"),r(),n(2,"h2"),a(3,"No Enrollments"),r(),n(4,"p"),a(5,"You don't have any enrollments yet"),r(),n(6,"button",20),v("click",function(){y(t);let s=l(2);return x(s.goToCatalog())}),a(7,"Browse Classes"),r()}}function U(i,o){if(i&1&&(n(0,"div",19),a(1,"\u{1F50D}"),r(),n(2,"h2"),a(3),r(),n(4,"p"),a(5,"Try a different filter"),r()),i&2){let t=l(2);d(3),g("No ",t.filterName()," enrollments")}}function Y(i,o){if(i&1&&(n(0,"div",8),m(1,B,8,0)(2,U,6,1),r()),i&2){let t=l();d(),u(t.activeFilter()==="all"?1:2)}}function q(i,o){if(i&1&&b(0,"app-class-registration-card",21),i&2){let t=o.$implicit;w("data",t)("showGroupStatus",!0)("showStudentStatus",t.status==="mixed")}}function H(i,o){if(i&1&&(n(0,"div",9),E(1,q,1,3,"app-class-registration-card",21,R),r()),i&2){let t=l();d(),I(t.filteredGroupedItems())}}function J(i,o){if(i&1&&(n(0,"div",24)(1,"span"),a(2,"Discounts"),r(),n(3,"span"),a(4),r()()),i&2){let t=l(2);d(4),p(t.formatAmount(t.orderService.totalDiscountAmount()))}}function K(i,o){if(i&1&&(n(0,"div",10)(1,"h2"),a(2,"Summary"),r(),n(3,"div",22)(4,"div",23)(5,"span"),a(6,"Active Enrollments"),r(),n(7,"span"),a(8),r()(),n(9,"div",23)(10,"span"),a(11,"Subtotal"),r(),n(12,"span"),a(13),r()(),m(14,J,5,1,"div",24),n(15,"div",25)(16,"span"),a(17,"Total Due"),r(),n(18,"span"),a(19),r()(),n(20,"div",26)(21,"span"),a(22,"Amount Paid"),r(),n(23,"span"),a(24),r()(),n(25,"div",27)(26,"span"),a(27,"Balance Due"),r(),n(28,"span",28),a(29),r()()()()),i&2){let t,e=l();d(8),p(e.activeItemCount()),d(5),p(e.formatAmount(((t=e.orderService.pricing())==null?null:t.subtotal)??0)),d(),u(e.orderService.totalDiscountAmount()!==0?14:-1),d(5),p(e.formatAmount(e.orderService.totalDue())),d(5),p(e.formatAmount(e.orderService.totalPaid())),d(5),p(e.formatAmount(e.orderService.amountDue()))}}var A=class i{orderService=C(L);configService=C(T);userService=C(F);router=C(k);activeFilter=P("all");cancelledCount=c(()=>this.orderService.cancelledItems().length);groupedItems=c(()=>{let o=this.orderService.items(),t=new Map;for(let e of o){let s={studentId:e.studentId,studentName:this.userService.getStudentById(e.studentId)?.fullName??"Unknown",options:e.options,status:e.status},f=t.get(e.sessionId);f?(f.students.push(s),f.status!==e.status&&f.status!=="mixed"&&(f.status="mixed")):t.set(e.sessionId,{sessionId:e.sessionId,className:e.snapshot.className,startDate:e.snapshot.startDate,endDate:e.snapshot.endDate,status:e.status,students:[s]})}return Array.from(t.values()).sort((e,s)=>e.className.localeCompare(s.className))});groupedItemsCount=c(()=>this.groupedItems().length);filteredGroupedItems=c(()=>{let o=this.activeFilter(),t=this.groupedItems();return o==="all"?t:t.map(e=>h(S({},e),{students:e.students.filter(s=>s.status===o)})).filter(e=>e.students.length>0)});filterName=c(()=>{let o=this.activeFilter();return{all:"All",submitted:"Pending Payment",paid:"Paid",cancelled:"Cancelled"}[o]});activeItemCount=c(()=>this.orderService.submittedCount()+this.orderService.paidCount());hasActiveItems=c(()=>this.activeItemCount()>0);showPaymentDeadline=c(()=>this.orderService.hasSubmittedItems()&&this.orderService.lockExpiresAt()!==null);daysRemaining=c(()=>{let o=this.orderService.lockExpiresAt();if(!o)return null;let t=new Date(this.configService.currentTime()),s=new Date(o).getTime()-t.getTime();return s<=0?null:Math.ceil(s/(1e3*60*60*24))});daysRemainingText=c(()=>{let o=this.daysRemaining();return o===null?"":o===1?"You have 1 day to complete payment":`You have ${o} days to complete payment`});setFilter(o){this.activeFilter.set(o)}goToCatalog(){this.router.navigate(["/catalog"])}formatAmount(o){return`$${(o/100).toFixed(2)}`}formatDeadline(o){return o?new Date(o).toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"}):""}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=M({type:i,selectors:[["app-order-list"]],decls:21,vars:18,consts:[[1,"order-list-page"],[1,"page-header"],[1,"subtitle"],[1,"payment-deadline-banner",3,"overdue"],[1,"filter-tabs"],[1,"tab",3,"click"],[1,"loading-container"],[1,"error-container"],[1,"empty-container"],[1,"orders-grid"],[1,"orders-summary"],[1,"payment-deadline-banner"],[1,"deadline-content"],[1,"deadline-icon"],[1,"deadline-text"],[1,"deadline-detail"],[1,"spinner"],[1,"error-icon"],[1,"btn-retry",3,"click"],[1,"empty-icon"],[1,"btn-primary",3,"click"],[3,"data","showGroupStatus","showStudentStatus"],[1,"summary-content"],[1,"summary-row"],[1,"summary-row","discount"],[1,"summary-row","total"],[1,"summary-row","paid"],[1,"summary-row","due"],[1,"amount-due"]],template:function(t,e){t&1&&(n(0,"div",0)(1,"header",1)(2,"h1"),a(3,"My Orders"),r(),n(4,"p",2),a(5,"View and manage your orders"),r()(),m(6,V,3,3,"div",3),n(7,"div",4)(8,"button",5),v("click",function(){return e.setFilter("all")}),a(9),r(),n(10,"button",5),v("click",function(){return e.setFilter("submitted")}),a(11),r(),n(12,"button",5),v("click",function(){return e.setFilter("paid")}),a(13),r(),n(14,"button",5),v("click",function(){return e.setFilter("cancelled")}),a(15),r()(),m(16,$,4,0,"div",6),m(17,j,7,1,"div",7),m(18,Y,3,1,"div",8),m(19,H,3,0,"div",9),m(20,K,30,6,"div",10),r()),t&2&&(d(6),u(e.showPaymentDeadline()?6:-1),d(2),_("active",e.activeFilter()==="all"),d(),g(" All (",e.groupedItemsCount(),") "),d(),_("active",e.activeFilter()==="submitted"),d(),g(" Pending Payment (",e.orderService.submittedCount(),") "),d(),_("active",e.activeFilter()==="paid"),d(),g(" Paid (",e.orderService.paidCount(),") "),d(),_("active",e.activeFilter()==="cancelled"),d(),g(" Cancelled (",e.cancelledCount(),") "),d(),u(e.orderService.loading()?16:-1),d(),u(e.orderService.error()?17:-1),d(),u(!e.orderService.loading()&&!e.orderService.error()&&e.filteredGroupedItems().length===0?18:-1),d(),u(e.filteredGroupedItems().length>0?19:-1),d(),u(e.hasActiveItems()?20:-1))},dependencies:[D,N],styles:[".order-list-page[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1.5rem}.page-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.payment-deadline-banner[_ngcontent-%COMP%]{background:#fff3cd;border:1px solid #ffc107;border-radius:12px;padding:1rem 1.25rem;margin-bottom:1.5rem}.payment-deadline-banner.overdue[_ngcontent-%COMP%]{background:var(--sys-error-container, #ffebee);border-color:var(--sys-error, #c62828)}.deadline-content[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.75rem}.deadline-icon[_ngcontent-%COMP%]{font-size:1.5rem;line-height:1}.deadline-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.deadline-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#856404;font-size:1rem}.payment-deadline-banner.overdue[_ngcontent-%COMP%]   .deadline-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--sys-error, #c62828)}.deadline-detail[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d}.payment-deadline-banner.overdue[_ngcontent-%COMP%]   .deadline-detail[_ngcontent-%COMP%]{color:var(--sys-on-error-container, #b71c1c)}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.75rem;color:var(--sys-on-surface, #212121)}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;color:var(--sys-on-surface-variant, #666)}.filter-tabs[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid var(--sys-outline-variant, #f0f0f0);overflow-x:auto}.tab[_ngcontent-%COMP%]{padding:.5rem 1rem;background:transparent;border:1px solid var(--sys-outline, #e0e0e0);border-radius:20px;font-size:.875rem;color:var(--sys-on-surface-variant, #666);cursor:pointer;white-space:nowrap;transition:all .2s ease}.tab[_ngcontent-%COMP%]:hover{border-color:var(--sys-primary, #c62828);color:var(--sys-primary, #c62828)}.tab.active[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);border-color:var(--sys-primary, #c62828);color:#fff}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;color:var(--sys-on-surface-variant, #666)}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{text-align:center;padding:3rem 2rem;background:var(--sys-error-container, #ffebee);border-radius:12px}.error-icon[_ngcontent-%COMP%]{width:48px;height:48px;background:var(--sys-error, #c62828);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;margin:0 auto 1rem}.error-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--sys-on-error-container, #b71c1c);margin-bottom:1rem}.btn-retry[_ngcontent-%COMP%]{padding:.5rem 1.5rem;background:var(--sys-error, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer}.empty-container[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem}.empty-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--sys-on-surface, #212121)}.empty-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #666);margin-bottom:1.5rem}.btn-primary[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s ease}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--sys-primary-dark, #a51c1c)}.orders-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.orders-summary[_ngcontent-%COMP%]{margin-top:2rem;padding:1.5rem;background:var(--sys-surface-container, #fafafa);border-radius:12px;border:1px solid var(--sys-outline-variant, #e0e0e0)}.orders-summary[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.25rem;color:var(--sys-on-surface, #212121)}.summary-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:.95rem;color:var(--sys-on-surface-variant, #666)}.summary-row.discount[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:var(--sys-secondary, #2e7d32)}.summary-row.total[_ngcontent-%COMP%]{padding-top:.75rem;border-top:1px solid var(--sys-outline-variant, #e0e0e0);font-weight:600;color:var(--sys-on-surface, #212121)}.summary-row.paid[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:var(--sys-secondary, #2e7d32)}.summary-row.due[_ngcontent-%COMP%]{padding-top:.5rem;font-weight:600;font-size:1.1rem;color:var(--sys-on-surface, #212121)}.summary-row[_ngcontent-%COMP%]   .amount-due[_ngcontent-%COMP%]{color:var(--sys-primary, #c62828)}"]})};export{A as OrderListComponent};
