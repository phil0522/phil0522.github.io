import{a as pe}from"./chunk-TXMCXX3T.js";import{a as me}from"./chunk-WHGADJKZ.js";import{a as ce}from"./chunk-WZD4CHKO.js";import"./chunk-AFLVTGEW.js";import{a as se}from"./chunk-F53H4XUE.js";import{b as K,c as Q,d as X,e as ee,f as te,g as ne,i as ie,j as oe,k as ae,n as re,r as de}from"./chunk-7Y5CEA3U.js";import{a as le}from"./chunk-DEG56DW5.js";import"./chunk-XKJWOYIG.js";import{b as Y}from"./chunk-RDKP2ZJK.js";import{b as J}from"./chunk-YUXLOB7R.js";import{a as H}from"./chunk-6B5SPXH3.js";import{b as Z}from"./chunk-6MUO5BU2.js";import{Aa as z,Ka as $,La as U,Ma as G,b as j,d as N,j as L,k as F,wa as W,xa as B}from"./chunk-B4PSB7QN.js";import{Eb as a,Fb as x,Gb as f,Hb as k,Ia as r,Kb as y,Lb as S,Mb as O,R as D,Rb as R,Ta as q,Vb as h,W as c,X as m,Yb as V,bb as u,cb as _,db as E,fb as w,gb as M,ha as P,hb as C,ib as t,jb as i,kb as v,ob as b,qb as g,sb as s}from"./chunk-VKJSCVXY.js";function ue(n){switch(n){case"locked":return"status-badge status-locked";case"submitted":return"status-badge status-submitted";case"paid":return"status-badge status-paid";case"cancelled":return"status-badge status-cancelled";case"change_requested":return"status-badge status-change-requested";case"refunded":return"status-badge status-refunded";case"partial":return"status-badge status-partial";case"empty":return"status-badge status-empty";default:return"status-badge"}}function _e(n){switch(n){case"locked":return"Awaiting Screenshot";case"submitted":return"Pending Payment";case"paid":return"Paid";case"cancelled":return"Cancelled";case"change_requested":return"Change Requested";case"refunded":return"Refunded";case"partial":return"Partially Paid";case"empty":return"Empty";default:return n}}function ge(n){switch(n){case"locked":return"item-status-badge item-status-locked";case"submitted":return"item-status-badge item-status-submitted";case"paid":return"item-status-badge item-status-paid";case"cancelled":return"item-status-badge item-status-cancelled";case"refunded":return"item-status-badge item-status-refunded";default:return"item-status-badge"}}function xe(n){switch(n){case"locked":return"Awaiting Screenshot";case"submitted":return"Pending";case"paid":return"Paid";case"cancelled":return"Cancelled";case"refunded":return"Refunded";default:return n}}function Ce(n){return`$${(n/100).toFixed(2)}`}function A(n){let o=n.replace(/[^0-9.]/g,""),e=parseFloat(o)||0;return Math.round(e*100)}function T(n){return(n/100).toFixed(2)}function fe(n){return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function he(n){return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}var Se=(n,o)=>({"text-danger":n,"text-warning":o}),I=(n,o)=>o.sessionId+"-"+o.studentId,Oe=(n,o)=>o.sessionId,we=(n,o)=>o.id;function Me(n,o){n&1&&(t(0,"div",1),v(1,"div",5),t(2,"p"),a(3,"Loading order details..."),i()())}function De(n,o){if(n&1){let e=b();t(0,"div",2)(1,"strong"),a(2,"Error:"),i(),a(3),t(4,"button",6),g("click",function(){c(e);let d=s();return m(d.clearError())}),a(5,"\xD7"),i()()}if(n&2){let e=s();r(3),f(" ",e.error()," ")}}function Pe(n,o){if(n&1&&(t(0,"div",19)(1,"span",20),a(2,"Phone:"),i(),t(3,"span",22),a(4),i()()),n&2){let e=s(3);r(4),x(e.userData().phone)}}function Ee(n,o){if(n&1&&(t(0,"div",19)(1,"span",20),a(2,"Address:"),i(),t(3,"span",22),a(4),i()()),n&2){let e=s(3);r(4),x(e.userData().address)}}function Ae(n,o){if(n&1&&(t(0,"div",16)(1,"h2"),a(2,"User Information"),i(),t(3,"div",35)(4,"div",19)(5,"span",20),a(6,"Name:"),i(),t(7,"span",22),a(8),i()(),t(9,"div",19)(10,"span",20),a(11,"Email:"),i(),t(12,"span",22),a(13),i()(),u(14,Pe,5,1,"div",19),u(15,Ee,5,1,"div",19),i()()),n&2){let e=s(2);r(8),x(e.userData().displayName),r(5),x(e.userData().email),r(),_(e.userData().phone?14:-1),r(),_(e.userData().address?15:-1)}}function Ie(n,o){if(n&1&&(t(0,"span",37),a(1),i()),n&2){let e=s(3);r(),k(" (",e.remainingLockTime().hours,"h ",e.remainingLockTime().minutes,"m remaining) ")}}function ke(n,o){if(n&1&&(t(0,"div",19)(1,"span",20),a(2,"Lock Expires:"),i(),t(3,"span",36),a(4),u(5,Ie,2,2,"span",37),i()()),n&2){let e=s(2);r(3),C("ngClass",R(3,Se,e.isOverdue(),e.isExpiringSoon())),r(),f(" ",e.formatDateTime(e.order().lockExpiresAt)," "),r(),_(e.remainingLockTime()?5:-1)}}function Te(n,o){n&1&&(t(0,"div",23)(1,"strong"),a(2,"\u26A0\uFE0F Overdue:"),i(),a(3," This order's payment lock has expired. Items may be released. "),i())}function qe(n,o){if(n&1){let e=b();t(0,"button",38),g("click",function(){c(e);let d=s(2);return m(d.openCancelItemsDialog())}),a(1," Cancel Items "),i()}}function Re(n,o){if(n&1&&(t(0,"div",42)(1,"div",43)(2,"span",44),a(3),i(),t(4,"span",45),a(5),i()(),t(6,"div",46)(7,"div",47)(8,"span",20),a(9,"Student:"),i(),t(10,"span",22),a(11),i()(),t(12,"div",47)(13,"span",20),a(14,"Options:"),i(),t(15,"span",22),v(16,"app-option-badges",48),i()()()()),n&2){let e=o.$implicit,l=s(3);r(3),x(l.getClassName(e.sessionId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," "),r(6),x(l.getStudentName(e.studentId)),r(5),C("options",e.options)("showEmpty",!0)}}function Ve(n,o){if(n&1&&(t(0,"div",27)(1,"h3",39),a(2," Locked Items "),t(3,"span",40),a(4),i()(),t(5,"div",41),w(6,Re,17,6,"div",42,I),i()()),n&2){let e=s(2);r(4),f("(",e.lockedItems().length,")"),r(2),M(e.lockedItems())}}function je(n,o){if(n&1&&(t(0,"div",49)(1,"div",43)(2,"span",44),a(3),i(),t(4,"span",45),a(5),i()(),t(6,"div",46)(7,"div",47)(8,"span",20),a(9,"Student:"),i(),t(10,"span",22),a(11),i()(),t(12,"div",47)(13,"span",20),a(14,"Options:"),i(),t(15,"span",22),v(16,"app-option-badges",48),i()()()()),n&2){let e=o.$implicit,l=s(3);r(3),x(l.getClassName(e.sessionId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," "),r(6),x(l.getStudentName(e.studentId)),r(5),C("options",e.options)("showEmpty",!0)}}function Ne(n,o){if(n&1&&(t(0,"div",27)(1,"h3",39),a(2," Paid Items "),t(3,"span",40),a(4),i()(),t(5,"div",41),w(6,je,17,6,"div",49,I),i()()),n&2){let e=s(2);r(4),f("(",e.paidItems().length,")"),r(2),M(e.paidItems())}}function Le(n,o){if(n&1&&(t(0,"div",50)(1,"div",43)(2,"span",44),a(3),i(),t(4,"span",45),a(5),i()(),t(6,"div",46)(7,"div",47)(8,"span",20),a(9,"Student:"),i(),t(10,"span",22),a(11),i()(),t(12,"div",47)(13,"span",20),a(14,"Options:"),i(),t(15,"span",22),v(16,"app-option-badges",48),i()()()()),n&2){let e=o.$implicit,l=s(3);r(3),x(l.getClassName(e.sessionId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," "),r(6),x(l.getStudentName(e.studentId)),r(5),C("options",e.options)("showEmpty",!0)}}function Fe(n,o){if(n&1&&(t(0,"div",27)(1,"h3",39),a(2," Pending Payment "),t(3,"span",40),a(4),i()(),t(5,"div",41),w(6,Le,17,6,"div",50,I),i()()),n&2){let e=s(2);r(4),f("(",e.submittedItems().length,")"),r(2),M(e.submittedItems())}}function We(n,o){n&1&&(t(0,"div",28)(1,"p"),a(2,"No items in this order."),i()())}function Be(n,o){if(n&1&&(t(0,"div",29),v(1,"app-payment-screenshot-gallery",51),i()),n&2){let e=s(2);r(),C("screenshots",e.order().paymentScreenshots)}}function ze(n,o){if(n&1&&(t(0,"div",30)(1,"h2"),a(2,"Pricing Summary"),i(),v(3,"app-price-breakdown",52),i()),n&2){let e=s(2);r(3),C("data",e.priceBreakdownData())}}function $e(n,o){if(n&1&&(t(0,"tr")(1,"td"),a(2),i(),t(3,"td",54),a(4),i(),t(5,"td")(6,"span",55),a(7),i()(),t(8,"td"),a(9),i(),t(10,"td"),a(11),i()()),n&2){let e=o.$implicit,l=s(3);r(2),x(l.formatDateTime(e.recordedAt)),r(2),x(l.formatCurrency(e.amount)),r(3),x(e.method),r(2),x(e.reference),r(2),x(e.notes||"-")}}function Ue(n,o){if(n&1&&(t(0,"div",31)(1,"h2"),a(2,"Payment History"),i(),t(3,"table",53)(4,"thead")(5,"tr")(6,"th"),a(7,"Date"),i(),t(8,"th"),a(9,"Amount"),i(),t(10,"th"),a(11,"Method"),i(),t(12,"th"),a(13,"Reference"),i(),t(14,"th"),a(15,"Notes"),i()()(),t(16,"tbody"),w(17,$e,12,5,"tr",null,E),i()()()),n&2){let e=s(2);r(17),M(e.payments())}}function Ge(n,o){if(n&1){let e=b();t(0,"div",57)(1,"div",58)(2,"span",44),a(3),i()(),t(4,"div",59)(5,"div",47)(6,"span",20),a(7,"Joined:"),i(),t(8,"span",22),a(9),i()()(),t(10,"button",38),g("click",function(){let d=c(e).$implicit,p=s(3);return m(p.openRemoveWaitlistDialog(d.sessionId))}),a(11," Remove Entry "),i()()}if(n&2){let e=o.$implicit,l=s(3);r(3),x(l.getClassName(e.sessionId)),r(6),x(l.formatDateTime(e.joinedAt))}}function Ye(n,o){if(n&1&&(t(0,"div",32)(1,"h2"),a(2,"Waitlist Entries"),i(),t(3,"div",56),w(4,Ge,12,2,"div",57,Oe),i()()),n&2){let e=s(2);r(4),M(e.waitlistEntries())}}function He(n,o){if(n&1&&(t(0,"div",68),a(1),i()),n&2){let e=o.$implicit,l=s(4);r(),f(" ",l.getActionDescription(e)," ")}}function Je(n,o){if(n&1&&(t(0,"div",70)(1,"span",20),a(2,"Reason:"),i(),t(3,"span",22),a(4),i()()),n&2){let e=s().$implicit;r(4),x(e.reason)}}function Ze(n,o){if(n&1&&(t(0,"div",70)(1,"span",20),a(2,"Admin Adjustment:"),i(),t(3,"span",36),a(4),i()()),n&2){let e=s().$implicit,l=s(3);r(3),C("ngClass",e.adminAdjustment<0?"text-success":"text-danger"),r(),k(" ",e.adminAdjustment<0?"-":"+","",l.formatCurrency(l.Math.abs(e.adminAdjustment))," ")}}function Ke(n,o){if(n&1&&(t(0,"div",70)(1,"span",20),a(2,"Adjustment Reason:"),i(),t(3,"span",22),a(4),i()()),n&2){let e=s().$implicit;r(4),x(e.adminAdjustmentReason)}}function Qe(n,o){if(n&1&&(t(0,"div",70)(1,"span",20),a(2,"Processed:"),i(),t(3,"span",22),a(4),i()()),n&2){let e=s().$implicit,l=s(3);r(4),x(l.formatDateTime(e.processedAt))}}function Xe(n,o){if(n&1&&(t(0,"div",70)(1,"span",20),a(2,"Admin Notes:"),i(),t(3,"span",22),a(4),i()()),n&2){let e=s().$implicit;r(4),x(e.adminNotes)}}function et(n,o){if(n&1){let e=b();t(0,"button",72),g("click",function(){c(e);let d=s().$implicit,p=s(3);return m(p.openUpdateAdjustmentDialog(d))}),a(1," Edit Adjustment "),i(),t(2,"button",73),g("click",function(){c(e);let d=s().$implicit,p=s(3);return m(p.openApproveChangeDialog(d))}),a(3," Approve "),i(),t(4,"button",38),g("click",function(){c(e);let d=s().$implicit,p=s(3);return m(p.openDenyChangeDialog(d))}),a(5," Deny "),i()}}function tt(n,o){if(n&1&&(t(0,"div",61)(1,"div",62)(2,"div",63)(3,"span",64),a(4),i(),t(5,"span",65),a(6),i()()(),t(7,"div",66)(8,"div",67)(9,"strong"),a(10,"Actions:"),i(),w(11,He,2,1,"div",68,E),i(),t(13,"div",69)(14,"div",70)(15,"span",20),a(16,"Requested:"),i(),t(17,"span",22),a(18),i()(),u(19,Je,5,1,"div",70),u(20,Ze,5,3,"div",70),u(21,Ke,5,1,"div",70),u(22,Qe,5,1,"div",70),u(23,Xe,5,1,"div",70),i()(),t(24,"div",71),u(25,et,6,0),i()()),n&2){let e=o.$implicit,l=s(3);C("ngClass","status-"+e.status),r(4),x(e.id),r(),C("ngClass","status-"+e.status),r(),f(" ",l.getChangeStatusLabel(e.status)," "),r(5),M(e.actions),r(7),x(l.formatDateTime(e.requestedAt)),r(),_(e.reason?19:-1),r(),_(e.adminAdjustment!==0?20:-1),r(),_(e.adminAdjustmentReason?21:-1),r(),_(e.processedAt?22:-1),r(),_(e.adminNotes?23:-1),r(2),_(e.status==="pending"?25:-1)}}function nt(n,o){if(n&1&&(t(0,"div",33)(1,"h2"),a(2,"Change Requests"),i(),t(3,"div",60),w(4,tt,26,11,"div",61,we),i()()),n&2){let e=s(2);r(4),M(e.changeRequests())}}function it(n,o){if(n&1&&(t(0,"div",79),a(1),i()),n&2){let e=s().$implicit;r(),x(e.details)}}function ot(n,o){n&1&&(t(0,"span",85),a(1,"Lunch"),i())}function at(n,o){n&1&&(t(0,"span",85),a(1,"Extended Care"),i())}function rt(n,o){if(n&1&&(t(0,"span",84),u(1,ot,2,0,"span",85),u(2,at,2,0,"span",85),i()),n&2){let e=s().$implicit;r(),_(e.options.lunch?1:-1),r(),_(e.options.extendedCare?2:-1)}}function dt(n,o){if(n&1&&(t(0,"div",81)(1,"span",82),a(2),i(),t(3,"span",83),a(4),i(),u(5,rt,3,2,"span",84),i()),n&2){let e=o.$implicit,l=s(5);r(2),x(e.className),r(2),x(l.getStudentName(e.studentId)),r(),_(e.options?5:-1)}}function lt(n,o){if(n&1&&(t(0,"div",80),w(1,dt,6,3,"div",81,E),i()),n&2){let e=s().$implicit;r(),M(e.affectedItems)}}function st(n,o){if(n&1&&(t(0,"div",75)(1,"div",76),a(2),i(),t(3,"div",77)(4,"div",78),a(5),i(),u(6,it,2,1,"div",79),u(7,lt,3,0,"div",80),i()()),n&2){let e=o.$implicit,l=s(3);r(2),x(l.formatDateTime(e.timestamp)),r(3),x(e.action),r(),_(e.details?6:-1),r(),_(e.affectedItems&&e.affectedItems.length>0?7:-1)}}function ct(n,o){if(n&1&&(t(0,"div",34)(1,"h2"),a(2,"Order History"),i(),t(3,"div",74),w(4,st,8,4,"div",75,E),i()()),n&2){let e=s(2);r(4),M(e.order().history)}}function mt(n,o){if(n&1){let e=b();t(0,"div",3)(1,"div",7)(2,"div",8)(3,"a",9),a(4,"\u2190 Back to Orders"),i(),t(5,"h1"),a(6,"Order Details"),i(),t(7,"div",10)(8,"span",11),a(9),i(),t(10,"span",12),a(11),i()()(),t(12,"div",13)(13,"button",14),g("click",function(){c(e);let d=s();return m(d.openAddAdjustmentDialog())}),a(14," Add Credit/Fee "),i(),t(15,"button",15),g("click",function(){c(e);let d=s();return m(d.openRecordPaymentDialog())}),a(16," Record Payment "),i()()(),u(17,Ae,16,4,"div",16),t(18,"div",17)(19,"h2"),a(20,"Order Status"),i(),t(21,"div",18)(22,"div",19)(23,"span",20),a(24,"Status:"),i(),t(25,"span",21),a(26),i()(),u(27,ke,6,6,"div",19),t(28,"div",19)(29,"span",20),a(30,"Created:"),i(),t(31,"span",22),a(32),i()(),t(33,"div",19)(34,"span",20),a(35,"Last Updated:"),i(),t(36,"span",22),a(37),i()()(),u(38,Te,4,0,"div",23),i(),t(39,"div",24)(40,"div",25)(41,"h2"),a(42,"Order Items"),i(),u(43,qe,2,0,"button",26),i(),u(44,Ve,8,1,"div",27),u(45,Ne,8,1,"div",27),u(46,Fe,8,1,"div",27),u(47,We,3,0,"div",28),i(),u(48,Be,2,1,"div",29),u(49,ze,4,1,"div",30),u(50,Ue,19,0,"div",31),u(51,Ye,6,0,"div",32),u(52,nt,6,0,"div",33),u(53,ct,6,0,"div",34),i()}if(n&2){let e=s();r(9),f("User: ",e.order().userDisplayId),r(),C("ngClass",e.getStatusBadgeClass(e.getOrderStatus(e.order()))),r(),f(" ",e.getStatusLabel(e.getOrderStatus(e.order()))," "),r(4),C("disabled",!e.canRecordPayment()),r(2),_(e.userData()?17:-1),r(8),C("ngClass",e.getStatusBadgeClass(e.getOrderStatus(e.order()))),r(),f(" ",e.getStatusLabel(e.getOrderStatus(e.order()))," "),r(),_(e.order().lockExpiresAt?27:-1),r(5),x(e.formatDateTime(e.order().createdAt)),r(5),x(e.formatDateTime(e.order().updatedAt)),r(),_(e.isOverdue()?38:-1),r(5),_(e.cancellableItems().length>0?43:-1),r(),_(e.lockedItems().length>0?44:-1),r(),_(e.paidItems().length>0?45:-1),r(),_(e.submittedItems().length>0?46:-1),r(),_(e.allItems().length===0?47:-1),r(),_(e.order().paymentScreenshots.length>0?48:-1),r(),_(e.priceBreakdownData()?49:-1),r(),_(e.payments().length>0?50:-1),r(),_(e.waitlistEntries().length>0?51:-1),r(),_(e.changeRequests().length>0?52:-1),r(),_(e.order().history&&e.order().history.length>0?53:-1)}}function pt(n,o){if(n&1&&(t(0,"div",23),a(1),i()),n&2){let e=s(2);r(),x(e.actionError())}}function ut(n,o){n&1&&(v(0,"span",108),a(1," Recording... "))}function _t(n,o){n&1&&a(0," Record Payment ")}function gt(n,o){if(n&1){let e=b();t(0,"div",86),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),t(1,"div",87),g("click",function(d){return c(e),m(d.stopPropagation())}),t(2,"div",88)(3,"h3"),a(4,"Record Payment"),i(),t(5,"button",6),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",89)(8,"form",90),g("ngSubmit",function(){c(e);let d=s();return m(d.recordPayment())}),t(9,"div",91)(10,"label",92),a(11,"Amount *"),i(),t(12,"input",93),O("ngModelChange",function(d){c(e);let p=s();return S(p.formPayment.amountInput,d)||(p.formPayment.amountInput=d),m(d)}),i(),t(13,"small",94),a(14),i()(),t(15,"div",91)(16,"label",95),a(17,"Payment Method *"),i(),t(18,"select",96),O("ngModelChange",function(d){c(e);let p=s();return S(p.formPayment.method,d)||(p.formPayment.method=d),m(d)}),t(19,"option",97),a(20,"Zelle"),i(),t(21,"option",98),a(22,"Check"),i(),t(23,"option",99),a(24,"Cash"),i(),t(25,"option",100),a(26,"Other"),i()()(),t(27,"div",91)(28,"label",101),a(29," Reference (optional) "),i(),t(30,"input",102),O("ngModelChange",function(d){c(e);let p=s();return S(p.formPayment.reference,d)||(p.formPayment.reference=d),m(d)}),i()(),t(31,"div",91)(32,"label",103),a(33,"Notes"),i(),t(34,"textarea",104),O("ngModelChange",function(d){c(e);let p=s();return S(p.formPayment.notes,d)||(p.formPayment.notes=d),m(d)}),i()(),u(35,pt,2,1,"div",23),t(36,"div",105)(37,"button",106),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(38," Cancel "),i(),t(39,"button",107),u(40,ut,2,0)(41,_t,1,0),i()()()()()()}if(n&2){let e=s();r(12),y("ngModel",e.formPayment.amountInput),r(2),f(" Amount due: ",e.formatCurrency(e.amountDue())," "),r(4),y("ngModel",e.formPayment.method),r(12),y("ngModel",e.formPayment.reference),r(4),y("ngModel",e.formPayment.notes),r(),_(e.actionError()?35:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),_(e.actionLoading()?40:41)}}function xt(n,o){if(n&1){let e=b();t(0,"label",110)(1,"input",115),g("change",function(){let d=c(e).$implicit,p=s(2);return m(p.toggleItemSelection(d))}),i(),t(2,"span",116)(3,"span",44),a(4),i(),a(5," - "),t(6,"span",117),a(7),i(),t(8,"span",45),a(9),i()()()}if(n&2){let e=o.$implicit,l=s(2);r(),C("checked",l.isItemSelected(e)),r(3),x(l.getClassName(e.sessionId)),r(3),x(l.getStudentName(e.studentId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," ")}}function Ct(n,o){if(n&1&&(t(0,"div",23),a(1),i()),n&2){let e=s(2);r(),x(e.actionError())}}function ft(n,o){n&1&&(v(0,"span",108),a(1," Cancelling... "))}function ht(n,o){if(n&1&&a(0),n&2){let e=s(2);f(" Cancel ",e.selectedItems().size," Item(s) ")}}function vt(n,o){if(n&1){let e=b();t(0,"div",86),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),t(1,"div",87),g("click",function(d){return c(e),m(d.stopPropagation())}),t(2,"div",88)(3,"h3"),a(4,"Cancel Order Items"),i(),t(5,"button",6),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",89)(8,"form",90),g("ngSubmit",function(){c(e);let d=s();return m(d.cancelItems())}),t(9,"div",91)(10,"label"),a(11,"Select items to cancel:"),i(),t(12,"div",109),w(13,xt,10,5,"label",110,I),i()(),t(15,"div",91)(16,"label",111),a(17,"Cancellation Reason *"),i(),t(18,"textarea",112),O("ngModelChange",function(d){c(e);let p=s();return S(p.formCancel.reason,d)||(p.formCancel.reason=d),m(d)}),i()(),t(19,"div",113)(20,"strong"),a(21,"Refund Policy:"),i(),a(22),i(),u(23,Ct,2,1,"div",23),t(24,"div",105)(25,"button",106),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(26," Cancel "),i(),t(27,"button",114),u(28,ft,2,0)(29,ht,1,1),i()()()()()()}if(n&2){let e=s();r(13),M(e.cancellableItems()),r(5),y("ngModel",e.formCancel.reason),r(4),f(" Cancelling paid items may incur a refund processing fee of ",e.formatCurrency(e.refundFee()),". "),r(),_(e.actionError()?23:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()||e.selectedItems().size===0),r(),_(e.actionLoading()?28:29)}}function bt(n,o){if(n&1&&(t(0,"div",23),a(1),i()),n&2){let e=s(2);r(),x(e.actionError())}}function yt(n,o){n&1&&(v(0,"span",108),a(1," Removing... "))}function St(n,o){n&1&&a(0," Remove Entry ")}function Ot(n,o){if(n&1){let e=b();t(0,"div",86),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),t(1,"div",87),g("click",function(d){return c(e),m(d.stopPropagation())}),t(2,"div",88)(3,"h3"),a(4,"Remove Waitlist Entry"),i(),t(5,"button",6),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",89)(8,"form",90),g("ngSubmit",function(){c(e);let d=s();return m(d.removeWaitlist())}),t(9,"div",91)(10,"label"),a(11,"Class:"),i(),t(12,"div",118),a(13),i()(),t(14,"div",113),a(15," This will remove the user from the waitlist for this class. "),i(),u(16,bt,2,1,"div",23),t(17,"div",105)(18,"button",106),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(19," Cancel "),i(),t(20,"button",114),u(21,yt,2,0)(22,St,1,0),i()()()()()()}if(n&2){let e=s();r(13),f(" ",e.getClassName(e.formRemoveWaitlist.sessionId)," "),r(3),_(e.actionError()?16:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),_(e.actionLoading()?21:22)}}function wt(n,o){if(n&1&&(t(0,"div",23),a(1),i()),n&2){let e=s(2);r(),x(e.actionError())}}function Mt(n,o){n&1&&(v(0,"span",108),a(1," Saving... "))}function Dt(n,o){n&1&&a(0," Save Adjustment ")}function Pt(n,o){if(n&1){let e=b();t(0,"div",86),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),t(1,"div",87),g("click",function(d){return c(e),m(d.stopPropagation())}),t(2,"div",88)(3,"h3"),a(4,"Update Adjustment"),i(),t(5,"button",6),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",89)(8,"form",90),g("ngSubmit",function(){c(e);let d=s();return m(d.updateAdjustment())}),t(9,"div",91)(10,"label"),a(11,"Request ID:"),i(),t(12,"div",118),a(13),i()(),t(14,"div",91)(15,"label",119),a(16,"Extra Fee (+) or Credit (-)"),i(),t(17,"input",120),O("ngModelChange",function(d){c(e);let p=s();return S(p.formChangeRequest.adjustmentInput,d)||(p.formChangeRequest.adjustmentInput=d),m(d)}),i(),t(18,"small",94),a(19,"Positive values add a fee, negative values give a credit"),i()(),t(20,"div",91)(21,"label",121),a(22,"Reason"),i(),t(23,"textarea",122),O("ngModelChange",function(d){c(e);let p=s();return S(p.formChangeRequest.adjustmentReason,d)||(p.formChangeRequest.adjustmentReason=d),m(d)}),i()(),t(24,"div",91)(25,"label",123),a(26,"Admin Notes"),i(),t(27,"textarea",124),O("ngModelChange",function(d){c(e);let p=s();return S(p.formChangeRequest.adminNotes,d)||(p.formChangeRequest.adminNotes=d),m(d)}),i()(),t(28,"div",125),a(29," The user will see this adjustment. You can update it multiple times before approving. "),i(),u(30,wt,2,1,"div",23),t(31,"div",105)(32,"button",106),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(33," Cancel "),i(),t(34,"button",107),u(35,Mt,2,0)(36,Dt,1,0),i()()()()()()}if(n&2){let e=s();r(13),x(e.formChangeRequest.requestId),r(4),y("ngModel",e.formChangeRequest.adjustmentInput),r(6),y("ngModel",e.formChangeRequest.adjustmentReason),r(4),y("ngModel",e.formChangeRequest.adminNotes),r(3),_(e.actionError()?30:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),_(e.actionLoading()?35:36)}}function Et(n,o){if(n&1&&(t(0,"div",127),a(1),i()),n&2){let e=o.$implicit,l=s(2);r(),x(l.getActionDescription(e))}}function At(n,o){if(n&1&&(t(0,"div",23),a(1),i()),n&2){let e=s(2);r(),x(e.actionError())}}function It(n,o){n&1&&(v(0,"span",108),a(1," Approving... "))}function kt(n,o){n&1&&a(0," Approve Changes ")}function Tt(n,o){if(n&1){let e=b();t(0,"div",86),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),t(1,"div",87),g("click",function(d){return c(e),m(d.stopPropagation())}),t(2,"div",88)(3,"h3"),a(4,"Approve Change Request"),i(),t(5,"button",6),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",89)(8,"form",90),g("ngSubmit",function(){c(e);let d=s();return m(d.approveChange())}),t(9,"div",91)(10,"label"),a(11,"Request ID:"),i(),t(12,"div",118),a(13),i()(),t(14,"div",91)(15,"label"),a(16,"Actions to apply:"),i(),t(17,"div",126),w(18,Et,2,1,"div",127,E),i()(),t(20,"div",91)(21,"label",128),a(22,"Admin Notes"),i(),t(23,"textarea",129),O("ngModelChange",function(d){c(e);let p=s();return S(p.formChangeRequest.adminNotes,d)||(p.formChangeRequest.adminNotes=d),m(d)}),i()(),t(24,"div",113),a(25," Approving will apply all changes to the order. Class removals will create vacancy holds for waitlist members. The order pricing will be recalculated. "),i(),u(26,At,2,1,"div",23),t(27,"div",105)(28,"button",106),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(29," Cancel "),i(),t(30,"button",107),u(31,It,2,0)(32,kt,1,0),i()()()()()()}if(n&2){let e=s();r(13),x(e.formChangeRequest.requestId),r(5),M(e.formChangeRequest.actions),r(5),y("ngModel",e.formChangeRequest.adminNotes),r(3),_(e.actionError()?26:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),_(e.actionLoading()?31:32)}}function qt(n,o){if(n&1&&(t(0,"div",23),a(1),i()),n&2){let e=s(2);r(),x(e.actionError())}}function Rt(n,o){n&1&&(v(0,"span",108),a(1," Denying... "))}function Vt(n,o){n&1&&a(0," Deny Request ")}function jt(n,o){if(n&1){let e=b();t(0,"div",86),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),t(1,"div",87),g("click",function(d){return c(e),m(d.stopPropagation())}),t(2,"div",88)(3,"h3"),a(4,"Deny Change Request"),i(),t(5,"button",6),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",89)(8,"form",90),g("ngSubmit",function(){c(e);let d=s();return m(d.denyChange())}),t(9,"div",91)(10,"label"),a(11,"Request ID:"),i(),t(12,"div",118),a(13),i()(),t(14,"div",91)(15,"label",130),a(16,"Reason for Denial *"),i(),t(17,"textarea",131),O("ngModelChange",function(d){c(e);let p=s();return S(p.formChangeRequest.adminNotes,d)||(p.formChangeRequest.adminNotes=d),m(d)}),i()(),t(18,"div",125),a(19," The user will be notified that their change request was denied. No changes will be applied to their order. "),i(),u(20,qt,2,1,"div",23),t(21,"div",105)(22,"button",106),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(23," Cancel "),i(),t(24,"button",114),u(25,Rt,2,0)(26,Vt,1,0),i()()()()()()}if(n&2){let e=s();r(13),x(e.formChangeRequest.requestId),r(4),y("ngModel",e.formChangeRequest.adminNotes),r(3),_(e.actionError()?20:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()||!e.formChangeRequest.adminNotes.trim()),r(),_(e.actionLoading()?25:26)}}function Nt(n,o){if(n&1&&(t(0,"div",23),a(1),i()),n&2){let e=s(2);r(),x(e.actionError())}}function Lt(n,o){n&1&&(v(0,"span",108),a(1," Adding... "))}function Ft(n,o){if(n&1&&a(0),n&2){let e=s(2);f(" Add ",e.formAdjustment.type==="credit"?"Credit":"Fee"," ")}}function Wt(n,o){if(n&1){let e=b();t(0,"div",86),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),t(1,"div",87),g("click",function(d){return c(e),m(d.stopPropagation())}),t(2,"div",88)(3,"h3"),a(4,"Add Credit or Fee"),i(),t(5,"button",6),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",89)(8,"form",90),g("ngSubmit",function(){c(e);let d=s();return m(d.addAdjustment())}),t(9,"div",91)(10,"label",132),a(11,"Type *"),i(),t(12,"select",133),O("ngModelChange",function(d){c(e);let p=s();return S(p.formAdjustment.type,d)||(p.formAdjustment.type=d),m(d)}),t(13,"option",134),a(14,"Credit (reduce amount due)"),i(),t(15,"option",135),a(16,"Fee (increase amount due)"),i()()(),t(17,"div",91)(18,"label",119),a(19,"Amount *"),i(),t(20,"input",136),O("ngModelChange",function(d){c(e);let p=s();return S(p.formAdjustment.amountInput,d)||(p.formAdjustment.amountInput=d),m(d)}),i(),t(21,"small",94),a(22," Enter the amount in dollars (e.g., 25.00) "),i()(),t(23,"div",91)(24,"label",121),a(25,"Reason *"),i(),t(26,"textarea",137),O("ngModelChange",function(d){c(e);let p=s();return S(p.formAdjustment.reason,d)||(p.formAdjustment.reason=d),m(d)}),i()(),t(27,"div",125),a(28),i(),u(29,Nt,2,1,"div",23),t(30,"div",105)(31,"button",106),g("click",function(){c(e);let d=s();return m(d.closeDialog())}),a(32," Cancel "),i(),t(33,"button",107),u(34,Lt,2,0)(35,Ft,1,1),i()()()()()()}if(n&2){let e=s();r(12),y("ngModel",e.formAdjustment.type),r(8),y("ngModel",e.formAdjustment.amountInput),r(6),y("ngModel",e.formAdjustment.reason),r(2),f(" ",e.formAdjustment.type==="credit"?"A credit will reduce the amount the user owes.":"A fee will increase the amount the user owes."," "),r(),_(e.actionError()?29:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()||!e.formAdjustment.amountInput||!e.formAdjustment.reason.trim()),r(),_(e.actionLoading()?34:35)}}var ve=class n{orderId=V.required();adminOrdersStore=D(pe);orderRpc=D(Y);userService=D(Z);seasonService=D(J);configService=D(H);router=D(L);notificationService=D(me);order=P(null);loading=P(!1);error=P(null);userData=P(null);studentMap=P(new Map);actionLoading=this.orderRpc.loading;actionError=this.orderRpc.error;dialogMode=P(null);formPayment={amountInput:"",method:"zelle",reference:"",notes:""};formCancel={reason:""};selectedItems=P(new Set);formRemoveWaitlist={sessionId:""};formChangeRequest={requestId:"",actions:[],adjustmentInput:"",adjustmentReason:"",adminNotes:""};formAdjustment={type:"credit",amountInput:"",reason:""};Math=Math;allItems=h(()=>this.order()?.items??[]);paidItems=h(()=>{let o=this.order();return o?B(o):[]});submittedItems=h(()=>{let o=this.order();return o?W(o):[]});lockedItems=h(()=>this.allItems().filter(o=>o.status==="locked"));cancellableItems=h(()=>[...this.lockedItems(),...this.paidItems(),...this.submittedItems()]);waitlistEntries=h(()=>this.order()?.waitlist??[]);payments=h(()=>this.order()?.payments??[]);changeRequests=h(()=>this.order()?.changeRequests??[]);totalDue=h(()=>{let o=this.order();return o?U(o):0});amountDue=h(()=>{let o=this.order();return o?z(o):0});priceBreakdownData=h(()=>{let o=this.order();if(!o?.pricing)return null;let e=(o.processingFees??[]).map(l=>({description:l.description,amount:l.amount}));return{pricing:o.pricing,couponCredit:o.couponDiscount??0,totalPaid:o.totalPaid,totalRefunded:$(o),processingFees:e,amountDue:this.amountDue()}});refundFee=h(()=>this.seasonService.selectedSeason()?.refundProcessingFee??2e3);isOverdue=h(()=>{let o=this.order();if(!o||!o.lockExpiresAt)return!1;let e=this.configService.currentTime();return new Date(o.lockExpiresAt)<new Date(e)});isExpiringSoon=h(()=>{let o=this.order();if(!o||!o.lockExpiresAt)return!1;let e=this.configService.currentTime(),l=new Date(o.lockExpiresAt),d=new Date(e),p=(l.getTime()-d.getTime())/(1e3*60*60);return p>0&&p<=12});remainingLockTime=h(()=>{let o=this.order();if(!o||!o.lockExpiresAt)return null;let e=this.configService.currentTime(),l=new Date(o.lockExpiresAt),d=new Date(e),p=l.getTime()-d.getTime();if(p<=0)return null;let be=Math.floor(p/(1e3*60*60)),ye=Math.floor(p%(1e3*60*60)/(1e3*60));return{hours:be,minutes:ye}});canRecordPayment=h(()=>this.amountDue()>0);formatCurrency=Ce;formatDate=fe;formatDateTime=he;getOrderStatus=G;getStatusBadgeClass=ue;getStatusLabel=_e;getItemStatusBadgeClass=ge;getItemStatusLabel=xe;async ngOnInit(){if(!this.userService.isAuthenticated()){await this.router.navigate(["/login"]);return}await this.loadOrder()}async loadOrder(){this.loading.set(!0),this.error.set(null);try{let o=await this.adminOrdersStore.getOrder(this.orderId(),!0);this.order.set(o),await this.loadUserData(o.userDisplayId)}catch(o){let e=o instanceof Error?o.message:String(o);this.error.set(e)}finally{this.loading.set(!1)}}async loadUserData(o){try{let e=await this.userService.getUserByDisplayId(o);if(e){this.userData.set({displayName:e.displayName,email:e.email,phone:e.primaryGuardian?.phone,address:e.primaryGuardian?.address?`${e.primaryGuardian.address.street}, ${e.primaryGuardian.address.city}, ${e.primaryGuardian.address.state} ${e.primaryGuardian.address.zipCode}`:void 0});let l=new Map;for(let d of e.students??[])l.set(d.id,`${d.firstName} ${d.lastName}`);this.studentMap.set(l)}}catch(e){console.error("Failed to load user data:",e)}}getClassName(o){return this.seasonService.classes().find(l=>l.id===o)?.name??o}getStudentName(o){return this.studentMap().get(o)??o}openRecordPaymentDialog(){this.formPayment.amountInput=T(this.amountDue()),this.formPayment.method="zelle",this.formPayment.reference="",this.formPayment.notes="",this.dialogMode.set("record-payment")}openCancelItemsDialog(){this.selectedItems.set(new Set),this.formCancel.reason="",this.dialogMode.set("cancel-items")}openRemoveWaitlistDialog(o){this.formRemoveWaitlist.sessionId=o,this.dialogMode.set("remove-waitlist")}openAddAdjustmentDialog(){this.formAdjustment.type="credit",this.formAdjustment.amountInput="",this.formAdjustment.reason="",this.dialogMode.set("add-adjustment")}closeDialog(){this.dialogMode.set(null),this.orderRpc.clearError()}isItemSelected(o){let e=`${o.sessionId}::${o.studentId}`;return this.selectedItems().has(e)}toggleItemSelection(o){let e=`${o.sessionId}::${o.studentId}`,l=new Set(this.selectedItems());l.has(e)?l.delete(e):l.add(e),this.selectedItems.set(l)}async recordPayment(){let o=this.order();if(!o)return;let e=A(this.formPayment.amountInput);if(e<=0){this.notificationService.warning("Please enter a valid payment amount.");return}try{await this.orderRpc.recordPayment({year:this.configService.currentActiveYear(),seasonId:o.seasonId,userAuthId:o.userAuthId,amount:e,reference:this.formPayment.reference||null,method:this.formPayment.method,notes:this.formPayment.notes||null}),await this.loadOrder(),this.closeDialog()}catch(l){console.error("Failed to record payment:",l)}}async cancelItems(){let o=this.order();if(o){if(this.selectedItems().size===0){this.notificationService.warning("Please select at least one item to cancel.");return}if(!this.formCancel.reason.trim()){this.notificationService.warning("Please enter a cancellation reason.");return}try{let e=Array.from(this.selectedItems()).map(l=>{let[d,p]=l.split("::");return{sessionId:d,studentId:p}});await this.orderRpc.cancelItems({year:this.configService.currentActiveYear(),seasonId:o.seasonId,items:e,reason:this.formCancel.reason,userAuthId:o.userAuthId}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to cancel items:",e)}}}async removeWaitlist(){let o=this.order();if(o)try{await this.orderRpc.removeWaitlistEntry({year:this.configService.currentActiveYear(),seasonId:o.seasonId,userAuthId:o.userAuthId,sessionId:this.formRemoveWaitlist.sessionId}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to remove waitlist entry:",e)}}async addAdjustment(){let o=this.order();if(!o)return;let e=A(this.formAdjustment.amountInput);if(e<=0){this.notificationService.warning("Please enter a valid amount.");return}if(!this.formAdjustment.reason.trim()){this.notificationService.warning("Please enter a reason for the adjustment.");return}let l=this.formAdjustment.type==="credit"?-e:e;try{await this.orderRpc.addAdjustment({year:this.configService.currentActiveYear(),seasonId:o.seasonId,userAuthId:o.userAuthId,amount:l,reason:this.formAdjustment.reason}),await this.loadOrder(),this.closeDialog(),this.notificationService.success(this.formAdjustment.type==="credit"?"Credit added successfully.":"Fee added successfully.")}catch(d){console.error("Failed to add adjustment:",d)}}getChangeStatusLabel(o){switch(o){case"pending":return"Pending";case"approved":return"Approved";case"denied":return"Denied";default:return o}}getActionDescription(o){let e=this.getClassName(o.target.sessionId),l=this.getStudentName(o.target.studentId);switch(o.type){case"remove_class":return`Remove from class: ${e} - ${l}`;case"add_addon":return`Add ${o.addon==="lunch"?"Lunch":"Extended Care"}: ${e} - ${l}`;case"remove_addon":return`Remove ${o.addon==="lunch"?"Lunch":"Extended Care"}: ${e} - ${l}`}}openUpdateAdjustmentDialog(o){this.formChangeRequest.requestId=o.id,this.formChangeRequest.actions=[...o.actions],this.formChangeRequest.adjustmentInput=o.adminAdjustment!==0?T(o.adminAdjustment):"",this.formChangeRequest.adjustmentReason=o.adminAdjustmentReason??"",this.formChangeRequest.adminNotes=o.adminNotes??"",this.dialogMode.set("update-adjustment")}openApproveChangeDialog(o){this.formChangeRequest.requestId=o.id,this.formChangeRequest.actions=[...o.actions],this.formChangeRequest.adminNotes=o.adminNotes??"",this.dialogMode.set("approve-change")}openDenyChangeDialog(o){this.formChangeRequest.requestId=o.id,this.formChangeRequest.actions=[...o.actions],this.formChangeRequest.adminNotes="",this.dialogMode.set("deny-change")}async updateAdjustment(){let o=this.order();if(o)try{let e=this.formChangeRequest.adjustmentInput.trim()?A(this.formChangeRequest.adjustmentInput):0;await this.orderRpc.updateChangeRequest({year:this.configService.currentActiveYear(),seasonId:o.seasonId,userAuthId:o.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminAdjustment:e,adminAdjustmentReason:this.formChangeRequest.adjustmentReason||null,adminNotes:this.formChangeRequest.adminNotes||null}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to update adjustment:",e)}}async approveChange(){let o=this.order();if(o)try{await this.orderRpc.approveChangeRequest({year:this.configService.currentActiveYear(),seasonId:o.seasonId,userAuthId:o.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminNotes:this.formChangeRequest.adminNotes||null}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to approve change request:",e)}}async denyChange(){let o=this.order();if(o&&this.formChangeRequest.adminNotes.trim())try{await this.orderRpc.denyChangeRequest({year:this.configService.currentActiveYear(),seasonId:o.seasonId,userAuthId:o.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminNotes:this.formChangeRequest.adminNotes}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to deny change request:",e)}}clearError(){this.error.set(null)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=q({type:n,selectors:[["app-admin-order-detail"]],inputs:{orderId:[1,"orderId"]},decls:11,vars:10,consts:[[1,"admin-order-detail-container"],[1,"loading-state"],[1,"error-banner"],[1,"order-content"],[1,"modal-overlay"],[1,"spinner"],["type","button",1,"btn-close",3,"click"],[1,"order-header"],[1,"header-left"],["routerLink","/admin/orders",1,"back-link"],[1,"order-meta"],[1,"user-id"],[1,"status-badge",3,"ngClass"],[1,"header-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"info-card","user-info-card"],[1,"info-card","status-card"],[1,"status-details"],[1,"detail-row"],[1,"label"],[1,"value","status-badge",3,"ngClass"],[1,"value"],[1,"alert","alert-danger"],[1,"info-card","items-card"],[1,"card-header"],["type","button",1,"btn","btn-danger-outline","btn-sm"],[1,"items-section"],[1,"empty-state"],[1,"info-card"],[1,"info-card","pricing-card"],[1,"info-card","payments-card"],[1,"info-card","waitlist-card"],[1,"info-card","change-requests-card"],[1,"info-card","history-card"],[1,"user-details"],[1,"value",3,"ngClass"],[1,"remaining-time"],["type","button",1,"btn","btn-danger-outline","btn-sm",3,"click"],[1,"section-title"],[1,"item-count"],[1,"items-list"],[1,"item-card","locked"],[1,"item-header"],[1,"class-name"],[1,"item-status-badge",3,"ngClass"],[1,"item-details"],[1,"detail-item"],[3,"options","showEmpty"],[1,"item-card"],[1,"item-card","pending"],[3,"screenshots"],[3,"data"],[1,"payments-table"],[1,"amount"],[1,"method-badge"],[1,"waitlist-list"],[1,"waitlist-item"],[1,"waitlist-header"],[1,"waitlist-details"],[1,"change-requests-list"],[1,"change-request-item",3,"ngClass"],[1,"request-header"],[1,"request-info"],[1,"request-id"],[1,"request-status-badge",3,"ngClass"],[1,"request-details"],[1,"request-actions-list"],[1,"request-action-row"],[1,"request-meta"],[1,"meta-item"],[1,"request-actions"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"history-timeline"],[1,"history-event"],[1,"event-time"],[1,"event-details"],[1,"event-action"],[1,"event-metadata"],[1,"affected-items"],[1,"affected-item"],[1,"item-class"],[1,"item-student"],[1,"item-options"],[1,"option-tag"],[1,"modal-overlay",3,"click"],[1,"modal-dialog",3,"click"],[1,"modal-header"],[1,"modal-body"],[3,"ngSubmit"],[1,"form-group"],["for","payment-amount"],["type","text","id","payment-amount","name","amount","placeholder","0.00","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text"],["for","payment-method"],["id","payment-method","name","method","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","zelle"],["value","check"],["value","cash"],["value","other"],["for","payment-reference"],["type","text","id","payment-reference","name","reference","placeholder","Confirmation number, check number, etc.",1,"form-control",3,"ngModelChange","ngModel"],["for","payment-notes"],["id","payment-notes","name","notes","rows","3","placeholder","Optional notes...",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"spinner-small"],[1,"items-checklist"],[1,"checkbox-item"],["for","cancel-reason"],["id","cancel-reason","name","reason","rows","3","placeholder","Enter reason for cancellation...","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-warning"],["type","submit",1,"btn","btn-danger",3,"disabled"],["type","checkbox",3,"change","checked"],[1,"item-info"],[1,"student-name"],[1,"read-only-value"],["for","adjustment-amount"],["type","text","id","adjustment-amount","name","adjustment","placeholder","0.00 (positive = fee, negative = credit)",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-reason"],["id","adjustment-reason","name","adjustmentReason","rows","2","placeholder","Explain the adjustment...",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-notes"],["id","adjustment-notes","name","notes","rows","2","placeholder","Optional notes (visible to user)...",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-info"],[1,"items-list-readonly"],[1,"item-row"],["for","approve-notes"],["id","approve-notes","name","notes","rows","3","placeholder","Optional notes...",1,"form-control",3,"ngModelChange","ngModel"],["for","deny-notes"],["id","deny-notes","name","notes","rows","3","placeholder","Please provide a reason for denying this request...","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-type"],["id","adjustment-type","name","type","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","credit"],["value","fee"],["type","text","id","adjustment-amount","name","amount","placeholder","0.00","required","",1,"form-control",3,"ngModelChange","ngModel"],["id","adjustment-reason","name","reason","rows","3","placeholder","Explain the reason for this adjustment...","required","",1,"form-control",3,"ngModelChange","ngModel"]],template:function(e,l){e&1&&(t(0,"div",0),u(1,Me,4,0,"div",1),u(2,De,6,1,"div",2),u(3,mt,54,22,"div",3),u(4,gt,42,9,"div",4),u(5,vt,30,6,"div",4),u(6,Ot,23,5,"div",4),u(7,Pt,37,8,"div",4),u(8,Tt,33,6,"div",4),u(9,jt,27,6,"div",4),u(10,Wt,36,8,"div",4),i()),e&2&&(r(),_(l.loading()?1:-1),r(),_(l.error()&&!l.loading()?2:-1),r(),_(l.order()&&!l.loading()?3:-1),r(),_(l.dialogMode()==="record-payment"?4:-1),r(),_(l.dialogMode()==="cancel-items"?5:-1),r(),_(l.dialogMode()==="remove-waitlist"?6:-1),r(),_(l.dialogMode()==="update-adjustment"?7:-1),r(),_(l.dialogMode()==="approve-change"?8:-1),r(),_(l.dialogMode()==="deny-change"?9:-1),r(),_(l.dialogMode()==="add-adjustment"?10:-1))},dependencies:[N,j,de,ne,oe,ae,K,ie,Q,X,re,te,ee,F,se,ce,le],styles:[".admin-order-detail-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #3498db;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-banner[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:15px;border-radius:4px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.btn-close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:24px;cursor:pointer;color:inherit}.order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:30px;padding-bottom:20px;border-bottom:2px solid #e0e0e0}.header-left[_ngcontent-%COMP%]{flex:1}.back-link[_ngcontent-%COMP%]{color:#3498db;text-decoration:none;margin-bottom:10px;display:inline-block}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.order-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:10px 0;font-size:28px}.order-meta[_ngcontent-%COMP%]{display:flex;gap:15px;align-items:center;margin-top:10px}.user-id[_ngcontent-%COMP%]{color:#666;font-size:14px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.info-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:20px;margin-bottom:20px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 20px;font-size:20px;color:#333}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.user-details[_ngcontent-%COMP%], .status-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:4px;font-size:12px;font-weight:600;text-transform:uppercase;display:inline-block}.status-submitted[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-paid[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-cancelled[_ngcontent-%COMP%], .status-refunded[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.status-partial[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status-empty[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.text-warning[_ngcontent-%COMP%]{color:#ffc107!important}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.remaining-time[_ngcontent-%COMP%]{font-size:12px;color:#666}.alert[_ngcontent-%COMP%]{padding:12px 16px;border-radius:4px;margin-top:15px}.alert-danger[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.alert-warning[_ngcontent-%COMP%]{background:#fff3cd;color:#856404;border:1px solid #ffeaa7}.alert-info[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460;border:1px solid #bee5eb}.items-section[_ngcontent-%COMP%]{margin-bottom:30px}.items-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:15px;color:#333}.item-count[_ngcontent-%COMP%]{color:#666;font-weight:400;font-size:14px}.items-list[_ngcontent-%COMP%]{display:grid;gap:12px}.item-card[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dee2e6;border-radius:6px;padding:15px}.item-card.locked[_ngcontent-%COMP%]{background:#f3e5f5;border-color:#ce93d8}.item-card.pending[_ngcontent-%COMP%]{background:#fff3cd;border-color:#ffeaa7}.item-card.cancelled[_ngcontent-%COMP%]{background:#f8d7da;border-color:#f5c6cb;opacity:.7}.item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.class-name[_ngcontent-%COMP%]{font-weight:600;color:#333}.item-status-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:3px;font-size:11px;font-weight:600;text-transform:uppercase}.item-status-locked[_ngcontent-%COMP%]{background:#7b1fa2;color:#fff}.item-status-submitted[_ngcontent-%COMP%]{background:#ffc107;color:#000}.item-status-paid[_ngcontent-%COMP%]{background:#28a745;color:#fff}.item-status-cancelled[_ngcontent-%COMP%], .item-status-refunded[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.item-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.detail-item[_ngcontent-%COMP%]{display:flex;gap:8px;font-size:14px}.detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.option-badge[_ngcontent-%COMP%]{background:#007bff;color:#fff;padding:2px 8px;border-radius:3px;font-size:11px;margin-right:4px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#666}.payments-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.payments-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:12px;background:#f8f9fa;border-bottom:2px solid #dee2e6;font-weight:600}.payments-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #dee2e6}.payments-table[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600}.method-badge[_ngcontent-%COMP%]{background:#6c757d;color:#fff;padding:4px 8px;border-radius:3px;font-size:12px;text-transform:uppercase}.waitlist-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.waitlist-item[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dee2e6;border-radius:6px;padding:15px}.waitlist-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.promoted-badge[_ngcontent-%COMP%]{background:#28a745;color:#fff;padding:4px 8px;border-radius:3px;font-size:12px;font-weight:600}.waitlist-details[_ngcontent-%COMP%]{margin-bottom:10px}.history-timeline[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px}.history-event[_ngcontent-%COMP%]{display:flex;gap:15px;padding:12px;background:#f8f9fa;border-radius:6px}.event-time[_ngcontent-%COMP%]{color:#666;font-size:12px;white-space:nowrap;min-width:150px}.event-details[_ngcontent-%COMP%]{flex:1}.event-action[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}.event-metadata[_ngcontent-%COMP%]{color:#666;font-size:14px}.affected-items[_ngcontent-%COMP%]{margin-top:8px;padding:8px;background:#e9ecef;border-radius:4px}.affected-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:4px 0;font-size:13px;border-bottom:1px solid #dee2e6}.affected-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.affected-item[_ngcontent-%COMP%]   .item-class[_ngcontent-%COMP%]{font-weight:500;color:#333}.affected-item[_ngcontent-%COMP%]   .item-student[_ngcontent-%COMP%]{color:#666}.affected-item[_ngcontent-%COMP%]   .item-options[_ngcontent-%COMP%]{display:flex;gap:4px;margin-left:auto}.affected-item[_ngcontent-%COMP%]   .option-tag[_ngcontent-%COMP%]{background:#6c757d;color:#fff;padding:2px 6px;border-radius:3px;font-size:10px}.btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.btn-primary-outline[_ngcontent-%COMP%]{background:#fff;color:#007bff;border:1px solid #007bff}.btn-primary-outline[_ngcontent-%COMP%]:hover:not(:disabled){background:#007bff;color:#fff}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6268}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#c82333}.btn-danger-outline[_ngcontent-%COMP%]{background:#fff;color:#dc3545;border:1px solid #dc3545}.btn-danger-outline[_ngcontent-%COMP%]:hover:not(:disabled){background:#dc3545;color:#fff}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:20px}.modal-body[_ngcontent-%COMP%]{padding:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;margin-bottom:8px;color:#333}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ced4da;border-radius:4px;font-size:14px}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 .2rem #007bff40}.form-text[_ngcontent-%COMP%]{display:block;margin-top:4px;font-size:12px;color:#6c757d}.items-checklist[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-height:300px;overflow-y:auto;padding:8px;background:#f8f9fa;border-radius:4px}.checkbox-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px;cursor:pointer}.checkbox-item[_ngcontent-%COMP%]:hover{background:#e9ecef;border-radius:4px}.checkbox-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}.item-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.read-only-value[_ngcontent-%COMP%]{padding:8px 12px;background:#f8f9fa;border-radius:4px;font-weight:500}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px;padding-top:20px;border-top:1px solid #dee2e6}.spinner-small[_ngcontent-%COMP%]{display:inline-block;width:14px;height:14px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite;margin-right:8px}.btn-success[_ngcontent-%COMP%]{background:#28a745;color:#fff}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#218838}.change-requests-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.change-request-item[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:8px;padding:16px;background:#f8f9fa}.change-request-item.status-pending[_ngcontent-%COMP%]{border-left:4px solid #ffc107}.change-request-item.status-approved[_ngcontent-%COMP%]{border-left:4px solid #28a745}.change-request-item.status-denied[_ngcontent-%COMP%]{border-left:4px solid #dc3545;opacity:.7}.change-request-item[_ngcontent-%COMP%]   .request-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.change-request-item[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.change-request-item[_ngcontent-%COMP%]   .request-id[_ngcontent-%COMP%]{font-weight:600;color:#495057}.request-status-badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:12px;font-size:11px;font-weight:600;text-transform:uppercase}.request-status-badge.status-pending[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.request-status-badge.status-approved[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.request-status-badge.status-denied[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.change-request-item[_ngcontent-%COMP%]   .request-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:16px}.change-request-item[_ngcontent-%COMP%]   .request-actions-list[_ngcontent-%COMP%]{font-size:14px}.change-request-item[_ngcontent-%COMP%]   .request-action-row[_ngcontent-%COMP%]{margin-left:16px;color:#666;padding:4px 0}.change-request-item[_ngcontent-%COMP%]   .request-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;font-size:13px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;gap:8px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666;min-width:130px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.change-request-item[_ngcontent-%COMP%]   .request-actions[_ngcontent-%COMP%]{display:flex;gap:10px;padding-top:12px;border-top:1px solid #dee2e6}.text-success[_ngcontent-%COMP%]{color:#28a745!important}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important}.items-list-readonly[_ngcontent-%COMP%]{background:#f8f9fa;padding:12px;border-radius:4px}.items-list-readonly[_ngcontent-%COMP%]   .item-row[_ngcontent-%COMP%]{padding:4px 0;color:#495057}"]})};export{ve as AdminOrderDetailComponent};
