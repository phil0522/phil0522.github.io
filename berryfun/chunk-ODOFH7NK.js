import{$ as Wf,A as Zn,Aa as np,B as zf,Ba as rp,C as Yt,Ca as En,D as Ou,E as qf,Ea as ip,F as mt,G as Js,H as Ge,Ha as bi,I as pe,Ia as sp,J as ku,Ja as op,L as Q,La as ap,M as _i,Ma as Si,N as Gf,Na as Ke,O as we,Oa as Uu,P as re,Pa as up,Pb as _p,Q as z,Qa as Bu,R as eo,Ra as cp,Rb as wp,S as Hf,Sa as Ii,T as Qn,Ta as bn,Tb as Ep,U as it,Ua as lp,Ub as Di,Vb as bp,Wa as ju,Wb as ao,Xa as hp,Xb as Sp,Ya as dp,Z as to,Za as $u,_ as Ve,_a as fp,a as E,aa as Kf,b as V,ba as wn,c as P0,ca as no,d as Lf,da as Mu,e as Vf,ea as ro,f as Uf,g as Rt,ga as wi,h as Xe,hb as pp,ia as Xt,j as xt,ja as Yn,ka as io,l as rt,la as Fu,m as ee,ma as Ei,n as Bf,na as Zf,nb as mp,o as xu,oa as Lu,p as jf,pa as Qf,q as Pe,qa as so,r as Pu,ra as Vu,s as Pt,sa as oo,sb as gp,t as Nu,ta as Xn,tb as yp,u as $f,ua as Jn,ub as vp,v as Qs,va as Yf,wa as Xf,x as Qt,xa as Jf,y as Ys,ya as ep,z as Xs,za as tp}from"./chunk-C26OXKSD.js";var Ip=null;function Nt(){return Ip}function zu(n){Ip??=n}var Ti=class{},er=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>z(Dp),providedIn:"platform"})}return n})();var Dp=(()=>{class n extends er{_location;_history;_doc=z(Ve);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Nt().getBaseHref(this._doc)}onPopState(t){let r=Nt().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Nt().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function uo(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function Tp(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function st(n){return n&&n[0]!=="?"?`?${n}`:n}var gt=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>z(Cp),providedIn:"root"})}return n})(),qu=new we(""),Cp=(()=>{class n extends gt{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??z(Ve).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return uo(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+st(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+st(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+st(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(re(er),re(qu,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Sn=(()=>{class n{_subject=new Rt;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=k0(Tp(Ap(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+st(r))}normalize(t){return n.stripTrailingSlash(O0(this._basePath,Ap(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+st(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+st(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=st;static joinWithSlash=uo;static stripTrailingSlash=Tp;static \u0275fac=function(r){return new(r||n)(re(gt))};static \u0275prov=Q({token:n,factory:()=>N0(),providedIn:"root"})}return n})();function N0(){return new Sn(re(gt))}function O0(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Ap(n){return n.replace(/\/index.html$/,"")}function k0(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var Hu=(()=>{class n extends gt{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=uo(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+st(s))||this._platformLocation.pathname;this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+st(s))||this._platformLocation.pathname;this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(re(er),re(qu,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})();var Gu=/\s+/,Rp=[],M0=(()=>{class n{_ngEl;_renderer;initialClasses=Rp;rawClass;stateMap=new Map;constructor(t,r){this._ngEl=t,this._renderer=r}set klass(t){this.initialClasses=t!=null?t.trim().split(Gu):Rp}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(Gu):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(Gu).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static \u0275fac=function(r){return new(r||n)(Ke(Ei),Ke(Si))};static \u0275dir=bn({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var F0=(()=>{class n{transform(t){return JSON.stringify(t,null,2)}static \u0275fac=function(r){return new(r||n)};static \u0275pipe=lp({name:"json",type:n,pure:!1})}return n})();var xp=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=Ii({type:n});static \u0275inj=_i({})}return n})();function Wu(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var Ai=class{};var Pp="browser";var Ci=class{_doc;constructor(e){this._doc=e}manager},co=(()=>{class n extends Ci{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(re(Ve))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),fo=new we(""),Yu=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(o=>{o.manager=this});let i=t.filter(o=>!(o instanceof co));this._plugins=i.slice().reverse();let s=t.find(o=>o instanceof co);s&&this._plugins.push(s)}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new pe(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(re(fo),re(no))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),Ku="ng-app-id";function Np(n){for(let e of n)e.remove()}function Op(n,e){let t=e.createElement("style");return t.textContent=n,t}function B0(n,e,t,r){let i=n.head?.querySelectorAll(`style[${Ku}="${e}"],link[${Ku}="${e}"]`);if(i)for(let s of i)s.removeAttribute(Ku),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function Qu(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var Xu=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,B0(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,Op);r?.forEach(i=>this.addUsage(i,this.external,Qu))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(Np(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])Np(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,Op(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,Qu(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(re(Ve),re(Lu),re(Vu,8),re(so))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),Zu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Ju=/%COMP%/g;var Mp="%COMP%",j0=`_nghost-${Mp}`,$0=`_ngcontent-${Mp}`,z0=!0,q0=new we("",{factory:()=>z0});function G0(n){return $0.replace(Ju,n)}function H0(n){return j0.replace(Ju,n)}function Fp(n,e){return e.map(t=>t.replace(Ju,n))}var ec=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;constructor(t,r,i,s,o,u,c=null,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.ngZone=u,this.nonce=c,this.tracingService=d,this.defaultRenderer=new Ri(t,o,u,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof ho?i.applyToHost(t):i instanceof xi&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,u=this.ngZone,c=this.eventManager,d=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,g=this.tracingService;switch(r.encapsulation){case oo.Emulated:s=new ho(c,d,r,this.appId,p,o,u,g);break;case oo.ShadowDom:return new lo(c,t,r,o,u,this.nonce,g,d);case oo.ExperimentalIsolatedShadowDom:return new lo(c,t,r,o,u,this.nonce,g);default:s=new xi(c,d,r,p,o,u,g);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(re(Yu),re(Xu),re(Lu),re(q0),re(Ve),re(no),re(Vu),re(op,8))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),Ri=class{eventManager;doc;ngZone;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.tracingService=i}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(Zu[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(kp(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(kp(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new pe(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Zu[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Zu[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(bi.DashCase|bi.Important)?e.style.setProperty(t,r,i&bi.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&bi.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Nt().getGlobalEventTarget(this.doc,e),!e))throw new pe(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function kp(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var lo=class extends Ri{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,r,i,s,o,u,c){super(e,i,s,u),this.hostEl=t,this.sharedStylesHost=c,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let d=r.styles;d=Fp(r.id,d);for(let g of d){let w=document.createElement("style");o&&w.setAttribute("nonce",o),w.textContent=g,this.shadowRoot.appendChild(w)}let p=r.getExternalStyles?.();if(p)for(let g of p){let w=Qu(g,i);o&&w.setAttribute("nonce",o),this.shadowRoot.appendChild(w)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},xi=class extends Ri{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,u,c){super(e,s,o,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let d=r.styles;this.styles=c?Fp(c,d):d,this.styleUrls=r.getExternalStyles?.(c)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&sp.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},ho=class extends xi{contentAttr;hostAttr;constructor(e,t,r,i,s,o,u,c){let d=i+"-"+r.id;super(e,t,r,s,o,u,c,d),this.contentAttr=G0(d),this.hostAttr=H0(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var po=class n extends Ti{supportsDOMEvents=!0;static makeCurrent(){zu(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=K0();return t==null?null:Z0(t)}resetBaseElement(){Pi=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Wu(document.cookie,e)}},Pi=null;function K0(){return Pi=Pi||document.head.querySelector("base"),Pi?Pi.getAttribute("href"):null}function Z0(n){return new URL(n,document.baseURI).pathname}var Q0=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),Lp=["alt","control","meta","shift"],Y0={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},X0={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Vp=(()=>{class n extends Ci{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),u=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Nt().onAndCancel(t,o.domEventName,u,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",u=r.indexOf("code");if(u>-1&&(r.splice(u,1),o="code."),Lp.forEach(d=>{let p=r.indexOf(d);p>-1&&(r.splice(p,1),o+=d+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=Y0[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),Lp.forEach(o=>{if(o!==i){let u=X0[o];u(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(re(Ve))};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})();function J0(n,e,t){let r=E({rootComponent:n,platformRef:t?.platformRef},ew(e));return bp(r)}function ew(n){return{appProviders:[...sw,...n?.providers??[]],platformProviders:iw}}function tw(){po.makeCurrent()}function nw(){return new Mu}function rw(){return Zf(document),document}var iw=[{provide:so,useValue:Pp},{provide:Qf,useValue:tw,multi:!0},{provide:Ve,useFactory:rw}];var sw=[{provide:Hf,useValue:"root"},{provide:Mu,useFactory:nw},{provide:fo,useClass:co,multi:!0},{provide:fo,useClass:Vp,multi:!0},ec,Xu,Yu,{provide:ap,useExisting:ec},{provide:Ai,useClass:Q0},[]];var Up=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(re(Ve))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var uw=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:function(r){let i=null;return r?i=new(r||n):i=re(cw),i},providedIn:"root"})}return n})(),cw=(()=>{class n extends uw{_doc;constructor(t){super(),this._doc=t}sanitize(t,r){if(r==null)return null;switch(t){case En.NONE:return r;case En.HTML:return Jn(r,"HTML")?Xn(r):rp(this._doc,String(r)).toString();case En.STYLE:return Jn(r,"Style")?Xn(r):r;case En.SCRIPT:if(Jn(r,"Script"))return Xn(r);throw new pe(5200,!1);case En.URL:return Jn(r,"URL")?Xn(r):np(String(r));case En.RESOURCE_URL:if(Jn(r,"ResourceURL"))return Xn(r);throw new pe(5201,!1);default:throw new pe(5202,!1)}}bypassSecurityTrustHtml(t){return Yf(t)}bypassSecurityTrustStyle(t){return Xf(t)}bypassSecurityTrustScript(t){return Jf(t)}bypassSecurityTrustUrl(t){return ep(t)}bypassSecurityTrustResourceUrl(t){return tp(t)}static \u0275fac=function(r){return new(r||n)(re(Ve))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var W="primary",qi=Symbol("RouteTitle"),sc=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function An(n){return new sc(n)}function Kp(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],u=n[s];if(o[0]===":")i[o.substring(1)]=u;else if(o!==u.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function wo(n){return new Promise((e,t)=>{n.pipe(Yt()).subscribe({next:r=>e(r),error:r=>t(r)})})}function hw(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!yt(n[t],e[t]))return!1;return!0}function yt(n,e){let t=n?oc(n):void 0,r=e?oc(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Zp(n[i],e[i]))return!1;return!0}function oc(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Zp(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Qp(n){return n.length>0?n[n.length-1]:null}function Rn(n){return xu(n)?n:hp(n)?rt(Promise.resolve(n)):ee(n)}function Yp(n){return xu(n)?wo(n):Promise.resolve(n)}var dw={exact:Jp,subset:em},Xp={exact:fw,subset:pw,ignored:()=>!0};function Bp(n,e,t){return dw[t.paths](n.root,e.root,t.matrixParams)&&Xp[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function fw(n,e){return yt(n,e)}function Jp(n,e,t){if(!Dn(n.segments,e.segments)||!yo(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Jp(n.children[r],e.children[r],t))return!1;return!0}function pw(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Zp(n[t],e[t]))}function em(n,e,t){return tm(n,e,e.segments,t)}function tm(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Dn(i,t)||e.hasChildren()||!yo(i,t,r))}else if(n.segments.length===t.length){if(!Dn(n.segments,t)||!yo(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!em(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Dn(n.segments,i)||!yo(n.segments,i,r)||!n.children[W]?!1:tm(n.children[W],e,s,r)}}function yo(n,e,t){return e.every((r,i)=>Xp[t](n[i].parameters,r.parameters))}var at=class{root;queryParams;fragment;_queryParamMap;constructor(e=new le([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=An(this.queryParams),this._queryParamMap}toString(){return yw.serialize(this)}},le=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return vo(this)}},Jt=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=An(this.parameters),this._parameterMap}toString(){return rm(this)}};function mw(n,e){return Dn(n,e)&&n.every((t,r)=>yt(t.parameters,e[r].parameters))}function Dn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function gw(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===W&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==W&&(t=t.concat(e(i,r)))}),t}var Gi=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>new en,providedIn:"root"})}return n})(),en=class{parse(e){let t=new uc(e);return new at(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Ni(e.root,!0)}`,r=ww(e.queryParams),i=typeof e.fragment=="string"?`#${vw(e.fragment)}`:"";return`${t}${r}${i}`}},yw=new en;function vo(n){return n.segments.map(e=>rm(e)).join("/")}function Ni(n,e){if(!n.hasChildren())return vo(n);if(e){let t=n.children[W]?Ni(n.children[W],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==W&&r.push(`${i}:${Ni(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=gw(n,(r,i)=>i===W?[Ni(n.children[W],!1)]:[`${i}:${Ni(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[W]!=null?`${vo(n)}/${t[0]}`:`${vo(n)}/(${t.join("//")})`}}function nm(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function mo(n){return nm(n).replace(/%3B/gi,";")}function vw(n){return encodeURI(n)}function ac(n){return nm(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function _o(n){return decodeURIComponent(n)}function jp(n){return _o(n.replace(/\+/g,"%20"))}function rm(n){return`${ac(n.path)}${_w(n.parameters)}`}function _w(n){return Object.entries(n).map(([e,t])=>`;${ac(e)}=${ac(t)}`).join("")}function ww(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${mo(t)}=${mo(i)}`).join("&"):`${mo(t)}=${mo(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Ew=/^[^\/()?;#]+/;function tc(n){let e=n.match(Ew);return e?e[0]:""}var bw=/^[^\/()?;=#]+/;function Sw(n){let e=n.match(bw);return e?e[0]:""}var Iw=/^[^=?&#]+/;function Dw(n){let e=n.match(Iw);return e?e[0]:""}var Tw=/^[^&#]+/;function Aw(n){let e=n.match(Tw);return e?e[0]:""}var uc=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new le([],{}):new le([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[W]=new le(e,t)),r}parseSegment(){let e=tc(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new pe(4009,!1);return this.capture(e),new Jt(_o(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Sw(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=tc(this.remaining);i&&(r=i,this.capture(r))}e[_o(t)]=_o(r)}parseQueryParam(e){let t=Dw(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=Aw(this.remaining);o&&(r=o,this.capture(r))}let i=jp(t),s=jp(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=tc(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new pe(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=W);let o=this.parseChildren();t[s??W]=Object.keys(o).length===1&&o[W]?o[W]:new le([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new pe(4011,!1)}};function im(n){return n.segments.length>0?new le([],{[W]:n}):n}function sm(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=sm(i);if(r===W&&s.segments.length===0&&s.hasChildren())for(let[o,u]of Object.entries(s.children))e[o]=u;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new le(n.segments,e);return Cw(t)}function Cw(n){if(n.numberOfChildren===1&&n.children[W]){let e=n.children[W];return new le(n.segments.concat(e.segments),e.children)}return n}function tn(n){return n instanceof at}function om(n,e,t=null,r=null,i=new en){let s=am(n);return um(s,e,t,r,i)}function am(n){let e;function t(s){let o={};for(let c of s.children){let d=t(c);o[c.outlet]=d}let u=new le(s.url,o);return s===n&&(e=u),u}let r=t(n.root),i=im(r);return e??i}function um(n,e,t,r,i){let s=n;for(;s.parent;)s=s.parent;if(e.length===0)return nc(s,s,s,t,r,i);let o=Rw(e);if(o.toRoot())return nc(s,s,new le([],{}),t,r,i);let u=xw(o,s,n),c=u.processChildren?ki(u.segmentGroup,u.index,o.commands):lm(u.segmentGroup,u.index,o.commands);return nc(s,u.segmentGroup,c,t,r,i)}function Eo(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Li(n){return typeof n=="object"&&n!=null&&n.outlets}function $p(n,e,t){n||="\u0275";let r=new at;return r.queryParams={[n]:e},t.parse(t.serialize(r)).queryParams[n]}function nc(n,e,t,r,i,s){let o={};for(let[d,p]of Object.entries(r??{}))o[d]=Array.isArray(p)?p.map(g=>$p(d,g,s)):$p(d,p,s);let u;n===e?u=t:u=cm(n,e,t);let c=im(sm(u));return new at(c,o,i)}function cm(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=cm(s,e,t)}),new le(n.segments,r)}var bo=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Eo(r[0]))throw new pe(4003,!1);let i=r.find(Li);if(i&&i!==Qp(r))throw new pe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Rw(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new bo(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let u={};return Object.entries(s.outlets).forEach(([c,d])=>{u[c]=typeof d=="string"?d.split("/"):d}),[...i,{outlets:u}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((u,c)=>{c==0&&u==="."||(c==0&&u===""?t=!0:u===".."?e++:u!=""&&i.push(u))}),i):[...i,s]},[]);return new bo(t,e,r)}var nr=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function xw(n,e,t){if(n.isAbsolute)return new nr(e,!0,0);if(!t)return new nr(e,!1,NaN);if(t.parent===null)return new nr(t,!0,0);let r=Eo(n.commands[0])?0:1,i=t.segments.length-1+r;return Pw(t,i,n.numberOfDoubleDots)}function Pw(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new pe(4005,!1);i=r.segments.length}return new nr(r,!1,i-s)}function Nw(n){return Li(n[0])?n[0].outlets:{[W]:n}}function lm(n,e,t){if(n??=new le([],{}),n.segments.length===0&&n.hasChildren())return ki(n,e,t);let r=Ow(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new le(n.segments.slice(0,r.pathIndex),{});return s.children[W]=new le(n.segments.slice(r.pathIndex),n.children),ki(s,0,i)}else return r.match&&i.length===0?new le(n.segments,{}):r.match&&!n.hasChildren()?cc(n,e,t):r.match?ki(n,0,i):cc(n,e,t)}function ki(n,e,t){if(t.length===0)return new le(n.segments,{});{let r=Nw(t),i={};if(Object.keys(r).some(s=>s!==W)&&n.children[W]&&n.numberOfChildren===1&&n.children[W].segments.length===0){let s=ki(n.children[W],e,t);return new le(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=lm(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new le(n.segments,i)}}function Ow(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],u=t[r];if(Li(u))break;let c=`${u}`,d=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&d&&typeof d=="object"&&d.outlets===void 0){if(!qp(c,d,o))return s;r+=2}else{if(!qp(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function cc(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Li(s)){let c=kw(s.outlets);return new le(r,c)}if(i===0&&Eo(t[0])){let c=n.segments[e];r.push(new Jt(c.path,zp(t[0]))),i++;continue}let o=Li(s)?s.outlets[W]:`${s}`,u=i<t.length-1?t[i+1]:null;o&&u&&Eo(u)?(r.push(new Jt(o,zp(u))),i+=2):(r.push(new Jt(o,{})),i++)}return new le(r,{})}function kw(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=cc(new le([],{}),0,r))}),e}function zp(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function qp(n,e,t){return n==t.path&&yt(e,t.parameters)}var Mi="imperative",Ae=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(Ae||{}),Qe=class{id;url;constructor(e,t){this.id=e,this.url=t}},Cn=class extends Qe{type=Ae.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ut=class extends Qe{urlAfterRedirects;type=Ae.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},qe=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(qe||{}),Vi=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(Vi||{}),vt=class extends Qe{reason;code;type=Ae.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},kt=class extends Qe{reason;code;type=Ae.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},ir=class extends Qe{error;target;type=Ae.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ui=class extends Qe{urlAfterRedirects;state;type=Ae.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},So=class extends Qe{urlAfterRedirects;state;type=Ae.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Io=class extends Qe{urlAfterRedirects;state;shouldActivate;type=Ae.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Do=class extends Qe{urlAfterRedirects;state;type=Ae.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},To=class extends Qe{urlAfterRedirects;state;type=Ae.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ao=class{route;type=Ae.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Co=class{route;type=Ae.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Ro=class{snapshot;type=Ae.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xo=class{snapshot;type=Ae.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Po=class{snapshot;type=Ae.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},No=class{snapshot;type=Ae.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Bi=class{},sr=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function Mw(n){return!(n instanceof Bi)&&!(n instanceof sr)}function Fw(n,e){return n.providers&&!n._injector&&(n._injector=Bu(n.providers,e,`Route: ${n.path}`)),n._injector??e}function ot(n){return n.outlet||W}function Lw(n,e){let t=n.filter(r=>ot(r)===e);return t.push(...n.filter(r=>ot(r)!==e)),t}function ur(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Oo=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return ur(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new cr(this.rootInjector)}},cr=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Oo(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(re(Qn))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ko=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=lc(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=lc(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=hc(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return hc(e,this._root).map(t=>t.value)}};function lc(n,e){if(n===e.value)return e;for(let t of e.children){let r=lc(n,t);if(r)return r}return null}function hc(n,e){if(n===e.value)return[e];for(let t of e.children){let r=hc(n,t);if(r.length)return r.unshift(e),r}return[]}var Ze=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function tr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var ji=class extends ko{snapshot;constructor(e,t){super(e),this.snapshot=t,yc(this,e)}toString(){return this.snapshot.toString()}};function hm(n){let e=Vw(n),t=new Xe([new Jt("",{})]),r=new Xe({}),i=new Xe({}),s=new Xe({}),o=new Xe(""),u=new Mt(t,r,s,o,i,W,n,e.root);return u.snapshot=e.root,new ji(new Ze(u,[]),e)}function Vw(n){let e={},t={},r={},s=new Tn([],e,r,"",t,W,n,null,{});return new $i("",new Ze(s,[]))}var Mt=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,u,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=u,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Pe(d=>d[qi]))??ee(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Pe(e=>An(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Pe(e=>An(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Mo(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:E(E({},e.params),n.params),data:E(E({},e.data),n.data),resolve:E(E(E(E({},n.data),e.data),i?.data),n._resolvedData)}:r={params:E({},n.params),data:E({},n.data),resolve:E(E({},n.data),n._resolvedData??{})},i&&fm(i)&&(r.resolve[qi]=i.title),r}var Tn=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[qi]}constructor(e,t,r,i,s,o,u,c,d){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=u,this.routeConfig=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=An(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=An(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},$i=class extends ko{url;constructor(e,t){super(t),this.url=e,yc(this,t)}toString(){return dm(this._root)}};function yc(n,e){e.value._routerState=n,e.children.forEach(t=>yc(n,t))}function dm(n){let e=n.children.length>0?` { ${n.children.map(dm).join(", ")} } `:"";return`${n.value}${e}`}function rc(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,yt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),yt(e.params,t.params)||n.paramsSubject.next(t.params),hw(e.url,t.url)||n.urlSubject.next(t.url),yt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function dc(n,e){let t=yt(n.params,e.params)&&mw(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||dc(n.parent,e.parent))}function fm(n){return typeof n.title=="string"||n.title===null}var pm=new we(""),vc=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=W;activateEvents=new wn;deactivateEvents=new wn;attachEvents=new wn;detachEvents=new wn;routerOutletData=Ep();parentContexts=z(cr);location=z(Uu);changeDetector=z(Di);inputBinder=z(Hi,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new pe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new pe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new pe(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new pe(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new fc(t,u,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=bn({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Yn]})}return n})(),fc=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===Mt?this.route:e===cr?this.childContexts:e===pm?this.outletData:this.parent.get(e,t)}},Hi=new we(""),_c=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Pu([r.queryParams,r.params,r.data]).pipe(mt(([s,o,u],c)=>(u=E(E(E({},s),o),u),c===0?ee(u):Promise.resolve(u)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let o=Sp(r.component);if(!o){this.unsubscribeFromRouteData(t);return}for(let{templateName:u}of o.inputs)t.activatedComponentRef.setInput(u,s[u])});this.outletDataSubscriptions.set(t,i)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac})}return n})(),wc=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=cp({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&pp(0,"router-outlet")},dependencies:[vc],encapsulation:2})}return n})();function Ec(n){let e=n.children&&n.children.map(Ec),t=e?V(E({},n),{children:e}):E({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==W&&(t.component=wc),t}function Uw(n,e,t){let r=zi(n,e._root,t?t._root:void 0);return new ji(r,e)}function zi(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=Bw(n,e,t);return new Ze(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(u=>zi(n,u)),o}}let r=jw(e.value),i=e.children.map(s=>zi(n,s));return new Ze(r,i)}}function Bw(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return zi(n,r,i);return zi(n,r)})}function jw(n){return new Mt(new Xe(n.url),new Xe(n.params),new Xe(n.queryParams),new Xe(n.fragment),new Xe(n.data),n.outlet,n.component,n)}var or=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},mm="ngNavigationCancelingError";function Fo(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=tn(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=gm(!1,qe.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function gm(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[mm]=!0,t.cancellationCode=e,t}function $w(n){return ym(n)&&tn(n.url)}function ym(n){return!!n&&n[mm]}var zw=(n,e,t,r)=>Pe(i=>(new pc(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),pc=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),rc(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=tr(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=tr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),u=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=tr(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=tr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new No(s.value.snapshot))}),e.children.length&&this.forwardEvent(new xo(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(rc(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(u.contexts),o.attachRef=u.componentRef,o.route=u.route.value,o.outlet&&o.outlet.attach(u.componentRef,u.route.value),rc(u.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},Lo=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},rr=class{component;route;constructor(e,t){this.component=e,this.route=t}};function qw(n,e,t){let r=n._root,i=e?e._root:null;return Oi(r,i,t,[r.value])}function Gw(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function lr(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!Gf(n)?n:e.get(n):r}function Oi(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=tr(e);return n.children.forEach(o=>{Hw(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,u])=>Fi(u,t.getContext(o),i)),i}function Hw(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=Ww(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Lo(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Oi(n,e,u?u.children:null,r,i):Oi(n,e,t,r,i),c&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new rr(u.outlet.component,o))}else o&&Fi(e,u,i),i.canActivateChecks.push(new Lo(r)),s.component?Oi(n,null,u?u.children:null,r,i):Oi(n,null,t,r,i);return i}function Ww(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Dn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Dn(n.url,e.url)||!yt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!dc(n,e)||!yt(n.queryParams,e.queryParams);case"paramsChange":default:return!dc(n,e)}}function Fi(n,e,t){let r=tr(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Fi(o,e.children.getContext(s),t):Fi(o,null,t):Fi(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new rr(e.outlet.component,i)):t.canDeactivateChecks.push(new rr(null,i)):t.canDeactivateChecks.push(new rr(null,i))}function Wi(n){return typeof n=="function"}function Kw(n){return typeof n=="boolean"}function Zw(n){return n&&Wi(n.canLoad)}function Qw(n){return n&&Wi(n.canActivate)}function Yw(n){return n&&Wi(n.canActivateChild)}function Xw(n){return n&&Wi(n.canDeactivate)}function Jw(n){return n&&Wi(n.canMatch)}function vm(n){return n instanceof jf||n?.name==="EmptyError"}var go=Symbol("INITIAL_VALUE");function ar(){return mt(n=>Pu(n.map(e=>e.pipe(Zn(1),qf(go)))).pipe(Pe(e=>{for(let t of e)if(t!==!0){if(t===go)return go;if(t===!1||eE(t))return t}return!0}),Qt(e=>e!==go),Zn(1)))}function eE(n){return tn(n)||n instanceof or}function _m(n){return n.aborted?ee(void 0).pipe(Zn(1)):new Uf(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function wm(n){return Js(_m(n))}function tE(n,e){return Pt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?ee(V(E({},t),{guardsResult:!0})):nE(o,r,i,n).pipe(Pt(u=>u&&Kw(u)?rE(r,s,n,e):ee(u)),Pe(u=>V(E({},t),{guardsResult:u})))})}function nE(n,e,t,r){return rt(n).pipe(Pt(i=>uE(i.component,i.route,t,e,r)),Yt(i=>i!==!0,!0))}function rE(n,e,t,r){return rt(e).pipe(Xs(i=>$f(sE(i.route.parent,r),iE(i.route,r),aE(n,i.path,t),oE(n,i.route,t))),Yt(i=>i!==!0,!0))}function iE(n,e){return n!==null&&e&&e(new Po(n)),ee(!0)}function sE(n,e){return n!==null&&e&&e(new Ro(n)),ee(!0)}function oE(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return ee(!0);let i=r.map(s=>Qs(()=>{let o=ur(e)??t,u=lr(s,o),c=Qw(u)?u.canActivate(e,n):it(o,()=>u(e,n));return Rn(c).pipe(Yt())}));return ee(i).pipe(ar())}function aE(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>Gw(o)).filter(o=>o!==null).map(o=>Qs(()=>{let u=o.guards.map(c=>{let d=ur(o.node)??t,p=lr(c,d),g=Yw(p)?p.canActivateChild(r,n):it(d,()=>p(r,n));return Rn(g).pipe(Yt())});return ee(u).pipe(ar())}));return ee(s).pipe(ar())}function uE(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ee(!0);let o=s.map(u=>{let c=ur(e)??i,d=lr(u,c),p=Xw(d)?d.canDeactivate(n,e,t,r):it(c,()=>d(n,e,t,r));return Rn(p).pipe(Yt())});return ee(o).pipe(ar())}function cE(n,e,t,r,i){let s=e.canLoad;if(s===void 0||s.length===0)return ee(!0);let o=s.map(u=>{let c=lr(u,n),d=Zw(c)?c.canLoad(e,t):it(n,()=>c(e,t)),p=Rn(d);return i?p.pipe(wm(i)):p});return ee(o).pipe(ar(),Em(r))}function Em(n){return Vf(Ge(e=>{if(typeof e!="boolean")throw Fo(n,e)}),Pe(e=>e===!0))}function lE(n,e,t,r,i){let s=e.canMatch;if(!s||s.length===0)return ee(!0);let o=s.map(u=>{let c=lr(u,n),d=Jw(c)?c.canMatch(e,t):it(n,()=>c(e,t)),p=Rn(d);return i?p.pipe(wm(i)):p});return ee(o).pipe(ar(),Em(r))}var In=class bm extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,bm.prototype)}},mc=class Sm extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,Sm.prototype)}};function hE(n){throw new pe(4e3,!1)}function dE(n){throw gm(!1,qe.GuardRejected)}var fE=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return r;if(i.numberOfChildren>1||!i.children[W])throw hE(`${e.redirectTo}`);i=i.children[W]}}async applyRedirectCommands(e,t,r,i,s){let o=await pE(t,i,s);if(o instanceof at)throw new mc(o);let u=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),e,r);if(o[0]==="/")throw new mc(u);return u}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new at(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let u=s.substring(1);r[i]=t[u]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([u,c])=>{o[u]=this.createSegmentGroup(e,c,r,i)}),new le(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new pe(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}};function pE(n,e,t){if(typeof n=="string")return Promise.resolve(n);let r=n,{queryParams:i,fragment:s,routeConfig:o,url:u,outlet:c,params:d,data:p,title:g}=e;return wo(Rn(it(t,()=>r({params:d,data:p,queryParams:i,fragment:s,routeConfig:o,url:u,outlet:c,title:g}))))}var gc={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function mE(n,e,t,r,i,s){let o=Im(n,e,t);return o.matched?(r=Fw(e,r),lE(r,e,t,i,s).pipe(Pe(u=>u===!0?o:E({},gc)))):ee(o)}function Im(n,e,t){if(e.path==="**")return gE(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?E({},gc):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Kp)(t,n,e);if(!i)return E({},gc);let s={};Object.entries(i.posParams??{}).forEach(([u,c])=>{s[u]=c.path});let o=i.consumed.length>0?E(E({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function gE(n){return{matched:!0,parameters:n.length>0?Qp(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function Gp(n,e,t,r){return t.length>0&&_E(n,t,r)?{segmentGroup:new le(e,vE(r,new le(t,n.children))),slicedSegments:[]}:t.length===0&&wE(n,t,r)?{segmentGroup:new le(n.segments,yE(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new le(n.segments,n.children),slicedSegments:t}}function yE(n,e,t,r){let i={};for(let s of t)if(Uo(n,e,s)&&!r[ot(s)]){let o=new le([],{});i[ot(s)]=o}return E(E({},r),i)}function vE(n,e){let t={};t[W]=e;for(let r of n)if(r.path===""&&ot(r)!==W){let i=new le([],{});t[ot(r)]=i}return t}function _E(n,e,t){return t.some(r=>Uo(n,e,r)&&ot(r)!==W)}function wE(n,e,t){return t.some(r=>Uo(n,e,r))}function Uo(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function EE(n,e,t){return e.length===0&&!n.children[t]}var bE=class{};async function SE(n,e,t,r,i,s,o="emptyOnly",u){return new DE(n,e,t,r,i,o,s,u).recognize()}var IE=31,DE=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,u,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=u,this.abortSignal=c,this.applyRedirects=new fE(this.urlSerializer,this.urlTree)}noMatchError(e){return new pe(4002,`'${e.segmentGroup}'`)}async recognize(){let e=Gp(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:r}=await this.match(e),i=new Ze(r,t),s=new $i("",i),o=om(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}async match(e){let t=new Tn([],Object.freeze({}),Object.freeze(E({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),W,this.rootComponentType,null,{});try{return{children:await this.processSegmentGroup(this.injector,this.config,e,W,t),rootSnapshot:t}}catch(r){if(r instanceof mc)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof In?this.noMatchError(r):r}}async processSegmentGroup(e,t,r,i,s){if(r.segments.length===0&&r.hasChildren())return this.processChildren(e,t,r,s);let o=await this.processSegment(e,t,r,r.segments,i,!0,s);return o instanceof Ze?[o]:[]}async processChildren(e,t,r,i){let s=[];for(let c of Object.keys(r.children))c==="primary"?s.unshift(c):s.push(c);let o=[];for(let c of s){let d=r.children[c],p=Lw(t,c),g=await this.processSegmentGroup(e,p,d,c,i);o.push(...g)}let u=Dm(o);return TE(u),u}async processSegment(e,t,r,i,s,o,u){for(let c of t)try{return await this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,u)}catch(d){if(d instanceof In||vm(d))continue;throw d}if(EE(r,i,s))return new bE;throw new In(r)}async processSegmentAgainstRoute(e,t,r,i,s,o,u,c){if(ot(r)!==o&&(o===W||!Uo(i,s,r)))throw new In(i);if(r.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,i,r,s,o,c);if(this.allowRedirects&&u)return this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c);throw new In(i)}async expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,u){let{matched:c,parameters:d,consumedSegments:p,positionalParamSegments:g,remainingSegments:w}=Im(t,i,s);if(!c)throw new In(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>IE&&(this.allowRedirects=!1));let C=new Tn(s,d,Object.freeze(E({},this.urlTree.queryParams)),this.urlTree.fragment,Hp(i),ot(i),i.component??i._loadedComponent??null,i,Wp(i)),N=Mo(C,u,this.paramsInheritanceStrategy);if(C.params=Object.freeze(N.params),C.data=Object.freeze(N.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let B=await this.applyRedirects.applyRedirectCommands(p,i.redirectTo,g,C,e),M=await this.applyRedirects.lineralizeSegments(i,B);return this.processSegment(e,r,t,M.concat(w),o,!1,u)}async matchSegmentAgainstRoute(e,t,r,i,s,o){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let u=await wo(mE(t,r,i,e,this.urlSerializer,this.abortSignal));if(r.path==="**"&&(t.children={}),!u?.matched)throw new In(t);e=r._injector??e;let{routes:c}=await this.getChildConfig(e,r,i),d=r._loadedInjector??e,{parameters:p,consumedSegments:g,remainingSegments:w}=u,C=new Tn(g,p,Object.freeze(E({},this.urlTree.queryParams)),this.urlTree.fragment,Hp(r),ot(r),r.component??r._loadedComponent??null,r,Wp(r)),N=Mo(C,o,this.paramsInheritanceStrategy);C.params=Object.freeze(N.params),C.data=Object.freeze(N.data);let{segmentGroup:B,slicedSegments:M}=Gp(t,g,w,c);if(M.length===0&&B.hasChildren()){let ie=await this.processChildren(d,c,B,C);return new Ze(C,ie)}if(c.length===0&&M.length===0)return new Ze(C,[]);let ne=ot(r)===s,X=await this.processSegment(d,c,B,M,ne?W:s,!0,C);return new Ze(C,X instanceof Ze?[X]:[])}async getChildConfig(e,t,r){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0)return{routes:t._loadedRoutes,injector:t._loadedInjector};if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await wo(cE(e,t,r,this.urlSerializer,this.abortSignal))){let s=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=s.routes,t._loadedInjector=s.injector,s}throw dE(t)}return{routes:[],injector:e}}};function TE(n){n.sort((e,t)=>e.value.outlet===W?-1:t.value.outlet===W?1:e.value.outlet.localeCompare(t.value.outlet))}function AE(n){let e=n.value.routeConfig;return e&&e.path===""}function Dm(n){let e=[],t=new Set;for(let r of n){if(!AE(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Dm(r.children);e.push(new Ze(r.value,i))}return e.filter(r=>!t.has(r))}function Hp(n){return n.data||{}}function Wp(n){return n.resolve||{}}var CE=new we("",{factory:()=>SE});function RE(n,e,t,r,i,s,o){let u=n.get(CE);return Pt(c=>ee(c).pipe(mt(d=>u(n,e,t,r,d.extractedUrl,i,s,o)),Pe(({state:d,tree:p})=>V(E({},c),{targetSnapshot:d,urlAfterRedirects:p}))))}function xE(n,e){return Pt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return ee(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let d of Tm(c))o.add(d);let u=0;return rt(o).pipe(Xs(c=>s.has(c)?PE(c,r,n,e):(c.data=Mo(c,c.parent,n).resolve,ee(void 0))),Ge(()=>u++),Ou(1),Pt(c=>u===o.size?ee(t):xt))})}function Tm(n){let e=n.children.map(t=>Tm(t)).flat();return[n,...e]}function PE(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!fm(i)&&(s[qi]=i.title),Qs(()=>(n.data=Mo(n,n.parent,t).resolve,NE(s,n,e,r).pipe(Pe(o=>(n._resolvedData=o,n.data=E(E({},n.data),o),null)))))}function NE(n,e,t,r){let i=oc(n);if(i.length===0)return ee({});let s={};return rt(i).pipe(Pt(o=>OE(n[o],e,t,r).pipe(Yt(),Ge(u=>{if(u instanceof or)throw Fo(new en,u);s[o]=u}))),Ou(1),Pe(()=>s),Ys(o=>vm(o)?xt:Bf(o)))}function OE(n,e,t,r){let i=ur(e)??r,s=lr(n,i),o=s.resolve?s.resolve(e,t):it(i,()=>s(e,t));return Rn(o)}function ic(n){return mt(e=>{let t=n(e);return t?rt(t).pipe(Pe(()=>e)):ee(e)})}var bc=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===W);return r}getResolvedTitleForRoute(t){return t.data[qi]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>z(Am),providedIn:"root"})}return n})(),Am=(()=>{class n extends bc{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(re(Up))};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),hr=new we("",{factory:()=>({})}),Ki=new we(""),Cm=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=z(_p);async loadComponent(t,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await Yp(it(t,()=>r.loadComponent())),o=await Pm(xm(s));return this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o,o}finally{this.componentLoaders.delete(r)}})();return this.componentLoaders.set(r,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await Rm(r,this.compiler,t,this.onLoadEndListener);return r._loadedRoutes=s.routes,r._loadedInjector=s.injector,s}finally{this.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,i),i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function Rm(n,e,t,r){let i=await Yp(it(t,()=>n.loadChildren())),s=await Pm(xm(i)),o;s instanceof up||Array.isArray(s)?o=s:o=await e.compileModuleAsync(s),r&&r(n);let u,c,d=!1;return Array.isArray(o)?(c=o,d=!0):(u=o.create(t).injector,c=u.get(Ki,[],{optional:!0,self:!0}).flat()),{routes:c.map(Ec),injector:u}}function kE(n){return n&&typeof n=="object"&&"default"in n}function xm(n){return kE(n)?n.default:n}async function Pm(n){return n}var Bo=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>z(ME),providedIn:"root"})}return n})(),ME=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Nm=new we("");var FE=()=>{},Om=new we(""),km=(()=>{class n{currentNavigation=wi(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=wi(null);events=new Rt;transitionAbortWithErrorSubject=new Rt;configLoader=z(Cm);environmentInjector=z(Qn);destroyRef=z(Wf);urlSerializer=z(Gi);rootContexts=z(cr);location=z(Sn);inputBindingEnabled=z(Hi,{optional:!0})!==null;titleStrategy=z(bc);options=z(hr,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=z(Bo);createViewTransition=z(Nm,{optional:!0});navigationErrorHandler=z(Om,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>ee(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new Ao(i)),r=i=>this.events.next(new Co(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;Xt(()=>{this.transitions?.next(V(E({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))})}setupNavigations(t){return this.transitions=new Xe(null),this.transitions.pipe(Qt(r=>r!==null),mt(r=>{let i=!1,s=new AbortController;return ee(r).pipe(mt(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",qe.SupersededByNewNavigation),xt;this.currentTransition=r;let u=this.lastSuccessfulNavigation();this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:u?V(E({},u),{previousNavigation:null}):null,abort:()=>s.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload")return this.events.next(new kt(o.id,this.urlSerializer.serialize(o.rawUrl),"",Vi.IgnoredSameUrlNavigation)),o.resolve(!1),xt;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return ee(o).pipe(mt(p=>(this.events.next(new Cn(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),p.id!==this.navigationId?xt:Promise.resolve(p))),RE(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,s.signal),Ge(p=>{r.targetSnapshot=p.targetSnapshot,r.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation.update(w=>(w.finalUrl=p.urlAfterRedirects,w));let g=new Ui(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(g)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:p,extractedUrl:g,source:w,restoredState:C,extras:N}=o,B=new Cn(p,this.urlSerializer.serialize(g),w,C);this.events.next(B);let M=hm(this.rootComponentType).snapshot;return this.currentTransition=r=V(E({},o),{targetSnapshot:M,urlAfterRedirects:g,extras:V(E({},N),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(ne=>(ne.finalUrl=g,ne)),ee(r)}else return this.events.next(new kt(o.id,this.urlSerializer.serialize(o.extractedUrl),"",Vi.IgnoredByUrlHandlingStrategy)),o.resolve(!1),xt}),Ge(o=>{let u=new So(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(u)}),Pe(o=>(this.currentTransition=r=V(E({},o),{guards:qw(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),tE(this.environmentInjector,o=>this.events.next(o)),Ge(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Fo(this.urlSerializer,o.guardsResult);let u=new Io(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(u)}),Qt(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",qe.GuardRejected),!1)),ic(o=>{if(o.guards.canActivateChecks.length!==0)return ee(o).pipe(Ge(u=>{let c=new Do(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}),mt(u=>{let c=!1;return ee(u).pipe(xE(this.paramsInheritanceStrategy,this.environmentInjector),Ge({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(u,"",qe.NoDataFromResolver)}}))}),Ge(u=>{let c=new To(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(c)}))}),ic(o=>{let u=d=>{let p=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let g=ur(d)??this.environmentInjector;p.push(this.configLoader.loadComponent(g,d.routeConfig).then(w=>{d.component=w}))}for(let g of d.children)p.push(...u(g));return p},c=u(o.targetSnapshot.root);return c.length===0?ee(o):rt(Promise.all(c).then(()=>o))}),ic(()=>this.afterPreactivation()),mt(()=>{let{currentSnapshot:o,targetSnapshot:u}=r,c=this.createViewTransition?.(this.environmentInjector,o.root,u.root);return c?rt(c).pipe(Pe(()=>r)):ee(r)}),Pe(o=>{let u=Uw(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=V(E({},o),{targetRouterState:u}),this.currentNavigation.update(c=>(c.targetRouterState=u,c)),r}),Ge(()=>{this.events.next(new Bi)}),zw(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Zn(1),Js(_m(s.signal).pipe(Qt(()=>!i&&!r.targetRouterState),Ge(()=>{this.cancelNavigationTransition(r,s.signal.reason+"",qe.Aborted)}))),Ge({next:o=>{i=!0,this.currentNavigation.update(u=>(u.abort=FE,u)),this.lastSuccessfulNavigation.set(Xt(this.currentNavigation)),this.events.next(new ut(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),Js(this.transitionAbortWithErrorSubject.pipe(Ge(o=>{throw o}))),zf(()=>{s.abort(),i||this.cancelNavigationTransition(r,"",qe.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Ys(o=>{if(this.destroyed)return r.resolve(!1),xt;if(i=!0,ym(o))this.events.next(new vt(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),$w(o)?this.events.next(new sr(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let u=new ir(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let c=it(this.environmentInjector,()=>this.navigationErrorHandler?.(u));if(c instanceof or){let{message:d,cancellationCode:p}=Fo(this.urlSerializer,c);this.events.next(new vt(r.id,this.urlSerializer.serialize(r.extractedUrl),d,p)),this.events.next(new sr(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(u),o}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return xt}))}))}cancelNavigationTransition(t,r,i){let s=new vt(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=Xt(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return t.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function LE(n){return n!==Mi}var Mm=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>z(VE),providedIn:"root"})}return n})(),Vo=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},VE=(()=>{class n extends Vo{static \u0275fac=(()=>{let t;return function(i){return(t||(t=io(n)))(i||n)}})();static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Sc=(()=>{class n{urlSerializer=z(Gi);options=z(hr,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=z(Sn);urlHandlingStrategy=z(Bo);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new at;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof at?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=hm(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:()=>z(Fm),providedIn:"root"})}return n})(),Fm=(()=>{class n extends Sc{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof Cn?this.updateStateMemento():t instanceof kt?this.commitTransition(r):t instanceof Ui?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof Bi?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof vt&&t.code!==qe.SupersededByNewNavigation&&t.code!==qe.Redirect?this.restoreHistory(r):t instanceof ir?this.restoreHistory(r,!0):t instanceof ut&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let u=this.browserPageId,c=E(E({},o),this.generateNgRouterState(i,u));this.location.replaceState(t,"",c)}else{let u=E(E({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",u)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=io(n)))(i||n)}})();static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ic(n,e){n.events.pipe(Qt(t=>t instanceof ut||t instanceof vt||t instanceof ir||t instanceof kt),Pe(t=>t instanceof ut||t instanceof kt?0:(t instanceof vt?t.code===qe.Redirect||t.code===qe.SupersededByNewNavigation:!1)?2:1),Qt(t=>t!==2),Zn(1)).subscribe(()=>{e()})}var UE={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},BE={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},dr=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=z(ju);stateManager=z(Sc);options=z(hr,{optional:!0})||{};pendingTasks=z(Kf);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=z(km);urlSerializer=z(Gi);location=z(Sn);urlHandlingStrategy=z(Bo);injector=z(Qn);_events=new Rt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=z(Mm);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=z(Ki,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!z(Hi,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Lf;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=Xt(this.navigationTransitions.currentNavigation);if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof vt&&r.code!==qe.Redirect&&r.code!==qe.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof ut)this.navigated=!0;else if(r instanceof sr){let o=r.navigationBehaviorOptions,u=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=E({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||LE(i.source)},o);this.scheduleNavigation(u,Mi,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}Mw(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Mi,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=E({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let u=this.parseUrl(t);this.scheduleNavigation(u,r,o,s).catch(c=>{this.disposed||this.injector.get(ro)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Xt(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Ec),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:u,preserveFragment:c}=r,d=c?this.currentUrlTree.fragment:o,p=null;switch(u??this.options.defaultQueryParamsHandling){case"merge":p=E(E({},this.currentUrlTree.queryParams),s);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=s||null}p!==null&&(p=this.removeEmptyProps(p));let g;try{let w=i?i.snapshot:this.routerState.snapshot.root;g=am(w)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),g=this.currentUrlTree.root}return um(g,t,p,d??null,this.urlSerializer)}navigateByUrl(t,r={skipLocationChange:!1}){let i=tn(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Mi,null,r)}navigate(t,r={skipLocationChange:!1}){return jE(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(ku(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=E({},UE):r===!1?i=E({},BE):i=r,tn(t))return Bp(this.currentUrlTree,t,i);let s=this.parseUrl(t);return Bp(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let u,c,d;o?(u=o.resolve,c=o.reject,d=o.promise):d=new Promise((g,w)=>{u=g,c=w});let p=this.pendingTasks.add();return Ic(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:u,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(g=>Promise.reject(g))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function jE(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new pe(4008,!1)}var jo=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=wi(null);get href(){return Xt(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Rt;applicationErrorHandler=z(ro);options=z(hr,{optional:!0});constructor(t,r,i,s,o,u){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=u,this.reactiveHref.set(z(new wp("href"),{optional:!0}));let c=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area"||!!(typeof customElements=="object"&&customElements.get(c)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let t=this.preserveFragment,r=i=>i==="merge"||i==="preserve";t||=r(this.queryParamsHandling),t||=!this.queryParamsHandling&&!r(this.options?.defaultQueryParamsHandling),t&&(this.subscription=this.router.events.subscribe(i=>{i instanceof ut&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(tn(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,s,o){let u=this.urlTree;if(u===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,c)?.catch(d=>{this.applicationErrorHandler(d)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:tn(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(Ke(dr),Ke(Mt),Fu("tabindex"),Ke(Si),Ke(Ei),Ke(gt))};static \u0275dir=bn({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,i){r&1&&mp("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&fp("href",i.reactiveHref(),ip)("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ao],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ao],replaceUrl:[2,"replaceUrl","replaceUrl",ao],routerLink:"routerLink"},features:[Yn]})}return n})(),zE=(()=>{class n{router;element;renderer;cdr;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new wn;link=z(jo,{optional:!0});constructor(t,r,i,s){this.router=t,this.element=r,this.renderer=i,this.cdr=s,this.routerEventsSubscription=t.events.subscribe(o=>{o instanceof ut&&this.update()})}ngAfterContentInit(){ee(this.links.changes,ee(null)).pipe(Nu()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=rt(t).pipe(Nu()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(t){let r=Array.isArray(t)?t:t.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(r=>{t?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let r=qE(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>{let s=i.urlTree;return s?t.isActive(s,r):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static \u0275fac=function(r){return new(r||n)(Ke(dr),Ke(Ei),Ke(Si),Ke(Di))};static \u0275dir=bn({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,s){if(r&1&&gp(s,jo,5),r&2){let o;yp(o=vp())&&(i.links=o)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Yn]})}return n})();function qE(n){return!!n.paths}var GE=new we("");function HE(n,...e){return eo([{provide:Ki,multi:!0,useValue:n},[],{provide:Mt,useFactory:WE},{provide:dp,multi:!0,useFactory:KE},e.map(t=>t.\u0275providers)])}function WE(){return z(dr).routerState.root}function Lm(n,e){return{\u0275kind:n,\u0275providers:e}}function KE(){let n=z(to);return e=>{let t=n.get($u);if(e!==t.components[0])return;let r=n.get(dr),i=n.get(ZE);n.get(QE)===1&&r.initialNavigation(),n.get(YE,null,{optional:!0})?.setUpPreloading(),n.get(GE,null,{optional:!0})?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var ZE=new we("",{factory:()=>new Rt}),QE=new we("",{factory:()=>1});var YE=new we("");function XE(){return Lm(6,[{provide:gt,useClass:Hu}])}function JE(){return Lm(8,[_c,{provide:Hi,useExisting:_c}])}var f={};P0(f,{BRAND:()=>Db,DIRTY:()=>xn,EMPTY_PATH:()=>rb,INVALID:()=>q,NEVER:()=>cS,OK:()=>Ue,ParseStatus:()=>Ne,Schema:()=>Y,ZodAny:()=>qo,ZodArray:()=>Yi,ZodBigInt:()=>Cc,ZodBoolean:()=>Rc,ZodBranded:()=>Xi,ZodCatch:()=>Uc,ZodDate:()=>xc,ZodDefault:()=>Vc,ZodDiscriminatedUnion:()=>Go,ZodEffects:()=>vr,ZodEnum:()=>Zo,ZodError:()=>wt,ZodFirstPartyTypeKind:()=>G,ZodFunction:()=>Wo,ZodIntersection:()=>kc,ZodIssueCode:()=>x,ZodLazy:()=>Mc,ZodLiteral:()=>Fc,ZodMap:()=>Wm,ZodNaN:()=>Qm,ZodNativeEnum:()=>Lc,ZodNever:()=>Pn,ZodNull:()=>Nc,ZodNullable:()=>_r,ZodNumber:()=>Ac,ZodObject:()=>gr,ZodOptional:()=>rn,ZodParsedType:()=>F,ZodPipeline:()=>Ji,ZodPromise:()=>Qo,ZodReadonly:()=>Bc,ZodRecord:()=>Ho,ZodSchema:()=>Y,ZodSet:()=>Km,ZodString:()=>Ko,ZodSymbol:()=>Gm,ZodTransformer:()=>vr,ZodTuple:()=>yr,ZodType:()=>Y,ZodUndefined:()=>Pc,ZodUnion:()=>Oc,ZodUnknown:()=>Qi,ZodVoid:()=>Hm,addIssueToContext:()=>k,any:()=>kb,array:()=>Vb,bigint:()=>Rb,boolean:()=>eg,coerce:()=>uS,custom:()=>Ym,date:()=>xb,datetimeRegex:()=>qm,defaultErrorMap:()=>Ft,discriminatedUnion:()=>$b,effect:()=>eS,enum:()=>Yb,function:()=>Kb,getErrorMap:()=>fr,getParsedType:()=>_t,instanceof:()=>Ab,intersection:()=>zb,isAborted:()=>$o,isAsync:()=>pr,isDirty:()=>zo,isValid:()=>nn,late:()=>Tb,lazy:()=>Zb,literal:()=>Qb,makeIssue:()=>Zi,map:()=>Hb,nan:()=>Cb,nativeEnum:()=>Xb,never:()=>Fb,null:()=>Ob,nullable:()=>nS,number:()=>Jm,object:()=>Ub,objectUtil:()=>Vm,oboolean:()=>aS,onumber:()=>oS,optional:()=>tS,ostring:()=>sS,pipeline:()=>iS,preprocess:()=>rS,promise:()=>Jb,quotelessJson:()=>eb,record:()=>Gb,set:()=>Wb,setErrorMap:()=>nb,strictObject:()=>Bb,string:()=>Xm,symbol:()=>Pb,transformer:()=>eS,tuple:()=>qb,undefined:()=>Nb,union:()=>jb,unknown:()=>Mb,util:()=>te,void:()=>Lb});var te;(function(n){n.assertEqual=i=>{};function e(i){}n.assertIs=e;function t(i){throw new Error}n.assertNever=t,n.arrayToEnum=i=>{let s={};for(let o of i)s[o]=o;return s},n.getValidEnumValues=i=>{let s=n.objectKeys(i).filter(u=>typeof i[i[u]]!="number"),o={};for(let u of s)o[u]=i[u];return n.objectValues(o)},n.objectValues=i=>n.objectKeys(i).map(function(s){return i[s]}),n.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{let s=[];for(let o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},n.find=(i,s)=>{for(let o of i)if(s(o))return o},n.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}n.joinValues=r,n.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(te||(te={}));var Vm=(function(n){return n.mergeShapes=(e,t)=>E(E({},e),t),n})(Vm||{}),F=te.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),_t=n=>{switch(typeof n){case"undefined":return F.undefined;case"string":return F.string;case"number":return Number.isNaN(n)?F.nan:F.number;case"boolean":return F.boolean;case"function":return F.function;case"bigint":return F.bigint;case"symbol":return F.symbol;case"object":return Array.isArray(n)?F.array:n===null?F.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?F.promise:typeof Map<"u"&&n instanceof Map?F.map:typeof Set<"u"&&n instanceof Set?F.set:typeof Date<"u"&&n instanceof Date?F.date:F.object;default:return F.unknown}};var x=te.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),eb=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:"),wt=(()=>{class n extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){let r=t||function(o){return o.message},i={_errors:[]},s=o=>{for(let u of o.issues)if(u.code==="invalid_union")u.unionErrors.map(s);else if(u.code==="invalid_return_type")s(u.returnTypeError);else if(u.code==="invalid_arguments")s(u.argumentsError);else if(u.path.length===0)i._errors.push(r(u));else{let c=i,d=0;for(;d<u.path.length;){let p=u.path[d];d===u.path.length-1?(c[p]=c[p]||{_errors:[]},c[p]._errors.push(r(u))):c[p]=c[p]||{_errors:[]},c=c[p],d++}}};return s(this),i}static assert(t){if(!(t instanceof n))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,te.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){let r={},i=[];for(let s of this.issues)if(s.path.length>0){let o=s.path[0];r[o]=r[o]||[],r[o].push(t(s))}else i.push(t(s));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}}return n.create=e=>new n(e),n})();var tb=(n,e)=>{let t;switch(n.code){case x.invalid_type:n.received===F.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case x.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,te.jsonStringifyReplacer)}`;break;case x.unrecognized_keys:t=`Unrecognized key(s) in object: ${te.joinValues(n.keys,", ")}`;break;case x.invalid_union:t="Invalid input";break;case x.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${te.joinValues(n.options)}`;break;case x.invalid_enum_value:t=`Invalid enum value. Expected ${te.joinValues(n.options)}, received '${n.received}'`;break;case x.invalid_arguments:t="Invalid function arguments";break;case x.invalid_return_type:t="Invalid function return type";break;case x.invalid_date:t="Invalid date";break;case x.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:te.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case x.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case x.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case x.custom:t="Invalid input";break;case x.invalid_intersection_types:t="Intersection results could not be merged";break;case x.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case x.not_finite:t="Number must be finite";break;default:t=e.defaultError,te.assertNever(n)}return{message:t}},Ft=tb;var Um=Ft;function nb(n){Um=n}function fr(){return Um}var Zi=n=>{let{data:e,path:t,errorMaps:r,issueData:i}=n,s=[...t,...i.path||[]],o=V(E({},i),{path:s});if(i.message!==void 0)return V(E({},i),{path:s,message:i.message});let u="",c=r.filter(d=>!!d).slice().reverse();for(let d of c)u=d(o,{data:e,defaultError:u}).message;return V(E({},i),{path:s,message:u})},rb=[];function k(n,e){let t=fr(),r=Zi({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===Ft?void 0:Ft].filter(i=>!!i)});n.common.issues.push(r)}var Ne=class n{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let i of t){if(i.status==="aborted")return q;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let i of t){let s=await i.key,o=await i.value;r.push({key:s,value:o})}return n.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let i of t){let{key:s,value:o}=i;if(s.status==="aborted"||o.status==="aborted")return q;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[s.value]=o.value)}return{status:e.value,value:r}}},q=Object.freeze({status:"aborted"}),xn=n=>({status:"dirty",value:n}),Ue=n=>({status:"valid",value:n}),$o=n=>n.status==="aborted",zo=n=>n.status==="dirty",nn=n=>n.status==="valid",pr=n=>typeof Promise<"u"&&n instanceof Promise;var j=(function(n){return n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message,n})(j||{});var Je=class{constructor(e,t,r,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Bm=(n,e)=>{if(nn(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new wt(n.common.issues);return this._error=t,this._error}}};function K(n){if(!n)return{};let{errorMap:e,invalid_type_error:t,required_error:r,description:i}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,u)=>{let{message:c}=n;return o.code==="invalid_enum_value"?{message:c??u.defaultError}:typeof u.data>"u"?{message:c??r??u.defaultError}:o.code!=="invalid_type"?{message:u.defaultError}:{message:c??t??u.defaultError}},description:i}}var Y=class{get description(){return this._def.description}_getType(e){return _t(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:_t(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ne,ctx:{common:e.parent.common,data:e.data,parsedType:_t(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(pr(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:_t(e)},i=this._parseSync({data:e,path:r.path,parent:r});return Bm(r,i)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:_t(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return nn(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>nn(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:_t(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(pr(i)?i:Promise.resolve(i));return Bm(r,s)}refine(e,t){let r=i=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,s)=>{let o=e(i),u=()=>s.addIssue(E({code:x.custom},r(i)));return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(u(),!1)):o?!0:(u(),!1)})}refinement(e,t){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof t=="function"?t(r,i):t),!1))}_refinement(e){return new vr({schema:this,typeName:G.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return rn.create(this,this._def)}nullable(){return _r.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Yi.create(this)}promise(){return Qo.create(this,this._def)}or(e){return Oc.create([this,e],this._def)}and(e){return kc.create(this,e,this._def)}transform(e){return new vr(V(E({},K(this._def)),{schema:this,typeName:G.ZodEffects,effect:{type:"transform",transform:e}}))}default(e){let t=typeof e=="function"?e:()=>e;return new Vc(V(E({},K(this._def)),{innerType:this,defaultValue:t,typeName:G.ZodDefault}))}brand(){return new Xi(E({typeName:G.ZodBranded,type:this},K(this._def)))}catch(e){let t=typeof e=="function"?e:()=>e;return new Uc(V(E({},K(this._def)),{innerType:this,catchValue:t,typeName:G.ZodCatch}))}describe(e){let t=this.constructor;return new t(V(E({},this._def),{description:e}))}pipe(e){return Ji.create(this,e)}readonly(){return Bc.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},ib=/^c[^\s-]{8,}$/i,sb=/^[0-9a-z]+$/,ob=/^[0-9A-HJKMNP-TV-Z]{26}$/i,ab=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ub=/^[a-z0-9_-]{21}$/i,cb=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,lb=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,hb=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,db="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Dc,fb=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,pb=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,mb=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,gb=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,yb=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,vb=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,$m="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",_b=new RegExp(`^${$m}$`);function zm(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);let t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function wb(n){return new RegExp(`^${zm(n)}$`)}function qm(n){let e=`${$m}T${zm(n)}`,t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Eb(n,e){return!!((e==="v4"||!e)&&fb.test(n)||(e==="v6"||!e)&&mb.test(n))}function bb(n,e){if(!cb.test(n))return!1;try{let[t]=n.split(".");if(!t)return!1;let r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&i?.typ!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function Sb(n,e){return!!((e==="v4"||!e)&&pb.test(n)||(e==="v6"||!e)&&gb.test(n))}var Ko=(()=>{class n extends Y{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==F.string){let o=this._getOrReturnCtx(t);return k(o,{code:x.invalid_type,expected:F.string,received:o.parsedType}),q}let i=new Ne,s;for(let o of this._def.checks)if(o.kind==="min")t.data.length<o.value&&(s=this._getOrReturnCtx(t,s),k(s,{code:x.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if(o.kind==="max")t.data.length>o.value&&(s=this._getOrReturnCtx(t,s),k(s,{code:x.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!1,message:o.message}),i.dirty());else if(o.kind==="length"){let u=t.data.length>o.value,c=t.data.length<o.value;(u||c)&&(s=this._getOrReturnCtx(t,s),u?k(s,{code:x.too_big,maximum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}):c&&k(s,{code:x.too_small,minimum:o.value,type:"string",inclusive:!0,exact:!0,message:o.message}),i.dirty())}else if(o.kind==="email")hb.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"email",code:x.invalid_string,message:o.message}),i.dirty());else if(o.kind==="emoji")Dc||(Dc=new RegExp(db,"u")),Dc.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"emoji",code:x.invalid_string,message:o.message}),i.dirty());else if(o.kind==="uuid")ab.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"uuid",code:x.invalid_string,message:o.message}),i.dirty());else if(o.kind==="nanoid")ub.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"nanoid",code:x.invalid_string,message:o.message}),i.dirty());else if(o.kind==="cuid")ib.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"cuid",code:x.invalid_string,message:o.message}),i.dirty());else if(o.kind==="cuid2")sb.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"cuid2",code:x.invalid_string,message:o.message}),i.dirty());else if(o.kind==="ulid")ob.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"ulid",code:x.invalid_string,message:o.message}),i.dirty());else if(o.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),k(s,{validation:"url",code:x.invalid_string,message:o.message}),i.dirty()}else o.kind==="regex"?(o.regex.lastIndex=0,o.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"regex",code:x.invalid_string,message:o.message}),i.dirty())):o.kind==="trim"?t.data=t.data.trim():o.kind==="includes"?t.data.includes(o.value,o.position)||(s=this._getOrReturnCtx(t,s),k(s,{code:x.invalid_string,validation:{includes:o.value,position:o.position},message:o.message}),i.dirty()):o.kind==="toLowerCase"?t.data=t.data.toLowerCase():o.kind==="toUpperCase"?t.data=t.data.toUpperCase():o.kind==="startsWith"?t.data.startsWith(o.value)||(s=this._getOrReturnCtx(t,s),k(s,{code:x.invalid_string,validation:{startsWith:o.value},message:o.message}),i.dirty()):o.kind==="endsWith"?t.data.endsWith(o.value)||(s=this._getOrReturnCtx(t,s),k(s,{code:x.invalid_string,validation:{endsWith:o.value},message:o.message}),i.dirty()):o.kind==="datetime"?qm(o).test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{code:x.invalid_string,validation:"datetime",message:o.message}),i.dirty()):o.kind==="date"?_b.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{code:x.invalid_string,validation:"date",message:o.message}),i.dirty()):o.kind==="time"?wb(o).test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{code:x.invalid_string,validation:"time",message:o.message}),i.dirty()):o.kind==="duration"?lb.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"duration",code:x.invalid_string,message:o.message}),i.dirty()):o.kind==="ip"?Eb(t.data,o.version)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"ip",code:x.invalid_string,message:o.message}),i.dirty()):o.kind==="jwt"?bb(t.data,o.alg)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"jwt",code:x.invalid_string,message:o.message}),i.dirty()):o.kind==="cidr"?Sb(t.data,o.version)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"cidr",code:x.invalid_string,message:o.message}),i.dirty()):o.kind==="base64"?yb.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"base64",code:x.invalid_string,message:o.message}),i.dirty()):o.kind==="base64url"?vb.test(t.data)||(s=this._getOrReturnCtx(t,s),k(s,{validation:"base64url",code:x.invalid_string,message:o.message}),i.dirty()):te.assertNever(o);return{status:i.value,value:t.data}}_regex(t,r,i){return this.refinement(s=>t.test(s),E({validation:r,code:x.invalid_string},j.errToObj(i)))}_addCheck(t){return new n(V(E({},this._def),{checks:[...this._def.checks,t]}))}email(t){return this._addCheck(E({kind:"email"},j.errToObj(t)))}url(t){return this._addCheck(E({kind:"url"},j.errToObj(t)))}emoji(t){return this._addCheck(E({kind:"emoji"},j.errToObj(t)))}uuid(t){return this._addCheck(E({kind:"uuid"},j.errToObj(t)))}nanoid(t){return this._addCheck(E({kind:"nanoid"},j.errToObj(t)))}cuid(t){return this._addCheck(E({kind:"cuid"},j.errToObj(t)))}cuid2(t){return this._addCheck(E({kind:"cuid2"},j.errToObj(t)))}ulid(t){return this._addCheck(E({kind:"ulid"},j.errToObj(t)))}base64(t){return this._addCheck(E({kind:"base64"},j.errToObj(t)))}base64url(t){return this._addCheck(E({kind:"base64url"},j.errToObj(t)))}jwt(t){return this._addCheck(E({kind:"jwt"},j.errToObj(t)))}ip(t){return this._addCheck(E({kind:"ip"},j.errToObj(t)))}cidr(t){return this._addCheck(E({kind:"cidr"},j.errToObj(t)))}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck(E({kind:"datetime",precision:typeof t?.precision>"u"?null:t?.precision,offset:t?.offset??!1,local:t?.local??!1},j.errToObj(t?.message)))}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck(E({kind:"time",precision:typeof t?.precision>"u"?null:t?.precision},j.errToObj(t?.message)))}duration(t){return this._addCheck(E({kind:"duration"},j.errToObj(t)))}regex(t,r){return this._addCheck(E({kind:"regex",regex:t},j.errToObj(r)))}includes(t,r){return this._addCheck(E({kind:"includes",value:t,position:r?.position},j.errToObj(r?.message)))}startsWith(t,r){return this._addCheck(E({kind:"startsWith",value:t},j.errToObj(r)))}endsWith(t,r){return this._addCheck(E({kind:"endsWith",value:t},j.errToObj(r)))}min(t,r){return this._addCheck(E({kind:"min",value:t},j.errToObj(r)))}max(t,r){return this._addCheck(E({kind:"max",value:t},j.errToObj(r)))}length(t,r){return this._addCheck(E({kind:"length",value:t},j.errToObj(r)))}nonempty(t){return this.min(1,j.errToObj(t))}trim(){return new n(V(E({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new n(V(E({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new n(V(E({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}return n.create=e=>new n(E({checks:[],typeName:G.ZodString,coerce:e?.coerce??!1},K(e))),n})();function Ib(n,e){let t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=t>r?t:r,s=Number.parseInt(n.toFixed(i).replace(".","")),o=Number.parseInt(e.toFixed(i).replace(".",""));return s%o/10**i}var Ac=(()=>{class n extends Y{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==F.number){let o=this._getOrReturnCtx(t);return k(o,{code:x.invalid_type,expected:F.number,received:o.parsedType}),q}let i,s=new Ne;for(let o of this._def.checks)o.kind==="int"?te.isInteger(t.data)||(i=this._getOrReturnCtx(t,i),k(i,{code:x.invalid_type,expected:"integer",received:"float",message:o.message}),s.dirty()):o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(i=this._getOrReturnCtx(t,i),k(i,{code:x.too_small,minimum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(i=this._getOrReturnCtx(t,i),k(i,{code:x.too_big,maximum:o.value,type:"number",inclusive:o.inclusive,exact:!1,message:o.message}),s.dirty()):o.kind==="multipleOf"?Ib(t.data,o.value)!==0&&(i=this._getOrReturnCtx(t,i),k(i,{code:x.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):o.kind==="finite"?Number.isFinite(t.data)||(i=this._getOrReturnCtx(t,i),k(i,{code:x.not_finite,message:o.message}),s.dirty()):te.assertNever(o);return{status:s.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,j.toString(r))}gt(t,r){return this.setLimit("min",t,!1,j.toString(r))}lte(t,r){return this.setLimit("max",t,!0,j.toString(r))}lt(t,r){return this.setLimit("max",t,!1,j.toString(r))}setLimit(t,r,i,s){return new n(V(E({},this._def),{checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:j.toString(s)}]}))}_addCheck(t){return new n(V(E({},this._def),{checks:[...this._def.checks,t]}))}int(t){return this._addCheck({kind:"int",message:j.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:j.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:j.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:j.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:j.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:j.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:j.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:j.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:j.toString(t)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&te.isInteger(t.value))}get isFinite(){let t=null,r=null;for(let i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(t===null||i.value<t)&&(t=i.value)}return Number.isFinite(r)&&Number.isFinite(t)}}return n.create=e=>new n(E({checks:[],typeName:G.ZodNumber,coerce:e?.coerce||!1},K(e))),n})(),Cc=(()=>{class n extends Y{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==F.bigint)return this._getInvalidInput(t);let i,s=new Ne;for(let o of this._def.checks)o.kind==="min"?(o.inclusive?t.data<o.value:t.data<=o.value)&&(i=this._getOrReturnCtx(t,i),k(i,{code:x.too_small,type:"bigint",minimum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="max"?(o.inclusive?t.data>o.value:t.data>=o.value)&&(i=this._getOrReturnCtx(t,i),k(i,{code:x.too_big,type:"bigint",maximum:o.value,inclusive:o.inclusive,message:o.message}),s.dirty()):o.kind==="multipleOf"?t.data%o.value!==BigInt(0)&&(i=this._getOrReturnCtx(t,i),k(i,{code:x.not_multiple_of,multipleOf:o.value,message:o.message}),s.dirty()):te.assertNever(o);return{status:s.value,value:t.data}}_getInvalidInput(t){let r=this._getOrReturnCtx(t);return k(r,{code:x.invalid_type,expected:F.bigint,received:r.parsedType}),q}gte(t,r){return this.setLimit("min",t,!0,j.toString(r))}gt(t,r){return this.setLimit("min",t,!1,j.toString(r))}lte(t,r){return this.setLimit("max",t,!0,j.toString(r))}lt(t,r){return this.setLimit("max",t,!1,j.toString(r))}setLimit(t,r,i,s){return new n(V(E({},this._def),{checks:[...this._def.checks,{kind:t,value:r,inclusive:i,message:j.toString(s)}]}))}_addCheck(t){return new n(V(E({},this._def),{checks:[...this._def.checks,t]}))}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:j.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:j.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:j.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:j.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:j.toString(r)})}get minValue(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}return n.create=e=>new n(E({checks:[],typeName:G.ZodBigInt,coerce:e?.coerce??!1},K(e))),n})(),Rc=(()=>{class n extends Y{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==F.boolean){let i=this._getOrReturnCtx(t);return k(i,{code:x.invalid_type,expected:F.boolean,received:i.parsedType}),q}return Ue(t.data)}}return n.create=e=>new n(E({typeName:G.ZodBoolean,coerce:e?.coerce||!1},K(e))),n})(),xc=(()=>{class n extends Y{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==F.date){let o=this._getOrReturnCtx(t);return k(o,{code:x.invalid_type,expected:F.date,received:o.parsedType}),q}if(Number.isNaN(t.data.getTime())){let o=this._getOrReturnCtx(t);return k(o,{code:x.invalid_date}),q}let i=new Ne,s;for(let o of this._def.checks)o.kind==="min"?t.data.getTime()<o.value&&(s=this._getOrReturnCtx(t,s),k(s,{code:x.too_small,message:o.message,inclusive:!0,exact:!1,minimum:o.value,type:"date"}),i.dirty()):o.kind==="max"?t.data.getTime()>o.value&&(s=this._getOrReturnCtx(t,s),k(s,{code:x.too_big,message:o.message,inclusive:!0,exact:!1,maximum:o.value,type:"date"}),i.dirty()):te.assertNever(o);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(t){return new n(V(E({},this._def),{checks:[...this._def.checks,t]}))}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:j.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:j.toString(r)})}get minDate(){let t=null;for(let r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(let r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}return n.create=e=>new n(E({checks:[],coerce:e?.coerce||!1,typeName:G.ZodDate},K(e))),n})(),Gm=(()=>{class n extends Y{_parse(t){if(this._getType(t)!==F.symbol){let i=this._getOrReturnCtx(t);return k(i,{code:x.invalid_type,expected:F.symbol,received:i.parsedType}),q}return Ue(t.data)}}return n.create=e=>new n(E({typeName:G.ZodSymbol},K(e))),n})(),Pc=(()=>{class n extends Y{_parse(t){if(this._getType(t)!==F.undefined){let i=this._getOrReturnCtx(t);return k(i,{code:x.invalid_type,expected:F.undefined,received:i.parsedType}),q}return Ue(t.data)}}return n.create=e=>new n(E({typeName:G.ZodUndefined},K(e))),n})(),Nc=(()=>{class n extends Y{_parse(t){if(this._getType(t)!==F.null){let i=this._getOrReturnCtx(t);return k(i,{code:x.invalid_type,expected:F.null,received:i.parsedType}),q}return Ue(t.data)}}return n.create=e=>new n(E({typeName:G.ZodNull},K(e))),n})(),qo=(()=>{class n extends Y{constructor(){super(...arguments),this._any=!0}_parse(t){return Ue(t.data)}}return n.create=e=>new n(E({typeName:G.ZodAny},K(e))),n})(),Qi=(()=>{class n extends Y{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ue(t.data)}}return n.create=e=>new n(E({typeName:G.ZodUnknown},K(e))),n})(),Pn=(()=>{class n extends Y{_parse(t){let r=this._getOrReturnCtx(t);return k(r,{code:x.invalid_type,expected:F.never,received:r.parsedType}),q}}return n.create=e=>new n(E({typeName:G.ZodNever},K(e))),n})(),Hm=(()=>{class n extends Y{_parse(t){if(this._getType(t)!==F.undefined){let i=this._getOrReturnCtx(t);return k(i,{code:x.invalid_type,expected:F.void,received:i.parsedType}),q}return Ue(t.data)}}return n.create=e=>new n(E({typeName:G.ZodVoid},K(e))),n})(),Yi=(()=>{class n extends Y{_parse(t){let{ctx:r,status:i}=this._processInputParams(t),s=this._def;if(r.parsedType!==F.array)return k(r,{code:x.invalid_type,expected:F.array,received:r.parsedType}),q;if(s.exactLength!==null){let u=r.data.length>s.exactLength.value,c=r.data.length<s.exactLength.value;(u||c)&&(k(r,{code:u?x.too_big:x.too_small,minimum:c?s.exactLength.value:void 0,maximum:u?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),i.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(k(r,{code:x.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),i.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(k(r,{code:x.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((u,c)=>s.type._parseAsync(new Je(r,u,r.path,c)))).then(u=>Ne.mergeArray(i,u));let o=[...r.data].map((u,c)=>s.type._parseSync(new Je(r,u,r.path,c)));return Ne.mergeArray(i,o)}get element(){return this._def.type}min(t,r){return new n(V(E({},this._def),{minLength:{value:t,message:j.toString(r)}}))}max(t,r){return new n(V(E({},this._def),{maxLength:{value:t,message:j.toString(r)}}))}length(t,r){return new n(V(E({},this._def),{exactLength:{value:t,message:j.toString(r)}}))}nonempty(t){return this.min(1,t)}}return n.create=(e,t)=>new n(E({type:e,minLength:null,maxLength:null,exactLength:null,typeName:G.ZodArray},K(t))),n})();function mr(n){if(n instanceof gr){let e={};for(let t in n.shape){let r=n.shape[t];e[t]=rn.create(mr(r))}return new gr(V(E({},n._def),{shape:()=>e}))}else return n instanceof Yi?new Yi(V(E({},n._def),{type:mr(n.element)})):n instanceof rn?rn.create(mr(n.unwrap())):n instanceof _r?_r.create(mr(n.unwrap())):n instanceof yr?yr.create(n.items.map(e=>mr(e))):n}var gr=(()=>{class n extends Y{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let t=this._def.shape(),r=te.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==F.object){let p=this._getOrReturnCtx(t);return k(p,{code:x.invalid_type,expected:F.object,received:p.parsedType}),q}let{status:i,ctx:s}=this._processInputParams(t),{shape:o,keys:u}=this._getCached(),c=[];if(!(this._def.catchall instanceof Pn&&this._def.unknownKeys==="strip"))for(let p in s.data)u.includes(p)||c.push(p);let d=[];for(let p of u){let g=o[p],w=s.data[p];d.push({key:{status:"valid",value:p},value:g._parse(new Je(s,w,s.path,p)),alwaysSet:p in s.data})}if(this._def.catchall instanceof Pn){let p=this._def.unknownKeys;if(p==="passthrough")for(let g of c)d.push({key:{status:"valid",value:g},value:{status:"valid",value:s.data[g]}});else if(p==="strict")c.length>0&&(k(s,{code:x.unrecognized_keys,keys:c}),i.dirty());else if(p!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let p=this._def.catchall;for(let g of c){let w=s.data[g];d.push({key:{status:"valid",value:g},value:p._parse(new Je(s,w,s.path,g)),alwaysSet:g in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let p=[];for(let g of d){let w=await g.key,C=await g.value;p.push({key:w,value:C,alwaysSet:g.alwaysSet})}return p}).then(p=>Ne.mergeObjectSync(i,p)):Ne.mergeObjectSync(i,d)}get shape(){return this._def.shape()}strict(t){return j.errToObj,new n(E(V(E({},this._def),{unknownKeys:"strict"}),t!==void 0?{errorMap:(r,i)=>{let s=this._def.errorMap?.(r,i).message??i.defaultError;return r.code==="unrecognized_keys"?{message:j.errToObj(t).message??s}:{message:s}}}:{}))}strip(){return new n(V(E({},this._def),{unknownKeys:"strip"}))}passthrough(){return new n(V(E({},this._def),{unknownKeys:"passthrough"}))}extend(t){return new n(V(E({},this._def),{shape:()=>E(E({},this._def.shape()),t)}))}merge(t){return new n({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>E(E({},this._def.shape()),t._def.shape()),typeName:G.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new n(V(E({},this._def),{catchall:t}))}pick(t){let r={};for(let i of te.objectKeys(t))t[i]&&this.shape[i]&&(r[i]=this.shape[i]);return new n(V(E({},this._def),{shape:()=>r}))}omit(t){let r={};for(let i of te.objectKeys(this.shape))t[i]||(r[i]=this.shape[i]);return new n(V(E({},this._def),{shape:()=>r}))}deepPartial(){return mr(this)}partial(t){let r={};for(let i of te.objectKeys(this.shape)){let s=this.shape[i];t&&!t[i]?r[i]=s:r[i]=s.optional()}return new n(V(E({},this._def),{shape:()=>r}))}required(t){let r={};for(let i of te.objectKeys(this.shape))if(t&&!t[i])r[i]=this.shape[i];else{let o=this.shape[i];for(;o instanceof rn;)o=o._def.innerType;r[i]=o}return new n(V(E({},this._def),{shape:()=>r}))}keyof(){return Zm(te.objectKeys(this.shape))}}return n.create=(e,t)=>new n(E({shape:()=>e,unknownKeys:"strip",catchall:Pn.create(),typeName:G.ZodObject},K(t))),n.strictCreate=(e,t)=>new n(E({shape:()=>e,unknownKeys:"strict",catchall:Pn.create(),typeName:G.ZodObject},K(t))),n.lazycreate=(e,t)=>new n(E({shape:e,unknownKeys:"strip",catchall:Pn.create(),typeName:G.ZodObject},K(t))),n})(),Oc=(()=>{class n extends Y{_parse(t){let{ctx:r}=this._processInputParams(t),i=this._def.options;function s(o){for(let c of o)if(c.result.status==="valid")return c.result;for(let c of o)if(c.result.status==="dirty")return r.common.issues.push(...c.ctx.common.issues),c.result;let u=o.map(c=>new wt(c.ctx.common.issues));return k(r,{code:x.invalid_union,unionErrors:u}),q}if(r.common.async)return Promise.all(i.map(async o=>{let u=V(E({},r),{common:V(E({},r.common),{issues:[]}),parent:null});return{result:await o._parseAsync({data:r.data,path:r.path,parent:u}),ctx:u}})).then(s);{let o,u=[];for(let d of i){let p=V(E({},r),{common:V(E({},r.common),{issues:[]}),parent:null}),g=d._parseSync({data:r.data,path:r.path,parent:p});if(g.status==="valid")return g;g.status==="dirty"&&!o&&(o={result:g,ctx:p}),p.common.issues.length&&u.push(p.common.issues)}if(o)return r.common.issues.push(...o.ctx.common.issues),o.result;let c=u.map(d=>new wt(d));return k(r,{code:x.invalid_union,unionErrors:c}),q}}get options(){return this._def.options}}return n.create=(e,t)=>new n(E({options:e,typeName:G.ZodUnion},K(t))),n})(),Lt=n=>n instanceof Mc?Lt(n.schema):n instanceof vr?Lt(n.innerType()):n instanceof Fc?[n.value]:n instanceof Zo?n.options:n instanceof Lc?te.objectValues(n.enum):n instanceof Vc?Lt(n._def.innerType):n instanceof Pc?[void 0]:n instanceof Nc?[null]:n instanceof rn?[void 0,...Lt(n.unwrap())]:n instanceof _r?[null,...Lt(n.unwrap())]:n instanceof Xi||n instanceof Bc?Lt(n.unwrap()):n instanceof Uc?Lt(n._def.innerType):[],Go=class n extends Y{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==F.object)return k(t,{code:x.invalid_type,expected:F.object,received:t.parsedType}),q;let r=this.discriminator,i=t.data[r],s=this.optionsMap.get(i);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(k(t,{code:x.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),q)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let i=new Map;for(let s of t){let o=Lt(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let u of o){if(i.has(u))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(u)}`);i.set(u,s)}}return new n(E({typeName:G.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i},K(r)))}};function Tc(n,e){let t=_t(n),r=_t(e);if(n===e)return{valid:!0,data:n};if(t===F.object&&r===F.object){let i=te.objectKeys(e),s=te.objectKeys(n).filter(u=>i.indexOf(u)!==-1),o=E(E({},n),e);for(let u of s){let c=Tc(n[u],e[u]);if(!c.valid)return{valid:!1};o[u]=c.data}return{valid:!0,data:o}}else if(t===F.array&&r===F.array){if(n.length!==e.length)return{valid:!1};let i=[];for(let s=0;s<n.length;s++){let o=n[s],u=e[s],c=Tc(o,u);if(!c.valid)return{valid:!1};i.push(c.data)}return{valid:!0,data:i}}else return t===F.date&&r===F.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}var kc=(()=>{class n extends Y{_parse(t){let{status:r,ctx:i}=this._processInputParams(t),s=(o,u)=>{if($o(o)||$o(u))return q;let c=Tc(o.value,u.value);return c.valid?((zo(o)||zo(u))&&r.dirty(),{status:r.value,value:c.data}):(k(i,{code:x.invalid_intersection_types}),q)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([o,u])=>s(o,u)):s(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}}return n.create=(e,t,r)=>new n(E({left:e,right:t,typeName:G.ZodIntersection},K(r))),n})(),yr=(()=>{class n extends Y{_parse(t){let{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==F.array)return k(i,{code:x.invalid_type,expected:F.array,received:i.parsedType}),q;if(i.data.length<this._def.items.length)return k(i,{code:x.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),q;!this._def.rest&&i.data.length>this._def.items.length&&(k(i,{code:x.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let o=[...i.data].map((u,c)=>{let d=this._def.items[c]||this._def.rest;return d?d._parse(new Je(i,u,i.path,c)):null}).filter(u=>!!u);return i.common.async?Promise.all(o).then(u=>Ne.mergeArray(r,u)):Ne.mergeArray(r,o)}get items(){return this._def.items}rest(t){return new n(V(E({},this._def),{rest:t}))}}return n.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new n(E({items:e,typeName:G.ZodTuple,rest:null},K(t)))},n})(),Ho=class n extends Y{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==F.object)return k(r,{code:x.invalid_type,expected:F.object,received:r.parsedType}),q;let i=[],s=this._def.keyType,o=this._def.valueType;for(let u in r.data)i.push({key:s._parse(new Je(r,u,r.path,u)),value:o._parse(new Je(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?Ne.mergeObjectAsync(t,i):Ne.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof Y?new n(E({keyType:e,valueType:t,typeName:G.ZodRecord},K(r))):new n(E({keyType:Ko.create(),valueType:e,typeName:G.ZodRecord},K(t)))}},Wm=(()=>{class n extends Y{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==F.map)return k(i,{code:x.invalid_type,expected:F.map,received:i.parsedType}),q;let s=this._def.keyType,o=this._def.valueType,u=[...i.data.entries()].map(([c,d],p)=>({key:s._parse(new Je(i,c,i.path,[p,"key"])),value:o._parse(new Je(i,d,i.path,[p,"value"]))}));if(i.common.async){let c=new Map;return Promise.resolve().then(async()=>{for(let d of u){let p=await d.key,g=await d.value;if(p.status==="aborted"||g.status==="aborted")return q;(p.status==="dirty"||g.status==="dirty")&&r.dirty(),c.set(p.value,g.value)}return{status:r.value,value:c}})}else{let c=new Map;for(let d of u){let p=d.key,g=d.value;if(p.status==="aborted"||g.status==="aborted")return q;(p.status==="dirty"||g.status==="dirty")&&r.dirty(),c.set(p.value,g.value)}return{status:r.value,value:c}}}}return n.create=(e,t,r)=>new n(E({valueType:t,keyType:e,typeName:G.ZodMap},K(r))),n})(),Km=(()=>{class n extends Y{_parse(t){let{status:r,ctx:i}=this._processInputParams(t);if(i.parsedType!==F.set)return k(i,{code:x.invalid_type,expected:F.set,received:i.parsedType}),q;let s=this._def;s.minSize!==null&&i.data.size<s.minSize.value&&(k(i,{code:x.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&i.data.size>s.maxSize.value&&(k(i,{code:x.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());let o=this._def.valueType;function u(d){let p=new Set;for(let g of d){if(g.status==="aborted")return q;g.status==="dirty"&&r.dirty(),p.add(g.value)}return{status:r.value,value:p}}let c=[...i.data.values()].map((d,p)=>o._parse(new Je(i,d,i.path,p)));return i.common.async?Promise.all(c).then(d=>u(d)):u(c)}min(t,r){return new n(V(E({},this._def),{minSize:{value:t,message:j.toString(r)}}))}max(t,r){return new n(V(E({},this._def),{maxSize:{value:t,message:j.toString(r)}}))}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}return n.create=(e,t)=>new n(E({valueType:e,minSize:null,maxSize:null,typeName:G.ZodSet},K(t))),n})(),Wo=class n extends Y{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==F.function)return k(t,{code:x.invalid_type,expected:F.function,received:t.parsedType}),q;function r(u,c){return Zi({data:u,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,fr(),Ft].filter(d=>!!d),issueData:{code:x.invalid_arguments,argumentsError:c}})}function i(u,c){return Zi({data:u,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,fr(),Ft].filter(d=>!!d),issueData:{code:x.invalid_return_type,returnTypeError:c}})}let s={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof Qo){let u=this;return Ue(async function(...c){let d=new wt([]),p=await u._def.args.parseAsync(c,s).catch(C=>{throw d.addIssue(r(c,C)),d}),g=await Reflect.apply(o,this,p);return await u._def.returns._def.type.parseAsync(g,s).catch(C=>{throw d.addIssue(i(g,C)),d})})}else{let u=this;return Ue(function(...c){let d=u._def.args.safeParse(c,s);if(!d.success)throw new wt([r(c,d.error)]);let p=Reflect.apply(o,this,d.data),g=u._def.returns.safeParse(p,s);if(!g.success)throw new wt([i(p,g.error)]);return g.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new n(V(E({},this._def),{args:yr.create(e).rest(Qi.create())}))}returns(e){return new n(V(E({},this._def),{returns:e}))}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new n(E({args:e||yr.create([]).rest(Qi.create()),returns:t||Qi.create(),typeName:G.ZodFunction},K(r)))}},Mc=(()=>{class n extends Y{get schema(){return this._def.getter()}_parse(t){let{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}return n.create=(e,t)=>new n(E({getter:e,typeName:G.ZodLazy},K(t))),n})(),Fc=(()=>{class n extends Y{_parse(t){if(t.data!==this._def.value){let r=this._getOrReturnCtx(t);return k(r,{received:r.data,code:x.invalid_literal,expected:this._def.value}),q}return{status:"valid",value:t.data}}get value(){return this._def.value}}return n.create=(e,t)=>new n(E({value:e,typeName:G.ZodLiteral},K(t))),n})();function Zm(n,e){return new Zo(E({values:n,typeName:G.ZodEnum},K(e)))}var Zo=(()=>{class n extends Y{_parse(t){if(typeof t.data!="string"){let r=this._getOrReturnCtx(t),i=this._def.values;return k(r,{expected:te.joinValues(i),received:r.parsedType,code:x.invalid_type}),q}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){let r=this._getOrReturnCtx(t),i=this._def.values;return k(r,{received:r.data,code:x.invalid_enum_value,options:i}),q}return Ue(t.data)}get options(){return this._def.values}get enum(){let t={};for(let r of this._def.values)t[r]=r;return t}get Values(){let t={};for(let r of this._def.values)t[r]=r;return t}get Enum(){let t={};for(let r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return n.create(t,E(E({},this._def),r))}exclude(t,r=this._def){return n.create(this.options.filter(i=>!t.includes(i)),E(E({},this._def),r))}}return n.create=Zm,n})(),Lc=(()=>{class n extends Y{_parse(t){let r=te.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(t);if(i.parsedType!==F.string&&i.parsedType!==F.number){let s=te.objectValues(r);return k(i,{expected:te.joinValues(s),received:i.parsedType,code:x.invalid_type}),q}if(this._cache||(this._cache=new Set(te.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){let s=te.objectValues(r);return k(i,{received:i.data,code:x.invalid_enum_value,options:s}),q}return Ue(t.data)}get enum(){return this._def.values}}return n.create=(e,t)=>new n(E({values:e,typeName:G.ZodNativeEnum},K(t))),n})(),Qo=(()=>{class n extends Y{unwrap(){return this._def.type}_parse(t){let{ctx:r}=this._processInputParams(t);if(r.parsedType!==F.promise&&r.common.async===!1)return k(r,{code:x.invalid_type,expected:F.promise,received:r.parsedType}),q;let i=r.parsedType===F.promise?r.data:Promise.resolve(r.data);return Ue(i.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}return n.create=(e,t)=>new n(E({type:e,typeName:G.ZodPromise},K(t))),n})(),vr=(()=>{class n extends Y{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===G.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){let{status:r,ctx:i}=this._processInputParams(t),s=this._def.effect||null,o={addIssue:u=>{k(i,u),u.fatal?r.abort():r.dirty()},get path(){return i.path}};if(o.addIssue=o.addIssue.bind(o),s.type==="preprocess"){let u=s.transform(i.data,o);if(i.common.async)return Promise.resolve(u).then(async c=>{if(r.value==="aborted")return q;let d=await this._def.schema._parseAsync({data:c,path:i.path,parent:i});return d.status==="aborted"?q:d.status==="dirty"?xn(d.value):r.value==="dirty"?xn(d.value):d});{if(r.value==="aborted")return q;let c=this._def.schema._parseSync({data:u,path:i.path,parent:i});return c.status==="aborted"?q:c.status==="dirty"?xn(c.value):r.value==="dirty"?xn(c.value):c}}if(s.type==="refinement"){let u=c=>{let d=s.refinement(c,o);if(i.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(i.common.async===!1){let c=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return c.status==="aborted"?q:(c.status==="dirty"&&r.dirty(),u(c.value),{status:r.value,value:c.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(c=>c.status==="aborted"?q:(c.status==="dirty"&&r.dirty(),u(c.value).then(()=>({status:r.value,value:c.value}))))}if(s.type==="transform")if(i.common.async===!1){let u=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!nn(u))return q;let c=s.transform(u.value,o);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:c}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(u=>nn(u)?Promise.resolve(s.transform(u.value,o)).then(c=>({status:r.value,value:c})):q);te.assertNever(s)}}return n.create=(e,t,r)=>new n(E({schema:e,typeName:G.ZodEffects,effect:t},K(r))),n.createWithPreprocess=(e,t,r)=>new n(E({schema:t,effect:{type:"preprocess",transform:e},typeName:G.ZodEffects},K(r))),n})();var rn=(()=>{class n extends Y{_parse(t){return this._getType(t)===F.undefined?Ue(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}return n.create=(e,t)=>new n(E({innerType:e,typeName:G.ZodOptional},K(t))),n})(),_r=(()=>{class n extends Y{_parse(t){return this._getType(t)===F.null?Ue(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}return n.create=(e,t)=>new n(E({innerType:e,typeName:G.ZodNullable},K(t))),n})(),Vc=(()=>{class n extends Y{_parse(t){let{ctx:r}=this._processInputParams(t),i=r.data;return r.parsedType===F.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}return n.create=(e,t)=>new n(E({innerType:e,typeName:G.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default},K(t))),n})(),Uc=(()=>{class n extends Y{_parse(t){let{ctx:r}=this._processInputParams(t),i=V(E({},r),{common:V(E({},r.common),{issues:[]})}),s=this._def.innerType._parse({data:i.data,path:i.path,parent:E({},i)});return pr(s)?s.then(o=>({status:"valid",value:o.status==="valid"?o.value:this._def.catchValue({get error(){return new wt(i.common.issues)},input:i.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new wt(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}}return n.create=(e,t)=>new n(E({innerType:e,typeName:G.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch},K(t))),n})(),Qm=(()=>{class n extends Y{_parse(t){if(this._getType(t)!==F.nan){let i=this._getOrReturnCtx(t);return k(i,{code:x.invalid_type,expected:F.nan,received:i.parsedType}),q}return{status:"valid",value:t.data}}}return n.create=e=>new n(E({typeName:G.ZodNaN},K(e))),n})(),Db=Symbol("zod_brand"),Xi=class extends Y{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}},Ji=class n extends Y{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?q:s.status==="dirty"?(t.dirty(),xn(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{let i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?q:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,t){return new n({in:e,out:t,typeName:G.ZodPipeline})}},Bc=(()=>{class n extends Y{_parse(t){let r=this._def.innerType._parse(t),i=s=>(nn(s)&&(s.value=Object.freeze(s.value)),s);return pr(r)?r.then(s=>i(s)):i(r)}unwrap(){return this._def.innerType}}return n.create=(e,t)=>new n(E({innerType:e,typeName:G.ZodReadonly},K(t))),n})();function jm(n,e){let t=typeof n=="function"?n(e):typeof n=="string"?{message:n}:n;return typeof t=="string"?{message:t}:t}function Ym(n,e={},t){return n?qo.create().superRefine((r,i)=>{let s=n(r);if(s instanceof Promise)return s.then(o=>{if(!o){let u=jm(e,r),c=u.fatal??t??!0;i.addIssue(V(E({code:"custom"},u),{fatal:c}))}});if(!s){let o=jm(e,r),u=o.fatal??t??!0;i.addIssue(V(E({code:"custom"},o),{fatal:u}))}}):qo.create()}var Tb={object:gr.lazycreate},G=(function(n){return n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly",n})(G||{});var Ab=(n,e={message:`Input not instance of ${n.name}`})=>Ym(t=>t instanceof n,e),Xm=Ko.create,Jm=Ac.create,Cb=Qm.create,Rb=Cc.create,eg=Rc.create,xb=xc.create,Pb=Gm.create,Nb=Pc.create,Ob=Nc.create,kb=qo.create,Mb=Qi.create,Fb=Pn.create,Lb=Hm.create,Vb=Yi.create,Ub=gr.create,Bb=gr.strictCreate,jb=Oc.create,$b=Go.create,zb=kc.create,qb=yr.create,Gb=Ho.create,Hb=Wm.create,Wb=Km.create,Kb=Wo.create,Zb=Mc.create,Qb=Fc.create,Yb=Zo.create,Xb=Lc.create,Jb=Qo.create,eS=vr.create,tS=rn.create,nS=_r.create,rS=vr.createWithPreprocess,iS=Ji.create,sS=()=>Xm().optional(),oS=()=>Jm().optional(),aS=()=>eg().optional(),uS={string:n=>Ko.create(V(E({},n),{coerce:!0})),number:n=>Ac.create(V(E({},n),{coerce:!0})),boolean:n=>Rc.create(V(E({},n),{coerce:!0})),bigint:n=>Cc.create(V(E({},n),{coerce:!0})),date:n=>xc.create(V(E({},n),{coerce:!0}))};var cS=q;var tg=f.enum(["M","F"]),ng=f.object({id:f.string().regex(/^U-\d{8}-K\d+$/,"Student ID must match format U-00000123-K1"),parentAuthId:f.string().min(1,"Parent Auth ID is required"),fullName:f.string().min(1,"Full name is required"),dob:f.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date of birth must be in YYYY-MM-DD format"),gender:tg,allergies:f.string().min(1,'Allergies field is required (use "None" if no allergies)'),dietaryNotes:f.string().optional(),medicalNotes:f.string().optional()});var rg="^(\\+?1[-. ]?)?\\(?[0-9]{3}\\)?[-. ]?[0-9]{3}[-. ]?[0-9]{4}$",ig=new RegExp(rg),sg=f.object({street:f.string().min(1,"Street address is required"),city:f.string().min(1,"City is required"),state:f.string().min(1,"State is required"),zipCode:f.string().min(1,"Zip code is required")}),og=f.object({name:f.string().min(1,"Emergency contact name is required"),phone:f.string().regex(ig,"Please enter a valid phone number"),relationship:f.string().min(1,"Relationship is required")}),ag=f.object({phone:f.string().regex(ig,"Please enter a valid phone number"),wechat:f.string().optional(),address:sg,emergencyContact:og}),ug=f.object({createdAt:f.string().datetime(),updatedAt:f.string().datetime()}),wr=f.object({uid:f.string().min(1,"UID is required"),displayId:f.string().regex(/^U-\d{8}$/,"Display ID must match format U-00000123"),email:f.string().email("Invalid email address"),displayName:f.string().min(1,"Display name is required"),isAdmin:f.boolean().default(!1),students:f.array(ng).default([]).optional(),contactInfo:ag.optional(),timestamps:ug});var lS=Math.pow(10,8)*24*60*60*1e3,sP=-lS;var jc=6e4,$c=36e5;var hS=3600;var cg=hS*24,oP=cg*7,dS=cg*365.2425,fS=dS/12,aP=fS*3,zc=Symbol.for("constructDateFrom");function Er(n,e){return typeof n=="function"?n(e):n&&typeof n=="object"&&zc in n?n[zc](e):n instanceof Date?new n.constructor(e):new Date(e)}function br(n,e){return Er(e||n,n)}function Yo(n,...e){let t=Er.bind(null,n||e.find(r=>typeof r=="object"));return e.map(t)}function qc(n,e){let t=+br(n)-+br(e);return t<0?-1:t>0?1:t}function lg(n,e,t){let[r,i]=Yo(t?.in,n,e);return r.getFullYear()-i.getFullYear()}function hg(n,e,t){let[r,i]=Yo(t?.in,n,e),s=qc(r,i),o=Math.abs(lg(r,i));r.setFullYear(1584),i.setFullYear(1584);let u=qc(r,i)===-s,c=s*(o-+u);return c===0?0:c}function Hc(n,e){let t=()=>Er(e?.in,NaN),r=e?.additionalDigits??2,i=yS(n),s;if(i.date){let d=vS(i.date,r);s=_S(d.restDateString,d.year)}if(!s||isNaN(+s))return t();let o=+s,u=0,c;if(i.time&&(u=wS(i.time),isNaN(u)))return t();if(i.timezone){if(c=ES(i.timezone),isNaN(c))return t()}else{let d=new Date(o+u),p=br(0,e?.in);return p.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),p.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),p}return br(o+u+c,e?.in)}var Xo={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},pS=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,mS=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,gS=/^([+-])(\d{2})(?::?(\d{2}))?$/;function yS(n){let e={},t=n.split(Xo.dateTimeDelimiter),r;if(t.length>2)return e;if(/:/.test(t[0])?r=t[0]:(e.date=t[0],r=t[1],Xo.timeZoneDelimiter.test(e.date)&&(e.date=n.split(Xo.timeZoneDelimiter)[0],r=n.substr(e.date.length,n.length))),r){let i=Xo.timezone.exec(r);i?(e.time=r.replace(i[1],""),e.timezone=i[1]):e.time=r}return e}function vS(n,e){let t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=n.match(t);if(!r)return{year:NaN,restDateString:""};let i=r[1]?parseInt(r[1]):null,s=r[2]?parseInt(r[2]):null;return{year:s===null?i:s*100,restDateString:n.slice((r[1]||r[2]).length)}}function _S(n,e){if(e===null)return new Date(NaN);let t=n.match(pS);if(!t)return new Date(NaN);let r=!!t[4],i=es(t[1]),s=es(t[2])-1,o=es(t[3]),u=es(t[4]),c=es(t[5])-1;if(r)return TS(e,u,c)?bS(e,u,c):new Date(NaN);{let d=new Date(0);return!IS(e,s,o)||!DS(e,i)?new Date(NaN):(d.setUTCFullYear(e,s,Math.max(i,o)),d)}}function es(n){return n?parseInt(n):1}function wS(n){let e=n.match(mS);if(!e)return NaN;let t=Gc(e[1]),r=Gc(e[2]),i=Gc(e[3]);return AS(t,r,i)?t*$c+r*jc+i*1e3:NaN}function Gc(n){return n&&parseFloat(n.replace(",","."))||0}function ES(n){if(n==="Z")return 0;let e=n.match(gS);if(!e)return 0;let t=e[1]==="+"?-1:1,r=parseInt(e[2]),i=e[3]&&parseInt(e[3])||0;return CS(r,i)?t*(r*$c+i*jc):NaN}function bS(n,e,t){let r=new Date(0);r.setUTCFullYear(n,0,4);let i=r.getUTCDay()||7,s=(e-1)*7+t+1-i;return r.setUTCDate(r.getUTCDate()+s),r}var SS=[31,null,31,30,31,30,31,31,30,31,30,31];function dg(n){return n%400===0||n%4===0&&n%100!==0}function IS(n,e,t){return e>=0&&e<=11&&t>=1&&t<=(SS[e]||(dg(n)?29:28))}function DS(n,e){return e>=1&&e<=(dg(n)?366:365)}function TS(n,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function AS(n,e,t){return n===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&n>=0&&n<25}function CS(n,e){return e>=0&&e<=59}var fg=5,pg=12;function RS(n){return`${n}-01-01`}function mg(n,e){let t=Hc(n),r=Hc(e);return hg(r,t)}function xS(n,e){let t=mg(n,e);return t>=fg&&t<=pg}var Wc=f.object({sessionId:f.string(),studentId:f.string()}),gg=f.object({type:f.literal("remove_class"),target:Wc}),yg=f.object({type:f.enum(["remove_addon","add_addon"]),target:Wc,addon:f.enum(["lunch","extendedCare"])}),ts=f.discriminatedUnion("type",[gg,yg]);var Kc=f.object({id:f.string(),requestedAt:f.string().datetime(),requestedBy:f.string(),reason:f.string().optional(),actions:f.array(ts).min(1),status:f.enum(["pending","approved","denied"]).default("pending"),adminAdjustment:f.number().int().default(0),adminAdjustmentReason:f.string().optional(),adminNotes:f.string().optional(),processedBy:f.string().optional(),processedAt:f.string().datetime().optional()});var vg=f.enum(["submitted","paid","cancelled"]),_g=f.object({basePrice:f.number().int().nonnegative(),lunchPrice:f.number().int().nonnegative(),extendedCarePrice:f.number().int().nonnegative(),itemTotal:f.number().int().nonnegative()}),wg=f.object({className:f.string(),weekName:f.string(),startDate:f.string(),endDate:f.string(),priceSnapshot:_g}),Eg=f.object({sessionId:f.string().regex(/^CL-\d{8}$/),studentId:f.string().regex(/^U-\d{8}-K\d+$/),options:f.object({lunch:f.boolean(),extendedCare:f.boolean()}),status:vg,snapshot:wg,submittedAt:f.string().datetime(),paidAt:f.string().datetime().optional(),cancelledAt:f.string().datetime().optional(),cancellationReason:f.string().optional(),isWaitlistClaim:f.boolean().optional()}),bg=f.object({sessionId:f.string().regex(/^CL-\d{8}$/),joinedAt:f.string().datetime(),isPromoted:f.boolean().default(!1),promotedAt:f.string().datetime().optional(),notes:f.string().optional()});var Sg=f.object({type:f.enum(["returning_family","sibling","multi_session","coupon","manual"]),amount:f.number().int().nonpositive(),description:f.string().optional()}),Ig=f.object({subtotal:f.number().int().nonnegative(),discounts:f.array(Sg)});function Jo(n){let e=n.discounts.reduce((t,r)=>t+r.amount,0);return Math.max(0,n.subtotal+e)}var Dg=f.object({id:f.string(),amount:f.number().int(),reason:f.string(),createdAt:f.string().datetime(),createdBy:f.string()}),Tg=f.object({id:f.string(),amount:f.number().int(),reference:f.string(),method:f.enum(["check","zelle","cash","other"]),recordedAt:f.string().datetime(),recordedBy:f.string(),notes:f.string().optional()});var Ag=f.object({studentId:f.string(),className:f.string(),options:f.object({lunch:f.boolean(),extendedCare:f.boolean()}).optional()}),Cg=f.object({action:f.enum(["items_submitted","items_cancelled","payment_recorded","refund_processed","waitlist_joined","waitlist_left","waitlist_claimed","waitlist_promoted","lock_extended","change_requested","change_updated","change_approved","change_denied","addon_updated"]),timestamp:f.string().datetime(),actor:f.string(),details:f.string().optional(),affectedItems:f.array(Ag).optional(),className:f.string().optional(),amount:f.number().int().optional(),paymentMethod:f.string().optional(),paymentReference:f.string().optional()}),Rg=f.object({id:f.string(),type:f.enum(["refund_fee","coupon","adjustment"]),amount:f.number().int(),description:f.string(),createdAt:f.string().datetime(),createdBy:f.string(),relatedRefundId:f.string().optional()}),xg=f.object({id:f.string(),amount:f.number().int().positive(),refundRequestId:f.string(),method:f.enum(["check","zelle","cash","other"]),reference:f.string().optional(),recordedAt:f.string().datetime(),recordedBy:f.string()}),PS=f.object({userAuthId:f.string(),userDisplayId:f.string(),seasonId:f.string().regex(/^SN-\d{8}$/),year:f.number().int().positive(),items:f.array(Eg).default([]),waitlist:f.array(bg).default([]),pricing:Ig.nullable(),payments:f.array(Tg).default([]),totalPaid:f.number().int().default(0),changeRequests:f.array(Kc).default([]),processingFees:f.array(Rg).default([]),refunds:f.array(xg).default([]),adjustments:f.array(Dg).default([]),lockExpiresAt:f.string().datetime().nullable(),history:f.array(Cg).default([]),createdAt:f.string().datetime(),updatedAt:f.string().datetime()});function NS(n){return n.items.filter(e=>e.status==="submitted")}function OS(n){return n.items.filter(e=>e.status==="paid")}function kS(n,e,t){return n.items.some(r=>r.sessionId===e&&r.studentId===t&&(r.status==="submitted"||r.status==="paid"))}function MS(n,e){return n.waitlist.some(t=>t.sessionId===e)}function FS(n){if(!n.pricing)return 0;let e=Jo(n.pricing),t=(n.processingFees??[]).reduce((u,c)=>u+c.amount,0),r=(n.refunds??[]).reduce((u,c)=>u+c.amount,0),i=n.totalPaid??0,s=(n.adjustments??[]).reduce((u,c)=>u+c.amount,0),o=e+t+s-i-r;return Math.max(0,o)}function LS(n,e){return!n.lockExpiresAt||!n.items.some(r=>r.status==="submitted")?!1:new Date(e)>new Date(n.lockExpiresAt)}var Pg=23;function VS(n,e,t=Pg){if(n.isPromoted)return{isEligible:!0,reason:"promoted"};let r=new Date(n.joinedAt).getTime(),s=(new Date(e).getTime()-r)/(1e3*60*60);return s>t?{isEligible:!0,reason:"matured"}:{isEligible:!1,reason:"too_fresh",hoursUntilEligible:t-s}}function US(n,e){return!n.lockExpiresAt||!n.items.some(r=>r.status==="submitted")?!1:new Date(e)>new Date(n.lockExpiresAt)}function BS(n,e,t=12){if(!n.lockExpiresAt||!n.items.some(u=>u.status==="submitted"))return!1;let i=new Date(e),o=(new Date(n.lockExpiresAt).getTime()-i.getTime())/(1e3*60*60);return o>0&&o<=t}function jS(n,e){if(!n.lockExpiresAt||!n.items.some(c=>c.status==="submitted"))return null;let r=new Date(e),s=new Date(n.lockExpiresAt).getTime()-r.getTime();if(s<=0)return null;let o=Math.floor(s/(1e3*60*60)),u=Math.floor(s%(1e3*60*60)/(1e3*60));return{hours:o,minutes:u}}function $S(n){return n.pricing?Jo(n.pricing):0}function zS(n){return n.changeRequests&&n.changeRequests.length>0&&n.changeRequests.some(s=>s.status==="pending")?"change_requested":n.items.length>0&&n.items.every(i=>i.status==="cancelled")?n.totalPaid>0?"refunded":"cancelled":n.items.length>0&&n.items.every(i=>i.status==="paid")?"paid":n.items.length>0&&n.items.every(i=>i.status==="submitted")?"submitted":n.items.length>0?"partial":"empty"}var Ng=f.object({}),Og=f.object({allowEnrollment:f.boolean(),maintenanceMode:f.boolean()}),kg=f.object({content:f.string()}),Mg=f.object({email:f.string().email(),phone:f.string(),address:f.string().optional()}),Fg=f.object({maturityHours:f.number().nonnegative().default(23),vacancyHoldExpirationHours:f.number().nonnegative().default(24),lastRecalculationAt:f.string().optional()}),qS=f.object({isSystemInitialized:f.boolean(),currentActiveYear:f.number().int().positive(),currentDate:f.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date must be ISO 8601 format: YYYY-MM-DD"),currentTime:f.string().datetime({message:"Time must be ISO 8601 format with timezone"}),systemSwitch:Og,financials:Ng,paymentInstructions:kg,contactInfo:Mg,waitlist:Fg.default({maturityHours:23})}),GS={isSystemInitialized:!1,currentActiveYear:2025,currentDate:"2025-01-01",currentTime:"2025-01-01T00:00:00.000Z",systemSwitch:{allowEnrollment:!0,maintenanceMode:!1},financials:{},paymentInstructions:{content:`## Zelle
\u6536\u6B3E\u90AE\u7BB1: pay@berryfun.com

## \u73B0\u91D1
\u73B0\u91D1\u4ED8\u6B3E\u53EF\u4EAB **3% \u6298\u6263**

---
\u8BF7\u5728\u4ED8\u6B3E\u5907\u6CE8\u4E2D\u6CE8\u660E\u8BA2\u5355\u53F7\uFF0C\u4ED8\u6B3E\u540E\u8BF7\u8054\u7CFB\u6211\u4EEC\u786E\u8BA4\u3002`},contactInfo:{email:"info@berryfun.com",phone:"(555) 123-4567",address:"123 Berry Lane, Summer City, CA 90210"},waitlist:{maturityHours:23,vacancyHoldExpirationHours:24}};var Lg=f.object({minSessions:f.number().int().positive(),discountAmount:f.number().int().nonnegative()}),Zc=f.object({deadline:f.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date must be ISO 8601 format: YYYY-MM-DD"),price:f.number().int().nonnegative()}),Sr=f.object({id:f.string().regex(/^CL-\d{8}$/,"Session ID must be format: CL-00000001"),seasonId:f.string().regex(/^SN-\d{8}$/,"Season ID must be format: SN-00000001"),name:f.string().min(1).max(200),startDate:f.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date must be ISO 8601 format: YYYY-MM-DD"),endDate:f.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date must be ISO 8601 format: YYYY-MM-DD"),basePrice:f.number().int().positive().optional(),lunchPrice:f.number().int().nonnegative().optional(),extendedCarePrice:f.number().int().nonnegative().optional(),capacity:f.number().int().positive(),earlyBirdTiers:f.array(Zc).optional(),isActive:f.boolean().default(!0)}).refine(n=>n.startDate<n.endDate,{message:"startDate must be before endDate",path:["endDate"]}),HS=Sr.innerType().partial().required({id:!0}),WS=Sr.innerType().omit({id:!0}),Vg=Sr;var Qc=f.object({id:f.string().regex(/^SN-\d{8}$/,"Season ID must be format: SN-00000001"),year:f.number().int().positive(),name:f.string().min(1).max(100),startDate:f.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date must be ISO 8601 format: YYYY-MM-DD"),endDate:f.string().regex(/^\d{4}-\d{2}-\d{2}$/,"Date must be ISO 8601 format: YYYY-MM-DD"),isActive:f.boolean(),description:f.string().max(1e4).optional(),siblingDiscountPerWeek:f.number().int().nonnegative().default(500),multiSessionDiscounts:f.array(Lg).default([]),refundProcessingFee:f.number().int().nonnegative().default(2e3),basePrice:f.number().int().positive().default(5e4),lunchPrice:f.number().int().nonnegative().default(0),extendedCarePrice:f.number().int().nonnegative().default(0),earlyBirdTiers:f.array(Zc).default([]),sessions:f.array(Vg).default([])}),KS=Qc.refine(n=>n.startDate<n.endDate,{message:"startDate must be before endDate",path:["endDate"]}),ZS=Qc.partial().required({id:!0}),QS=Qc.omit({id:!0});function Ug(n,e){return V(E({},n),{basePrice:n.basePrice??e.basePrice,lunchPrice:n.lunchPrice??e.lunchPrice,extendedCarePrice:n.extendedCarePrice??e.extendedCarePrice,earlyBirdTiers:n.earlyBirdTiers??e.earlyBirdTiers})}function YS(n){return V(E({},n),{sessions:n.sessions.map(e=>Ug(e,n))})}var XS=Sr.innerType().extend({enrolledCount:f.number().int().nonnegative(),vacancyHoldsCount:f.number().int().nonnegative(),publicAvailable:f.number().int().nonnegative(),waitlistAvailable:f.number().int().nonnegative()});function Yc(n,e){let t=e?.enrolledStudents?.length??0,r=e?.vacancyHolds?.length??0,i=Math.max(0,n.capacity-t-r),s=Math.max(0,n.capacity-t);return V(E({},n),{enrolledCount:t,vacancyHoldsCount:r,publicAvailable:i,waitlistAvailable:s})}function JS(n,e){return n.map(t=>Yc(t,e?.classes[t.id]))}var Bg=f.object({id:f.string().regex(/^VH-\d{8}$/,"Vacancy hold ID must be format: VH-00000001"),createdAt:f.string().datetime(),expiresAt:f.string().datetime(),originUserId:f.string().regex(/^U-\d{8}$/).optional()}),jg=f.object({enrolledStudents:f.array(f.string().regex(/^U-\d{8}-K\d+$/)).default([]),vacancyHolds:f.array(Bg).default([])}),eI=f.object({seasonId:f.string().regex(/^SN-\d{8}$/,"Season ID must be format: SN-00000001"),classes:f.record(f.string(),jg)});function $g(n,e){let t=n.classes[e];return t?t.vacancyHolds??[]:[]}function tI(n,e){return $g(n,e).length}var Xc=class{static resolveBasePrice(e,t){if(!e.earlyBirdTiers||e.earlyBirdTiers.length===0)return e.basePrice;let r=[...e.earlyBirdTiers].sort((i,s)=>i.deadline.localeCompare(s.deadline));for(let i of r)if(t<=i.deadline)return i.price;return e.basePrice}static calculateTotalPrice(e,t,r){let i=this.resolveBasePrice(e,t);return r.includeLunch&&(i+=e.lunchPrice),r.includeExtendedCare&&(i+=e.extendedCarePrice),i}static formatPrice(e){return`$${(e/100).toFixed(2)}`}static createSessionLookup(e){let t=new Map;for(let r of e)t.set(r.id,r);return t}static createPriceSnapshot(e,t,r){let i=this.resolvePriceFromData(e,t),s=i;return r.lunch&&(s+=e.lunchPrice),r.extendedCare&&(s+=e.extendedCarePrice),{basePrice:i,lunchPrice:e.lunchPrice,extendedCarePrice:e.extendedCarePrice,itemTotal:s}}static resolvePriceFromData(e,t){if(!e.earlyBirdTiers||e.earlyBirdTiers.length===0)return e.basePrice;let r=[...e.earlyBirdTiers].sort((i,s)=>i.deadline.localeCompare(s.deadline));for(let i of r)if(t<=i.deadline)return i.price;return e.basePrice}static calculateCartPricing(e){let{items:t,sessionLookup:r,currentDate:i,discountConfig:s}=e,o=0;for(let c of t){let d=r.get(c.sessionId);if(!d)throw new Error(`Session not found: ${c.sessionId}`);let p=this.createPriceSnapshot(d,i,c.options);o+=p.itemTotal}let u=this.calculateOrderDiscountsFromItems(t,s);return{subtotal:o,discounts:u}}static recalculateOrderPricing(e){let{existingItems:t,discountConfig:r}=e,i=t.reduce((o,u)=>o+u.priceSnapshot.itemTotal,0),s=this.calculateOrderDiscountsFromItems(t,r);return{subtotal:i,discounts:s}}static calculateOrderDiscountsFromItems(e,t){let r=[],i=new Map;for(let o of e)i.has(o.sessionId)||i.set(o.sessionId,new Set),i.get(o.sessionId).add(o.studentId);if(t.siblingDiscountPerWeek>0){let o=0,u=0;for(let[,c]of i)c.size>=2&&(o+=t.siblingDiscountPerWeek*c.size,u++);o>0&&r.push({type:"sibling",amount:-o,description:`Sibling discount (${u} session${u>1?"s":""} with multiple students)`})}let s=i.size;if(t.multiSessionDiscountTiers.length>0){let o=[...t.multiSessionDiscountTiers].sort((u,c)=>c.minSessions-u.minSessions);for(let u of o)if(s>=u.minSessions){r.push({type:"multi_session",amount:-u.discountAmount,description:`${u.minSessions}+ sessions discount`});break}}return r}};var nI=f.object({seasonId:f.string(),items:f.array(f.object({sessionId:f.string(),studentId:f.string(),options:f.object({lunch:f.boolean(),extendedCare:f.boolean()})}))}),rI=f.object({seasonId:f.string(),items:f.array(f.object({sessionId:f.string(),studentId:f.string(),options:f.object({lunch:f.boolean(),extendedCare:f.boolean()})}))}),iI=f.object({year:f.number(),userAuthId:f.string(),amount:f.number(),reference:f.string(),method:f.enum(["check","zelle","cash","other"]),notes:f.string().optional()});var sI=f.object({year:f.number(),items:f.array(f.object({sessionId:f.string(),studentId:f.string()})),reason:f.string()}),oI=f.object({seasonId:f.string(),sessionId:f.string()}),aI=f.object({seasonId:f.string(),sessionId:f.string()}),uI=f.object({year:f.number(),userAuthId:f.string(),sessionId:f.string(),notes:f.string().optional()}),cI=f.object({year:f.number(),items:f.array(f.object({sessionId:f.string(),studentId:f.string()}))}),lI=f.object({year:f.number(),actions:f.array(ts)}),hI=f.object({year:f.number(),actions:f.array(ts),reason:f.string().optional()}),dI=f.object({year:f.number(),userAuthId:f.string(),changeRequestId:f.string(),adminAdjustment:f.number().optional(),adminAdjustmentReason:f.string().optional(),adminNotes:f.string().optional()}),fI=f.object({year:f.number(),userAuthId:f.string(),changeRequestId:f.string(),adminNotes:f.string().optional()}),pI=f.object({year:f.number(),userAuthId:f.string(),changeRequestId:f.string(),adminNotes:f.string()}),mI=f.object({userId:f.string(),userName:f.string(),sessionId:f.string(),className:f.string(),joinedAt:f.string(),isPromoted:f.boolean(),promotedAt:f.string().optional(),notes:f.string().optional()}),gI=f.object({success:f.boolean(),message:f.string()}),yI=f.object({success:f.boolean(),message:f.string(),createdData:f.object({config:f.boolean(),season:f.string(),classes:f.array(f.string()),users:f.array(f.string())})}),vI=f.object({email:f.string(),displayName:f.string(),isAdmin:f.boolean().optional()}),_I=f.object({success:f.boolean(),user:f.object({uid:f.string(),email:f.string(),displayName:f.string(),displayId:f.string()})}),wI=f.object({seasonId:f.string(),name:f.string(),year:f.number(),startDate:f.string(),endDate:f.string()}),EI=f.object({sessionId:f.string(),seasonId:f.string(),name:f.string(),capacity:f.number(),enrolledCount:f.number().optional(),year:f.number().optional(),basePrice:f.number().optional()}),bI=f.object({scenarioId:f.string(),setupData:f.record(f.unknown()).optional()}),SI=f.object({success:f.boolean(),message:f.string(),loginAs:f.object({email:f.string(),password:f.string(),displayName:f.string()}).optional(),navigateTo:f.string().optional(),createdData:f.record(f.unknown()).optional()}),zg=f.object({name:f.string(),dob:f.string().optional(),gender:f.enum(["M","F"]).optional(),allergies:f.string().optional(),dietaryNotes:f.string().optional(),medicalNotes:f.string().optional()}),qg=f.object({name:f.string(),students:f.array(f.union([f.string(),zg])).optional(),isAdmin:f.boolean().optional()}),Gg=f.object({deadline:f.string(),price:f.number()}),Hg=f.object({parentName:f.string(),studentName:f.string().optional(),isEligible:f.boolean().optional()}),Wg=f.object({name:f.string(),capacity:f.number().optional(),basePrice:f.number().optional(),startDate:f.string().optional(),endDate:f.string().optional(),fillCapacity:f.number().optional(),earlyBirdTiers:f.array(Gg).optional(),waitlistEntries:f.array(Hg).optional(),vacancyHolds:f.number().optional()}),Kg=f.object({name:f.string(),year:f.number().optional(),startDate:f.string().optional(),endDate:f.string().optional(),classes:f.array(Wg).optional(),isActive:f.boolean().optional()}),Zg=f.enum(["fillRemainingCapacity","expireWaitlistHolds","createVacancyHold","releaseVacancyHold","claimVacancyByOther"]),Qg=f.object({label:f.string(),instruction:f.string(),action:Zg,targetClass:f.string().optional()}),Yg=f.object({parents:f.array(qg).optional(),seasons:f.array(Kg).optional(),loginAs:f.string().optional(),navigateTo:f.string().optional(),serverTime:f.string().optional(),midTestActions:f.array(Qg).optional()}),II=f.object({scenario:Yg}),DI=f.object({action:Zg,targetClass:f.string().optional()}),TI=f.object({success:f.boolean(),message:f.string()});var Xg=()=>{};var ty=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},AI=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],u=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},ny={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,u=o?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,p=s>>2,g=(s&3)<<4|u>>4,w=(u&15)<<2|d>>6,C=d&63;c||(C=64,o||(w=64)),r.push(t[p],t[g],t[w],t[C])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(ty(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):AI(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let g=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||g==null)throw new el;let w=s<<2|u>>4;if(r.push(w),d!==64){let C=u<<4&240|d>>2;if(r.push(C),g!==64){let N=d<<6&192|g;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},el=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},CI=function(n){let e=ty(n);return ny.encodeByteArray(e,!0)},rs=function(n){return CI(n).replace(/\./g,"")},ry=function(n){try{return ny.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function iy(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var RI=()=>iy().__FIREBASE_DEFAULTS__,xI=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},PI=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&ry(n[1]);return e&&JSON.parse(e)},ta=()=>{try{return Xg()||RI()||xI()||PI()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},NI=n=>{var e,t;return(t=(e=ta())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},na=n=>{let e=NI(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},nl=()=>{var n;return(n=ta())===null||n===void 0?void 0:n.config},KN=n=>{var e;return(e=ta())===null||e===void 0?void 0:e[`_${n}`]};var ea=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Ir(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ra(n){return(await fetch(n,{credentials:"include"})).ok}function sy(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[rs(JSON.stringify(t)),rs(JSON.stringify(o)),""].join(".")}var ns={};function OI(){let n={prod:[],emulator:[]};for(let e of Object.keys(ns))ns[e]?n.emulator.push(e):n.prod.push(e);return n}function kI(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var Jg=!1;function ia(n,e){if(typeof window>"u"||typeof document>"u"||!Ir(window.location.host)||ns[n]===e||ns[n]||Jg)return;ns[n]=e;function t(w){return`__firebase__banner__${w}`}let r="__firebase__banner",s=OI().prod.length>0;function o(){let w=document.getElementById(r);w&&w.remove()}function u(w){w.style.display="flex",w.style.background="#7faaf0",w.style.position="fixed",w.style.bottom="5px",w.style.left="5px",w.style.padding=".5em",w.style.borderRadius="5px",w.style.alignItems="center"}function c(w,C){w.setAttribute("width","24"),w.setAttribute("id",C),w.setAttribute("height","24"),w.setAttribute("viewBox","0 0 24 24"),w.setAttribute("fill","none"),w.style.marginLeft="-6px"}function d(){let w=document.createElement("span");return w.style.cursor="pointer",w.style.marginLeft="16px",w.style.fontSize="24px",w.innerHTML=" &times;",w.onclick=()=>{Jg=!0,o()},w}function p(w,C){w.setAttribute("id",C),w.innerText="Learn more",w.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",w.setAttribute("target","__blank"),w.style.paddingLeft="5px",w.style.textDecoration="underline"}function g(){let w=kI(r),C=t("text"),N=document.getElementById(C)||document.createElement("span"),B=t("learnmore"),M=document.getElementById(B)||document.createElement("a"),ne=t("preprendIcon"),X=document.getElementById(ne)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(w.created){let ie=w.element;u(ie),p(M,B);let me=d();c(X,ne),ie.append(X,N,M,me),document.body.appendChild(ie)}s?(N.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function sa(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ZN(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sa())}function MI(){var n;let e=(n=ta())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function QN(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function YN(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function XN(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function JN(){let n=sa();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function oy(){return!MI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function rl(){try{return typeof indexedDB=="object"}catch{return!1}}function ay(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var FI="FirebaseError",ct=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=FI,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,is.prototype.create)}},is=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?LI(s,r):"Error",u=`${this.serviceName}: ${o} (${i}).`;return new ct(i,u,r)}};function LI(n,e){return n.replace(VI,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var VI=/\{\$([^}]+)}/g;function eO(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Dr(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(ey(s)&&ey(o)){if(!Dr(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function ey(n){return n!==null&&typeof n=="object"}function tO(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function nO(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function rO(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function iO(n,e){let t=new tl(n,e);return t.subscribe.bind(t)}var tl=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");UI(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Jc),i.error===void 0&&(i.error=Jc),i.complete===void 0&&(i.complete=Jc);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function UI(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Jc(){}var sO=14400*1e3;function lt(n){return n&&n._delegate?n._delegate:n}var ht=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Nn="[DEFAULT]";var il=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new ea;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(jI(e))try{this.getOrInitializeService({instanceIdentifier:Nn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Nn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Nn){return this.instances.has(e)}getOptions(e=Nn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:BI(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Nn){return this.component?this.component.multipleInstances?e:Nn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function BI(n){return n===Nn?void 0:n}function jI(n){return n.instantiationMode==="EAGER"}var oa=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new il(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var $I=[],se=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(se||{}),zI={debug:se.DEBUG,verbose:se.VERBOSE,info:se.INFO,warn:se.WARN,error:se.ERROR,silent:se.SILENT},qI=se.INFO,GI={[se.DEBUG]:"log",[se.VERBOSE]:"log",[se.INFO]:"info",[se.WARN]:"warn",[se.ERROR]:"error"},HI=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=GI[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Tr=class{constructor(e){this.name=e,this._logLevel=qI,this._logHandler=HI,this._userLogHandler=null,$I.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?zI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,se.DEBUG,...e),this._logHandler(this,se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,se.VERBOSE,...e),this._logHandler(this,se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,se.INFO,...e),this._logHandler(this,se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,se.WARN,...e),this._logHandler(this,se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,se.ERROR,...e),this._logHandler(this,se.ERROR,...e)}};var WI=(n,e)=>e.some(t=>n instanceof t),uy,cy;function KI(){return uy||(uy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZI(){return cy||(cy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var ly=new WeakMap,ol=new WeakMap,hy=new WeakMap,sl=new WeakMap,ul=new WeakMap;function QI(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Et(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&ly.set(t,n)}).catch(()=>{}),ul.set(e,n),e}function YI(n){if(ol.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});ol.set(n,e)}var al={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return ol.get(n);if(e==="objectStoreNames")return n.objectStoreNames||hy.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Et(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function dy(n){al=n(al)}function XI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(aa(this),e,...t);return hy.set(r,e.sort?e.sort():[e]),Et(r)}:ZI().includes(n)?function(...e){return n.apply(aa(this),e),Et(ly.get(this))}:function(...e){return Et(n.apply(aa(this),e))}}function JI(n){return typeof n=="function"?XI(n):(n instanceof IDBTransaction&&YI(n),WI(n,KI())?new Proxy(n,al):n)}function Et(n){if(n instanceof IDBRequest)return QI(n);if(sl.has(n))return sl.get(n);let e=JI(n);return e!==n&&(sl.set(n,e),ul.set(e,n)),e}var aa=n=>ul.get(n);function py(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),u=Et(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Et(o.result),c.oldVersion,c.newVersion,Et(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var eD=["get","getKey","getAll","getAllKeys","count"],tD=["put","add","delete","clear"],cl=new Map;function fy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(cl.get(e))return cl.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=tD.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||eD.includes(t)))return;let s=async function(o,...u){let c=this.transaction(o,i?"readwrite":"readonly"),d=c.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[t](...u),i&&c.done]))[0]};return cl.set(e,s),s}dy(n=>V(E({},n),{get:(e,t,r)=>fy(e,t)||n.get(e,t,r),has:(e,t)=>!!fy(e,t)||n.has(e,t)}));var hl=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(nD(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function nD(n){let e=n.getComponent();return e?.type==="VERSION"}var dl="@firebase/app",my="0.13.2";var Vt=new Tr("@firebase/app"),rD="@firebase/app-compat",iD="@firebase/analytics-compat",sD="@firebase/analytics",oD="@firebase/app-check-compat",aD="@firebase/app-check",uD="@firebase/auth",cD="@firebase/auth-compat",lD="@firebase/database",hD="@firebase/data-connect",dD="@firebase/database-compat",fD="@firebase/functions",pD="@firebase/functions-compat",mD="@firebase/installations",gD="@firebase/installations-compat",yD="@firebase/messaging",vD="@firebase/messaging-compat",_D="@firebase/performance",wD="@firebase/performance-compat",ED="@firebase/remote-config",bD="@firebase/remote-config-compat",SD="@firebase/storage",ID="@firebase/storage-compat",DD="@firebase/firestore",TD="@firebase/ai",AD="@firebase/firestore-compat",CD="firebase",RD="11.10.0";var fl="[DEFAULT]",xD={[dl]:"fire-core",[rD]:"fire-core-compat",[sD]:"fire-analytics",[iD]:"fire-analytics-compat",[aD]:"fire-app-check",[oD]:"fire-app-check-compat",[uD]:"fire-auth",[cD]:"fire-auth-compat",[lD]:"fire-rtdb",[hD]:"fire-data-connect",[dD]:"fire-rtdb-compat",[fD]:"fire-fn",[pD]:"fire-fn-compat",[mD]:"fire-iid",[gD]:"fire-iid-compat",[yD]:"fire-fcm",[vD]:"fire-fcm-compat",[_D]:"fire-perf",[wD]:"fire-perf-compat",[ED]:"fire-rc",[bD]:"fire-rc-compat",[SD]:"fire-gcs",[ID]:"fire-gcs-compat",[DD]:"fire-fst",[AD]:"fire-fst-compat",[TD]:"fire-vertex","fire-js":"fire-js",[CD]:"fire-js-all"};var ua=new Map,PD=new Map,pl=new Map;function gy(n,e){try{n.container.addComponent(e)}catch(t){Vt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function On(n){let e=n.name;if(pl.has(e))return Vt.debug(`There were multiple attempts to register component ${e}.`),!1;pl.set(e,n);for(let t of ua.values())gy(t,n);for(let t of PD.values())gy(t,n);return!0}function ca(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function la(n){return n==null?!1:n.settings!==void 0}var ND={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},sn=new is("app","Firebase",ND);var ml=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ht("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw sn.create("app-deleted",{appName:this._name})}};var wy=RD;function OD(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:fl,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw sn.create("bad-app-name",{appName:String(i)});if(t||(t=nl()),!t)throw sn.create("no-options");let s=ua.get(i);if(s){if(Dr(t,s.options)&&Dr(r,s.config))return s;throw sn.create("duplicate-app",{appName:i})}let o=new oa(i);for(let c of pl.values())o.addComponent(c);let u=new ml(t,r,o);return ua.set(i,u),u}function on(n=fl){let e=ua.get(n);if(!e&&n===fl&&nl())return OD();if(!e)throw sn.create("no-app",{appName:n});return e}function dt(n,e,t){var r;let i=(r=xD[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&u.push("and"),o&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vt.warn(u.join(" "));return}On(new ht(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var kD="firebase-heartbeat-database",MD=1,ss="firebase-heartbeat-store",ll=null;function Ey(){return ll||(ll=py(kD,MD,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ss)}catch(t){console.warn(t)}}}}).catch(n=>{throw sn.create("idb-open",{originalErrorMessage:n.message})})),ll}async function FD(n){try{let t=(await Ey()).transaction(ss),r=await t.objectStore(ss).get(by(n));return await t.done,r}catch(e){if(e instanceof ct)Vt.warn(e.message);else{let t=sn.create("idb-get",{originalErrorMessage:e?.message});Vt.warn(t.message)}}}async function yy(n,e){try{let r=(await Ey()).transaction(ss,"readwrite");await r.objectStore(ss).put(e,by(n)),await r.done}catch(t){if(t instanceof ct)Vt.warn(t.message);else{let r=sn.create("idb-set",{originalErrorMessage:t?.message});Vt.warn(r.message)}}}function by(n){return`${n.name}!${n.options.appId}`}var LD=1024,VD=30,gl=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new yl(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=vy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>VD){let o=BD(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Vt.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=vy(),{heartbeatsToSend:r,unsentEntries:i}=UD(this._heartbeatsCache.heartbeats),s=rs(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Vt.warn(t),""}}};function vy(){return new Date().toISOString().substring(0,10)}function UD(n,e=LD){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),_y(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),_y(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var yl=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return rl()?ay().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await FD(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return yy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return yy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function _y(n){return rs(JSON.stringify({version:2,heartbeats:n})).length}function BD(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function jD(n){On(new ht("platform-logger",e=>new hl(e),"PRIVATE")),On(new ht("heartbeat",e=>new gl(e),"PRIVATE")),dt(dl,my,n),dt(dl,my,"esm2017"),dt("fire-js","")}jD("");var $D="firebase",zD="11.10.0";dt($D,zD,"app");var Sy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Iy={};var Ut,vl;(function(){var n;function e(I,y){function _(){}_.prototype=y.prototype,I.D=y.prototype,I.prototype=new _,I.prototype.constructor=I,I.C=function(b,S,T){for(var v=Array(arguments.length-2),Tt=2;Tt<arguments.length;Tt++)v[Tt-2]=arguments[Tt];return y.prototype[S].apply(b,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,y,_){_||(_=0);var b=Array(16);if(typeof y=="string")for(var S=0;16>S;++S)b[S]=y.charCodeAt(_++)|y.charCodeAt(_++)<<8|y.charCodeAt(_++)<<16|y.charCodeAt(_++)<<24;else for(S=0;16>S;++S)b[S]=y[_++]|y[_++]<<8|y[_++]<<16|y[_++]<<24;y=I.g[0],_=I.g[1],S=I.g[2];var T=I.g[3],v=y+(T^_&(S^T))+b[0]+3614090360&4294967295;y=_+(v<<7&4294967295|v>>>25),v=T+(S^y&(_^S))+b[1]+3905402710&4294967295,T=y+(v<<12&4294967295|v>>>20),v=S+(_^T&(y^_))+b[2]+606105819&4294967295,S=T+(v<<17&4294967295|v>>>15),v=_+(y^S&(T^y))+b[3]+3250441966&4294967295,_=S+(v<<22&4294967295|v>>>10),v=y+(T^_&(S^T))+b[4]+4118548399&4294967295,y=_+(v<<7&4294967295|v>>>25),v=T+(S^y&(_^S))+b[5]+1200080426&4294967295,T=y+(v<<12&4294967295|v>>>20),v=S+(_^T&(y^_))+b[6]+2821735955&4294967295,S=T+(v<<17&4294967295|v>>>15),v=_+(y^S&(T^y))+b[7]+4249261313&4294967295,_=S+(v<<22&4294967295|v>>>10),v=y+(T^_&(S^T))+b[8]+1770035416&4294967295,y=_+(v<<7&4294967295|v>>>25),v=T+(S^y&(_^S))+b[9]+2336552879&4294967295,T=y+(v<<12&4294967295|v>>>20),v=S+(_^T&(y^_))+b[10]+4294925233&4294967295,S=T+(v<<17&4294967295|v>>>15),v=_+(y^S&(T^y))+b[11]+2304563134&4294967295,_=S+(v<<22&4294967295|v>>>10),v=y+(T^_&(S^T))+b[12]+1804603682&4294967295,y=_+(v<<7&4294967295|v>>>25),v=T+(S^y&(_^S))+b[13]+4254626195&4294967295,T=y+(v<<12&4294967295|v>>>20),v=S+(_^T&(y^_))+b[14]+2792965006&4294967295,S=T+(v<<17&4294967295|v>>>15),v=_+(y^S&(T^y))+b[15]+1236535329&4294967295,_=S+(v<<22&4294967295|v>>>10),v=y+(S^T&(_^S))+b[1]+4129170786&4294967295,y=_+(v<<5&4294967295|v>>>27),v=T+(_^S&(y^_))+b[6]+3225465664&4294967295,T=y+(v<<9&4294967295|v>>>23),v=S+(y^_&(T^y))+b[11]+643717713&4294967295,S=T+(v<<14&4294967295|v>>>18),v=_+(T^y&(S^T))+b[0]+3921069994&4294967295,_=S+(v<<20&4294967295|v>>>12),v=y+(S^T&(_^S))+b[5]+3593408605&4294967295,y=_+(v<<5&4294967295|v>>>27),v=T+(_^S&(y^_))+b[10]+38016083&4294967295,T=y+(v<<9&4294967295|v>>>23),v=S+(y^_&(T^y))+b[15]+3634488961&4294967295,S=T+(v<<14&4294967295|v>>>18),v=_+(T^y&(S^T))+b[4]+3889429448&4294967295,_=S+(v<<20&4294967295|v>>>12),v=y+(S^T&(_^S))+b[9]+568446438&4294967295,y=_+(v<<5&4294967295|v>>>27),v=T+(_^S&(y^_))+b[14]+3275163606&4294967295,T=y+(v<<9&4294967295|v>>>23),v=S+(y^_&(T^y))+b[3]+4107603335&4294967295,S=T+(v<<14&4294967295|v>>>18),v=_+(T^y&(S^T))+b[8]+1163531501&4294967295,_=S+(v<<20&4294967295|v>>>12),v=y+(S^T&(_^S))+b[13]+2850285829&4294967295,y=_+(v<<5&4294967295|v>>>27),v=T+(_^S&(y^_))+b[2]+4243563512&4294967295,T=y+(v<<9&4294967295|v>>>23),v=S+(y^_&(T^y))+b[7]+1735328473&4294967295,S=T+(v<<14&4294967295|v>>>18),v=_+(T^y&(S^T))+b[12]+2368359562&4294967295,_=S+(v<<20&4294967295|v>>>12),v=y+(_^S^T)+b[5]+4294588738&4294967295,y=_+(v<<4&4294967295|v>>>28),v=T+(y^_^S)+b[8]+2272392833&4294967295,T=y+(v<<11&4294967295|v>>>21),v=S+(T^y^_)+b[11]+1839030562&4294967295,S=T+(v<<16&4294967295|v>>>16),v=_+(S^T^y)+b[14]+4259657740&4294967295,_=S+(v<<23&4294967295|v>>>9),v=y+(_^S^T)+b[1]+2763975236&4294967295,y=_+(v<<4&4294967295|v>>>28),v=T+(y^_^S)+b[4]+1272893353&4294967295,T=y+(v<<11&4294967295|v>>>21),v=S+(T^y^_)+b[7]+4139469664&4294967295,S=T+(v<<16&4294967295|v>>>16),v=_+(S^T^y)+b[10]+3200236656&4294967295,_=S+(v<<23&4294967295|v>>>9),v=y+(_^S^T)+b[13]+681279174&4294967295,y=_+(v<<4&4294967295|v>>>28),v=T+(y^_^S)+b[0]+3936430074&4294967295,T=y+(v<<11&4294967295|v>>>21),v=S+(T^y^_)+b[3]+3572445317&4294967295,S=T+(v<<16&4294967295|v>>>16),v=_+(S^T^y)+b[6]+76029189&4294967295,_=S+(v<<23&4294967295|v>>>9),v=y+(_^S^T)+b[9]+3654602809&4294967295,y=_+(v<<4&4294967295|v>>>28),v=T+(y^_^S)+b[12]+3873151461&4294967295,T=y+(v<<11&4294967295|v>>>21),v=S+(T^y^_)+b[15]+530742520&4294967295,S=T+(v<<16&4294967295|v>>>16),v=_+(S^T^y)+b[2]+3299628645&4294967295,_=S+(v<<23&4294967295|v>>>9),v=y+(S^(_|~T))+b[0]+4096336452&4294967295,y=_+(v<<6&4294967295|v>>>26),v=T+(_^(y|~S))+b[7]+1126891415&4294967295,T=y+(v<<10&4294967295|v>>>22),v=S+(y^(T|~_))+b[14]+2878612391&4294967295,S=T+(v<<15&4294967295|v>>>17),v=_+(T^(S|~y))+b[5]+4237533241&4294967295,_=S+(v<<21&4294967295|v>>>11),v=y+(S^(_|~T))+b[12]+1700485571&4294967295,y=_+(v<<6&4294967295|v>>>26),v=T+(_^(y|~S))+b[3]+2399980690&4294967295,T=y+(v<<10&4294967295|v>>>22),v=S+(y^(T|~_))+b[10]+4293915773&4294967295,S=T+(v<<15&4294967295|v>>>17),v=_+(T^(S|~y))+b[1]+2240044497&4294967295,_=S+(v<<21&4294967295|v>>>11),v=y+(S^(_|~T))+b[8]+1873313359&4294967295,y=_+(v<<6&4294967295|v>>>26),v=T+(_^(y|~S))+b[15]+4264355552&4294967295,T=y+(v<<10&4294967295|v>>>22),v=S+(y^(T|~_))+b[6]+2734768916&4294967295,S=T+(v<<15&4294967295|v>>>17),v=_+(T^(S|~y))+b[13]+1309151649&4294967295,_=S+(v<<21&4294967295|v>>>11),v=y+(S^(_|~T))+b[4]+4149444226&4294967295,y=_+(v<<6&4294967295|v>>>26),v=T+(_^(y|~S))+b[11]+3174756917&4294967295,T=y+(v<<10&4294967295|v>>>22),v=S+(y^(T|~_))+b[2]+718787259&4294967295,S=T+(v<<15&4294967295|v>>>17),v=_+(T^(S|~y))+b[9]+3951481745&4294967295,I.g[0]=I.g[0]+y&4294967295,I.g[1]=I.g[1]+(S+(v<<21&4294967295|v>>>11))&4294967295,I.g[2]=I.g[2]+S&4294967295,I.g[3]=I.g[3]+T&4294967295}r.prototype.u=function(I,y){y===void 0&&(y=I.length);for(var _=y-this.blockSize,b=this.B,S=this.h,T=0;T<y;){if(S==0)for(;T<=_;)i(this,I,T),T+=this.blockSize;if(typeof I=="string"){for(;T<y;)if(b[S++]=I.charCodeAt(T++),S==this.blockSize){i(this,b),S=0;break}}else for(;T<y;)if(b[S++]=I[T++],S==this.blockSize){i(this,b),S=0;break}}this.h=S,this.o+=y},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var y=1;y<I.length-8;++y)I[y]=0;var _=8*this.o;for(y=I.length-8;y<I.length;++y)I[y]=_&255,_/=256;for(this.u(I),I=Array(16),y=_=0;4>y;++y)for(var b=0;32>b;b+=8)I[_++]=this.g[y]>>>b&255;return I};function s(I,y){var _=u;return Object.prototype.hasOwnProperty.call(_,I)?_[I]:_[I]=y(I)}function o(I,y){this.h=y;for(var _=[],b=!0,S=I.length-1;0<=S;S--){var T=I[S]|0;b&&T==y||(_[S]=T,b=!1)}this.g=_}var u={};function c(I){return-128<=I&&128>I?s(I,function(y){return new o([y|0],0>y?-1:0)}):new o([I|0],0>I?-1:0)}function d(I){if(isNaN(I)||!isFinite(I))return g;if(0>I)return M(d(-I));for(var y=[],_=1,b=0;I>=_;b++)y[b]=I/_|0,_*=4294967296;return new o(y,0)}function p(I,y){if(I.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(I.charAt(0)=="-")return M(p(I.substring(1),y));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var _=d(Math.pow(y,8)),b=g,S=0;S<I.length;S+=8){var T=Math.min(8,I.length-S),v=parseInt(I.substring(S,S+T),y);8>T?(T=d(Math.pow(y,T)),b=b.j(T).add(d(v))):(b=b.j(_),b=b.add(d(v)))}return b}var g=c(0),w=c(1),C=c(16777216);n=o.prototype,n.m=function(){if(B(this))return-M(this).m();for(var I=0,y=1,_=0;_<this.g.length;_++){var b=this.i(_);I+=(0<=b?b:4294967296+b)*y,y*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(N(this))return"0";if(B(this))return"-"+M(this).toString(I);for(var y=d(Math.pow(I,6)),_=this,b="";;){var S=me(_,y).g;_=ne(_,S.j(y));var T=((0<_.g.length?_.g[0]:_.h)>>>0).toString(I);if(_=S,N(_))return T+b;for(;6>T.length;)T="0"+T;b=T+b}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function N(I){if(I.h!=0)return!1;for(var y=0;y<I.g.length;y++)if(I.g[y]!=0)return!1;return!0}function B(I){return I.h==-1}n.l=function(I){return I=ne(this,I),B(I)?-1:N(I)?0:1};function M(I){for(var y=I.g.length,_=[],b=0;b<y;b++)_[b]=~I.g[b];return new o(_,~I.h).add(w)}n.abs=function(){return B(this)?M(this):this},n.add=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],b=0,S=0;S<=y;S++){var T=b+(this.i(S)&65535)+(I.i(S)&65535),v=(T>>>16)+(this.i(S)>>>16)+(I.i(S)>>>16);b=v>>>16,T&=65535,v&=65535,_[S]=v<<16|T}return new o(_,_[_.length-1]&-2147483648?-1:0)};function ne(I,y){return I.add(M(y))}n.j=function(I){if(N(this)||N(I))return g;if(B(this))return B(I)?M(this).j(M(I)):M(M(this).j(I));if(B(I))return M(this.j(M(I)));if(0>this.l(C)&&0>I.l(C))return d(this.m()*I.m());for(var y=this.g.length+I.g.length,_=[],b=0;b<2*y;b++)_[b]=0;for(b=0;b<this.g.length;b++)for(var S=0;S<I.g.length;S++){var T=this.i(b)>>>16,v=this.i(b)&65535,Tt=I.i(S)>>>16,ei=I.i(S)&65535;_[2*b+2*S]+=v*ei,X(_,2*b+2*S),_[2*b+2*S+1]+=T*ei,X(_,2*b+2*S+1),_[2*b+2*S+1]+=v*Tt,X(_,2*b+2*S+1),_[2*b+2*S+2]+=T*Tt,X(_,2*b+2*S+2)}for(b=0;b<y;b++)_[b]=_[2*b+1]<<16|_[2*b];for(b=y;b<2*y;b++)_[b]=0;return new o(_,0)};function X(I,y){for(;(I[y]&65535)!=I[y];)I[y+1]+=I[y]>>>16,I[y]&=65535,y++}function ie(I,y){this.g=I,this.h=y}function me(I,y){if(N(y))throw Error("division by zero");if(N(I))return new ie(g,g);if(B(I))return y=me(M(I),y),new ie(M(y.g),M(y.h));if(B(y))return y=me(I,M(y)),new ie(M(y.g),y.h);if(30<I.g.length){if(B(I)||B(y))throw Error("slowDivide_ only works with positive integers.");for(var _=w,b=y;0>=b.l(I);)_=Ye(_),b=Ye(b);var S=de(_,1),T=de(b,1);for(b=de(b,2),_=de(_,2);!N(b);){var v=T.add(b);0>=v.l(I)&&(S=S.add(_),T=v),b=de(b,1),_=de(_,1)}return y=ne(I,S.j(y)),new ie(S,y)}for(S=g;0<=I.l(y);){for(_=Math.max(1,Math.floor(I.m()/y.m())),b=Math.ceil(Math.log(_)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),T=d(_),v=T.j(y);B(v)||0<v.l(I);)_-=b,T=d(_),v=T.j(y);N(T)&&(T=w),S=S.add(T),I=ne(I,v)}return new ie(S,I)}n.A=function(I){return me(this,I).h},n.and=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],b=0;b<y;b++)_[b]=this.i(b)&I.i(b);return new o(_,this.h&I.h)},n.or=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],b=0;b<y;b++)_[b]=this.i(b)|I.i(b);return new o(_,this.h|I.h)},n.xor=function(I){for(var y=Math.max(this.g.length,I.g.length),_=[],b=0;b<y;b++)_[b]=this.i(b)^I.i(b);return new o(_,this.h^I.h)};function Ye(I){for(var y=I.g.length+1,_=[],b=0;b<y;b++)_[b]=I.i(b)<<1|I.i(b-1)>>>31;return new o(_,I.h)}function de(I,y){var _=y>>5;y%=32;for(var b=I.g.length-_,S=[],T=0;T<b;T++)S[T]=0<y?I.i(T+_)>>>y|I.i(T+_+1)<<32-y:I.i(T+_);return new o(S,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,vl=Iy.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=p,Ut=Iy.Integer=o}).apply(typeof Sy<"u"?Sy:typeof self<"u"?self:typeof window<"u"?window:{});var ha=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bt={};var _l,qD,Ar,wl,os,da,El,bl,Sl;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,l,h){return a==Array.prototype||a==Object.prototype||(a[l]=h.value),a};function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof ha=="object"&&ha];for(var l=0;l<a.length;++l){var h=a[l];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(a,l){if(l)e:{var h=r;a=a.split(".");for(var m=0;m<a.length-1;m++){var D=a[m];if(!(D in h))break e;h=h[D]}a=a[a.length-1],m=h[a],l=l(m),l!=m&&l!=null&&e(h,a,{configurable:!0,writable:!0,value:l})}}function s(a,l){a instanceof String&&(a+="");var h=0,m=!1,D={next:function(){if(!m&&h<a.length){var A=h++;return{value:l(A,a[A]),done:!1}}return m=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}i("Array.prototype.values",function(a){return a||function(){return s(this,function(l,h){return h})}});var o=o||{},u=this||self;function c(a){var l=typeof a;return l=l!="object"?l:a?Array.isArray(a)?"array":l:"null",l=="array"||l=="object"&&typeof a.length=="number"}function d(a){var l=typeof a;return l=="object"&&a!=null||l=="function"}function p(a,l,h){return a.call.apply(a.bind,arguments)}function g(a,l,h){if(!a)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,m),a.apply(l,D)}}return function(){return a.apply(l,arguments)}}function w(a,l,h){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:g,w.apply(null,arguments)}function C(a,l){var h=Array.prototype.slice.call(arguments,1);return function(){var m=h.slice();return m.push.apply(m,arguments),a.apply(this,m)}}function N(a,l){function h(){}h.prototype=l.prototype,a.aa=l.prototype,a.prototype=new h,a.prototype.constructor=a,a.Qb=function(m,D,A){for(var O=Array(arguments.length-2),he=2;he<arguments.length;he++)O[he-2]=arguments[he];return l.prototype[D].apply(m,O)}}function B(a){let l=a.length;if(0<l){let h=Array(l);for(let m=0;m<l;m++)h[m]=a[m];return h}return[]}function M(a,l){for(let h=1;h<arguments.length;h++){let m=arguments[h];if(c(m)){let D=a.length||0,A=m.length||0;a.length=D+A;for(let O=0;O<A;O++)a[D+O]=m[O]}else a.push(m)}}class ne{constructor(l,h){this.i=l,this.j=h,this.h=0,this.g=null}get(){let l;return 0<this.h?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function X(a){return/^[\s\xa0]*$/.test(a)}function ie(){var a=u.navigator;return a&&(a=a.userAgent)?a:""}function me(a){return me[" "](a),a}me[" "]=function(){};var Ye=ie().indexOf("Gecko")!=-1&&!(ie().toLowerCase().indexOf("webkit")!=-1&&ie().indexOf("Edge")==-1)&&!(ie().indexOf("Trident")!=-1||ie().indexOf("MSIE")!=-1)&&ie().indexOf("Edge")==-1;function de(a,l,h){for(let m in a)l.call(h,a[m],m,a)}function I(a,l){for(let h in a)l.call(void 0,a[h],h,a)}function y(a){let l={};for(let h in a)l[h]=a[h];return l}let _="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(a,l){let h,m;for(let D=1;D<arguments.length;D++){m=arguments[D];for(h in m)a[h]=m[h];for(let A=0;A<_.length;A++)h=_[A],Object.prototype.hasOwnProperty.call(m,h)&&(a[h]=m[h])}}function S(a){var l=1;a=a.split(":");let h=[];for(;0<l&&a.length;)h.push(a.shift()),l--;return a.length&&h.push(a.join(":")),h}function T(a){u.setTimeout(()=>{throw a},0)}function v(){var a=su;let l=null;return a.g&&(l=a.g,a.g=a.g.next,a.g||(a.h=null),l.next=null),l}class Tt{constructor(){this.h=this.g=null}add(l,h){let m=ei.get();m.set(l,h),this.h?this.h.next=m:this.g=m,this.h=m}}var ei=new ne(()=>new Y_,a=>a.reset());class Y_{constructor(){this.next=this.g=this.h=null}set(l,h){this.h=l,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let ti,ni=!1,su=new Tt,Md=()=>{let a=u.Promise.resolve(void 0);ti=()=>{a.then(X_)}};var X_=()=>{for(var a;a=v();){try{a.h.call(a.g)}catch(h){T(h)}var l=ei;l.j(a),100>l.h&&(l.h++,a.next=l.g,l.g=a)}ni=!1};function Ht(){this.s=this.s,this.C=this.C}Ht.prototype.s=!1,Ht.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ht.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ke(a,l){this.type=a,this.g=this.target=l,this.defaultPrevented=!1}ke.prototype.h=function(){this.defaultPrevented=!0};var J_=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var a=!1,l=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let h=()=>{};u.addEventListener("test",h,l),u.removeEventListener("test",h,l)}catch{}return a})();function ri(a,l){if(ke.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var h=this.type=a.type,m=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=l,l=a.relatedTarget){if(Ye){e:{try{me(l.nodeName);var D=!0;break e}catch{}D=!1}D||(l=null)}}else h=="mouseover"?l=a.fromElement:h=="mouseout"&&(l=a.toElement);this.relatedTarget=l,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:e0[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ri.aa.h.call(this)}}N(ri,ke);var e0={2:"touch",3:"pen",4:"mouse"};ri.prototype.h=function(){ri.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var ii="closure_listenable_"+(1e6*Math.random()|0),t0=0;function n0(a,l,h,m,D){this.listener=a,this.proxy=null,this.src=l,this.type=h,this.capture=!!m,this.ha=D,this.key=++t0,this.da=this.fa=!1}function Os(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ks(a){this.src=a,this.g={},this.h=0}ks.prototype.add=function(a,l,h,m,D){var A=a.toString();a=this.g[A],a||(a=this.g[A]=[],this.h++);var O=au(a,l,m,D);return-1<O?(l=a[O],h||(l.fa=!1)):(l=new n0(l,this.src,A,!!m,D),l.fa=h,a.push(l)),l};function ou(a,l){var h=l.type;if(h in a.g){var m=a.g[h],D=Array.prototype.indexOf.call(m,l,void 0),A;(A=0<=D)&&Array.prototype.splice.call(m,D,1),A&&(Os(l),a.g[h].length==0&&(delete a.g[h],a.h--))}}function au(a,l,h,m){for(var D=0;D<a.length;++D){var A=a[D];if(!A.da&&A.listener==l&&A.capture==!!h&&A.ha==m)return D}return-1}var uu="closure_lm_"+(1e6*Math.random()|0),cu={};function Fd(a,l,h,m,D){if(m&&m.once)return Vd(a,l,h,m,D);if(Array.isArray(l)){for(var A=0;A<l.length;A++)Fd(a,l[A],h,m,D);return null}return h=fu(h),a&&a[ii]?a.K(l,h,d(m)?!!m.capture:!!m,D):Ld(a,l,h,!1,m,D)}function Ld(a,l,h,m,D,A){if(!l)throw Error("Invalid event type");var O=d(D)?!!D.capture:!!D,he=hu(a);if(he||(a[uu]=he=new ks(a)),h=he.add(l,h,m,O,A),h.proxy)return h;if(m=r0(),h.proxy=m,m.src=a,m.listener=h,a.addEventListener)J_||(D=O),D===void 0&&(D=!1),a.addEventListener(l.toString(),m,D);else if(a.attachEvent)a.attachEvent(Bd(l.toString()),m);else if(a.addListener&&a.removeListener)a.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return h}function r0(){function a(h){return l.call(a.src,a.listener,h)}let l=i0;return a}function Vd(a,l,h,m,D){if(Array.isArray(l)){for(var A=0;A<l.length;A++)Vd(a,l[A],h,m,D);return null}return h=fu(h),a&&a[ii]?a.L(l,h,d(m)?!!m.capture:!!m,D):Ld(a,l,h,!0,m,D)}function Ud(a,l,h,m,D){if(Array.isArray(l))for(var A=0;A<l.length;A++)Ud(a,l[A],h,m,D);else m=d(m)?!!m.capture:!!m,h=fu(h),a&&a[ii]?(a=a.i,l=String(l).toString(),l in a.g&&(A=a.g[l],h=au(A,h,m,D),-1<h&&(Os(A[h]),Array.prototype.splice.call(A,h,1),A.length==0&&(delete a.g[l],a.h--)))):a&&(a=hu(a))&&(l=a.g[l.toString()],a=-1,l&&(a=au(l,h,m,D)),(h=-1<a?l[a]:null)&&lu(h))}function lu(a){if(typeof a!="number"&&a&&!a.da){var l=a.src;if(l&&l[ii])ou(l.i,a);else{var h=a.type,m=a.proxy;l.removeEventListener?l.removeEventListener(h,m,a.capture):l.detachEvent?l.detachEvent(Bd(h),m):l.addListener&&l.removeListener&&l.removeListener(m),(h=hu(l))?(ou(h,a),h.h==0&&(h.src=null,l[uu]=null)):Os(a)}}}function Bd(a){return a in cu?cu[a]:cu[a]="on"+a}function i0(a,l){if(a.da)a=!0;else{l=new ri(l,this);var h=a.listener,m=a.ha||a.src;a.fa&&lu(a),a=h.call(m,l)}return a}function hu(a){return a=a[uu],a instanceof ks?a:null}var du="__closure_events_fn_"+(1e9*Math.random()>>>0);function fu(a){return typeof a=="function"?a:(a[du]||(a[du]=function(l){return a.handleEvent(l)}),a[du])}function Me(){Ht.call(this),this.i=new ks(this),this.M=this,this.F=null}N(Me,Ht),Me.prototype[ii]=!0,Me.prototype.removeEventListener=function(a,l,h,m){Ud(this,a,l,h,m)};function $e(a,l){var h,m=a.F;if(m)for(h=[];m;m=m.F)h.push(m);if(a=a.M,m=l.type||l,typeof l=="string")l=new ke(l,a);else if(l instanceof ke)l.target=l.target||a;else{var D=l;l=new ke(m,a),b(l,D)}if(D=!0,h)for(var A=h.length-1;0<=A;A--){var O=l.g=h[A];D=Ms(O,m,!0,l)&&D}if(O=l.g=a,D=Ms(O,m,!0,l)&&D,D=Ms(O,m,!1,l)&&D,h)for(A=0;A<h.length;A++)O=l.g=h[A],D=Ms(O,m,!1,l)&&D}Me.prototype.N=function(){if(Me.aa.N.call(this),this.i){var a=this.i,l;for(l in a.g){for(var h=a.g[l],m=0;m<h.length;m++)Os(h[m]);delete a.g[l],a.h--}}this.F=null},Me.prototype.K=function(a,l,h,m){return this.i.add(String(a),l,!1,h,m)},Me.prototype.L=function(a,l,h,m){return this.i.add(String(a),l,!0,h,m)};function Ms(a,l,h,m){if(l=a.i.g[String(l)],!l)return!0;l=l.concat();for(var D=!0,A=0;A<l.length;++A){var O=l[A];if(O&&!O.da&&O.capture==h){var he=O.listener,xe=O.ha||O.src;O.fa&&ou(a.i,O),D=he.call(xe,m)!==!1&&D}}return D&&!m.defaultPrevented}function jd(a,l,h){if(typeof a=="function")h&&(a=w(a,h));else if(a&&typeof a.handleEvent=="function")a=w(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(l)?-1:u.setTimeout(a,l||0)}function $d(a){a.g=jd(()=>{a.g=null,a.i&&(a.i=!1,$d(a))},a.l);let l=a.h;a.h=null,a.m.apply(null,l)}class s0 extends Ht{constructor(l,h){super(),this.m=l,this.l=h,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:$d(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function si(a){Ht.call(this),this.h=a,this.g={}}N(si,Ht);var zd=[];function qd(a){de(a.g,function(l,h){this.g.hasOwnProperty(h)&&lu(l)},a),a.g={}}si.prototype.N=function(){si.aa.N.call(this),qd(this)},si.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pu=u.JSON.stringify,o0=u.JSON.parse,a0=class{stringify(a){return u.JSON.stringify(a,void 0)}parse(a){return u.JSON.parse(a,void 0)}};function mu(){}mu.prototype.h=null;function Gd(a){return a.h||(a.h=a.i())}function Hd(){}var oi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function gu(){ke.call(this,"d")}N(gu,ke);function yu(){ke.call(this,"c")}N(yu,ke);var gn={},Wd=null;function Fs(){return Wd=Wd||new Me}gn.La="serverreachability";function Kd(a){ke.call(this,gn.La,a)}N(Kd,ke);function ai(a){let l=Fs();$e(l,new Kd(l))}gn.STAT_EVENT="statevent";function Zd(a,l){ke.call(this,gn.STAT_EVENT,a),this.stat=l}N(Zd,ke);function ze(a){let l=Fs();$e(l,new Zd(l,a))}gn.Ma="timingevent";function Qd(a,l){ke.call(this,gn.Ma,a),this.size=l}N(Qd,ke);function ui(a,l){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){a()},l)}function ci(){this.g=!0}ci.prototype.xa=function(){this.g=!1};function u0(a,l,h,m,D,A){a.info(function(){if(a.g)if(A)for(var O="",he=A.split("&"),xe=0;xe<he.length;xe++){var ce=he[xe].split("=");if(1<ce.length){var Fe=ce[0];ce=ce[1];var Le=Fe.split("_");O=2<=Le.length&&Le[1]=="type"?O+(Fe+"="+ce+"&"):O+(Fe+"=redacted&")}}else O=null;else O=A;return"XMLHTTP REQ ("+m+") [attempt "+D+"]: "+l+`
`+h+`
`+O})}function c0(a,l,h,m,D,A,O){a.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+D+"]: "+l+`
`+h+`
`+A+" "+O})}function Gn(a,l,h,m){a.info(function(){return"XMLHTTP TEXT ("+l+"): "+h0(a,h)+(m?" "+m:"")})}function l0(a,l){a.info(function(){return"TIMEOUT: "+l})}ci.prototype.info=function(){};function h0(a,l){if(!a.g)return l;if(!l)return null;try{var h=JSON.parse(l);if(h){for(a=0;a<h.length;a++)if(Array.isArray(h[a])){var m=h[a];if(!(2>m.length)){var D=m[1];if(Array.isArray(D)&&!(1>D.length)){var A=D[0];if(A!="noop"&&A!="stop"&&A!="close")for(var O=1;O<D.length;O++)D[O]=""}}}}return pu(h)}catch{return l}}var Ls={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Yd={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},vu;function Vs(){}N(Vs,mu),Vs.prototype.g=function(){return new XMLHttpRequest},Vs.prototype.i=function(){return{}},vu=new Vs;function Wt(a,l,h,m){this.j=a,this.i=l,this.l=h,this.R=m||1,this.U=new si(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Xd}function Xd(){this.i=null,this.g="",this.h=!1}var Jd={},_u={};function wu(a,l,h){a.L=1,a.v=$s(At(l)),a.m=h,a.P=!0,ef(a,null)}function ef(a,l){a.F=Date.now(),Us(a),a.A=At(a.v);var h=a.A,m=a.R;Array.isArray(m)||(m=[String(m)]),mf(h.i,"t",m),a.C=0,h=a.j.J,a.h=new Xd,a.g=Of(a.j,h?l:null,!a.m),0<a.O&&(a.M=new s0(w(a.Y,a,a.g),a.O)),l=a.U,h=a.g,m=a.ca;var D="readystatechange";Array.isArray(D)||(D&&(zd[0]=D.toString()),D=zd);for(var A=0;A<D.length;A++){var O=Fd(h,D[A],m||l.handleEvent,!1,l.h||l);if(!O)break;l.g[O.key]=O}l=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),l["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,l)):(a.u="GET",a.g.ea(a.A,a.u,null,l)),ai(),u0(a.i,a.u,a.A,a.l,a.R,a.m)}Wt.prototype.ca=function(a){a=a.target;let l=this.M;l&&Ct(a)==3?l.j():this.Y(a)},Wt.prototype.Y=function(a){try{if(a==this.g)e:{let Le=Ct(this.g);var l=this.g.Ba();let Kn=this.g.Z();if(!(3>Le)&&(Le!=3||this.g&&(this.h.h||this.g.oa()||bf(this.g)))){this.J||Le!=4||l==7||(l==8||0>=Kn?ai(3):ai(2)),Eu(this);var h=this.g.Z();this.X=h;t:if(tf(this)){var m=bf(this.g);a="";var D=m.length,A=Ct(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){yn(this),li(this);var O="";break t}this.h.i=new u.TextDecoder}for(l=0;l<D;l++)this.h.h=!0,a+=this.h.i.decode(m[l],{stream:!(A&&l==D-1)});m.length=0,this.h.g+=a,this.C=0,O=this.h.g}else O=this.g.oa();if(this.o=h==200,c0(this.i,this.u,this.A,this.l,this.R,Le,h),this.o){if(this.T&&!this.K){t:{if(this.g){var he,xe=this.g;if((he=xe.g?xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(he)){var ce=he;break t}}ce=null}if(h=ce)Gn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,bu(this,h);else{this.o=!1,this.s=3,ze(12),yn(this),li(this);break e}}if(this.P){h=!0;let nt;for(;!this.J&&this.C<O.length;)if(nt=d0(this,O),nt==_u){Le==4&&(this.s=4,ze(14),h=!1),Gn(this.i,this.l,null,"[Incomplete Response]");break}else if(nt==Jd){this.s=4,ze(15),Gn(this.i,this.l,O,"[Invalid Chunk]"),h=!1;break}else Gn(this.i,this.l,nt,null),bu(this,nt);if(tf(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Le!=4||O.length!=0||this.h.h||(this.s=1,ze(16),h=!1),this.o=this.o&&h,!h)Gn(this.i,this.l,O,"[Invalid Chunked Response]"),yn(this),li(this);else if(0<O.length&&!this.W){this.W=!0;var Fe=this.j;Fe.g==this&&Fe.ba&&!Fe.M&&(Fe.j.info("Great, no buffering proxy detected. Bytes received: "+O.length),Cu(Fe),Fe.M=!0,ze(11))}}else Gn(this.i,this.l,O,null),bu(this,O);Le==4&&yn(this),this.o&&!this.J&&(Le==4?Rf(this.j,this):(this.o=!1,Us(this)))}else R0(this.g),h==400&&0<O.indexOf("Unknown SID")?(this.s=3,ze(12)):(this.s=0,ze(13)),yn(this),li(this)}}}catch{}finally{}};function tf(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function d0(a,l){var h=a.C,m=l.indexOf(`
`,h);return m==-1?_u:(h=Number(l.substring(h,m)),isNaN(h)?Jd:(m+=1,m+h>l.length?_u:(l=l.slice(m,m+h),a.C=m+h,l)))}Wt.prototype.cancel=function(){this.J=!0,yn(this)};function Us(a){a.S=Date.now()+a.I,nf(a,a.I)}function nf(a,l){if(a.B!=null)throw Error("WatchDog timer not null");a.B=ui(w(a.ba,a),l)}function Eu(a){a.B&&(u.clearTimeout(a.B),a.B=null)}Wt.prototype.ba=function(){this.B=null;let a=Date.now();0<=a-this.S?(l0(this.i,this.A),this.L!=2&&(ai(),ze(17)),yn(this),this.s=2,li(this)):nf(this,this.S-a)};function li(a){a.j.G==0||a.J||Rf(a.j,a)}function yn(a){Eu(a);var l=a.M;l&&typeof l.ma=="function"&&l.ma(),a.M=null,qd(a.U),a.g&&(l=a.g,a.g=null,l.abort(),l.ma())}function bu(a,l){try{var h=a.j;if(h.G!=0&&(h.g==a||Su(h.h,a))){if(!a.K&&Su(h.h,a)&&h.G==3){try{var m=h.Da.g.parse(l)}catch{m=null}if(Array.isArray(m)&&m.length==3){var D=m;if(D[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<a.F)Ws(h),Gs(h);else break e;Au(h),ze(18)}}else h.za=D[1],0<h.za-h.T&&37500>D[2]&&h.F&&h.v==0&&!h.C&&(h.C=ui(w(h.Za,h),6e3));if(1>=of(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else _n(h,11)}else if((a.K||h.g==a)&&Ws(h),!X(l))for(D=h.Da.g.parse(l),l=0;l<D.length;l++){let ce=D[l];if(h.T=ce[0],ce=ce[1],h.G==2)if(ce[0]=="c"){h.K=ce[1],h.ia=ce[2];let Fe=ce[3];Fe!=null&&(h.la=Fe,h.j.info("VER="+h.la));let Le=ce[4];Le!=null&&(h.Aa=Le,h.j.info("SVER="+h.Aa));let Kn=ce[5];Kn!=null&&typeof Kn=="number"&&0<Kn&&(m=1.5*Kn,h.L=m,h.j.info("backChannelRequestTimeoutMs_="+m)),m=h;let nt=a.g;if(nt){let Zs=nt.g?nt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Zs){var A=m.h;A.g||Zs.indexOf("spdy")==-1&&Zs.indexOf("quic")==-1&&Zs.indexOf("h2")==-1||(A.j=A.l,A.g=new Set,A.h&&(Iu(A,A.h),A.h=null))}if(m.D){let Ru=nt.g?nt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ru&&(m.ya=Ru,fe(m.I,m.D,Ru))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-a.F,h.j.info("Handshake RTT: "+h.R+"ms")),m=h;var O=a;if(m.qa=Nf(m,m.J?m.ia:null,m.W),O.K){af(m.h,O);var he=O,xe=m.L;xe&&(he.I=xe),he.B&&(Eu(he),Us(he)),m.g=O}else Af(m);0<h.i.length&&Hs(h)}else ce[0]!="stop"&&ce[0]!="close"||_n(h,7);else h.G==3&&(ce[0]=="stop"||ce[0]=="close"?ce[0]=="stop"?_n(h,7):Tu(h):ce[0]!="noop"&&h.l&&h.l.ta(ce),h.v=0)}}ai(4)}catch{}}var f0=class{constructor(a,l){this.g=a,this.map=l}};function rf(a){this.l=a||10,u.PerformanceNavigationTiming?(a=u.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function sf(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function of(a){return a.h?1:a.g?a.g.size:0}function Su(a,l){return a.h?a.h==l:a.g?a.g.has(l):!1}function Iu(a,l){a.g?a.g.add(l):a.h=l}function af(a,l){a.h&&a.h==l?a.h=null:a.g&&a.g.has(l)&&a.g.delete(l)}rf.prototype.cancel=function(){if(this.i=uf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function uf(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let l=a.i;for(let h of a.g.values())l=l.concat(h.D);return l}return B(a.i)}function p0(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(c(a)){for(var l=[],h=a.length,m=0;m<h;m++)l.push(a[m]);return l}l=[],h=0;for(m in a)l[h++]=a[m];return l}function m0(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(c(a)||typeof a=="string"){var l=[];a=a.length;for(var h=0;h<a;h++)l.push(h);return l}l=[],h=0;for(let m in a)l[h++]=m;return l}}}function cf(a,l){if(a.forEach&&typeof a.forEach=="function")a.forEach(l,void 0);else if(c(a)||typeof a=="string")Array.prototype.forEach.call(a,l,void 0);else for(var h=m0(a),m=p0(a),D=m.length,A=0;A<D;A++)l.call(void 0,m[A],h&&h[A],a)}var lf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function g0(a,l){if(a){a=a.split("&");for(var h=0;h<a.length;h++){var m=a[h].indexOf("="),D=null;if(0<=m){var A=a[h].substring(0,m);D=a[h].substring(m+1)}else A=a[h];l(A,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function vn(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof vn){this.h=a.h,Bs(this,a.j),this.o=a.o,this.g=a.g,js(this,a.s),this.l=a.l;var l=a.i,h=new fi;h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),hf(this,h),this.m=a.m}else a&&(l=String(a).match(lf))?(this.h=!1,Bs(this,l[1]||"",!0),this.o=hi(l[2]||""),this.g=hi(l[3]||"",!0),js(this,l[4]),this.l=hi(l[5]||"",!0),hf(this,l[6]||"",!0),this.m=hi(l[7]||"")):(this.h=!1,this.i=new fi(null,this.h))}vn.prototype.toString=function(){var a=[],l=this.j;l&&a.push(di(l,df,!0),":");var h=this.g;return(h||l=="file")&&(a.push("//"),(l=this.o)&&a.push(di(l,df,!0),"@"),a.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&a.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&a.push("/"),a.push(di(h,h.charAt(0)=="/"?_0:v0,!0))),(h=this.i.toString())&&a.push("?",h),(h=this.m)&&a.push("#",di(h,E0)),a.join("")};function At(a){return new vn(a)}function Bs(a,l,h){a.j=h?hi(l,!0):l,a.j&&(a.j=a.j.replace(/:$/,""))}function js(a,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);a.s=l}else a.s=null}function hf(a,l,h){l instanceof fi?(a.i=l,b0(a.i,a.h)):(h||(l=di(l,w0)),a.i=new fi(l,a.h))}function fe(a,l,h){a.i.set(l,h)}function $s(a){return fe(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function hi(a,l){return a?l?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function di(a,l,h){return typeof a=="string"?(a=encodeURI(a).replace(l,y0),h&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function y0(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var df=/[#\/\?@]/g,v0=/[#\?:]/g,_0=/[#\?]/g,w0=/[#\?@]/g,E0=/#/g;function fi(a,l){this.h=this.g=null,this.i=a||null,this.j=!!l}function Kt(a){a.g||(a.g=new Map,a.h=0,a.i&&g0(a.i,function(l,h){a.add(decodeURIComponent(l.replace(/\+/g," ")),h)}))}n=fi.prototype,n.add=function(a,l){Kt(this),this.i=null,a=Hn(this,a);var h=this.g.get(a);return h||this.g.set(a,h=[]),h.push(l),this.h+=1,this};function ff(a,l){Kt(a),l=Hn(a,l),a.g.has(l)&&(a.i=null,a.h-=a.g.get(l).length,a.g.delete(l))}function pf(a,l){return Kt(a),l=Hn(a,l),a.g.has(l)}n.forEach=function(a,l){Kt(this),this.g.forEach(function(h,m){h.forEach(function(D){a.call(l,D,m,this)},this)},this)},n.na=function(){Kt(this);let a=Array.from(this.g.values()),l=Array.from(this.g.keys()),h=[];for(let m=0;m<l.length;m++){let D=a[m];for(let A=0;A<D.length;A++)h.push(l[m])}return h},n.V=function(a){Kt(this);let l=[];if(typeof a=="string")pf(this,a)&&(l=l.concat(this.g.get(Hn(this,a))));else{a=Array.from(this.g.values());for(let h=0;h<a.length;h++)l=l.concat(a[h])}return l},n.set=function(a,l){return Kt(this),this.i=null,a=Hn(this,a),pf(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[l]),this.h+=1,this},n.get=function(a,l){return a?(a=this.V(a),0<a.length?String(a[0]):l):l};function mf(a,l,h){ff(a,l),0<h.length&&(a.i=null,a.g.set(Hn(a,l),B(h)),a.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],l=Array.from(this.g.keys());for(var h=0;h<l.length;h++){var m=l[h];let A=encodeURIComponent(String(m)),O=this.V(m);for(m=0;m<O.length;m++){var D=A;O[m]!==""&&(D+="="+encodeURIComponent(String(O[m]))),a.push(D)}}return this.i=a.join("&")};function Hn(a,l){return l=String(l),a.j&&(l=l.toLowerCase()),l}function b0(a,l){l&&!a.j&&(Kt(a),a.i=null,a.g.forEach(function(h,m){var D=m.toLowerCase();m!=D&&(ff(this,m),mf(this,D,h))},a)),a.j=l}function S0(a,l){let h=new ci;if(u.Image){let m=new Image;m.onload=C(Zt,h,"TestLoadImage: loaded",!0,l,m),m.onerror=C(Zt,h,"TestLoadImage: error",!1,l,m),m.onabort=C(Zt,h,"TestLoadImage: abort",!1,l,m),m.ontimeout=C(Zt,h,"TestLoadImage: timeout",!1,l,m),u.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=a}else l(!1)}function I0(a,l){let h=new ci,m=new AbortController,D=setTimeout(()=>{m.abort(),Zt(h,"TestPingServer: timeout",!1,l)},1e4);fetch(a,{signal:m.signal}).then(A=>{clearTimeout(D),A.ok?Zt(h,"TestPingServer: ok",!0,l):Zt(h,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(D),Zt(h,"TestPingServer: error",!1,l)})}function Zt(a,l,h,m,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),m(h)}catch{}}function D0(){this.g=new a0}function T0(a,l,h){let m=h||"";try{cf(a,function(D,A){let O=D;d(D)&&(O=pu(D)),l.push(m+A+"="+encodeURIComponent(O))})}catch(D){throw l.push(m+"type="+encodeURIComponent("_badmap")),D}}function pi(a){this.l=a.Ub||null,this.j=a.eb||!1}N(pi,mu),pi.prototype.g=function(){return new zs(this.l,this.j)},pi.prototype.i=(function(a){return function(){return a}})({});function zs(a,l){Me.call(this),this.D=a,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(zs,Me),n=zs.prototype,n.open=function(a,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=l,this.readyState=1,gi(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let l={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(l.body=a),(this.D||u).fetch(new Request(this.A,l)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,mi(this)),this.readyState=0},n.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,gi(this)),this.g&&(this.readyState=3,gi(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;gf(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function gf(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}n.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var l=a.value?a.value:new Uint8Array(0);(l=this.v.decode(l,{stream:!a.done}))&&(this.response=this.responseText+=l)}a.done?mi(this):gi(this),this.readyState==3&&gf(this)}},n.Ra=function(a){this.g&&(this.response=this.responseText=a,mi(this))},n.Qa=function(a){this.g&&(this.response=a,mi(this))},n.ga=function(){this.g&&mi(this)};function mi(a){a.readyState=4,a.l=null,a.j=null,a.v=null,gi(a)}n.setRequestHeader=function(a,l){this.u.append(a,l)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],l=this.h.entries();for(var h=l.next();!h.done;)h=h.value,a.push(h[0]+": "+h[1]),h=l.next();return a.join(`\r
`)};function gi(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(zs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function yf(a){let l="";return de(a,function(h,m){l+=m,l+=":",l+=h,l+=`\r
`}),l}function Du(a,l,h){e:{for(m in h){var m=!1;break e}m=!0}m||(h=yf(h),typeof a=="string"?h!=null&&encodeURIComponent(String(h)):fe(a,l,h))}function _e(a){Me.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(_e,Me);var A0=/^https?$/i,C0=["POST","PUT"];n=_e.prototype,n.Ha=function(a){this.J=a},n.ea=function(a,l,h,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);l=l?l.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():vu.g(),this.v=this.o?Gd(this.o):Gd(vu),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(l,String(a),!0),this.B=!1}catch(A){vf(this,A);return}if(a=h||"",h=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var D in m)h.set(D,m[D]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let A of m.keys())h.set(A,m.get(A));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(h.keys()).find(A=>A.toLowerCase()=="content-type"),D=u.FormData&&a instanceof u.FormData,!(0<=Array.prototype.indexOf.call(C0,l,void 0))||m||D||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[A,O]of h)this.g.setRequestHeader(A,O);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ef(this),this.u=!0,this.g.send(a),this.u=!1}catch(A){vf(this,A)}};function vf(a,l){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=l,a.m=5,_f(a),qs(a)}function _f(a){a.A||(a.A=!0,$e(a,"complete"),$e(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,$e(this,"complete"),$e(this,"abort"),qs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qs(this,!0)),_e.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?wf(this):this.bb())},n.bb=function(){wf(this)};function wf(a){if(a.h&&typeof o<"u"&&(!a.v[1]||Ct(a)!=4||a.Z()!=2)){if(a.u&&Ct(a)==4)jd(a.Ea,0,a);else if($e(a,"readystatechange"),Ct(a)==4){a.h=!1;try{let O=a.Z();e:switch(O){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var h;if(!(h=l)){var m;if(m=O===0){var D=String(a.D).match(lf)[1]||null;!D&&u.self&&u.self.location&&(D=u.self.location.protocol.slice(0,-1)),m=!A0.test(D?D.toLowerCase():"")}h=m}if(h)$e(a,"complete"),$e(a,"success");else{a.m=6;try{var A=2<Ct(a)?a.g.statusText:""}catch{A=""}a.l=A+" ["+a.Z()+"]",_f(a)}}finally{qs(a)}}}}function qs(a,l){if(a.g){Ef(a);let h=a.g,m=a.v[0]?()=>{}:null;a.g=null,a.v=null,l||$e(a,"ready");try{h.onreadystatechange=m}catch{}}}function Ef(a){a.I&&(u.clearTimeout(a.I),a.I=null)}n.isActive=function(){return!!this.g};function Ct(a){return a.g?a.g.readyState:0}n.Z=function(){try{return 2<Ct(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(a){if(this.g){var l=this.g.responseText;return a&&l.indexOf(a)==0&&(l=l.substring(a.length)),o0(l)}};function bf(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function R0(a){let l={};a=(a.g&&2<=Ct(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<a.length;m++){if(X(a[m]))continue;var h=S(a[m]);let D=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let A=l[D]||[];l[D]=A,A.push(h)}I(l,function(m){return m.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function yi(a,l,h){return h&&h.internalChannelParams&&h.internalChannelParams[a]||l}function Sf(a){this.Aa=0,this.i=[],this.j=new ci,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=yi("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=yi("baseRetryDelayMs",5e3,a),this.cb=yi("retryDelaySeedMs",1e4,a),this.Wa=yi("forwardChannelMaxRetries",2,a),this.wa=yi("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new rf(a&&a.concurrentRequestLimit),this.Da=new D0,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Sf.prototype,n.la=8,n.G=1,n.connect=function(a,l,h,m){ze(0),this.W=a,this.H=l||{},h&&m!==void 0&&(this.H.OSID=h,this.H.OAID=m),this.F=this.X,this.I=Nf(this,null,this.W),Hs(this)};function Tu(a){if(If(a),a.G==3){var l=a.U++,h=At(a.I);if(fe(h,"SID",a.K),fe(h,"RID",l),fe(h,"TYPE","terminate"),vi(a,h),l=new Wt(a,a.j,l),l.L=2,l.v=$s(At(h)),h=!1,u.navigator&&u.navigator.sendBeacon)try{h=u.navigator.sendBeacon(l.v.toString(),"")}catch{}!h&&u.Image&&(new Image().src=l.v,h=!0),h||(l.g=Of(l.j,null),l.g.ea(l.v)),l.F=Date.now(),Us(l)}Pf(a)}function Gs(a){a.g&&(Cu(a),a.g.cancel(),a.g=null)}function If(a){Gs(a),a.u&&(u.clearTimeout(a.u),a.u=null),Ws(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&u.clearTimeout(a.s),a.s=null)}function Hs(a){if(!sf(a.h)&&!a.s){a.s=!0;var l=a.Ga;ti||Md(),ni||(ti(),ni=!0),su.add(l,a),a.B=0}}function x0(a,l){return of(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=l.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=ui(w(a.Ga,a,l),xf(a,a.B)),a.B++,!0)}n.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;let D=new Wt(this,this.j,a),A=this.o;if(this.S&&(A?(A=y(A),b(A,this.S)):A=this.S),this.m!==null||this.O||(D.H=A,A=null),this.P)e:{for(var l=0,h=0;h<this.i.length;h++){t:{var m=this.i[h];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(l+=m,4096<l){l=h;break e}if(l===4096||h===this.i.length-1){l=h+1;break e}}l=1e3}else l=1e3;l=Tf(this,D,l),h=At(this.I),fe(h,"RID",a),fe(h,"CVER",22),this.D&&fe(h,"X-HTTP-Session-Id",this.D),vi(this,h),A&&(this.O?l="headers="+encodeURIComponent(String(yf(A)))+"&"+l:this.m&&Du(h,this.m,A)),Iu(this.h,D),this.Ua&&fe(h,"TYPE","init"),this.P?(fe(h,"$req",l),fe(h,"SID","null"),D.T=!0,wu(D,h,null)):wu(D,h,l),this.G=2}}else this.G==3&&(a?Df(this,a):this.i.length==0||sf(this.h)||Df(this))};function Df(a,l){var h;l?h=l.l:h=a.U++;let m=At(a.I);fe(m,"SID",a.K),fe(m,"RID",h),fe(m,"AID",a.T),vi(a,m),a.m&&a.o&&Du(m,a.m,a.o),h=new Wt(a,a.j,h,a.B+1),a.m===null&&(h.H=a.o),l&&(a.i=l.D.concat(a.i)),l=Tf(a,h,1e3),h.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),Iu(a.h,h),wu(h,m,l)}function vi(a,l){a.H&&de(a.H,function(h,m){fe(l,m,h)}),a.l&&cf({},function(h,m){fe(l,m,h)})}function Tf(a,l,h){h=Math.min(a.i.length,h);var m=a.l?w(a.l.Na,a.l,a):null;e:{var D=a.i;let A=-1;for(;;){let O=["count="+h];A==-1?0<h?(A=D[0].g,O.push("ofs="+A)):A=0:O.push("ofs="+A);let he=!0;for(let xe=0;xe<h;xe++){let ce=D[xe].g,Fe=D[xe].map;if(ce-=A,0>ce)A=Math.max(0,D[xe].g-100),he=!1;else try{T0(Fe,O,"req"+ce+"_")}catch{m&&m(Fe)}}if(he){m=O.join("&");break e}}}return a=a.i.splice(0,h),l.D=a,m}function Af(a){if(!a.g&&!a.u){a.Y=1;var l=a.Fa;ti||Md(),ni||(ti(),ni=!0),su.add(l,a),a.v=0}}function Au(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=ui(w(a.Fa,a),xf(a,a.v)),a.v++,!0)}n.Fa=function(){if(this.u=null,Cf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=ui(w(this.ab,this),a)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ze(10),Gs(this),Cf(this))};function Cu(a){a.A!=null&&(u.clearTimeout(a.A),a.A=null)}function Cf(a){a.g=new Wt(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var l=At(a.qa);fe(l,"RID","rpc"),fe(l,"SID",a.K),fe(l,"AID",a.T),fe(l,"CI",a.F?"0":"1"),!a.F&&a.ja&&fe(l,"TO",a.ja),fe(l,"TYPE","xmlhttp"),vi(a,l),a.m&&a.o&&Du(l,a.m,a.o),a.L&&(a.g.I=a.L);var h=a.g;a=a.ia,h.L=1,h.v=$s(At(l)),h.m=null,h.P=!0,ef(h,a)}n.Za=function(){this.C!=null&&(this.C=null,Gs(this),Au(this),ze(19))};function Ws(a){a.C!=null&&(u.clearTimeout(a.C),a.C=null)}function Rf(a,l){var h=null;if(a.g==l){Ws(a),Cu(a),a.g=null;var m=2}else if(Su(a.h,l))h=l.D,af(a.h,l),m=1;else return;if(a.G!=0){if(l.o)if(m==1){h=l.m?l.m.length:0,l=Date.now()-l.F;var D=a.B;m=Fs(),$e(m,new Qd(m,h)),Hs(a)}else Af(a);else if(D=l.s,D==3||D==0&&0<l.X||!(m==1&&x0(a,l)||m==2&&Au(a)))switch(h&&0<h.length&&(l=a.h,l.i=l.i.concat(h)),D){case 1:_n(a,5);break;case 4:_n(a,10);break;case 3:_n(a,6);break;default:_n(a,2)}}}function xf(a,l){let h=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(h*=2),h*l}function _n(a,l){if(a.j.info("Error code "+l),l==2){var h=w(a.fb,a),m=a.Xa;let D=!m;m=new vn(m||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Bs(m,"https"),$s(m),D?S0(m.toString(),h):I0(m.toString(),h)}else ze(2);a.G=0,a.l&&a.l.sa(l),Pf(a),If(a)}n.fb=function(a){a?(this.j.info("Successfully pinged google.com"),ze(2)):(this.j.info("Failed to ping google.com"),ze(1))};function Pf(a){if(a.G=0,a.ka=[],a.l){let l=uf(a.h);(l.length!=0||a.i.length!=0)&&(M(a.ka,l),M(a.ka,a.i),a.h.i.length=0,B(a.i),a.i.length=0),a.l.ra()}}function Nf(a,l,h){var m=h instanceof vn?At(h):new vn(h);if(m.g!="")l&&(m.g=l+"."+m.g),js(m,m.s);else{var D=u.location;m=D.protocol,l=l?l+"."+D.hostname:D.hostname,D=+D.port;var A=new vn(null);m&&Bs(A,m),l&&(A.g=l),D&&js(A,D),h&&(A.l=h),m=A}return h=a.D,l=a.ya,h&&l&&fe(m,h,l),fe(m,"VER",a.la),vi(a,m),m}function Of(a,l,h){if(l&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return l=a.Ca&&!a.pa?new _e(new pi({eb:h})):new _e(a.pa),l.Ha(a.J),l}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function kf(){}n=kf.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ks(){}Ks.prototype.g=function(a,l){return new We(a,l)};function We(a,l){Me.call(this),this.g=new Sf(l),this.l=a,this.h=l&&l.messageUrlParams||null,a=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(a?a["X-WebChannel-Content-Type"]=l.messageContentType:a={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.va&&(a?a["X-WebChannel-Client-Profile"]=l.va:a={"X-WebChannel-Client-Profile":l.va}),this.g.S=a,(a=l&&l.Sb)&&!X(a)&&(this.g.m=a),this.v=l&&l.supportsCrossDomainXhr||!1,this.u=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!X(l)&&(this.g.D=l,a=this.h,a!==null&&l in a&&(a=this.h,l in a&&delete a[l])),this.j=new Wn(this)}N(We,Me),We.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},We.prototype.close=function(){Tu(this.g)},We.prototype.o=function(a){var l=this.g;if(typeof a=="string"){var h={};h.__data__=a,a=h}else this.u&&(h={},h.__data__=pu(a),a=h);l.i.push(new f0(l.Ya++,a)),l.G==3&&Hs(l)},We.prototype.N=function(){this.g.l=null,delete this.j,Tu(this.g),delete this.g,We.aa.N.call(this)};function Mf(a){gu.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var l=a.__sm__;if(l){e:{for(let h in l){a=h;break e}a=void 0}(this.i=a)&&(a=this.i,l=l!==null&&a in l?l[a]:void 0),this.data=l}else this.data=a}N(Mf,gu);function Ff(){yu.call(this),this.status=1}N(Ff,yu);function Wn(a){this.g=a}N(Wn,kf),Wn.prototype.ua=function(){$e(this.g,"a")},Wn.prototype.ta=function(a){$e(this.g,new Mf(a))},Wn.prototype.sa=function(a){$e(this.g,new Ff)},Wn.prototype.ra=function(){$e(this.g,"b")},Ks.prototype.createWebChannel=Ks.prototype.g,We.prototype.send=We.prototype.o,We.prototype.open=We.prototype.m,We.prototype.close=We.prototype.close,Sl=Bt.createWebChannelTransport=function(){return new Ks},bl=Bt.getStatEventTarget=function(){return Fs()},El=Bt.Event=gn,da=Bt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ls.NO_ERROR=0,Ls.TIMEOUT=8,Ls.HTTP_ERROR=6,os=Bt.ErrorCode=Ls,Yd.COMPLETE="complete",wl=Bt.EventType=Yd,Hd.EventType=oi,oi.OPEN="a",oi.CLOSE="b",oi.ERROR="c",oi.MESSAGE="d",Me.prototype.listen=Me.prototype.K,Ar=Bt.WebChannel=Hd,qD=Bt.FetchXmlHttpFactory=pi,_e.prototype.listenOnce=_e.prototype.L,_e.prototype.getLastError=_e.prototype.Ka,_e.prototype.getLastErrorCode=_e.prototype.Ba,_e.prototype.getStatus=_e.prototype.Z,_e.prototype.getResponseJson=_e.prototype.Oa,_e.prototype.getResponseText=_e.prototype.oa,_e.prototype.send=_e.prototype.ea,_e.prototype.setWithCredentials=_e.prototype.Ha,_l=Bt.XhrIo=_e}).apply(typeof ha<"u"?ha:typeof self<"u"?self:typeof window<"u"?window:{});var Dy="@firebase/firestore",Ty="4.8.0";var Ce=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ce.UNAUTHENTICATED=new Ce(null),Ce.GOOGLE_CREDENTIALS=new Ce("google-credentials-uid"),Ce.FIRST_PARTY=new Ce("first-party-uid"),Ce.MOCK_USER=new Ce("mock-user");var Zr="11.10.0";var Bn=new Tr("@firebase/firestore");function Cr(){return Bn.logLevel}function U(n,...e){if(Bn.logLevel<=se.DEBUG){let t=e.map(ud);Bn.debug(`Firestore (${Zr}): ${n}`,...t)}}function $t(n,...e){if(Bn.logLevel<=se.ERROR){let t=e.map(ud);Bn.error(`Firestore (${Zr}): ${n}`,...t)}}function dn(n,...e){if(Bn.logLevel<=se.WARN){let t=e.map(ud);Bn.warn(`Firestore (${Zr}): ${n}`,...t)}}function ud(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function H(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,_v(n,r,t)}function _v(n,e,t){let r=`FIRESTORE (${Zr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw $t(r),new Error(r)}function ve(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||_v(e,i,r)}function ae(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},L=class extends ct{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var bt=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var va=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Rl=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ce.UNAUTHENTICATED))}shutdown(){}},xl=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Pl=class{constructor(e){this.t=e,this.currentUser=Ce.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ve(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new bt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new bt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?u(c):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new bt)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve(typeof r.accessToken=="string",31837,{l:r}),new va(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ve(e===null||typeof e=="string",2055,{h:e}),new Ce(e)}},Nl=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ce.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},Ol=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new Nl(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Ce.FIRST_PARTY))}shutdown(){}invalidateToken(){}},_a=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},kl=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,la(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ve(this.o===void 0,3512);let r=s=>{s.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new _a(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ve(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new _a(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function GD(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function wv(){return new TextEncoder}var fs=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=GD(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function J(n,e){return n<e?-1:n>e?1:0}function Ml(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return J(r,i);{let s=wv(),o=HD(s.encode(Ay(n,t)),s.encode(Ay(e,t)));return o!==0?o:J(r,i)}}t+=r>65535?2:1}return J(n.length,e.length)}function Ay(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function HD(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return J(n[t],e[t]);return J(n.length,e.length)}function Fr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Cy="__name__",wa=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&H(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&H(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return J(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Ml(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ut.fromString(e.substring(4,e.length-2))}},ye=class n extends wa{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new L(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},WD=/^[_a-zA-Z][_a-zA-Z0-9]*$/,tt=class n extends wa{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return WD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Cy}static keyField(){return new n([Cy])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new L(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new L(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new L(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(o=!o,i++):u!=="."||o?(r+=u,i++):(s(),i++)}if(s(),o)throw new L(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var $=class n{constructor(e){this.path=e}static fromPath(e){return new n(ye.fromString(e))}static fromName(e){return new n(ye.fromString(e).popFirst(5))}static empty(){return new n(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ye(e.slice()))}};function Ev(n,e,t){if(!t)throw new L(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function KD(n,e,t,r){if(e===!0&&r===!0)throw new L(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Ry(n){if(!$.isDocumentKey(n))throw new L(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function xy(n){if($.isDocumentKey(n))throw new L(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function bv(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Wa(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":H(12329,{type:typeof n})}function an(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new L(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Wa(n);throw new L(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function De(n,e){let t={typeString:n};return e&&(t.value=e),t}function xs(n,e){if(!bv(n))throw new L(P.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new L(P.INVALID_ARGUMENT,t);return!0}var Py=-62135596800,Ny=1e6,Te=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Ny);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new L(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Py)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new L(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Ny}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(xs(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-Py;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Te._jsonSchemaVersion="firestore/timestamp/1.0",Te._jsonSchema={type:De("string",Te._jsonSchemaVersion),seconds:De("number"),nanoseconds:De("number")};var Z=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Te(0,0))}static max(){return new n(new Te(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ps=-1,Fl=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Fl.UNKNOWN_ID=-1;function ZD(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Z.fromTimestamp(r===1e9?new Te(t+1,0):new Te(t,r));return new jn(i,$.empty(),e)}function QD(n){return new jn(n.readTime,n.key,ps)}var jn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Z.min(),$.empty(),ps)}static max(){return new n(Z.max(),$.empty(),ps)}};function YD(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=$.comparator(n.documentKey,e.documentKey),t!==0?t:J(n.largestBatchId,e.largestBatchId))}var XD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ll=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Ka(n){if(n.code!==P.FAILED_PRECONDITION||n.message!==XD)throw n;U("LocalStore","Unexpectedly lost primary lease")}var R=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&H(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(u=>{++i,u.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),u=0;for(let c=0;c<s;c++){let d=c;t(e[d]).next(p=>{o[d]=p,++u,u===s&&r(o)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function JD(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Qr(n){return n.name==="IndexedDbTransactionError"}var cd=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),eT=-1;function Za(n){return n==null}function ms(n){return n===0&&1/n==-1/0}function tT(n){return typeof n=="number"&&Number.isInteger(n)&&!ms(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Sv="";function nT(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Oy(e)),e=rT(n.get(t),e);return Oy(e)}function rT(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case Sv:t+="";break;default:t+=s}}return t}function Oy(n){return n+Sv+""}var iT="remoteDocuments",Iv="owner";var Dv="mutationQueues";var Tv="mutations";var Av="documentMutations",sT="remoteDocumentsV14";var Cv="remoteDocumentGlobal";var Rv="targets";var xv="targetDocuments";var Pv="targetGlobal",Nv="collectionParents";var Ov="clientMetadata";var kv="bundles";var Mv="namedQueries";var oT="indexConfiguration";var aT="indexState";var uT="indexEntries";var Fv="documentOverlays";var cT="globals";var lT=[Dv,Tv,Av,iT,Rv,Iv,Pv,xv,Ov,Cv,Nv,kv,Mv],BO=[...lT,Fv],hT=[Dv,Tv,Av,sT,Rv,Iv,Pv,xv,Ov,Cv,Nv,kv,Mv,Fv],dT=hT,fT=[...dT,oT,aT,uT];var jO=[...fT,cT];function ky(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Yr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Lv(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ee=class n{constructor(e,t){this.comparator=e,this.root=t||St.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,St.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,St.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Nr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Nr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Nr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Nr(this.root,e,this.comparator,!0)}},Nr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},St=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw H(43730,{key:this.key,value:this.value});if(this.right.isRed())throw H(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw H(27949);return e+(this.isRed()?0:1)}};St.EMPTY=null,St.RED=!0,St.BLACK=!1;St.EMPTY=new class{constructor(){this.size=0}get key(){throw H(57766)}get value(){throw H(16141)}get color(){throw H(16727)}get left(){throw H(29726)}get right(){throw H(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new St(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Re=class n{constructor(e){this.comparator=e,this.data=new Ee(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ea(this.data.getIterator())}getIteratorFrom(e){return new Ea(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Ea=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var kn=class n{constructor(e){this.fields=e,e.sort(tt.comparator)}static empty(){return new n([])}unionWith(e){let t=new Re(tt.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Fr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var ba=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var je=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ba("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};je.EMPTY_BYTE_STRING=new je("");var pT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zt(n){if(ve(!!n,39018),typeof n=="string"){let e=0,t=pT.exec(n);if(ve(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ge(n.seconds),nanos:ge(n.nanos)}}function ge(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function qt(n){return typeof n=="string"?je.fromBase64String(n):je.fromUint8Array(n)}var Vv="server_timestamp",Uv="__type__",Bv="__previous_value__",jv="__local_write_time__";function ld(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Uv])===null||t===void 0?void 0:t.stringValue)===Vv}function Qa(n){let e=n.mapValue.fields[Bv];return ld(e)?Qa(e):e}function gs(n){let e=zt(n.mapValue.fields[jv].timestampValue);return new Te(e.seconds,e.nanos)}var Vl=class{constructor(e,t,r,i,s,o,u,c,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=p}},Sa="(default)",Ia=class n{constructor(e,t){this.projectId=e,this.database=t||Sa}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Sa}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var hd="__type__",$v="__max__",fa={mapValue:{fields:{__type__:{stringValue:$v}}}},dd="__vector__",Lr="value";function fn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?ld(n)?4:qv(n)?9007199254740991:zv(n)?10:11:H(28295,{value:n})}function Dt(n,e){if(n===e)return!0;let t=fn(n);if(t!==fn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return gs(n).isEqual(gs(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=zt(i.timestampValue),u=zt(s.timestampValue);return o.seconds===u.seconds&&o.nanos===u.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return qt(i.bytesValue).isEqual(qt(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return ge(i.geoPointValue.latitude)===ge(s.geoPointValue.latitude)&&ge(i.geoPointValue.longitude)===ge(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return ge(i.integerValue)===ge(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=ge(i.doubleValue),u=ge(s.doubleValue);return o===u?ms(o)===ms(u):isNaN(o)&&isNaN(u)}return!1})(n,e);case 9:return Fr(n.arrayValue.values||[],e.arrayValue.values||[],Dt);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},u=s.mapValue.fields||{};if(ky(o)!==ky(u))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(u[c]===void 0||!Dt(o[c],u[c])))return!1;return!0})(n,e);default:return H(52216,{left:n})}}function ys(n,e){return(n.values||[]).find(t=>Dt(t,e))!==void 0}function Vr(n,e){if(n===e)return 0;let t=fn(n),r=fn(e);if(t!==r)return J(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return J(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let u=ge(s.integerValue||s.doubleValue),c=ge(o.integerValue||o.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1})(n,e);case 3:return My(n.timestampValue,e.timestampValue);case 4:return My(gs(n),gs(e));case 5:return Ml(n.stringValue,e.stringValue);case 6:return(function(s,o){let u=qt(s),c=qt(o);return u.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let u=s.split("/"),c=o.split("/");for(let d=0;d<u.length&&d<c.length;d++){let p=J(u[d],c[d]);if(p!==0)return p}return J(u.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let u=J(ge(s.latitude),ge(o.latitude));return u!==0?u:J(ge(s.longitude),ge(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Fy(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var u,c,d,p;let g=s.fields||{},w=o.fields||{},C=(u=g[Lr])===null||u===void 0?void 0:u.arrayValue,N=(c=w[Lr])===null||c===void 0?void 0:c.arrayValue,B=J(((d=C?.values)===null||d===void 0?void 0:d.length)||0,((p=N?.values)===null||p===void 0?void 0:p.length)||0);return B!==0?B:Fy(C,N)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===fa.mapValue&&o===fa.mapValue)return 0;if(s===fa.mapValue)return 1;if(o===fa.mapValue)return-1;let u=s.fields||{},c=Object.keys(u),d=o.fields||{},p=Object.keys(d);c.sort(),p.sort();for(let g=0;g<c.length&&g<p.length;++g){let w=Ml(c[g],p[g]);if(w!==0)return w;let C=Vr(u[c[g]],d[p[g]]);if(C!==0)return C}return J(c.length,p.length)})(n.mapValue,e.mapValue);default:throw H(23264,{le:t})}}function My(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return J(n,e);let t=zt(n),r=zt(e),i=J(t.seconds,r.seconds);return i!==0?i:J(t.nanos,r.nanos)}function Fy(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Vr(t[i],r[i]);if(s)return s}return J(t.length,r.length)}function Ur(n){return Ul(n)}function Ul(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=zt(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return qt(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return $.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Ul(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Ul(t.fields[o])}`;return i+"}"})(n.mapValue):H(61005,{value:n})}function ga(n){switch(fn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Qa(n);return e?16+ga(e):16;case 5:return 2*n.stringValue.length;case 6:return qt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+ga(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return Yr(r.fields,(s,o)=>{i+=s.length+ga(o)}),i})(n.mapValue);default:throw H(13486,{value:n})}}function Ly(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Bl(n){return!!n&&"integerValue"in n}function fd(n){return!!n&&"arrayValue"in n}function Vy(n){return!!n&&"nullValue"in n}function Uy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Il(n){return!!n&&"mapValue"in n}function zv(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[hd])===null||t===void 0?void 0:t.stringValue)===dd}function us(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Yr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=us(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=us(n.arrayValue.values[t]);return e}return Object.assign({},n)}function qv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===$v}var zO={mapValue:{fields:{[hd]:{stringValue:dd},[Lr]:{arrayValue:{}}}}};var jt=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Il(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=us(t)}setAll(e){let t=tt.emptyPath(),r={},i=[];e.forEach((o,u)=>{if(!t.isImmediateParentOf(u)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=u.popLast()}o?r[u.lastSegment()]=us(o):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Il(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Dt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Il(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Yr(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(us(this.value))}};var ft=class n{constructor(e,t,r,i,s,o,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=u}static newInvalidDocument(e){return new n(e,0,Z.min(),Z.min(),Z.min(),jt.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Z.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Z.min(),Z.min(),jt.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Z.min(),Z.min(),jt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Z.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Z.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Br=class{constructor(e,t){this.position=e,this.inclusive=t}};function By(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=$.comparator($.fromName(o.referenceValue),t.key):r=Vr(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function jy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Dt(n.position[t],e.position[t]))return!1;return!0}var jr=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function mT(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Da=class{},Ie=class n extends Da{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new $l(e,t,r):t==="array-contains"?new Gl(e,r):t==="in"?new Hl(e,r):t==="not-in"?new Wl(e,r):t==="array-contains-any"?new Kl(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new zl(e,r):new ql(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Vr(t,this.value)):t!==null&&fn(this.value)===fn(t)&&this.matchesComparison(Vr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return H(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},pt=class n extends Da{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return Gv(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function Gv(n){return n.op==="and"}function Hv(n){return gT(n)&&Gv(n)}function gT(n){for(let e of n.filters)if(e instanceof pt)return!1;return!0}function jl(n){if(n instanceof Ie)return n.field.canonicalString()+n.op.toString()+Ur(n.value);if(Hv(n))return n.filters.map(e=>jl(e)).join(",");{let e=n.filters.map(t=>jl(t)).join(",");return`${n.op}(${e})`}}function Wv(n,e){return n instanceof Ie?(function(r,i){return i instanceof Ie&&r.op===i.op&&r.field.isEqual(i.field)&&Dt(r.value,i.value)})(n,e):n instanceof pt?(function(r,i){return i instanceof pt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,u)=>s&&Wv(o,i.filters[u]),!0):!1})(n,e):void H(19439)}function Kv(n){return n instanceof Ie?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ur(t.value)}`})(n):n instanceof pt?(function(t){return t.op.toString()+" {"+t.getFilters().map(Kv).join(" ,")+"}"})(n):"Filter"}var $l=class extends Ie{constructor(e,t,r){super(e,t,r),this.key=$.fromName(r.referenceValue)}matches(e){let t=$.comparator(e.key,this.key);return this.matchesComparison(t)}},zl=class extends Ie{constructor(e,t){super(e,"in",t),this.keys=Zv("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ql=class extends Ie{constructor(e,t){super(e,"not-in",t),this.keys=Zv("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Zv(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>$.fromName(r.referenceValue))}var Gl=class extends Ie{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return fd(t)&&ys(t.arrayValue,this.value)}},Hl=class extends Ie{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&ys(this.value.arrayValue,t)}},Wl=class extends Ie{constructor(e,t){super(e,"not-in",t)}matches(e){if(ys(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!ys(this.value.arrayValue,t)}},Kl=class extends Ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!fd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ys(this.value.arrayValue,r))}};var Zl=class{constructor(e,t=null,r=[],i=[],s=null,o=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=u,this.Pe=null}};function $y(n,e=null,t=[],r=[],i=null,s=null,o=null){return new Zl(n,e,t,r,i,s,o)}function pd(n){let e=ae(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>jl(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),Za(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ur(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ur(r)).join(",")),e.Pe=t}return e.Pe}function md(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!mT(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Wv(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!jy(n.startAt,e.startAt)&&jy(n.endAt,e.endAt)}function Ql(n){return $.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var $n=class{constructor(e,t=null,r=[],i=[],s=null,o="F",u=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=u,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function yT(n,e,t,r,i,s,o,u){return new $n(n,e,t,r,i,s,o,u)}function Ya(n){return new $n(n)}function zy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Qv(n){return n.collectionGroup!==null}function cs(n){let e=ae(n);if(e.Te===null){e.Te=[];let t=new Set;for(let s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let u=new Re(tt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new jr(s,r))}),t.has(tt.keyField().canonicalString())||e.Te.push(new jr(tt.keyField(),r))}return e.Te}function It(n){let e=ae(n);return e.Ie||(e.Ie=vT(e,cs(n))),e.Ie}function vT(n,e){if(n.limitType==="F")return $y(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new jr(i.field,s)});let t=n.endAt?new Br(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Br(n.startAt.position,n.startAt.inclusive):null;return $y(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Yl(n,e){let t=n.filters.concat([e]);return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Xl(n,e,t){return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Xa(n,e){return md(It(n),It(e))&&n.limitType===e.limitType}function Yv(n){return`${pd(It(n))}|lt:${n.limitType}`}function Rr(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Kv(i)).join(", ")}]`),Za(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Ur(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Ur(i)).join(",")),`Target(${r})`})(It(n))}; limitType=${n.limitType})`}function Ja(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):$.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of cs(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,u,c){let d=By(o,u,c);return o.inclusive?d<=0:d<0})(r.startAt,cs(r),i)||r.endAt&&!(function(o,u,c){let d=By(o,u,c);return o.inclusive?d>=0:d>0})(r.endAt,cs(r),i))})(n,e)}function _T(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Xv(n){return(e,t)=>{let r=!1;for(let i of cs(n)){let s=wT(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function wT(n,e,t){let r=n.field.isKeyField()?$.comparator(e.key,t.key):(function(s,o,u){let c=o.data.field(s),d=u.data.field(s);return c!==null&&d!==null?Vr(c,d):H(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return H(19790,{direction:n.dir})}}var Gt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Yr(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Lv(this.inner)}size(){return this.innerSize}};var ET=new Ee($.comparator);function pn(){return ET}var Jv=new Ee($.comparator);function as(...n){let e=Jv;for(let t of n)e=e.insert(t.key,t);return e}function bT(n){let e=Jv;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Mn(){return ls()}function e_(){return ls()}function ls(){return new Gt(n=>n.toString(),(n,e)=>n.isEqual(e))}var qO=new Ee($.comparator),ST=new Re($.comparator);function ue(...n){let e=ST;for(let t of n)e=e.add(t);return e}var IT=new Re(J);function DT(){return IT}function gd(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ms(e)?"-0":e}}function t_(n){return{integerValue:""+n}}function TT(n,e){return tT(e)?t_(e):gd(n,e)}var $r=class{constructor(){this._=void 0}};function AT(n,e,t){return n instanceof vs?(function(i,s){let o={fields:{[Uv]:{stringValue:Vv},[jv]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ld(s)&&(s=Qa(s)),s&&(o.fields[Bv]=s),{mapValue:o}})(t,e):n instanceof zr?n_(n,e):n instanceof qr?r_(n,e):(function(i,s){let o=RT(i,s),u=qy(o)+qy(i.Ee);return Bl(o)&&Bl(i.Ee)?t_(u):gd(i.serializer,u)})(n,e)}function CT(n,e,t){return n instanceof zr?n_(n,e):n instanceof qr?r_(n,e):t}function RT(n,e){return n instanceof _s?(function(r){return Bl(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var vs=class extends $r{},zr=class extends $r{constructor(e){super(),this.elements=e}};function n_(n,e){let t=i_(e);for(let r of n.elements)t.some(i=>Dt(i,r))||t.push(r);return{arrayValue:{values:t}}}var qr=class extends $r{constructor(e){super(),this.elements=e}};function r_(n,e){let t=i_(e);for(let r of n.elements)t=t.filter(i=>!Dt(i,r));return{arrayValue:{values:t}}}var _s=class extends $r{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function qy(n){return ge(n.integerValue||n.doubleValue)}function i_(n){return fd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function xT(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof zr&&i instanceof zr||r instanceof qr&&i instanceof qr?Fr(r.elements,i.elements,Dt):r instanceof _s&&i instanceof _s?Dt(r.Ee,i.Ee):r instanceof vs&&i instanceof vs})(n.transform,e.transform)}var hs=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ya(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var ws=class{};function s_(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Jl(n.key,hs.none()):new Es(n.key,n.data,hs.none());{let t=n.data,r=jt.empty(),i=new Re(tt.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Gr(n.key,r,new kn(i.toArray()),hs.none())}}function PT(n,e,t){n instanceof Es?(function(i,s,o){let u=i.value.clone(),c=Hy(i.fieldTransforms,s,o.transformResults);u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):n instanceof Gr?(function(i,s,o){if(!ya(i.precondition,s))return void s.convertToUnknownDocument(o.version);let u=Hy(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(o_(i)),c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function ds(n,e,t,r){return n instanceof Es?(function(s,o,u,c){if(!ya(s.precondition,o))return u;let d=s.value.clone(),p=Wy(s.fieldTransforms,c,o);return d.setAll(p),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Gr?(function(s,o,u,c){if(!ya(s.precondition,o))return u;let d=Wy(s.fieldTransforms,c,o),p=o.data;return p.setAll(o_(s)),p.setAll(d),o.convertToFoundDocument(o.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(g=>g.field))})(n,e,t,r):(function(s,o,u){return ya(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):u})(n,e,t)}function Gy(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Fr(r,i,(s,o)=>xT(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Es=class extends ws{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Gr=class extends ws{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function o_(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Hy(n,e,t){let r=new Map;ve(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,u=e.data.field(s.field);r.set(s.field,CT(o,u,t[i]))}return r}function Wy(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,AT(s,o,e))}return r}var Jl=class extends ws{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};var eh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&PT(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ds(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ds(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=e_();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,u=this.applyToLocalView(o,s.mutatedFields);u=t.has(i.key)?null:u;let c=s_(o,u);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Z.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ue())}isEqual(e){return this.batchId===e.batchId&&Fr(this.mutations,e.mutations,(t,r)=>Gy(t,r))&&Fr(this.baseMutations,e.baseMutations,(t,r)=>Gy(t,r))}};var th=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var nh=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var be,oe;function a_(n){if(n===void 0)return $t("GRPC error has no .code"),P.UNKNOWN;switch(n){case be.OK:return P.OK;case be.CANCELLED:return P.CANCELLED;case be.UNKNOWN:return P.UNKNOWN;case be.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case be.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case be.INTERNAL:return P.INTERNAL;case be.UNAVAILABLE:return P.UNAVAILABLE;case be.UNAUTHENTICATED:return P.UNAUTHENTICATED;case be.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case be.NOT_FOUND:return P.NOT_FOUND;case be.ALREADY_EXISTS:return P.ALREADY_EXISTS;case be.PERMISSION_DENIED:return P.PERMISSION_DENIED;case be.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case be.ABORTED:return P.ABORTED;case be.OUT_OF_RANGE:return P.OUT_OF_RANGE;case be.UNIMPLEMENTED:return P.UNIMPLEMENTED;case be.DATA_LOSS:return P.DATA_LOSS;default:return H(39323,{code:n})}}(oe=be||(be={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";var Ky=null;var NT=new Ut([4294967295,4294967295],0);function Zy(n){let e=wv().encode(n),t=new vl;return t.update(e),new Uint8Array(t.digest())}function Qy(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ut([t,r],0),new Ut([i,s],0)]}var rh=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Fn(`Invalid padding: ${t}`);if(r<0)throw new Fn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Fn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Fn(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Ut.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Ut.fromNumber(r)));return i.compare(NT)===1&&(i=new Ut([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=Zy(e),[r,i]=Qy(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(u=>o.insert(u)),o}insert(e){if(this.fe===0)return;let t=Zy(e),[r,i]=Qy(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);this.we(o)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Fn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ta=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,bs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(Z.min(),i,new Ee(J),pn(),ue())}},bs=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,ue(),ue(),ue())}};var Or=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},Aa=class{constructor(e,t){this.targetId=e,this.De=t}},Ca=class{constructor(e,t,r=je.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Ra=class{constructor(){this.ve=0,this.Ce=Yy(),this.Fe=je.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ue(),t=ue(),r=ue();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:H(38017,{changeType:s})}}),new bs(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=Yy()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ve(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},ih=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=pn(),this.je=pa(),this.Je=pa(),this.He=new Ee(J)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:H(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let s=i.target;if(Ql(s))if(r===0){let o=new $(s.path);this.Xe(t,o,ft.newNoDocument(o,Z.min()))}else ve(r===1,20013,{expectedCount:r});else{let o=this.ot(t);if(o!==r){let u=this._t(e),c=u?this.ut(u,e,o):1;if(c!==0){this.rt(t);let d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,d)}Ky?.ct((function(p,g,w,C,N){var B,M,ne,X,ie,me;let Ye={localCacheCount:p,existenceFilterCount:g.count,databaseId:w.database,projectId:w.projectId},de=g.unchangedNames;return de&&(Ye.bloomFilter={applied:N===0,hashCount:(B=de?.hashCount)!==null&&B!==void 0?B:0,bitmapLength:(X=(ne=(M=de?.bits)===null||M===void 0?void 0:M.bitmap)===null||ne===void 0?void 0:ne.length)!==null&&X!==void 0?X:0,padding:(me=(ie=de?.bits)===null||ie===void 0?void 0:ie.padding)!==null&&me!==void 0?me:0,mightContain:I=>{var y;return(y=C?.mightContain(I))!==null&&y!==void 0&&y}}),Ye})(o,e.De,this.We.lt(),u,c))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,u;try{o=qt(r).toUint8Array()}catch(c){if(c instanceof ba)return dn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new rh(o,i,s)}catch(c){return dn(c instanceof Fn?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.fe===0?null:u}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.We.lt(),u=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Xe(t,s,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((s,o)=>{let u=this.st(o);if(u){if(s.current&&Ql(u.target)){let c=new $(u.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,ft.newNoDocument(c,e))}s.Ne&&(t.set(o,s.Le()),s.ke())}});let r=ue();this.Je.forEach((s,o)=>{let u=!0;o.forEachWhile(c=>{let d=this.st(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(e));let i=new Ta(e,t,this.He,this.ze,r);return this.ze=pn(),this.je=pa(),this.Je=pa(),this.He=new Ee(J),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Ra,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Re(J),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Re(J),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||U("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Ra),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function pa(){return new Ee($.comparator)}function Yy(){return new Ee($.comparator)}var OT={asc:"ASCENDING",desc:"DESCENDING"},kT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},MT={and:"AND",or:"OR"},sh=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function oh(n,e){return n.useProto3Json||Za(e)?e:{value:e}}function ah(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function u_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function kr(n){return ve(!!n,49232),Z.fromTimestamp((function(t){let r=zt(t);return new Te(r.seconds,r.nanos)})(n))}function c_(n,e){return uh(n,e).canonicalString()}function uh(n,e){let t=(function(i){return new ye(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function l_(n){let e=ye.fromString(n);return ve(m_(e),10190,{key:e.toString()}),e}function Dl(n,e){let t=l_(e);if(t.get(1)!==n.databaseId.projectId)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new L(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new $(d_(t))}function h_(n,e){return c_(n.databaseId,e)}function FT(n){let e=l_(n);return e.length===4?ye.emptyPath():d_(e)}function Xy(n){return new ye(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function d_(n){return ve(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function LT(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:H(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,p){return d.useProto3Json?(ve(p===void 0||typeof p=="string",58123),je.fromBase64String(p||"")):(ve(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),je.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,u=o&&(function(d){let p=d.code===void 0?P.UNKNOWN:a_(d.code);return new L(p,d.message||"")})(o);t=new Ca(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Dl(n,r.document.name),s=kr(r.document.updateTime),o=r.document.createTime?kr(r.document.createTime):Z.min(),u=new jt({mapValue:{fields:r.document.fields}}),c=ft.newFoundDocument(i,s,o,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Or(d,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Dl(n,r.document),s=r.readTime?kr(r.readTime):Z.min(),o=ft.newNoDocument(i,s),u=r.removedTargetIds||[];t=new Or([],u,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Dl(n,r.document),s=r.removedTargetIds||[];t=new Or([],s,i,null)}else{if(!("filter"in e))return H(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new nh(i,s),u=r.targetId;t=new Aa(u,o)}}return t}function VT(n,e){return{documents:[h_(n,e.path)]}}function UT(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=h_(n,i);let s=(function(d){if(d.length!==0)return p_(pt.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(d){if(d.length!==0)return d.map(p=>(function(w){return{field:xr(w.field),direction:$T(w.dir)}})(p))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let u=oh(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{Vt:t,parent:i}}function BT(n){let e=FT(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ve(r===1,65062);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=(function(g){let w=f_(g);return w instanceof pt&&Hv(w)?w.getFilters():[w]})(t.where));let o=[];t.orderBy&&(o=(function(g){return g.map(w=>(function(N){return new jr(Pr(N.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(N.direction))})(w))})(t.orderBy));let u=null;t.limit&&(u=(function(g){let w;return w=typeof g=="object"?g.value:g,Za(w)?null:w})(t.limit));let c=null;t.startAt&&(c=(function(g){let w=!!g.before,C=g.values||[];return new Br(C,w)})(t.startAt));let d=null;return t.endAt&&(d=(function(g){let w=!g.before,C=g.values||[];return new Br(C,w)})(t.endAt)),yT(e,i,o,s,u,"F",c,d)}function jT(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return H(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function f_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Pr(t.unaryFilter.field);return Ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Pr(t.unaryFilter.field);return Ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Pr(t.unaryFilter.field);return Ie.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Pr(t.unaryFilter.field);return Ie.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return H(61313);default:return H(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ie.create(Pr(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return H(58110);default:return H(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return pt.create(t.compositeFilter.filters.map(r=>f_(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return H(1026)}})(t.compositeFilter.op))})(n):H(30097,{filter:n})}function $T(n){return OT[n]}function zT(n){return kT[n]}function qT(n){return MT[n]}function xr(n){return{fieldPath:n.canonicalString()}}function Pr(n){return tt.fromServerFormat(n.fieldPath)}function p_(n){return n instanceof Ie?(function(t){if(t.op==="=="){if(Uy(t.value))return{unaryFilter:{field:xr(t.field),op:"IS_NAN"}};if(Vy(t.value))return{unaryFilter:{field:xr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Uy(t.value))return{unaryFilter:{field:xr(t.field),op:"IS_NOT_NAN"}};if(Vy(t.value))return{unaryFilter:{field:xr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:xr(t.field),op:zT(t.op),value:t.value}}})(n):n instanceof pt?(function(t){let r=t.getFilters().map(i=>p_(i));return r.length===1?r[0]:{compositeFilter:{op:qT(t.op),filters:r}}})(n):H(54877,{filter:n})}function m_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ss=class n{constructor(e,t,r,i,s=Z.min(),o=Z.min(),u=je.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var ch=class{constructor(e){this.gt=e}};function GT(n){let e=BT({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xl(e,e.limit,"L"):e}var xa=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(ge(e.integerValue));else if("doubleValue"in e){let r=ge(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),ms(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=zt(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(qt(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?qv(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):zv(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):H(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let s=e.fields||{};this.Ct(t,53);let o=Lr,u=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(ge(u)),this.xt(o,t),this.Dt(s[o],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),$.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};xa.Ut=new xa;var lh=class{constructor(){this.Dn=new hh}addToCollectionParentIndex(e,t){return this.Dn.add(t),R.resolve()}getCollectionParents(e,t){return R.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return R.resolve()}deleteFieldIndex(e,t){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,t){return R.resolve()}getDocumentsMatchingTarget(e,t){return R.resolve(null)}getIndexType(e,t){return R.resolve(0)}getFieldIndexes(e,t){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,t){return R.resolve(jn.min())}getMinOffsetFromCollectionGroup(e,t){return R.resolve(jn.min())}updateCollectionGroup(e,t,r){return R.resolve()}updateIndexEntries(e,t){return R.resolve()}},hh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Re(ye.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(ye.comparator)).toArray()}};var GO=new Uint8Array(0);var Jy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},g_=41943040,et=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};et.DEFAULT_COLLECTION_PERCENTILE=10,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,et.DEFAULT=new et(g_,et.DEFAULT_COLLECTION_PERCENTILE,et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),et.DISABLED=new et(-1,0,0);var Is=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var ev="LruGarbageCollector",HT=1048576;function tv([n,e],[t,r]){let i=J(n,t);return i===0?J(e,r):i}var dh=class{constructor(e){this.Tr=e,this.buffer=new Re(tv),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();tv(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},fh=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){U(ev,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Qr(t)?U(ev,"Ignoring IndexedDB error during garbage collection: ",t):await Ka(t)}await this.Rr(3e5)})}},ph=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return R.resolve(cd.ue);let r=new dh(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(Jy)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Jy):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,s,o,u,c,d,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(r=g,u=Date.now(),this.removeTargets(e,r,t))).next(g=>(s=g,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(g=>(d=Date.now(),Cr()<=se.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-p}ms
	Determined least recently used ${i} in `+(u-o)+`ms
	Removed ${s} targets in `+(c-u)+`ms
	Removed ${g} documents in `+(d-c)+`ms
Total Duration: ${d-p}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:g})))}};function WT(n,e){return new ph(n,e)}var mh=class{constructor(){this.changes=new Gt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ft.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?R.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var gh=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var yh=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ds(r.mutation,i,kn.empty(),Te.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ue()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ue()){let i=Mn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=as();return s.forEach((u,c)=>{o=o.insert(u,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Mn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ue()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,u)=>{t.set(o,u)})})}computeViews(e,t,r,i){let s=pn(),o=ls(),u=(function(){return ls()})();return t.forEach((c,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Gr)?s=s.insert(d.key,d):p!==void 0?(o.set(d.key,p.mutation.getFieldMask()),ds(p.mutation,d,p.mutation.getFieldMask(),Te.now())):o.set(d.key,kn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,p)=>o.set(d,p)),t.forEach((d,p)=>{var g;return u.set(d,new gh(p,(g=o.get(d))!==null&&g!==void 0?g:null))}),u))}recalculateAndSaveOverlays(e,t){let r=ls(),i=new Ee((o,u)=>o-u),s=ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let u of o)u.keys().forEach(c=>{let d=t.get(c);if(d===null)return;let p=r.get(c)||kn.empty();p=u.applyToLocalView(d,p),r.set(c,p);let g=(i.get(u.batchId)||ue()).add(c);i=i.insert(u.batchId,g)})}).next(()=>{let o=[],u=i.getReverseIterator();for(;u.hasNext();){let c=u.getNext(),d=c.key,p=c.value,g=e_();p.forEach(w=>{if(!s.has(w)){let C=s_(t.get(w),r.get(w));C!==null&&g.set(w,C),s=s.add(w)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,g))}return R.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return $.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Qv(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):R.resolve(Mn()),u=ps,c=s;return o.next(d=>R.forEach(d,(p,g)=>(u<g.largestBatchId&&(u=g.largestBatchId),s.get(p)?R.resolve():this.remoteDocumentCache.getEntry(e,p).next(w=>{c=c.insert(p,w)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,ue())).next(p=>({batchId:u,changes:bT(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $(t)).next(r=>{let i=as();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=as();return this.indexManager.getCollectionParents(e,s).next(u=>R.forEach(u,c=>{let d=(function(g,w){return new $n(w,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((g,w)=>{o=o.insert(g,w)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,d)=>{let p=d.getKey();o.get(p)===null&&(o=o.insert(p,ft.newInvalidDocument(p)))});let u=as();return o.forEach((c,d)=>{let p=s.get(c);p!==void 0&&ds(p.mutation,d,kn.empty(),Te.now()),Ja(t,d)&&(u=u.insert(c,d))}),u})}};var vh=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return R.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:kr(i.createTime)}})(t)),R.resolve()}getNamedQuery(e,t){return R.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:GT(i.bundledQuery),readTime:kr(i.readTime)}})(t)),R.resolve()}};var _h=class{constructor(){this.overlays=new Ee($.comparator),this.kr=new Map}getOverlay(e,t){return R.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Mn();return R.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.wt(e,t,s)}),R.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),R.resolve()}getOverlaysForCollection(e,t,r){let i=Mn(),s=t.length+1,o=new $(t.child("")),u=this.overlays.getIteratorFrom(o);for(;u.hasNext();){let c=u.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return R.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ee((d,p)=>d-p),o=this.overlays.getIterator();for(;o.hasNext();){let d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=Mn(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=Mn(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return R.resolve(u)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new th(t,r));let s=this.kr.get(t);s===void 0&&(s=ue(),this.kr.set(t,s)),this.kr.set(t,s.add(r.key))}};var wh=class{constructor(){this.sessionToken=je.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,R.resolve()}};var Ds=class{constructor(){this.qr=new Re(Se.Qr),this.$r=new Re(Se.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new Se(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new Se(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new $(new ye([])),r=new Se(t,e),i=new Se(t,e+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new $(new ye([])),r=new Se(t,e),i=new Se(t,e+1),s=ue();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Se(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Se=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return $.comparator(e.key,t.key)||J(e.Hr,t.Hr)}static Ur(e,t){return J(e.Hr,t.Hr)||$.comparator(e.key,t.key)}};var Eh=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Re(Se.Qr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new eh(s,t,r,i);this.mutationQueue.push(o);for(let u of i)this.Yr=this.Yr.add(new Se(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return R.resolve(o)}lookupMutationBatch(e,t){return R.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?eT:this.er-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Se(t,0),i=new Se(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{let u=this.Zr(o.Hr);s.push(u)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(J);return t.forEach(i=>{let s=new Se(i,0),o=new Se(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],u=>{r=r.add(u.Hr)})}),R.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;$.isDocumentKey(s)||(s=s.child(""));let o=new Se(new $(s),0),u=new Re(J);return this.Yr.forEachWhile(c=>{let d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(c.Hr)),!0)},o),R.resolve(this.ei(u))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ve(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return R.forEach(t.mutations,i=>{let s=new Se(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new Se(t,0),i=this.Yr.firstAfterOrEqual(r);return R.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var bh=class{constructor(e){this.ni=e,this.docs=(function(){return new Ee($.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return R.resolve(r?r.document.mutableCopy():ft.newInvalidDocument(t))}getEntries(e,t){let r=pn();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ft.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=pn(),o=t.path,u=new $(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){let{key:d,value:{document:p}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||YD(QD(p),r)<=0||(i.has(p.key)||Ja(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,t,r,i){H(9500)}ri(e,t){return R.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Sh(this)}getSize(e){return R.resolve(this.size)}},Sh=class extends mh{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),R.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var Ih=class{constructor(e){this.persistence=e,this.ii=new Gt(t=>pd(t),md),this.lastRemoteSnapshotVersion=Z.min(),this.highestTargetId=0,this.si=0,this.oi=new Ds,this.targetCount=0,this._i=Is.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),R.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new Is(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,R.resolve()}updateTargetData(e,t){return this.hr(t),R.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ii.forEach((o,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return R.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),R.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),R.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return R.resolve(r)}containsKey(e,t){return R.resolve(this.oi.containsKey(t))}};var Pa=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new cd(0),this.ci=!1,this.ci=!0,this.li=new wh,this.referenceDelegate=e(this),this.hi=new Ih(this),this.indexManager=new lh,this.remoteDocumentCache=(function(i){return new bh(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new ch(t),this.Ti=new vh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _h,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new Eh(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){U("MemoryPersistence","Starting transaction:",e);let i=new Dh(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return R.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},Dh=class extends Ll{constructor(e){super(),this.currentSequenceNumber=e}},Th=class n{constructor(e){this.persistence=e,this.Ai=new Ds,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw H(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),R.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),R.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.mi,r=>{let i=$.fromPath(r);return this.fi(e,i).next(s=>{s||t.removeEntry(i,Z.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return R.or([()=>R.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},Na=class n{constructor(e,t){this.persistence=e,this.gi=new Gt(r=>nT(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=WT(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return R.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return R.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?R.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,t).next(u=>{u||(r++,s.removeEntry(o,Z.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),R.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),R.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),R.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),R.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ga(e.data.value)),t}Sr(e,t,r){return R.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return R.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Ah=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=ue(),i=ue();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Ch=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Rh=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return oy()?8:JD(sa())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ps(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Ch;return this.ws(e,t,o).next(u=>{if(s.result=u,this.Rs)return this.Ss(e,t,o,u.size)})}).next(()=>s.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(Cr()<=se.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",Rr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),R.resolve()):(Cr()<=se.DEBUG&&U("QueryEngine","Query:",Rr(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(Cr()<=se.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",Rr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,It(t))):R.resolve())}ps(e,t){if(zy(t))return R.resolve(null);let r=It(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Xl(t,null,"F"),r=It(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ue(...s);return this.gs.getDocuments(e,o).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{let d=this.bs(t,u);return this.Ds(t,d,o,c.readTime)?this.ps(e,Xl(t,null,"F")):this.vs(e,d,t,c)}))})))}ys(e,t,r,i){return zy(t)||i.isEqual(Z.min())?R.resolve(null):this.gs.getDocuments(e,r).next(s=>{let o=this.bs(t,s);return this.Ds(t,o,r,i)?R.resolve(null):(Cr()<=se.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Rr(t)),this.vs(e,o,t,ZD(i,ps)).next(u=>u))})}bs(e,t){let r=new Re(Xv(e));return t.forEach((i,s)=>{Ja(e,s)&&(r=r.add(s))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,r){return Cr()<=se.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",Rr(t)),this.gs.getDocumentsMatchingQuery(e,t,jn.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var yd="LocalStore",KT=3e8,xh=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new Ee(J),this.Ms=new Gt(s=>pd(s),md),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yh(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function ZT(n,e,t,r){return new xh(n,e,t,r)}async function y_(n,e){let t=ae(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],u=[],c=ue();for(let d of i){o.push(d.batchId);for(let p of d.mutations)c=c.add(p.key)}for(let d of s){u.push(d.batchId);for(let p of d.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(r,c).next(d=>({Bs:d,removedBatchIds:o,addedBatchIds:u}))})})}function v_(n){let e=ae(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function QT(n,e){let t=ae(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let u=[];e.targetChanges.forEach((p,g)=>{let w=i.get(g);if(!w)return;u.push(t.hi.removeMatchingKeys(s,p.removedDocuments,g).next(()=>t.hi.addMatchingKeys(s,p.addedDocuments,g)));let C=w.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(g)!==null?C=C.withResumeToken(je.EMPTY_BYTE_STRING,Z.min()).withLastLimboFreeSnapshotVersion(Z.min()):p.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(p.resumeToken,r)),i=i.insert(g,C),(function(B,M,ne){return B.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=KT?!0:ne.addedDocuments.size+ne.modifiedDocuments.size+ne.removedDocuments.size>0})(w,C,p)&&u.push(t.hi.updateTargetData(s,C))});let c=pn(),d=ue();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(YT(s,o,e.documentUpdates).next(p=>{c=p.Ls,d=p.ks})),!r.isEqual(Z.min())){let p=t.hi.getLastRemoteSnapshotVersion(s).next(g=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return R.waitFor(u).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.Fs=i,s))}function YT(n,e,t){let r=ue(),i=ue();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=pn();return t.forEach((u,c)=>{let d=s.get(u);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(Z.min())?(e.removeEntry(u,c.readTime),o=o.insert(u,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(u,c)):U(yd,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",c.version)}),{Ls:o,ks:i}})}function XT(n,e){let t=ae(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):t.hi.allocateTargetId(r).next(o=>(i=new Ss(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}async function Ph(n,e,t){let r=ae(n),i=r.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Qr(o))throw o;U(yd,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function nv(n,e,t){let r=ae(n),i=Z.min(),s=ue();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(c,d,p){let g=ae(c),w=g.Ms.get(p);return w!==void 0?R.resolve(g.Fs.get(w)):g.hi.getTargetData(d,p)})(r,o,It(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,u.targetId).next(c=>{s=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,t?i:Z.min(),t?s:ue())).next(u=>(JT(r,_T(e),u),{documents:u,qs:s})))}function JT(n,e,t){let r=n.xs.get(e)||Z.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.xs.set(e,r)}var Oa=class{constructor(){this.activeTargetIds=DT()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Nh=class{constructor(){this.Fo=new Oa,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Oa,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Oh=class{xo(e){}shutdown(){}};var rv="ConnectivityMonitor",ka=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){U(rv,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){U(rv,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var ma=null;function kh(){return ma===null?ma=(function(){return 268435456+Math.round(2147483648*Math.random())})():ma++,"0x"+ma.toString(16)}var Tl="RestConnection",eA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Mh=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Sa?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){let o=kh(),u=this.Go(e,t.toUriEncodedString());U(Tl,`Sending RPC '${e}' ${o}:`,u,r);let c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,s);let{host:d}=new URL(u),p=Ir(d);return this.jo(e,u,c,r,p).then(g=>(U(Tl,`Received RPC '${e}' ${o}: `,g),g),g=>{throw dn(Tl,`RPC '${e}' ${o} failed with error: `,g,"url: ",u,"request:",r),g})}Jo(e,t,r,i,s,o){return this.Wo(e,t,r,i,s)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Zr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,t){let r=eA[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var Fh=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var Be="WebChannelConnection",Lh=class extends Mh{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,s){let o=kh();return new Promise((u,c)=>{let d=new _l;d.setWithCredentials(!0),d.listenOnce(wl.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case os.NO_ERROR:let g=d.getResponseJson();U(Be,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),u(g);break;case os.TIMEOUT:U(Be,`RPC '${e}' ${o} timed out`),c(new L(P.DEADLINE_EXCEEDED,"Request time out"));break;case os.HTTP_ERROR:let w=d.getStatus();if(U(Be,`RPC '${e}' ${o} failed with status:`,w,"response text:",d.getResponseText()),w>0){let C=d.getResponseJson();Array.isArray(C)&&(C=C[0]);let N=C?.error;if(N&&N.status&&N.message){let B=(function(ne){let X=ne.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(X)>=0?X:P.UNKNOWN})(N.status);c(new L(B,N.message))}else c(new L(P.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new L(P.UNAVAILABLE,"Connection failed."));break;default:H(9055,{c_:e,streamId:o,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{U(Be,`RPC '${e}' ${o} completed.`)}});let p=JSON.stringify(i);U(Be,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",p,r,15)})}P_(e,t,r){let i=kh(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Sl(),u=bl(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let p=s.join("");U(Be,`Creating RPC '${e}' stream ${i}: ${p}`,c);let g=o.createWebChannel(p,c);this.T_(g);let w=!1,C=!1,N=new Fh({Ho:M=>{C?U(Be,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(w||(U(Be,`Opening RPC '${e}' stream ${i} transport.`),g.open(),w=!0),U(Be,`RPC '${e}' stream ${i} sending:`,M),g.send(M))},Yo:()=>g.close()}),B=(M,ne,X)=>{M.listen(ne,ie=>{try{X(ie)}catch(me){setTimeout(()=>{throw me},0)}})};return B(g,Ar.EventType.OPEN,()=>{C||(U(Be,`RPC '${e}' stream ${i} transport opened.`),N.s_())}),B(g,Ar.EventType.CLOSE,()=>{C||(C=!0,U(Be,`RPC '${e}' stream ${i} transport closed`),N.__(),this.I_(g))}),B(g,Ar.EventType.ERROR,M=>{C||(C=!0,dn(Be,`RPC '${e}' stream ${i} transport errored. Name:`,M.name,"Message:",M.message),N.__(new L(P.UNAVAILABLE,"The operation could not be completed")))}),B(g,Ar.EventType.MESSAGE,M=>{var ne;if(!C){let X=M.data[0];ve(!!X,16349);let ie=X,me=ie?.error||((ne=ie[0])===null||ne===void 0?void 0:ne.error);if(me){U(Be,`RPC '${e}' stream ${i} received error:`,me);let Ye=me.status,de=(function(_){let b=be[_];if(b!==void 0)return a_(b)})(Ye),I=me.message;de===void 0&&(de=P.INTERNAL,I="Unknown error status: "+Ye+" with message "+me.message),C=!0,N.__(new L(de,I)),g.close()}else U(Be,`RPC '${e}' stream ${i} received:`,X),N.a_(X)}}),B(u,El.STAT_EVENT,M=>{M.stat===da.PROXY?U(Be,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===da.NOPROXY&&U(Be,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{N.o_()},0),N}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function Al(){return typeof document<"u"?document:null}function eu(n){return new sh(n,!0)}var Ma=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&U("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var iv="PersistentStream",Vh=class{constructor(e,t,r,i,s,o,u,c){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Ma(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?($t(t.toString()),$t("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new L(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return U(iv,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(U(iv,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Uh=class extends Vh{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=LT(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Z.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?Z.min():o.readTime?kr(o.readTime):Z.min()})(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=Xy(this.serializer),t.addTarget=(function(s,o){let u,c=o.target;if(u=Ql(c)?{documents:VT(s,c)}:{query:UT(s,c).Vt},u.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){u.resumeToken=u_(s,o.resumeToken);let d=oh(s,o.expectedCount);d!==null&&(u.expectedCount=d)}else if(o.snapshotVersion.compareTo(Z.min())>0){u.readTime=ah(s,o.snapshotVersion.toTimestamp());let d=oh(s,o.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);let r=jT(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=Xy(this.serializer),t.removeTarget=e,this.k_(t)}};var Bh=class{},jh=class extends Bh{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,uh(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new L(P.UNKNOWN,s.toString())})}Jo(e,t,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Jo(e,uh(t,r),i,o,u,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new L(P.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},$h=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?($t(t),this._a=!1):U("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var Hr="RemoteStore",zh=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{Ns(this)&&(U(Hr,"Restarting streams for network reachability change."),await(async function(c){let d=ae(c);d.Ia.add(4),await Ps(d),d.Aa.set("Unknown"),d.Ia.delete(4),await tu(d)})(this))})}),this.Aa=new $h(r,i)}};async function tu(n){if(Ns(n))for(let e of n.da)await e(!0)}async function Ps(n){for(let e of n.da)await e(!1)}function __(n,e){let t=ae(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Ed(t)?wd(t):Xr(t).x_()&&_d(t,e))}function vd(n,e){let t=ae(n),r=Xr(t);t.Ta.delete(e),r.x_()&&w_(t,e),t.Ta.size===0&&(r.x_()?r.B_():Ns(t)&&t.Aa.set("Unknown"))}function _d(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Z.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Xr(n).H_(e)}function w_(n,e){n.Ra.$e(e),Xr(n).Y_(e)}function wd(n){n.Ra=new ih({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Xr(n).start(),n.Aa.aa()}function Ed(n){return Ns(n)&&!Xr(n).M_()&&n.Ta.size>0}function Ns(n){return ae(n).Ia.size===0}function E_(n){n.Ra=void 0}async function tA(n){n.Aa.set("Online")}async function nA(n){n.Ta.forEach((e,t)=>{_d(n,e)})}async function rA(n,e){E_(n),Ed(n)?(n.Aa.la(e),wd(n)):n.Aa.set("Unknown")}async function iA(n,e,t){if(n.Aa.set("Online"),e instanceof Ca&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let u of s.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,o),i.Ta.delete(u),i.Ra.removeTarget(u))})(n,e)}catch(r){U(Hr,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await sv(n,r)}else if(e instanceof Or?n.Ra.Ye(e):e instanceof Aa?n.Ra.it(e):n.Ra.et(e),!t.isEqual(Z.min()))try{let r=await v_(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let u=s.Ra.Pt(o);return u.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let p=s.Ta.get(d);p&&s.Ta.set(d,p.withResumeToken(c.resumeToken,o))}}),u.targetMismatches.forEach((c,d)=>{let p=s.Ta.get(c);if(!p)return;s.Ta.set(c,p.withResumeToken(je.EMPTY_BYTE_STRING,p.snapshotVersion)),w_(s,c);let g=new Ss(p.target,c,d,p.sequenceNumber);_d(s,g)}),s.remoteSyncer.applyRemoteEvent(u)})(n,t)}catch(r){U(Hr,"Failed to raise snapshot:",r),await sv(n,r)}}async function sv(n,e,t){if(!Qr(e))throw e;n.Ia.add(1),await Ps(n),n.Aa.set("Offline"),t||(t=()=>v_(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{U(Hr,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await tu(n)})}async function ov(n,e){let t=ae(n);t.asyncQueue.verifyOperationInProgress(),U(Hr,"RemoteStore received new credentials");let r=Ns(t);t.Ia.add(3),await Ps(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await tu(t)}async function sA(n,e){let t=ae(n);e?(t.Ia.delete(2),await tu(t)):e||(t.Ia.add(2),await Ps(t),t.Aa.set("Unknown"))}function Xr(n){return n.Va||(n.Va=(function(t,r,i){let s=ae(t);return s.ia(),new Uh(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:tA.bind(null,n),e_:nA.bind(null,n),n_:rA.bind(null,n),J_:iA.bind(null,n)}),n.da.push(async e=>{e?(n.Va.N_(),Ed(n)?wd(n):n.Aa.set("Unknown")):(await n.Va.stop(),E_(n))})),n.Va}var qh=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new bt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,u=new n(e,t,o,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new L(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function b_(n,e){if($t("AsyncQueue",`${e}: ${n}`),Qr(n))return new L(P.UNAVAILABLE,`${e}: ${n}`);throw n}var Fa=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||$.comparator(t.key,r.key):(t,r)=>$.comparator(t.key,r.key),this.keyedMap=as(),this.sortedSet=new Ee(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var La=class{constructor(){this.fa=new Ee($.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):H(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},Wr=class n{constructor(e,t,r,i,s,o,u,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(u=>{o.push({type:0,doc:u})}),new n(e,t,Fa.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Xa(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Gh=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},Hh=class{constructor(){this.queries=av(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=ae(t),s=i.queries;i.queries=av(),s.forEach((o,u)=>{for(let c of u.wa)c.onError(r)})})(this,new L(P.ABORTED,"Firestore shutting down"))}};function av(){return new Gt(n=>Yv(n),Xa)}async function bd(n,e){let t=ae(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new Gh,r=e.ba()?0:1);try{switch(r){case 0:s.ya=await t.onListen(i,!0);break;case 1:s.ya=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let u=b_(o,`Initialization of query '${Rr(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&Id(t)}async function Sd(n,e){let t=ae(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function oA(n,e){let t=ae(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let u of o.wa)u.Ca(i)&&(r=!0);o.ya=i}}r&&Id(t)}function aA(n,e,t){let r=ae(n),i=r.queries.get(e);if(i)for(let s of i.wa)s.onError(t);r.queries.delete(e)}function Id(n){n.Da.forEach(e=>{e.next()})}var Wh,uv;(uv=Wh||(Wh={})).Fa="default",uv.Cache="cache";var Ts=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Wr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Wr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Wh.Cache}};var Va=class{constructor(e){this.key=e}},Ua=class{constructor(e){this.key=e}},Kh=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ue(),this.mutatedKeys=ue(),this.Xa=Xv(e),this.eu=new Fa(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new La,i=t?t.eu:this.eu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,u=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,g)=>{let w=i.get(p),C=Ja(this.query,g)?g:null,N=!!w&&this.mutatedKeys.has(w.key),B=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations),M=!1;w&&C?w.data.isEqual(C.data)?N!==B&&(r.track({type:3,doc:C}),M=!0):this.iu(w,C)||(r.track({type:2,doc:C}),M=!0,(c&&this.Xa(C,c)>0||d&&this.Xa(C,d)<0)&&(u=!0)):!w&&C?(r.track({type:0,doc:C}),M=!0):w&&!C&&(r.track({type:1,doc:w}),M=!0,(c||d)&&(u=!0)),M&&(C?(o=o.add(C),s=B?s.add(p):s.delete(p)):(o=o.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let p=this.query.limitType==="F"?o.last():o.first();o=o.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{eu:o,ru:r,Ds:u,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let o=e.ru.pa();o.sort((p,g)=>(function(C,N){let B=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H(20277,{At:M})}};return B(C)-B(N)})(p.type,g.type)||this.Xa(p.doc,g.doc)),this.su(r),i=i!=null&&i;let u=t&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,d=c!==this.Ya;return this.Ya=c,o.length!==0||d?{snapshot:new Wr(this.query,e.eu,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new La,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=ue(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new Ua(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new Va(r))}),t}uu(e){this.Ha=e.qs,this.Za=ue();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Wr.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},Dd="SyncEngine",Zh=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Qh=class{constructor(e){this.key=e,this.lu=!1}},Yh=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Gt(u=>Yv(u),Xa),this.Tu=new Map,this.Iu=new Set,this.du=new Ee($.comparator),this.Eu=new Map,this.Au=new Ds,this.Ru={},this.Vu=new Map,this.mu=Is.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};async function uA(n,e,t=!0){let r=A_(n),i,s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await S_(r,e,t,!0),i}async function cA(n,e){let t=A_(n);await S_(t,e,!0,!1)}async function S_(n,e,t,r){let i=await XT(n.localStore,It(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),u;return r&&(u=await lA(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&__(n.remoteStore,i),u}async function lA(n,e,t,r,i){n.gu=(g,w,C)=>(async function(B,M,ne,X){let ie=M.view.nu(ne);ie.Ds&&(ie=await nv(B.localStore,M.query,!1).then(({documents:I})=>M.view.nu(I,ie)));let me=X&&X.targetChanges.get(M.targetId),Ye=X&&X.targetMismatches.get(M.targetId)!=null,de=M.view.applyChanges(ie,B.isPrimaryClient,me,Ye);return lv(B,M.targetId,de._u),de.snapshot})(n,g,w,C);let s=await nv(n.localStore,e,!0),o=new Kh(e,s.qs),u=o.nu(s.documents),c=bs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(u,n.isPrimaryClient,c);lv(n,t,d._u);let p=new Zh(e,t,o);return n.Pu.set(e,p),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),d.snapshot}async function hA(n,e,t){let r=ae(n),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!Xa(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ph(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&vd(r.remoteStore,i.targetId),Xh(r,i.targetId)}).catch(Ka)):(Xh(r,i.targetId),await Ph(r.localStore,i.targetId,!0))}async function dA(n,e){let t=ae(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),vd(t.remoteStore,r.targetId))}async function I_(n,e){let t=ae(n);try{let r=await QT(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Eu.get(s);o&&(ve(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?ve(o.lu,14607):i.removedDocuments.size>0&&(ve(o.lu,42227),o.lu=!1))}),await T_(t,r,e)}catch(r){await Ka(r)}}function cv(n,e,t){let r=ae(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((s,o)=>{let u=o.view.va(e);u.snapshot&&i.push(u.snapshot)}),(function(o,u){let c=ae(o);c.onlineState=u;let d=!1;c.queries.forEach((p,g)=>{for(let w of g.wa)w.va(u)&&(d=!0)}),d&&Id(c)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function fA(n,e,t){let r=ae(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),s=i&&i.key;if(s){let o=new Ee($.comparator);o=o.insert(s,ft.newNoDocument(s,Z.min()));let u=ue().add(s),c=new Ta(Z.min(),new Map,new Ee(J),o,u);await I_(r,c),r.du=r.du.remove(s),r.Eu.delete(e),Td(r)}else await Ph(r.localStore,e,!1).then(()=>Xh(r,e,t)).catch(Ka)}function Xh(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||D_(n,r)})}function D_(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(vd(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Td(n))}function lv(n,e,t){for(let r of t)r instanceof Va?(n.Au.addReference(r.key,e),pA(n,r)):r instanceof Ua?(U(Dd,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||D_(n,r.key)):H(19791,{yu:r})}function pA(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(U(Dd,"New document in limbo: "+t),n.Iu.add(r),Td(n))}function Td(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new $(ye.fromString(e)),r=n.mu.next();n.Eu.set(r,new Qh(t)),n.du=n.du.insert(t,r),__(n.remoteStore,new Ss(It(Ya(t.path)),r,"TargetPurposeLimboResolution",cd.ue))}}async function T_(n,e,t){let r=ae(n),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((u,c)=>{o.push(r.gu(c,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let g=d?!d.fromCache:(p=t?.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,g?"current":"not-current")}if(d){i.push(d);let g=Ah.Es(c.targetId,d);s.push(g)}}))}),await Promise.all(o),r.hu.J_(i),await(async function(c,d){let p=ae(c);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>R.forEach(d,w=>R.forEach(w.Is,C=>p.persistence.referenceDelegate.addReference(g,w.targetId,C)).next(()=>R.forEach(w.ds,C=>p.persistence.referenceDelegate.removeReference(g,w.targetId,C)))))}catch(g){if(!Qr(g))throw g;U(yd,"Failed to update sequence numbers: "+g)}for(let g of d){let w=g.targetId;if(!g.fromCache){let C=p.Fs.get(w),N=C.snapshotVersion,B=C.withLastLimboFreeSnapshotVersion(N);p.Fs=p.Fs.insert(w,B)}}})(r.localStore,s))}async function mA(n,e){let t=ae(n);if(!t.currentUser.isEqual(e)){U(Dd,"User change. New user:",e.toKey());let r=await y_(t.localStore,e);t.currentUser=e,(function(s,o){s.Vu.forEach(u=>{u.forEach(c=>{c.reject(new L(P.CANCELLED,o))})}),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await T_(t,r.Bs)}}function gA(n,e){let t=ae(n),r=t.Eu.get(e);if(r&&r.lu)return ue().add(r.key);{let i=ue(),s=t.Tu.get(e);if(!s)return i;for(let o of s){let u=t.Pu.get(o);i=i.unionWith(u.view.tu)}return i}}function A_(n){let e=ae(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=I_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=gA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=fA.bind(null,e),e.hu.J_=oA.bind(null,e.eventManager),e.hu.pu=aA.bind(null,e.eventManager),e}var C_=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=eu(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,r){return null}Fu(t,r){return null}vu(t){return ZT(this.persistence,new Rh,t.initialUser,this.serializer)}Du(t){return new Pa(Th.Vi,this.serializer)}bu(t){return new Nh}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),Jh=class extends C_{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ve(this.persistence.referenceDelegate instanceof Na,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new fh(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?et.withCacheSize(this.cacheSizeBytes):et.DEFAULT;return new Pa(r=>Na.Vi(r,t),this.serializer)}};var yA=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>cv(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=mA.bind(null,this.syncEngine),await sA(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Hh})()}createDatastore(t){let r=eu(t.databaseInfo.databaseId),i=(function(o){return new Lh(o)})(t.databaseInfo);return(function(o,u,c,d){return new jh(o,u,c,d)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,o,u,c){return new zh(i,s,o,u,c)})(this.localStore,this.datastore,t.asyncQueue,r=>cv(this.syncEngine,r,0),(function(){return ka.C()?new ka:new Oh})())}createSyncEngine(t,r){return(function(s,o,u,c,d,p,g){let w=new Yh(s,o,u,c,d,p);return g&&(w.fu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await(async function(s){let o=ae(s);U(Hr,"RemoteStore shutting down."),o.Ia.add(5),await Ps(o),o.Ea.shutdown(),o.Aa.set("Unknown")})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}return n.provider={build:()=>new n},n})();var As=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):$t("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var mn="FirestoreClient",ed=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ce.UNAUTHENTICATED,this.clientId=fs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{U(mn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(U(mn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new bt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=b_(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Cl(n,e){n.asyncQueue.verifyOperationInProgress(),U(mn,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await y_(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>{dn("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{U("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{dn("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e}async function hv(n,e){n.asyncQueue.verifyOperationInProgress();let t=await vA(n);U(mn,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>ov(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>ov(e.remoteStore,i)),n._onlineComponents=e}async function vA(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U(mn,"Using user provided OfflineComponentProvider");try{await Cl(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;dn("Error using user provided cache. Falling back to memory cache: "+t),await Cl(n,new C_)}}else U(mn,"Using default OfflineComponentProvider"),await Cl(n,new Jh(void 0));return n._offlineComponents}async function _A(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(U(mn,"Using user provided OnlineComponentProvider"),await hv(n,n._uninitializedComponentsProvider._online)):(U(mn,"Using default OnlineComponentProvider"),await hv(n,new yA))),n._onlineComponents}async function Ba(n){let e=await _A(n),t=e.eventManager;return t.onListen=uA.bind(null,e.syncEngine),t.onUnlisten=hA.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=cA.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=dA.bind(null,e.syncEngine),t}function wA(n,e,t={}){let r=new bt;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,u,c,d){let p=new As({next:w=>{p.Ou(),o.enqueueAndForget(()=>Sd(s,g));let C=w.docs.has(u);!C&&w.fromCache?d.reject(new L(P.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&w.fromCache&&c&&c.source==="server"?d.reject(new L(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(w)},error:w=>d.reject(w)}),g=new Ts(Ya(u.path),p,{includeMetadataChanges:!0,ka:!0});return bd(s,g)})(await Ba(n),n.asyncQueue,e,t,r)),r.promise}function EA(n,e,t={}){let r=new bt;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,u,c,d){let p=new As({next:w=>{p.Ou(),o.enqueueAndForget(()=>Sd(s,g)),w.fromCache&&c.source==="server"?d.reject(new L(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(w)},error:w=>d.reject(w)}),g=new Ts(u,p,{includeMetadataChanges:!0,ka:!0});return bd(s,g)})(await Ba(n),n.asyncQueue,e,t,r)),r.promise}function R_(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var dv=new Map;var x_="firestore.googleapis.com",fv=!0,ja=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new L(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=x_,this.ssl=fv}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:fv;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=g_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<HT)throw new L(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}KD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=R_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new L(P.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Kr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ja({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new L(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new L(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ja(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Rl;switch(r.type){case"firstParty":return new Ol(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new L(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=dv.get(t);r&&(U("ComponentProvider","Removing Datastore"),dv.delete(t),r.terminate())})(this),Promise.resolve()}};function bA(n,e,t,r={}){var i;n=an(n,Kr);let s=Ir(e),o=n._getSettings(),u=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;s&&(ra(`https://${c}`),ia("Firestore",!0)),o.host!==x_&&o.host!==c&&dn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:r});if(!Dr(d,u)&&(n._setSettings(d),r.mockUserToken)){let p,g;if(typeof r.mockUserToken=="string")p=r.mockUserToken,g=Ce.MOCK_USER;else{p=sy(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let w=r.mockUserToken.sub||r.mockUserToken.user_id;if(!w)throw new L(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new Ce(w)}n._authCredentials=new xl(new va(p,g))}}var zn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Oe=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new un(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(xs(t,n._jsonSchema))return new n(e,r||null,new $(ye.fromString(t.referencePath)))}};Oe._jsonSchemaVersion="firestore/documentReference/1.0",Oe._jsonSchema={type:De("string",Oe._jsonSchemaVersion),referencePath:De("string")};var un=class n extends zn{constructor(e,t,r){super(e,t,Ya(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Oe(this.firestore,null,new $(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function P_(n,e,...t){if(n=lt(n),Ev("collection","path",e),n instanceof Kr){let r=ye.fromString(e,...t);return xy(r),new un(n,null,r)}{if(!(n instanceof Oe||n instanceof un))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ye.fromString(e,...t));return xy(r),new un(n.firestore,null,r)}}function N_(n,e,...t){if(n=lt(n),arguments.length===1&&(e=fs.newId()),Ev("doc","path",e),n instanceof Kr){let r=ye.fromString(e,...t);return Ry(r),new Oe(n,null,new $(r))}{if(!(n instanceof Oe||n instanceof un))throw new L(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ye.fromString(e,...t));return Ry(r),new Oe(n.firestore,n instanceof un?n.converter:null,new $(r))}}var pv="AsyncQueue",$a=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Ma(this,"async_queue_retry"),this.oc=()=>{let r=Al();r&&U(pv,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=Al();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=Al();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new bt;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Qr(e))throw e;U(pv,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,$t("INTERNAL UNHANDLED ERROR: ",mv(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=qh.createAndSchedule(this,e,t,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&H(47125,{hc:mv(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function mv(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function gv(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}var qn=class extends Kr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new $a,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new $a(e),this._firestoreClient=void 0,await e}}};function O_(n,e){let t=typeof n=="object"?n:on(),r=typeof n=="string"?n:e||Sa,i=ca(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=na("firestore");s&&bA(i,...s)}return i}function Ad(n){if(n._terminated)throw new L(P.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||SA(n),n._firestoreClient}function SA(n){var e,t,r;let i=n._freezeSettings(),s=(function(u,c,d,p){return new Vl(u,c,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,R_(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new ed(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(u){let c=u?._online.build();return{_offline:u?._offline.build(c),_online:c}})(n._componentsProvider))}var cn=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(je.fromBase64String(e))}catch(t){throw new L(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(je.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(xs(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};cn._jsonSchemaVersion="firestore/bytes/1.0",cn._jsonSchema={type:De("string",cn._jsonSchemaVersion),bytes:De("string")};var za=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new L(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var qa=class{constructor(e){this._methodName=e}};var ln=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new L(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new L(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(xs(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};ln._jsonSchemaVersion="firestore/geoPoint/1.0",ln._jsonSchema={type:De("string",ln._jsonSchemaVersion),latitude:De("number"),longitude:De("number")};var hn=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(xs(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new L(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};hn._jsonSchemaVersion="firestore/vectorValue/1.0",hn._jsonSchema={type:De("string",hn._jsonSchemaVersion),vectorValues:De("object")};var IA=/^__.*__$/;function k_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H(40011,{Ec:n})}}var td=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return rd(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(k_(this.Ec)&&IA.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},nd=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||eu(e)}Dc(e,t,r,i=!1){return new td({Ec:e,methodName:t,bc:r,path:tt.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function DA(n){let e=n._freezeSettings(),t=eu(n._databaseId);return new nd(n._databaseId,!!e.ignoreUndefinedProperties,t)}function TA(n,e,t,r=!1){return Cd(t,n.Dc(r?4:3,e))}function Cd(n,e){if(M_(n=lt(n)))return CA("Unsupported field value:",e,n),AA(n,e);if(n instanceof qa)return(function(r,i){if(!k_(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let u of r){let c=Cd(u,i.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=lt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return TT(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Te.fromDate(r);return{timestampValue:ah(i.serializer,s)}}if(r instanceof Te){let s=new Te(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ah(i.serializer,s)}}if(r instanceof ln)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof cn)return{bytesValue:u_(i.serializer,r._byteString)};if(r instanceof Oe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:c_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof hn)return(function(o,u){return{mapValue:{fields:{[hd]:{stringValue:dd},[Lr]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return gd(u.serializer,d)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${Wa(r)}`)})(n,e)}function AA(n,e){let t={};return Lv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Yr(n,(r,i)=>{let s=Cd(i,e.Vc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function M_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Te||n instanceof ln||n instanceof cn||n instanceof Oe||n instanceof qa||n instanceof hn)}function CA(n,e,t){if(!M_(t)||!bv(t)){let r=Wa(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}var RA=new RegExp("[~\\*/\\[\\]]");function xA(n,e,t){if(e.search(RA)>=0)throw rd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new za(...e.split("."))._internalPath}catch{throw rd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function rd(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new L(P.INVALID_ARGUMENT,u+n+c)}var Ga=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Oe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new id(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Rd("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},id=class extends Ga{data(){return super.data()}};function Rd(n,e){return typeof e=="string"?xA(n,e):e instanceof za?e._internalPath:e._delegate._internalPath}function F_(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new L(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Cs=class{},sd=class extends Cs{};function xd(n,e,...t){let r=[];e instanceof Cs&&r.push(e),r=r.concat(t),(function(s){let o=s.filter(c=>c instanceof od).length,u=s.filter(c=>c instanceof Ha).length;if(o>1||o>0&&u>0)throw new L(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var Ha=class n extends sd{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return V_(e._query,t),new zn(e.firestore,e.converter,Yl(e._query,t))}_parse(e){let t=DA(e.firestore);return(function(s,o,u,c,d,p,g){let w;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new L(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){vv(g,p);let N=[];for(let B of g)N.push(yv(c,s,B));w={arrayValue:{values:N}}}else w=yv(c,s,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||vv(g,p),w=TA(u,o,g,p==="in"||p==="not-in");return Ie.create(d,p,w)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function L_(n,e,t){let r=e,i=Rd("where",n);return Ha._create(i,r,t)}var od=class n extends Cs{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:pt.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i,u=s.getFlattenedFilters();for(let c of u)V_(o,c),o=Yl(o,c)})(e._query,t),new zn(e.firestore,e.converter,Yl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function yv(n,e,t){if(typeof(t=lt(t))=="string"){if(t==="")throw new L(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Qv(e)&&t.indexOf("/")!==-1)throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ye.fromString(t));if(!$.isDocumentKey(r))throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ly(n,new $(r))}if(t instanceof Oe)return Ly(n,t._key);throw new L(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wa(t)}.`)}function vv(n,e){if(!Array.isArray(n)||n.length===0)throw new L(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function V_(n,e){let t=(function(i,s){for(let o of i)for(let u of o.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new L(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new L(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var ad=class{convertValue(e,t="none"){switch(fn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(qt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw H(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Yr(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[Lr].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>ge(o.doubleValue));return new hn(s)}convertGeoPoint(e){return new ln(ge(e.latitude),ge(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Qa(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(gs(e));default:return null}}convertTimestamp(e){let t=zt(e);return new Te(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ye.fromString(e);ve(m_(r),9688,{name:e});let i=new Ia(r.get(1),r.get(3)),s=new $(r.popFirst(5));return i.isEqual(t)||$t(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};var Ln=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Vn=class n extends Ga{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Mr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Rd("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new L(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Vn._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vn._jsonSchema={type:De("string",Vn._jsonSchemaVersion),bundleSource:De("string","DocumentSnapshot"),bundleName:De("string"),bundle:De("string")};var Mr=class extends Vn{data(e={}){return super.data(e)}},Un=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ln(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Mr(this._firestore,this._userDataWriter,r.key,r,new Ln(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new L(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(u=>{let c=new Mr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ln(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let c=new Mr(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Ln(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=o.indexOf(u.doc.key),o=o.delete(u.doc.key)),u.type!==1&&(o=o.add(u.doc),p=o.indexOf(u.doc.key)),{type:PA(u.type),doc:c,oldIndex:d,newIndex:p}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new L(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=fs.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function PA(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H(61501,{type:n})}}function U_(n){n=an(n,Oe);let e=an(n.firestore,qn);return wA(Ad(e),n._key).then(t=>j_(e,n,t))}Un._jsonSchemaVersion="firestore/querySnapshot/1.0",Un._jsonSchema={type:De("string",Un._jsonSchemaVersion),bundleSource:De("string","QuerySnapshot"),bundleName:De("string"),bundle:De("string")};var Rs=class extends ad{constructor(e){super(),this.firestore=e}convertBytes(e){return new cn(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Oe(this.firestore,null,t)}};function B_(n){n=an(n,zn);let e=an(n.firestore,qn),t=Ad(e),r=new Rs(e);return F_(n._query),EA(t,n._query).then(i=>new Un(e,r,n,i))}function HO(n,...e){var t,r,i;n=lt(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||gv(e[o])||(s=e[o++]);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(gv(e[o])){let g=e[o];e[o]=(t=g.next)===null||t===void 0?void 0:t.bind(g),e[o+1]=(r=g.error)===null||r===void 0?void 0:r.bind(g),e[o+2]=(i=g.complete)===null||i===void 0?void 0:i.bind(g)}let c,d,p;if(n instanceof Oe)d=an(n.firestore,qn),p=Ya(n._key.path),c={next:g=>{e[o]&&e[o](j_(d,n,g))},error:e[o+1],complete:e[o+2]};else{let g=an(n,zn);d=an(g.firestore,qn),p=g._query;let w=new Rs(d);c={next:C=>{e[o]&&e[o](new Un(d,w,g,C))},error:e[o+1],complete:e[o+2]},F_(n._query)}return(function(w,C,N,B){let M=new As(B),ne=new Ts(C,M,N);return w.asyncQueue.enqueueAndForget(async()=>bd(await Ba(w),ne)),()=>{M.Ou(),w.asyncQueue.enqueueAndForget(async()=>Sd(await Ba(w),ne))}})(Ad(d),p,u,c)}function j_(n,e,t){let r=t.docs.get(e._key),i=new Rs(n);return new Vn(n,i,e._key,r,new Ln(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Zr=i})(wy),On(new ht("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),u=new qn(new Pl(r.getProvider("auth-internal")),new kl(o,r.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new L(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ia(d.options.projectId,p)})(o,i),o);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),dt(Dy,Ty,e),dt(Dy,Ty,"esm2017")})();var NA="type.googleapis.com/google.protobuf.Int64Value",OA="type.googleapis.com/google.protobuf.UInt64Value";function G_(n,e){let t={};for(let r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function nu(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>nu(e));if(typeof n=="function"||typeof n=="object")return G_(n,e=>nu(e));throw new Error("Data cannot be encoded in JSON: "+n)}function Jr(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case NA:case OA:{let e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>Jr(e)):typeof n=="function"||typeof n=="object"?G_(n,e=>Jr(e)):n}var kd="functions";var $_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},He=class n extends ct{constructor(e,t,r){super(`${kd}/${e}`,t||""),this.details=r,Object.setPrototypeOf(this,n.prototype)}};function kA(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function ru(n,e){let t=kA(n),r=t,i;try{let s=e&&e.error;if(s){let o=s.status;if(typeof o=="string"){if(!$_[o])return new He("internal","internal");t=$_[o],r=o}let u=s.message;typeof u=="string"&&(r=u),i=s.details,i!==void 0&&(i=Jr(i))}}catch{}return t==="ok"?null:new He(t,r,i)}var Pd=class{constructor(e,t,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,la(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i?.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{let e=await this.auth.getToken();return e?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){let t=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}}};var Nd="us-central1",MA=/^data: (.*?)(?:\n|$)/;function FA(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new He("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}var Od=class{constructor(e,t,r,i,s=Nd,o=(...u)=>fetch(...u)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new Pd(e,t,r,i),this.cancelAllRequests=new Promise(u=>{this.deleteService=()=>Promise.resolve(u())});try{let u=new URL(s);this.customDomain=u.origin+(u.pathname==="/"?"":u.pathname),this.region=Nd}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){let t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}};function LA(n,e,t){let r=Ir(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(ra(n.emulatorOrigin),ia("Functions",!0))}function VA(n,e,t){let r=i=>BA(n,e,i,t||{});return r.stream=(i,s)=>$A(n,e,i,s),r}async function UA(n,e,t,r){t["Content-Type"]="application/json";let i;try{i=await r(n,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let s=null;try{s=await i.json()}catch{}return{status:i.status,json:s}}async function H_(n,e){let t={},r=await n.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(t.Authorization="Bearer "+r.authToken),r.messagingToken&&(t["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=r.appCheckToken),t}function BA(n,e,t,r){let i=n._url(e);return jA(n,i,t,r)}async function jA(n,e,t,r){t=nu(t);let i={data:t},s=await H_(n,r),o=r.timeout||7e4,u=FA(o),c=await Promise.race([UA(e,i,s,n.fetchImpl),u.promise,n.cancelAllRequests]);if(u.cancel(),!c)throw new He("cancelled","Firebase Functions instance was deleted.");let d=ru(c.status,c.json);if(d)throw d;if(!c.json)throw new He("internal","Response is not valid JSON object.");let p=c.json.data;if(typeof p>"u"&&(p=c.json.result),typeof p>"u")throw new He("internal","Response is missing data field.");return{data:Jr(p)}}function $A(n,e,t,r){let i=n._url(e);return zA(n,i,t,r||{})}async function zA(n,e,t,r){var i;t=nu(t);let s={data:t},o=await H_(n,r);o["Content-Type"]="application/json",o.Accept="text/event-stream";let u;try{u=await n.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:o,signal:r?.signal})}catch(C){if(C instanceof Error&&C.name==="AbortError"){let B=new He("cancelled","Request was cancelled.");return{data:Promise.reject(B),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(B)}}}}}}let N=ru(0,null);return{data:Promise.reject(N),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(N)}}}}}}let c,d,p=new Promise((C,N)=>{c=C,d=N});(i=r?.signal)===null||i===void 0||i.addEventListener("abort",()=>{let C=new He("cancelled","Request was cancelled.");d(C)});let g=u.body.getReader(),w=qA(g,c,d,r?.signal);return{stream:{[Symbol.asyncIterator](){let C=w.getReader();return{async next(){let{value:N,done:B}=await C.read();return{value:N,done:B}},async return(){return await C.cancel(),{done:!0,value:void 0}}}}},data:p}}function qA(n,e,t,r){let i=(o,u)=>{let c=o.match(MA);if(!c)return;let d=c[1];try{let p=JSON.parse(d);if("result"in p){e(Jr(p.result));return}if("message"in p){u.enqueue(Jr(p.message));return}if("error"in p){let g=ru(0,p);u.error(g),t(g);return}}catch(p){if(p instanceof He){u.error(p),t(p);return}}},s=new TextDecoder;return new ReadableStream({start(o){let u="";return c();async function c(){if(r?.aborted){let d=new He("cancelled","Request was cancelled");return o.error(d),t(d),Promise.resolve()}try{let{value:d,done:p}=await n.read();if(p){u.trim()&&i(u.trim(),o),o.close();return}if(r?.aborted){let w=new He("cancelled","Request was cancelled");o.error(w),t(w),await n.cancel();return}u+=s.decode(d,{stream:!0});let g=u.split(`
`);u=g.pop()||"";for(let w of g)w.trim()&&i(w.trim(),o);return c()}catch(d){let p=d instanceof He?d:ru(0,null);o.error(p),t(p)}}},cancel(){return n.cancel()}})}var z_="@firebase/functions",q_="0.12.9";var GA="auth-internal",HA="app-check-internal",WA="messaging-internal";function KA(n){let e=(t,{instanceIdentifier:r})=>{let i=t.getProvider("app").getImmediate(),s=t.getProvider(GA),o=t.getProvider(WA),u=t.getProvider(HA);return new Od(i,s,o,u,r)};On(new ht(kd,e,"PUBLIC").setMultipleInstances(!0)),dt(z_,q_,n),dt(z_,q_,"esm2017")}function W_(n=on(),e=Nd){let r=ca(lt(n),kd).getImmediate({identifier:e}),i=na("functions");return i&&ZA(r,...i),r}function ZA(n,e,t){LA(lt(n),e,t)}function K_(n,e,t){return VA(lt(n),e,t)}KA();var iu=class{constructor(e){this.firestore=e}async getDocument(e,t){try{let r=N_(this.firestore,e,t),i=await U_(r);return i.exists()?i.data():null}catch(r){throw console.error(`Failed to get document ${e}/${t}:`,r),r}}async getDocuments(e,t){try{let r=P_(this.firestore,e),i=xd(r);if(t&&t.length>0){let o=t.map(u=>L_(u.field,u.op,u.value));i=xd(r,...o)}return(await B_(i)).docs.map(o=>o.data())}catch(r){throw console.error(`Failed to get documents from ${e}:`,r),r}}};var Z_=class n{db=new iu(O_(on()));async getUserByAuthId(e){let t=await this.db.getDocument("users",e);return t?wr.parse(t):null}async getUserByDisplayId(e){let t=await this.db.getDocuments("users",[{field:"displayId",op:"==",value:e}]);return t.length===0?null:wr.parse(t[0])}async getUserByEmail(e){let t=await this.db.getDocuments("users",[{field:"email",op:"==",value:e}]);return t.length===0?null:wr.parse(t[0])}async listAllUsers(e){let r=(await this.db.getDocuments("users")).map(i=>wr.parse(i));return e&&e>0?r.slice(0,e):r}async searchUsers(e){if(!e||e.trim().length===0)return[];let t=await this.listAllUsers(),r=e.toLowerCase();return t.filter(i=>i.displayName.toLowerCase().includes(r)||i.email.toLowerCase().includes(r)||i.displayId.toLowerCase().includes(r))}async getStudentById(e){let t=e.match(/^(U-\d{8})-K\d+$/);if(!t)return null;let r=t[1],i=await this.getUserByDisplayId(r);return!i||!i.students?null:i.students.find(s=>s.id===e)??null}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};var Q_=class n{functions=W_(on());async call(e,t){return(await K_(this.functions,e)(t)).data}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Q({token:n,factory:n.\u0275fac,providedIn:"root"})};export{Nt as a,M0 as b,F0 as c,xp as d,J0 as e,uw as f,ut as g,Mt as h,vc as i,dr as j,jo as k,zE as l,HE as m,XE as n,JE as o,ry as p,NI as q,KN as r,Ir as s,ra as t,ia as u,sa as v,ZN as w,QN as x,YN as y,XN as z,JN as A,ct as B,is as C,eO as D,Dr as E,tO as F,nO as G,rO as H,iO as I,lt as J,ht as K,se as L,Tr as M,On as N,ca as O,la as P,wy as Q,OD as R,on as S,dt as T,bA as U,P_ as V,N_ as W,O_ as X,xd as Y,L_ as Z,HO as _,W_ as $,ZA as aa,GS as ba,KS as ca,YS as da,Yc as ea,JS as fa,rg as ga,RS as ha,mg as ia,xS as ja,eI as ka,tI as la,Jo as ma,PS as na,NS as oa,OS as pa,kS as qa,MS as ra,FS as sa,LS as ta,VS as ua,Xc as va,US as wa,BS as xa,jS as ya,$S as za,zS as Aa,iu as Ba,Z_ as Ca,Q_ as Da};
