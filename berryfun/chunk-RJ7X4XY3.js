import{a as J,b as K,c as Q,f as X,h as Z,i as ee,j as te,k as ne,m as ie,n as oe,r as ae}from"./chunk-U4YJGQVE.js";import{a as H}from"./chunk-FYGYBRKK.js";import{a as U}from"./chunk-L5OFKJS2.js";import{a as $}from"./chunk-EUESG25O.js";import{b as G}from"./chunk-3NM435RE.js";import{Ka as Y,d as q,j as R,k as j}from"./chunk-UIQMLXH2.js";import{Bb as l,Cb as h,Db as S,Eb as k,Hb as u,Ia as s,Ib as f,Jb as x,Mb as N,R as D,Sb as L,Ta as F,W as m,X as p,a as V,b as B,bb as _,cb as C,db as O,eb as M,fb as P,gb as v,ha as y,hb as o,ib as i,jb as z,nb as b,pb as g,rb as c,zb as w}from"./chunk-6GAPJCXB.js";function W(r){return`$${(r/100).toFixed(2)}`}function re(r,n){let e=new Date(r),a=new Date(n),t=e.toLocaleDateString("en-US",{month:"short"}),d=a.toLocaleDateString("en-US",{month:"short"}),E=e.getDate(),T=a.getDate(),I=e.getFullYear();return t===d?`${t} ${E} - ${T}, ${I}`:`${t} ${E} - ${d} ${T}, ${I}`}var le=()=>[],A=(r,n)=>n.id,de=(r,n)=>n.minSessions;function ce(r,n){if(r&1&&(o(0,"option",19),l(1),i()),r&2){let e=n.$implicit;v("value",e.id),s(),h(e.name)}}function me(r,n){if(r&1){let e=b();o(0,"select",17),x("ngModelChange",function(t){m(e);let d=c();return f(d.selectedSeasonIdForFilter,t)||(d.selectedSeasonIdForFilter=t),p(t)}),o(1,"option",18),l(2,"All Seasons"),i(),M(3,ce,2,2,"option",19,A),i()}if(r&2){let e=c();u("ngModel",e.selectedSeasonIdForFilter),s(3),P(e.seasonService.seasons())}}function pe(r,n){r&1&&(o(0,"div",12),z(1,"div",20),o(2,"p"),l(3,"Loading catalog..."),i()())}function _e(r,n){if(r&1){let e=b();o(0,"div",13)(1,"div",21),l(2,"!"),i(),o(3,"p"),l(4),i(),o(5,"button",22),g("click",function(){m(e);let t=c();return p(t.loadCatalog())}),l(6,"Retry"),i()()}if(r&2){let e=c();s(4),h(e.seasonService.error())}}function Ce(r,n){if(r&1&&(o(0,"div",31),l(1),i()),r&2){let e=c().$implicit;s(),S(" ",e.description," ")}}function ge(r,n){if(r&1){let e=b();o(0,"div",25)(1,"div",26)(2,"div")(3,"h3"),l(4),i(),o(5,"p",27),l(6),i()(),o(7,"span",28),l(8),i()(),o(9,"div",29)(10,"div",30)(11,"span"),l(12,"Year:"),i(),o(13,"span"),l(14),i()(),o(15,"div",30)(16,"span"),l(17,"Classes:"),i(),o(18,"span"),l(19),i()(),_(20,Ce,2,1,"div",31),i(),o(21,"div",32)(22,"button",33),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.openEditSeasonDialog(t))}),l(23,"Edit"),i(),o(24,"button",33),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.openCouponDialog(t))}),l(25),i(),o(26,"button",34),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.toggleSeasonActive(t))}),l(27),i()()()}if(r&2){let e=n.$implicit,a=c(2);w("inactive",!e.isActive),s(4),h(e.name),s(2),S(" ",a.formatDateRange(e.startDate,e.endDate)," "),s(),w("active",e.isActive),s(),S(" ",e.isActive?"Active":"Inactive"," "),s(6),h(e.year),s(5),h(e.sessions.length),s(),C(e.description?20:-1),s(5),S(" Coupons (",e.coupons.length,") "),s(),w("btn-activate",!e.isActive),v("disabled",a.seasonService.actionLoading()),s(),S(" ",e.isActive?"Deactivate":"Activate"," ")}}function ue(r,n){if(r&1){let e=b();o(0,"div",24)(1,"p"),l(2),i(),o(3,"button",11),g("click",function(){m(e);let t=c(2);return p(t.openCreateDialog())}),l(4,"Create Season"),i()()}if(r&2){let e=c(2);s(2),S("No ",e.showActiveOnly()?"active":""," seasons found")}}function fe(r,n){if(r&1&&(o(0,"div",14),M(1,ge,28,15,"div",23,A),_(3,ue,5,1,"div",24),i()),r&2){let e=c();s(),P(e.displayedSeasons()),s(2),C(e.displayedSeasons().length===0?3:-1)}}function xe(r,n){if(r&1){let e=b();o(0,"tr")(1,"td"),l(2),i(),o(3,"td"),l(4),i(),o(5,"td"),l(6),i(),o(7,"td"),l(8),i(),o(9,"td")(10,"span"),l(11),i()(),o(12,"td"),l(13),i(),o(14,"td")(15,"span",28),l(16),i()(),o(17,"td")(18,"div",37)(19,"button",38),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.openEditClassDialog(t))}),l(20,"Edit"),i(),o(21,"button",39),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.toggleClassActive(t))}),l(22),i()()()()}if(r&2){let e=n.$implicit,a=c(2);w("inactive",!e.isActive),s(2),h(e.name),s(2),h(a.getSeasonName(e.seasonId)),s(2),h(a.formatDateRange(e.startDate,e.endDate)),s(2),h(e.capacity),s(2),w("text-warning",a.getEnrolledCount(e.id)>=e.capacity),s(),S(" ",a.getEnrolledCount(e.id)," "),s(2),h(a.formatCurrency(e.basePrice)),s(2),w("active",e.isActive),s(),S(" ",e.isActive?"Active":"Inactive"," "),s(5),w("btn-activate",!e.isActive),v("disabled",a.seasonService.actionLoading()),s(),S(" ",e.isActive?"Hide":"Show"," ")}}function he(r,n){if(r&1){let e=b();o(0,"div",24)(1,"p"),l(2),i(),o(3,"button",11),g("click",function(){m(e);let t=c(2);return p(t.openCreateDialog())}),l(4,"Create Class"),i()()}if(r&2){let e=c(2);s(2),S("No ",e.showActiveOnly()?"active":""," classes found")}}function Se(r,n){if(r&1&&(o(0,"div",15)(1,"table",35)(2,"thead")(3,"tr")(4,"th"),l(5,"Name"),i(),o(6,"th"),l(7,"Season"),i(),o(8,"th"),l(9,"Dates"),i(),o(10,"th"),l(11,"Capacity"),i(),o(12,"th"),l(13,"Enrolled"),i(),o(14,"th"),l(15,"Price"),i(),o(16,"th"),l(17,"Status"),i(),o(18,"th"),l(19,"Actions"),i()()(),o(20,"tbody"),M(21,xe,23,17,"tr",36,A),i()(),_(23,he,5,1,"div",24),i()),r&2){let e=c();s(21),P(e.displayedClasses()),s(2),C(e.displayedClasses().length===0?23:-1)}}function be(r,n){r&1&&(o(0,"span",67),l(1,"Has content"),i())}function ve(r,n){if(r&1){let e=b();o(0,"div",68)(1,"textarea",72),x("ngModelChange",function(t){m(e);let d=c(3);return f(d.formSeason.description,t)||(d.formSeason.description=t),p(t)}),i()()}if(r&2){let e=c(3);s(),u("ngModel",e.formSeason.description)}}function ye(r,n){r&1&&(o(0,"span",67),l(1,"Configured"),i())}function Me(r,n){if(r&1&&(o(0,"span",80),l(1),i()),r&2){let e=n.$implicit;s(),k("",e.minSessions,"+: ","$"+(e.discountAmount/100).toFixed(2)," off")}}function Pe(r,n){if(r&1&&(o(0,"div",79),M(1,Me,2,2,"span",80,de),i()),r&2){let e=c();s(),P(e)}}function we(r,n){r&1&&_(0,Pe,3,0,"div",79),r&2&&C(n.length>0?0:-1)}function Te(r,n){r&1&&(o(0,"div",78),l(1,"Invalid format"),i())}function Ee(r,n){if(r&1&&_(0,we,1,1)(1,Te,2,0,"div",78),r&2){let e,a=c(4);C((e=a.getParsedMultiSessionDiscounts())?0:1,e)}}function De(r,n){if(r&1){let e=b();o(0,"div",68)(1,"div",51)(2,"div",47)(3,"label",73),l(4,"Sibling Discount/Week ($)"),i(),o(5,"div",74)(6,"input",75),x("ngModelChange",function(t){m(e);let d=c(3);return f(d.formSeason.siblingDiscountPerWeek,t)||(d.formSeason.siblingDiscountPerWeek=t),p(t)}),i(),o(7,"span",57),l(8,"Per student when 2+ siblings"),i()()(),o(9,"div",47)(10,"label",76),l(11,"Multi-Session ($)"),i(),o(12,"div",74)(13,"input",77),x("ngModelChange",function(t){m(e);let d=c(3);return f(d.formSeason.multiSessionDiscountsText,t)||(d.formSeason.multiSessionDiscountsText=t),p(t)}),i(),o(14,"span",57),l(15,'sessions:discount (e.g., "2:10.00" = $10 off)'),i()()()(),_(16,Ee,2,1),i()}if(r&2){let e=c(3);s(6),u("ngModel",e.formSeason.siblingDiscountPerWeek),s(7),u("ngModel",e.formSeason.multiSessionDiscountsText),s(3),C(e.formSeason.multiSessionDiscountsText?16:-1)}}function Ae(r,n){if(r&1&&(o(0,"span",67),l(1),i()),r&2){let e=c(3);s(),S("",e.formSeason.earlyBirdTiers.length," tier(s)")}}function Oe(r,n){if(r&1){let e=b();o(0,"div",82)(1,"input",84),x("ngModelChange",function(t){let d=m(e).$implicit;return f(d.deadline,t)||(d.deadline=t),p(t)}),i(),o(2,"input",85),x("ngModelChange",function(t){let d=m(e).$implicit;return f(d.price,t)||(d.price=t),p(t)}),i(),o(3,"span",86),l(4),i(),o(5,"button",87),g("click",function(){let t=m(e).$index,d=c(4);return p(d.removeSeasonEarlyBirdTier(t))}),l(6,"\xD7"),i()()}if(r&2){let e=n.$implicit;s(),u("ngModel",e.deadline),s(),u("ngModel",e.price),s(2),h("$"+e.price.toFixed(2))}}function ke(r,n){if(r&1){let e=b();o(0,"div",68)(1,"div",81),M(2,Oe,7,3,"div",82,O),o(4,"button",83),g("click",function(){m(e);let t=c(3);return p(t.addSeasonEarlyBirdTier())}),l(5," + Add Tier "),i(),o(6,"span",57),l(7),i()()()}if(r&2){let e=c(3);s(2),P(e.formSeason.earlyBirdTiers),s(5),S("Classes inherit these tiers. Base: ","$"+e.formSeason.basePrice.toFixed(2))}}function Le(r,n){if(r&1){let e=b();o(0,"div",42)(1,"div",43)(2,"div",44)(3,"label",45),l(4,"Season Name *"),i(),o(5,"input",46),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.name,t)||(d.formSeason.name=t),p(t)}),i()(),o(6,"div",47)(7,"label",48),l(8,"Year *"),i(),o(9,"input",49),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.year,t)||(d.formSeason.year=t),p(t)}),i()(),o(10,"div",50)(11,"label")(12,"input",9),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.isActive,t)||(d.formSeason.isActive=t),p(t)}),i(),l(13," Active "),i()()(),o(14,"div",51)(15,"div",47)(16,"label",52),l(17,"Start Date *"),i(),o(18,"input",53),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.startDate,t)||(d.formSeason.startDate=t),p(t)}),i()(),o(19,"div",47)(20,"label",54),l(21,"End Date *"),i(),o(22,"input",55),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.endDate,t)||(d.formSeason.endDate=t),p(t)}),i()()(),o(23,"div",56)(24,"h4"),l(25,"Pricing ($) *"),i(),o(26,"span",57),l(27,"Classes inherit these prices unless overridden"),i()(),o(28,"div",43)(29,"div",47)(30,"label",58),l(31,"Base ($)"),i(),o(32,"input",59),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.basePrice,t)||(d.formSeason.basePrice=t),p(t)}),i()(),o(33,"div",47)(34,"label",60),l(35,"Lunch ($)"),i(),o(36,"input",61),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.lunchPrice,t)||(d.formSeason.lunchPrice=t),p(t)}),i()(),o(37,"div",47)(38,"label",62),l(39,"Extended Care ($)"),i(),o(40,"input",63),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.extendedCarePrice,t)||(d.formSeason.extendedCarePrice=t),p(t)}),i()()(),o(41,"div",64)(42,"button",65),g("click",function(){m(e);let t=c(2);return p(t.toggleSection("description"))}),o(43,"span",66),l(44),i(),l(45," Description "),_(46,be,2,0,"span",67),i(),_(47,ve,2,1,"div",68),i(),o(48,"div",64)(49,"button",65),g("click",function(){m(e);let t=c(2);return p(t.toggleSection("discounts"))}),o(50,"span",66),l(51),i(),l(52," Discounts "),_(53,ye,2,0,"span",67),i(),_(54,De,17,3,"div",68),i(),o(55,"div",64)(56,"button",65),g("click",function(){m(e);let t=c(2);return p(t.toggleSection("earlybird"))}),o(57,"span",66),l(58),i(),l(59," Early Bird Pricing "),_(60,Ae,2,1,"span",67),i(),_(61,ke,8,1,"div",68),i(),o(62,"div",69)(63,"button",70),g("click",function(){m(e);let t=c(2);return p(t.closeDialog())}),l(64,"Cancel"),i(),o(65,"button",71),g("click",function(){m(e);let t=c(2);return p(t.saveSeason())}),l(66),i()()()}if(r&2){let e=c(2);s(5),u("ngModel",e.formSeason.name),s(4),u("ngModel",e.formSeason.year),v("disabled",e.dialogMode()==="edit-season"),s(3),u("ngModel",e.formSeason.isActive),s(6),u("ngModel",e.formSeason.startDate),s(4),u("ngModel",e.formSeason.endDate),s(10),u("ngModel",e.formSeason.basePrice),s(4),u("ngModel",e.formSeason.lunchPrice),s(4),u("ngModel",e.formSeason.extendedCarePrice),s(4),h(e.expandedSections().has("description")?"\u25BC":"\u25B6"),s(2),C(e.formSeason.description?46:-1),s(),C(e.expandedSections().has("description")?47:-1),s(4),h(e.expandedSections().has("discounts")?"\u25BC":"\u25B6"),s(2),C(e.formSeason.siblingDiscountPerWeek||e.formSeason.multiSessionDiscountsText?53:-1),s(),C(e.expandedSections().has("discounts")?54:-1),s(4),h(e.expandedSections().has("earlybird")?"\u25BC":"\u25B6"),s(2),C(e.formSeason.earlyBirdTiers.length>0?60:-1),s(),C(e.expandedSections().has("earlybird")?61:-1),s(4),v("disabled",!e.isSeasonFormValid()),s(),S(" ",e.dialogMode()==="create-season"?"Create":"Save"," ")}}function Ve(r,n){if(r&1&&(o(0,"option",19),l(1),i()),r&2){let e=n.$implicit;v("value",e.id),s(),h(e.name)}}function Be(r,n){if(r&1&&(o(0,"span",101),l(1),i()),r&2){let e=c(3);s(),S("Using season default: ",e.getSeasonPricingDisplay("basePrice"))}}function We(r,n){if(r&1&&(o(0,"span",101),l(1),i()),r&2){let e=c(3);s(),S("Using season default: ",e.getSeasonPricingDisplay("lunchPrice"))}}function Ie(r,n){if(r&1&&(o(0,"span",101),l(1),i()),r&2){let e=c(3);s(),S("Using season default: ",e.getSeasonPricingDisplay("extendedCarePrice"))}}function Fe(r,n){if(r&1&&(o(0,"span",80),l(1),i()),r&2){let e=n.$implicit,a=c(4);s(),k("Before ",e.deadline,": ",a.formatCurrency(e.price))}}function ze(r,n){r&1&&(o(0,"span",57),l(1,"No early bird tiers defined at season level"),i())}function Ne(r,n){if(r&1){let e=b();o(0,"div",106)(1,"span",101),l(2,"Using season default tiers:"),i(),M(3,Fe,2,2,"span",80,O),_(5,ze,2,0,"span",57),o(6,"button",83),g("click",function(){m(e);let t=c(3);return p(t.initializeClassEarlyBirdTiers())}),l(7," + Override with custom tiers "),i()()}if(r&2){let e=c(3);s(3),P(e.getSeasonEarlyBirdTiers()),s(2),C(e.getSeasonEarlyBirdTiers().length===0?5:-1)}}function qe(r,n){if(r&1){let e=b();o(0,"div",82)(1,"input",84),x("ngModelChange",function(t){let d=m(e).$implicit;return f(d.deadline,t)||(d.deadline=t),p(t)}),i(),o(2,"input",85),x("ngModelChange",function(t){let d=m(e).$implicit;return f(d.price,t)||(d.price=t),p(t)}),i(),o(3,"span",86),l(4),i(),o(5,"button",87),g("click",function(){let t=m(e).$index,d=c(4);return p(d.removeEarlyBirdTier(t))}),l(6,"\xD7"),i()()}if(r&2){let e=n.$implicit;s(),u("ngModel",e.deadline),s(),u("ngModel",e.price),s(2),h("$"+e.price.toFixed(2))}}function Re(r,n){if(r&1){let e=b();o(0,"button",108),g("click",function(){m(e);let t=c(4);return p(t.clearClassEarlyBirdTiers())}),l(1," Use season defaults instead "),i()}}function je(r,n){if(r&1){let e=b();M(0,qe,7,3,"div",82,O),o(2,"button",83),g("click",function(){m(e);let t=c(3);return p(t.addEarlyBirdTier())}),l(3," + Add Early Bird Tier "),i(),_(4,Re,2,0,"button",107),o(5,"span",57),l(6),i()}if(r&2){let e=c(3);P(e.formClass.earlyBirdTiers??N(2,le)),s(4),C(e.formClass.earlyBirdTiers!==null?4:-1),s(2),S("Orders placed before deadline get discounted price. Base: ",e.getEffectiveBasePrice())}}function Ue(r,n){if(r&1){let e=b();o(0,"div",42)(1,"div",47)(2,"label",88),l(3,"Class Name *"),i(),o(4,"input",89),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.name,t)||(d.formClass.name=t),p(t)}),i()(),o(5,"div",51)(6,"div",47)(7,"label",90),l(8,"Season *"),i(),o(9,"select",91),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.seasonId,t)||(d.formClass.seasonId=t),p(t)}),o(10,"option",18),l(11,"Select season..."),i(),M(12,Ve,2,2,"option",19,A),i()(),o(14,"div",47)(15,"label")(16,"input",9),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.isActive,t)||(d.formClass.isActive=t),p(t)}),i(),l(17," Active "),i()()(),o(18,"div",51)(19,"div",47)(20,"label",92),l(21,"Start Date *"),i(),o(22,"input",93),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.startDate,t)||(d.formClass.startDate=t),p(t)}),i()(),o(23,"div",47)(24,"label",94),l(25,"End Date *"),i(),o(26,"input",95),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.endDate,t)||(d.formClass.endDate=t),p(t)}),i()()(),o(27,"div",47)(28,"label",96),l(29,"Capacity *"),i(),o(30,"input",97),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.capacity,t)||(d.formClass.capacity=t),p(t)}),i()(),o(31,"div",98)(32,"h4"),l(33,"Pricing (Optional - inherits from Season)"),i(),o(34,"span",57),l(35,"Leave empty to use Season default prices"),i()(),o(36,"div",51)(37,"div",47)(38,"label",99),l(39,"Base Price ($)"),i(),o(40,"div",74)(41,"input",100),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.basePrice,t)||(d.formClass.basePrice=t),p(t)}),i(),_(42,Be,2,1,"span",101),i()(),o(43,"div",47)(44,"label",102),l(45,"Lunch Price ($)"),i(),o(46,"div",74)(47,"input",103),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.lunchPrice,t)||(d.formClass.lunchPrice=t),p(t)}),i(),_(48,We,2,1,"span",101),i()()(),o(49,"div",47)(50,"label",104),l(51,"Extended Care Price ($)"),i(),o(52,"div",74)(53,"input",105),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.extendedCarePrice,t)||(d.formClass.extendedCarePrice=t),p(t)}),i(),_(54,Ie,2,1,"span",101),i()(),o(55,"div",47)(56,"label"),l(57,"Early Bird Pricing Tiers ($)"),i(),o(58,"div",81),_(59,Ne,8,1,"div",106)(60,je,7,3),i()(),o(61,"div",69)(62,"button",70),g("click",function(){m(e);let t=c(2);return p(t.closeDialog())}),l(63,"Cancel"),i(),o(64,"button",71),g("click",function(){m(e);let t=c(2);return p(t.saveClass())}),l(65),i()()()}if(r&2){let e=c(2);s(4),u("ngModel",e.formClass.name),s(5),u("ngModel",e.formClass.seasonId),v("disabled",e.dialogMode()==="edit-class"),s(3),P(e.seasonService.seasons()),s(4),u("ngModel",e.formClass.isActive),s(6),u("ngModel",e.formClass.startDate),s(4),u("ngModel",e.formClass.endDate),s(4),u("ngModel",e.formClass.capacity),s(11),u("ngModel",e.formClass.basePrice),v("placeholder","Inherited: "+e.getSeasonPricingDisplay("basePrice")),s(),C(e.formClass.basePrice===null&&e.formClass.seasonId?42:-1),s(5),u("ngModel",e.formClass.lunchPrice),v("placeholder","Inherited: "+e.getSeasonPricingDisplay("lunchPrice")),s(),C(e.formClass.lunchPrice===null&&e.formClass.seasonId?48:-1),s(5),u("ngModel",e.formClass.extendedCarePrice),v("placeholder","Inherited: "+e.getSeasonPricingDisplay("extendedCarePrice")),s(),C(e.formClass.extendedCarePrice===null&&e.formClass.seasonId?54:-1),s(5),C(e.formClass.earlyBirdTiers===null&&e.formClass.seasonId?59:60),s(5),v("disabled",!e.isClassFormValid()),s(),S(" ",e.dialogMode()==="create-class"?"Create":"Save"," ")}}function Ye(r,n){if(r&1){let e=b();o(0,"div",115)(1,"div",116)(2,"span",117),l(3),i(),o(4,"span",118),l(5),i(),o(6,"span",119),l(7),i()(),o(8,"button",120),g("click",function(){let t=m(e).$implicit,d=c(4);return p(d.removeCouponFromSeason(t.id))}),l(9," Remove "),i()()}if(r&2){let e=n.$implicit,a=c(4);s(3),h(e.name),s(2),h(e.id),s(2),h(a.formatCurrency(e.maxCreditCents)),s(),v("disabled",a.couponActionLoading())}}function $e(r,n){if(r&1&&(o(0,"div",110),M(1,Ye,10,4,"div",115,A),i()),r&2){let e=c(3);s(),P(e.selectedSeasonForCoupons().coupons)}}function He(r,n){r&1&&(o(0,"div",111),l(1,"No coupons assigned to this season"),i())}function Ge(r,n){if(r&1&&(o(0,"option",19),l(1),i()),r&2){let e=n.$implicit,a=c(4);v("value",e.id),s(),k("",e.name," (",a.formatCurrency(e.maxCreditCents),")")}}function Je(r,n){if(r&1){let e=b();o(0,"div",113)(1,"select",121),x("ngModelChange",function(t){m(e);let d=c(3);return f(d.selectedCouponToAdd,t)||(d.selectedCouponToAdd=t),p(t)}),o(2,"option",18),l(3,"Select a coupon..."),i(),M(4,Ge,2,3,"option",19,A),i(),o(6,"button",122),g("click",function(){m(e);let t=c(3);return p(t.addCouponToSeason())}),l(7," Add "),i()()}if(r&2){let e=c(3);s(),u("ngModel",e.selectedCouponToAdd),s(3),P(e.availableCouponsForSeason()),s(2),v("disabled",!e.selectedCouponToAdd||e.couponActionLoading())}}function Ke(r,n){r&1&&(o(0,"p",57),l(1,"No coupons exist. Create coupons in Coupon Management first."),i())}function Qe(r,n){r&1&&(o(0,"p",57),l(1,"All coupons are already assigned to this season."),i())}function Xe(r,n){if(r&1&&(o(0,"div",114),l(1),i()),r&2){let e=c(3);s(),h(e.couponActionError())}}function Ze(r,n){if(r&1){let e=b();o(0,"div",42)(1,"div",109)(2,"h4"),l(3,"Season Coupons"),i(),o(4,"p",57),l(5,"Coupons added here will automatically apply to all orders for this season."),i(),_(6,$e,3,0,"div",110),_(7,He,2,0,"div",111),o(8,"div",112)(9,"h5"),l(10,"Add Coupon"),i(),_(11,Je,8,2,"div",113),_(12,Ke,2,0,"p",57),_(13,Qe,2,0,"p",57),i(),_(14,Xe,2,1,"div",114),i(),o(15,"div",69)(16,"button",70),g("click",function(){m(e);let t=c(2);return p(t.closeDialog())}),l(17,"Done"),i()()()}if(r&2){let e=c(2);s(6),C(e.selectedSeasonForCoupons().coupons&&e.selectedSeasonForCoupons().coupons.length>0?6:-1),s(),C(!e.selectedSeasonForCoupons().coupons||e.selectedSeasonForCoupons().coupons.length===0?7:-1),s(4),C(e.availableCouponsForSeason().length>0?11:-1),s(),C(e.availableCouponsForSeason().length===0&&e.allCoupons().length===0?12:-1),s(),C(e.availableCouponsForSeason().length===0&&e.allCoupons().length>0?13:-1),s(),C(e.couponActionError()?14:-1)}}function et(r,n){if(r&1){let e=b();o(0,"div",40),g("click",function(){m(e);let t=c();return p(t.closeDialog())}),o(1,"div",41),g("click",function(t){return m(e),p(t.stopPropagation())}),o(2,"h3"),l(3),i(),_(4,Le,67,20,"div",42),_(5,Ue,66,19,"div",42),_(6,Ze,18,6,"div",42),i()()}if(r&2){let e=c();s(3),h(e.getDialogTitle()),s(),C(e.dialogMode()==="create-season"||e.dialogMode()==="edit-season"?4:-1),s(),C(e.dialogMode()==="create-class"||e.dialogMode()==="edit-class"?5:-1),s(),C(e.dialogMode()==="manage-coupons"&&e.selectedSeasonForCoupons()?6:-1)}}var se=class r{seasonService=D(H);configService=D($);userService=D(G);router=D(R);datastore=D(U);functions=D(Y);_enrollmentMap=y(new Map);selectedSeasonForCoupons=y(null);allCoupons=y([]);couponActionLoading=y(!1);couponActionError=y(null);selectedCouponToAdd="";availableCouponsForSeason=L(()=>{let n=this.selectedSeasonForCoupons();if(!n)return[];let e=new Set((n.coupons||[]).map(a=>a.id));return this.allCoupons().filter(a=>!e.has(a.id))});formatCurrency=W;formatDateRange=re;centsToDollars(n){return n/100}dollarsToCents(n){return Math.round(n*100)}viewMode=y("seasons");showActiveOnly=y(!0);selectedSeasonIdForFilter=y("");dialogMode=y(null);expandedSections=y(new Set);formSeason={name:"",year:0,startDate:"",endDate:"",isActive:!0,description:"",siblingDiscountPerWeek:5,multiSessionDiscountsText:"",basePrice:500,lunchPrice:50,extendedCarePrice:100,earlyBirdTiers:[]};formClass={seasonId:"",name:"",startDate:"",endDate:"",capacity:20,basePrice:null,lunchPrice:null,extendedCarePrice:null,isActive:!0,earlyBirdTiers:null};displayedSeasons=L(()=>{let n=this.seasonService.seasons();return this.showActiveOnly()?n.filter(e=>e.isActive):n});displayedClasses=L(()=>{let n=this.seasonService.classes();this.showActiveOnly()&&(n=n.filter(a=>a.isActive));let e=this.selectedSeasonIdForFilter();return e&&(n=n.filter(a=>a.seasonId===e)),n});async ngOnInit(){if(!this.userService.isAuthenticated()){this.router.navigate(["/login"]);return}if(!this.userService.isAdmin()){this.router.navigate(["/"]);return}await this.loadCatalog()}async loadCatalog(){let n=this.configService.currentActiveYear();try{await Promise.all([this.seasonService.loadAllSeasons(n),this.seasonService.loadAllClasses(n)]),await this.loadEnrollmentData(n)}catch(e){console.error("Failed to load catalog:",e)}}async loadEnrollmentData(n){let e=this.seasonService.seasons(),a=new Map;for(let t of e)try{let d=await this.datastore.getRegistration(n,t.id);if(d?.classes)for(let[E,T]of Object.entries(d.classes))a.set(E,T.enrolledStudents?.length??0)}catch{}this._enrollmentMap.set(a)}getEnrolledCount(n){return this._enrollmentMap().get(n)??0}openCreateDialog(){this.viewMode()==="seasons"?(this.formSeason={name:"",year:this.configService.currentActiveYear(),startDate:"",endDate:"",isActive:!0,description:"",siblingDiscountPerWeek:5,multiSessionDiscountsText:"",basePrice:500,lunchPrice:50,extendedCarePrice:100,earlyBirdTiers:[]},this.dialogMode.set("create-season")):(this.formClass={seasonId:"",name:"",startDate:"",endDate:"",capacity:20,basePrice:null,lunchPrice:null,extendedCarePrice:null,isActive:!0,earlyBirdTiers:null},this.dialogMode.set("create-class"))}openEditSeasonDialog(n){this.formSeason={id:n.id,name:n.name,year:n.year,startDate:n.startDate,endDate:n.endDate,isActive:n.isActive,description:n.description??"",siblingDiscountPerWeek:this.centsToDollars(n.siblingDiscountPerWeek??500),multiSessionDiscountsText:this.encodeMultiSessionDiscounts(n.multiSessionDiscounts??[]),basePrice:this.centsToDollars(n.basePrice),lunchPrice:this.centsToDollars(n.lunchPrice),extendedCarePrice:this.centsToDollars(n.extendedCarePrice),earlyBirdTiers:n.earlyBirdTiers?n.earlyBirdTiers.map(a=>({deadline:a.deadline,price:this.centsToDollars(a.price)})):[]};let e=new Set;n.description&&e.add("description"),(n.siblingDiscountPerWeek||(n.multiSessionDiscounts?.length??0)>0)&&e.add("discounts"),(n.earlyBirdTiers?.length??0)>0&&e.add("earlybird"),this.expandedSections.set(e),this.dialogMode.set("edit-season")}openEditClassDialog(n){this.formClass={id:n.id,seasonId:n.seasonId,name:n.name,startDate:n.startDate,endDate:n.endDate,capacity:n.capacity,basePrice:n.basePrice!=null?this.centsToDollars(n.basePrice):null,lunchPrice:n.lunchPrice!=null?this.centsToDollars(n.lunchPrice):null,extendedCarePrice:n.extendedCarePrice!=null?this.centsToDollars(n.extendedCarePrice):null,isActive:n.isActive,earlyBirdTiers:n.earlyBirdTiers?n.earlyBirdTiers.map(e=>({deadline:e.deadline,price:this.centsToDollars(e.price)})):null},this.dialogMode.set("edit-class")}closeDialog(){this.dialogMode.set(null),this.expandedSections.set(new Set)}toggleSection(n){let e=new Set(this.expandedSections());e.has(n)?e.delete(n):e.add(n),this.expandedSections.set(e)}getDialogTitle(){switch(this.dialogMode()){case"create-season":return"Create Season";case"edit-season":return"Edit Season";case"create-class":return"Create Class";case"edit-class":return"Edit Class";default:return""}}isSeasonFormValid(){return!!(this.formSeason.name&&this.formSeason.year&&this.formSeason.startDate&&this.formSeason.endDate&&this.formSeason.basePrice>0&&this.formSeason.lunchPrice>=0&&this.formSeason.extendedCarePrice>=0)}isClassFormValid(){return!!(this.formClass.name&&this.formClass.seasonId&&this.formClass.startDate&&this.formClass.endDate&&this.formClass.capacity>0)}async saveSeason(){if(!this.isSeasonFormValid())return;let n=this.parseMultiSessionDiscounts(this.formSeason.multiSessionDiscountsText);if(n===null){alert("Invalid multi-session discount format. Use format: 2:10.00, 3:20.00");return}let e=[...this.formSeason.earlyBirdTiers].sort((a,t)=>a.deadline.localeCompare(t.deadline)).map(a=>({deadline:a.deadline,price:this.dollarsToCents(a.price)}));try{if(this.dialogMode()==="create-season"){let a={year:this.formSeason.year,name:this.formSeason.name,startDate:this.formSeason.startDate,endDate:this.formSeason.endDate,isActive:this.formSeason.isActive,description:this.formSeason.description,siblingDiscountPerWeek:this.dollarsToCents(this.formSeason.siblingDiscountPerWeek),multiSessionDiscounts:n,refundProcessingFee:2e3,basePrice:this.dollarsToCents(this.formSeason.basePrice),lunchPrice:this.dollarsToCents(this.formSeason.lunchPrice),extendedCarePrice:this.dollarsToCents(this.formSeason.extendedCarePrice),earlyBirdTiers:e,coupons:[],sessions:[]};await this.seasonService.createSeason(a)}else this.dialogMode()==="edit-season"&&this.formSeason.id&&await this.seasonService.updateSeason(this.formSeason.id,{name:this.formSeason.name,startDate:this.formSeason.startDate,endDate:this.formSeason.endDate,isActive:this.formSeason.isActive,description:this.formSeason.description,siblingDiscountPerWeek:this.dollarsToCents(this.formSeason.siblingDiscountPerWeek),multiSessionDiscounts:n,basePrice:this.dollarsToCents(this.formSeason.basePrice),lunchPrice:this.dollarsToCents(this.formSeason.lunchPrice),extendedCarePrice:this.dollarsToCents(this.formSeason.extendedCarePrice),earlyBirdTiers:e});this.closeDialog()}catch(a){alert("Failed to save season: "+a.message)}}async saveClass(){if(!this.isClassFormValid())return;let n=this.formClass.earlyBirdTiers?[...this.formClass.earlyBirdTiers].sort((e,a)=>e.deadline.localeCompare(a.deadline)).map(e=>({deadline:e.deadline,price:this.dollarsToCents(e.price)})):void 0;try{if(this.dialogMode()==="create-class"){let e={seasonId:this.formClass.seasonId,name:this.formClass.name,startDate:this.formClass.startDate,endDate:this.formClass.endDate,capacity:this.formClass.capacity,basePrice:this.formClass.basePrice!=null?this.dollarsToCents(this.formClass.basePrice):void 0,lunchPrice:this.formClass.lunchPrice!=null?this.dollarsToCents(this.formClass.lunchPrice):void 0,extendedCarePrice:this.formClass.extendedCarePrice!=null?this.dollarsToCents(this.formClass.extendedCarePrice):void 0,isActive:this.formClass.isActive,earlyBirdTiers:n};await this.seasonService.createClass(e)}else this.dialogMode()==="edit-class"&&this.formClass.id&&await this.seasonService.updateClass(this.formClass.id,{name:this.formClass.name,startDate:this.formClass.startDate,endDate:this.formClass.endDate,capacity:this.formClass.capacity,basePrice:this.formClass.basePrice!=null?this.dollarsToCents(this.formClass.basePrice):void 0,lunchPrice:this.formClass.lunchPrice!=null?this.dollarsToCents(this.formClass.lunchPrice):void 0,extendedCarePrice:this.formClass.extendedCarePrice!=null?this.dollarsToCents(this.formClass.extendedCarePrice):void 0,isActive:this.formClass.isActive,earlyBirdTiers:n});this.closeDialog()}catch(e){alert("Failed to save class: "+e.message)}}async toggleSeasonActive(n){try{await this.seasonService.toggleSeasonActive(n.id)}catch(e){alert("Failed to toggle season status: "+e.message)}}async toggleClassActive(n){try{await this.seasonService.toggleClassActive(n.id)}catch(e){alert("Failed to toggle class status: "+e.message)}}addEarlyBirdTier(){this.formClass.earlyBirdTiers===null&&(this.formClass.earlyBirdTiers=[]);let n=new Date;n.setDate(n.getDate()+14);let e=n.toISOString().split("T")[0],a=this.formClass.basePrice??this.getSeasonBasePriceDollars(),t=Math.max(0,a-50);this.formClass.earlyBirdTiers.push({deadline:e,price:t})}removeEarlyBirdTier(n){this.formClass.earlyBirdTiers&&this.formClass.earlyBirdTiers.splice(n,1)}getSeasonBasePriceDollars(){if(!this.formClass.seasonId)return 500;let n=this.seasonService.seasons().find(e=>e.id===this.formClass.seasonId);return this.centsToDollars(n?.basePrice??5e4)}encodeMultiSessionDiscounts(n){return!n||n.length===0?"":n.sort((e,a)=>e.minSessions-a.minSessions).map(e=>`${e.minSessions}:${(e.discountAmount/100).toFixed(2)}`).join(", ")}parseMultiSessionDiscounts(n){if(!n.trim())return[];let e=[],a=n.split(",").map(t=>t.trim()).filter(t=>t);for(let t of a){let d=t.match(/^(\d+):(\d+(?:\.\d{1,2})?)$/);if(!d)return null;let E=parseInt(d[1],10),T=parseFloat(d[2]);if(E<1||isNaN(T)||T<0)return null;e.push({minSessions:E,discountAmount:Math.round(T*100)})}return e.sort((t,d)=>t.minSessions-d.minSessions)}getParsedMultiSessionDiscounts(){return this.parseMultiSessionDiscounts(this.formSeason.multiSessionDiscountsText)}getSeasonName(n){return this.seasonService.seasons().find(a=>a.id===n)?.name??n}getSeasonPricingDisplay(n){if(!this.formClass.seasonId)return"Select a season";let e=this.seasonService.seasons().find(a=>a.id===this.formClass.seasonId);return e?W(e[n]??0):"Season not found"}getSeasonEarlyBirdTiers(){return this.formClass.seasonId?this.seasonService.seasons().find(e=>e.id===this.formClass.seasonId)?.earlyBirdTiers??[]:[]}getEffectiveBasePrice(){return this.formClass.basePrice!==null?`$${this.formClass.basePrice.toFixed(2)}`:this.getSeasonPricingDisplay("basePrice")}initializeClassEarlyBirdTiers(){this.formClass.earlyBirdTiers=[]}clearClassEarlyBirdTiers(){this.formClass.earlyBirdTiers=null}addSeasonEarlyBirdTier(){let n=new Date;n.setDate(n.getDate()+14);let e=n.toISOString().split("T")[0],a=Math.max(0,this.formSeason.basePrice-50);this.formSeason.earlyBirdTiers.push({deadline:e,price:a})}removeSeasonEarlyBirdTier(n){this.formSeason.earlyBirdTiers.splice(n,1)}async openCouponDialog(n){this.selectedSeasonForCoupons.set(n),this.couponActionError.set(null),this.selectedCouponToAdd="",this.dialogMode.set("manage-coupons");try{let e=await this.functions.callApi("listCoupons",{});this.allCoupons.set(e.coupons)}catch(e){console.error("Failed to load coupons:",e),this.allCoupons.set([])}}async addCouponToSeason(){let n=this.selectedSeasonForCoupons();if(!n||!this.selectedCouponToAdd)return;let e=this.allCoupons().find(a=>a.id===this.selectedCouponToAdd);if(e){this.couponActionLoading.set(!0),this.couponActionError.set(null);try{await this.functions.callApi("addCouponToSeason",{seasonId:n.id,coupon:e});let a=[...n.coupons||[],e];this.selectedSeasonForCoupons.set(B(V({},n),{coupons:a})),this.selectedCouponToAdd="",await this.seasonService.loadAllSeasons(this.configService.currentActiveYear())}catch(a){console.error("Failed to add coupon to season:",a),this.couponActionError.set(a instanceof Error?a.message:"Failed to add coupon")}finally{this.couponActionLoading.set(!1)}}}async removeCouponFromSeason(n){let e=this.selectedSeasonForCoupons();if(e){this.couponActionLoading.set(!0),this.couponActionError.set(null);try{await this.functions.callApi("removeCouponFromSeason",{seasonId:e.id,couponId:n});let a=(e.coupons||[]).filter(t=>t.id!==n);this.selectedSeasonForCoupons.set(B(V({},e),{coupons:a})),await this.seasonService.loadAllSeasons(this.configService.currentActiveYear())}catch(a){console.error("Failed to remove coupon from season:",a),this.couponActionError.set(a instanceof Error?a.message:"Failed to remove coupon")}finally{this.couponActionLoading.set(!1)}}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=F({type:r,selectors:[["app-admin-catalog-list"]],decls:27,vars:14,consts:[[1,"admin-catalog"],[1,"page-header"],["routerLink","/admin",1,"back-link"],[1,"subtitle"],[1,"tab-bar"],[1,"tab",3,"click"],[1,"filter-bar"],[1,"filter-controls"],[1,"toggle-filter"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"season-filter",3,"ngModel"],[1,"btn-create",3,"click"],[1,"loading-container"],[1,"error-container"],[1,"seasons-grid"],[1,"classes-table-container"],[1,"dialog-overlay"],[1,"season-filter",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"spinner"],[1,"error-icon"],[1,"btn-retry",3,"click"],[1,"season-card",3,"inactive"],[1,"empty-state"],[1,"season-card"],[1,"card-header"],[1,"season-dates"],[1,"status-badge"],[1,"card-content"],[1,"info-row"],[1,"season-description"],[1,"card-actions"],[1,"btn-action",3,"click"],[1,"btn-action",3,"click","disabled"],[1,"classes-table"],[3,"inactive"],[1,"action-buttons"],[1,"btn-sm",3,"click"],[1,"btn-sm",3,"click","disabled"],[1,"dialog-overlay",3,"click"],[1,"dialog",3,"click"],[1,"dialog-form"],[1,"form-row","form-row-3"],[1,"form-group","form-group-wide"],["for","seasonName"],["type","text","id","seasonName","required","",3,"ngModelChange","ngModel"],[1,"form-group"],["for","seasonYear"],["type","number","id","seasonYear","required","",3,"ngModelChange","ngModel","disabled"],[1,"form-group","form-group-checkbox"],[1,"form-row"],["for","seasonStartDate"],["type","date","id","seasonStartDate","required","",3,"ngModelChange","ngModel"],["for","seasonEndDate"],["type","date","id","seasonEndDate","required","",3,"ngModelChange","ngModel"],[1,"form-section-header"],[1,"hint"],["for","seasonBasePrice"],["type","number","id","seasonBasePrice","step","0.01","min","0","required","",3,"ngModelChange","ngModel"],["for","seasonLunchPrice"],["type","number","id","seasonLunchPrice","step","0.01","min","0","required","",3,"ngModelChange","ngModel"],["for","seasonExtendedCarePrice"],["type","number","id","seasonExtendedCarePrice","step","0.01","min","0","required","",3,"ngModelChange","ngModel"],[1,"collapsible-section"],["type","button",1,"section-toggle",3,"click"],[1,"toggle-icon"],[1,"section-badge"],[1,"section-content"],[1,"dialog-actions"],[1,"btn-secondary",3,"click"],[1,"btn-primary",3,"click","disabled"],["id","seasonDescription","rows","3","placeholder","Optional description (supports Markdown)",3,"ngModelChange","ngModel"],["for","siblingDiscount"],[1,"input-with-hint"],["type","number","id","siblingDiscount","step","0.01","min","0",3,"ngModelChange","ngModel"],["for","multiSessionDiscounts"],["type","text","id","multiSessionDiscounts","placeholder","2:10.00, 3:20.00",3,"ngModelChange","ngModel"],[1,"discount-preview","error"],[1,"discount-preview"],[1,"discount-tier"],[1,"early-bird-tiers"],[1,"tier-row"],["type","button",1,"btn-add-tier",3,"click"],["type","date","placeholder","Deadline",3,"ngModelChange","ngModel"],["type","number","step","0.01","min","0","placeholder","Price ($)",3,"ngModelChange","ngModel"],[1,"tier-price-hint"],["type","button",1,"btn-remove",3,"click"],["for","className"],["type","text","id","className","required","",3,"ngModelChange","ngModel"],["for","classSeason"],["id","classSeason","required","",3,"ngModelChange","ngModel","disabled"],["for","classStartDate"],["type","date","id","classStartDate","required","",3,"ngModelChange","ngModel"],["for","classEndDate"],["type","date","id","classEndDate","required","",3,"ngModelChange","ngModel"],["for","classCapacity"],["type","number","id","classCapacity","min","1","required","",3,"ngModelChange","ngModel"],[1,"form-section"],["for","classBasePrice"],["type","number","id","classBasePrice","step","0.01","min","0",3,"ngModelChange","ngModel","placeholder"],[1,"hint","inherited"],["for","classLunchPrice"],["type","number","id","classLunchPrice","step","0.01","min","0",3,"ngModelChange","ngModel","placeholder"],["for","classExtendedCarePrice"],["type","number","id","classExtendedCarePrice","step","0.01","min","0",3,"ngModelChange","ngModel","placeholder"],[1,"inherited-preview"],["type","button",1,"btn-inherit"],["type","button",1,"btn-inherit",3,"click"],[1,"coupon-section"],[1,"coupon-list"],[1,"no-coupons"],[1,"add-coupon-section"],[1,"coupon-select-row"],[1,"error-message"],[1,"coupon-item"],[1,"coupon-info"],[1,"coupon-name"],[1,"coupon-id"],[1,"coupon-credit"],[1,"btn-remove-coupon",3,"click","disabled"],[1,"coupon-select",3,"ngModelChange","ngModel"],[1,"btn-add-coupon",3,"click","disabled"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"header",1)(2,"a",2),l(3,"\u2190 Back to Dashboard"),i(),o(4,"h1"),l(5,"Catalog Management"),i(),o(6,"p",3),l(7,"Manage seasons and classes"),i()(),o(8,"div",4)(9,"button",5),g("click",function(){return a.viewMode.set("seasons")}),l(10),i(),o(11,"button",5),g("click",function(){return a.viewMode.set("classes")}),l(12),i()(),o(13,"div",6)(14,"div",7)(15,"label",8)(16,"input",9),x("ngModelChange",function(d){return f(a.showActiveOnly,d)||(a.showActiveOnly=d),d}),i(),o(17,"span"),l(18,"Active Only"),i()(),_(19,me,5,1,"select",10),i(),o(20,"button",11),g("click",function(){return a.openCreateDialog()}),l(21),i()(),_(22,pe,4,0,"div",12),_(23,_e,7,1,"div",13),_(24,fe,4,1,"div",14),_(25,Se,24,1,"div",15),_(26,et,7,4,"div",16),i()),e&2&&(s(9),w("active",a.viewMode()==="seasons"),s(),S(" Seasons (",a.seasonService.seasons().length,") "),s(),w("active",a.viewMode()==="classes"),s(),S(" Classes (",a.seasonService.classes().length,") "),s(4),u("ngModel",a.showActiveOnly),s(3),C(a.viewMode()==="classes"?19:-1),s(2),S(" + Create ",a.viewMode()==="seasons"?"Season":"Class"," "),s(),C(a.seasonService.loading()?22:-1),s(),C(a.seasonService.error()?23:-1),s(),C(a.viewMode()==="seasons"&&!a.seasonService.loading()&&!a.seasonService.error()?24:-1),s(),C(a.viewMode()==="classes"&&!a.seasonService.loading()&&!a.seasonService.error()?25:-1),s(),C(a.dialogMode()?26:-1))},dependencies:[q,ae,te,ne,K,Z,J,ee,Q,oe,ie,X,j],styles:[".admin-catalog[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:1.5rem}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.back-link[_ngcontent-%COMP%]{display:inline-block;color:var(--sys-primary, #c62828);text-decoration:none;font-size:.875rem;margin-bottom:.5rem}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.75rem}.subtitle[_ngcontent-%COMP%]{margin:0;color:#666;font-size:.875rem}.tab-bar[_ngcontent-%COMP%]{display:flex;gap:.5rem;border-bottom:2px solid #e0e0e0;margin-bottom:1.5rem}.tab[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:none;border:none;border-bottom:3px solid transparent;cursor:pointer;font-size:1rem;font-weight:500;color:#666;transition:all .2s}.tab[_ngcontent-%COMP%]:hover{color:#333}.tab.active[_ngcontent-%COMP%]{color:var(--sys-primary, #c62828);border-bottom-color:var(--sys-primary, #c62828)}.filter-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding:1rem;background:#f5f5f5;border-radius:8px}.filter-controls[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}.toggle-filter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.season-filter[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem}.btn-create[_ngcontent-%COMP%]{padding:.75rem 1.25rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:6px;font-weight:500;cursor:pointer}.btn-create[_ngcontent-%COMP%]:hover{background:#a51c1c}.seasons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}.season-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:1.5rem;transition:box-shadow .2s}.season-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a}.season-card.inactive[_ngcontent-%COMP%]{opacity:.6}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid #f0f0f0}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1.25rem}.season-dates[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#666}.status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.75rem;font-weight:500;background:#e0e0e0;color:#666}.status-badge.active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.card-content[_ngcontent-%COMP%]{margin-bottom:1rem}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;font-size:.875rem}.season-description[_ngcontent-%COMP%]{margin-top:.75rem;padding-top:.75rem;border-top:1px solid #f0f0f0;font-size:.875rem;color:#666;white-space:pre-wrap}.card-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn-action[_ngcontent-%COMP%]{flex:1;padding:.5rem;background:#fff;border:1px solid #ddd;border-radius:6px;cursor:pointer;font-size:.875rem}.btn-action[_ngcontent-%COMP%]:hover:not(:disabled){background:#f5f5f5}.btn-action.btn-activate[_ngcontent-%COMP%]{border-color:var(--sys-primary, #c62828);color:var(--sys-primary, #c62828)}.btn-action[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.classes-table-container[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;overflow:hidden}.classes-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.classes-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f5f5f5}.classes-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .classes-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #e0e0e0}.classes-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem;color:#666}.classes-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.875rem}.classes-table[_ngcontent-%COMP%]   tr.inactive[_ngcontent-%COMP%]{opacity:.6}.classes-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f9f9f9}.text-warning[_ngcontent-%COMP%]{color:#ff9800;font-weight:600}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;background:#fff;border:1px solid #ddd;border-radius:4px;font-size:.75rem;cursor:pointer}.btn-sm[_ngcontent-%COMP%]:hover:not(:disabled){background:#f5f5f5}.btn-sm.btn-activate[_ngcontent-%COMP%]{border-color:var(--sys-primary, #c62828);color:var(--sys-primary, #c62828)}.btn-sm[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:2rem;max-width:600px;width:90%;max-height:90vh;overflow-y:auto;overflow-x:hidden;box-sizing:border-box}.dialog-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;overflow:hidden}.dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;width:100%;box-sizing:border-box}.form-row-3[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr}.form-group-wide[_ngcontent-%COMP%]{grid-column:span 1}.form-group-checkbox[_ngcontent-%COMP%]{display:flex;align-items:flex-end;padding-bottom:.75rem}.form-section-header[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:.75rem;margin-top:.5rem;padding-bottom:.25rem;border-bottom:1px solid #e0e0e0}.form-section-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#333}.collapsible-section[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:6px;overflow:hidden}.section-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;width:100%;padding:.75rem 1rem;background:#f9f9f9;border:none;cursor:pointer;font-size:.875rem;font-weight:500;color:#333;text-align:left}.section-toggle[_ngcontent-%COMP%]:hover{background:#f0f0f0}.toggle-icon[_ngcontent-%COMP%]{font-size:.7rem;color:#666}.section-badge[_ngcontent-%COMP%]{margin-left:auto;padding:.125rem .5rem;background:#e8f5e9;color:#2e7d32;border-radius:10px;font-size:.7rem;font-weight:500}.section-content[_ngcontent-%COMP%]{padding:1rem;border-top:1px solid #e0e0e0}.section-content[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem;font-family:inherit;resize:vertical}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:.875rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem;font-family:inherit;box-sizing:border-box;max-width:100%}.form-group[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto;margin-right:.5rem}.input-with-hint[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.input-with-hint[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem;box-sizing:border-box;width:100%}.hint[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.discount-preview[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.5rem;padding:.5rem;background:#e8f5e9;border-radius:4px;font-size:.75rem}.discount-preview.error[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.discount-tier[_ngcontent-%COMP%]{background:#c8e6c9;padding:.25rem .5rem;border-radius:4px;color:#2e7d32}.early-bird-tiers[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.tier-row[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.tier-row[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]{flex:1;padding:.5rem;border:1px solid #ddd;border-radius:4px;font-size:.875rem}.tier-row[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:120px;padding:.5rem;border:1px solid #ddd;border-radius:4px;font-size:.875rem}.tier-price-hint[_ngcontent-%COMP%]{font-size:.75rem;color:#666;min-width:60px}.btn-remove[_ngcontent-%COMP%]{background:#f44336;color:#fff;border:none;border-radius:4px;width:28px;height:28px;cursor:pointer;font-size:1.2rem;line-height:1;display:flex;align-items:center;justify-content:center}.btn-remove[_ngcontent-%COMP%]:hover{background:#d32f2f}.btn-add-tier[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32;border:1px dashed #4caf50;border-radius:4px;padding:.5rem 1rem;cursor:pointer;font-size:.875rem;align-self:flex-start}.btn-add-tier[_ngcontent-%COMP%]:hover{background:#c8e6c9}.btn-inherit[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;border:1px dashed #2196f3;border-radius:4px;padding:.5rem 1rem;cursor:pointer;font-size:.875rem;align-self:flex-start;margin-left:.5rem}.btn-inherit[_ngcontent-%COMP%]:hover{background:#bbdefb}.form-section[_ngcontent-%COMP%]{margin-top:1rem;padding-top:1rem;border-top:1px solid #e0e0e0}.form-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1rem;color:#333}.hint.inherited[_ngcontent-%COMP%]{color:#1976d2;font-style:italic}.inherited-preview[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;padding:.75rem;background:#e3f2fd;border-radius:6px}.dialog-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end;margin-top:1.5rem}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:6px;font-weight:500;cursor:pointer}.btn-primary[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#a51c1c}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#f5f5f5;color:#333}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}.loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f3f3f3;border-top:3px solid var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-icon[_ngcontent-%COMP%]{width:60px;height:60px;background:#f44336;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:700;margin:0 auto 1rem}.btn-retry[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer;margin-top:1rem}.coupon-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.coupon-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1rem;color:#333}.coupon-section[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.875rem;color:#666}.coupon-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.coupon-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#f5f5f5;border-radius:6px}.coupon-info[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}.coupon-name[_ngcontent-%COMP%]{font-weight:500}.coupon-id[_ngcontent-%COMP%]{font-size:.75rem;font-family:monospace;color:#666;background:#fff;padding:.125rem .375rem;border-radius:4px}.coupon-credit[_ngcontent-%COMP%]{color:#2e7d32;font-weight:500}.btn-remove-coupon[_ngcontent-%COMP%]{padding:.375rem .75rem;background:#f44336;color:#fff;border:none;border-radius:4px;font-size:.75rem;cursor:pointer}.btn-remove-coupon[_ngcontent-%COMP%]:hover:not(:disabled){background:#d32f2f}.btn-remove-coupon[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.no-coupons[_ngcontent-%COMP%]{padding:1rem;text-align:center;color:#666;background:#f9f9f9;border-radius:6px}.add-coupon-section[_ngcontent-%COMP%]{padding-top:1rem;border-top:1px solid #e0e0e0}.coupon-select-row[_ngcontent-%COMP%]{display:flex;gap:.5rem}.coupon-select[_ngcontent-%COMP%]{flex:1;padding:.5rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem}.btn-add-coupon[_ngcontent-%COMP%]{padding:.5rem 1rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer}.btn-add-coupon[_ngcontent-%COMP%]:hover:not(:disabled){background:#a51c1c}.btn-add-coupon[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{padding:.75rem;background:#ffebee;color:#c62828;border-radius:6px;font-size:.875rem}@media(max-width:768px){.seasons-grid[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.filter-bar[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.filter-controls[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}"]})};export{se as AdminCatalogListComponent};
