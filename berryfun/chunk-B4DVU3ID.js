import{a as Me}from"./chunk-PZIVJ3MC.js";import{a as De}from"./chunk-2OIRXN5N.js";import{a as we}from"./chunk-DN4JYJ55.js";import{a as me,b as ue,c as pe,d as _e,e as ge,f as Ce,g as fe,i as xe,j as he,k as be,m as ve,q as ye}from"./chunk-E62POJJA.js";import{a as Oe,b as Se}from"./chunk-4HCI3TMR.js";import"./chunk-QMA264EO.js";import{a as B,b as G}from"./chunk-RYIKU5Y3.js";import{$ as ce,D as X,E as ee,F as te,G as ne,P as ie,Q as oe,R as re,S as ae,X as de,Y as se,Z as le,b as J,d as Z,j as Q}from"./chunk-UHLAHZJO.js";import"./chunk-UYHN5VVP.js";import{$a as V,Ab as v,Bb as z,Ea as d,Eb as O,Fb as S,Gb as w,Lb as K,N as T,Pa as H,Pb as x,S as m,Sb as Y,T as u,Za as p,_a as _,bb as A,cb as E,da as I,db as f,eb as n,fb as o,gb as M,kb as b,mb as g,ob as l,yb as a,zb as C}from"./chunk-DU5POHF6.js";import"./chunk-Q7L6LLAK.js";function Pe(i){switch(i){case"locked":return"status-badge status-locked";case"submitted":return"status-badge status-submitted";case"secured":return"status-badge status-secured";case"paid":return"status-badge status-paid";case"cancelled":return"status-badge status-cancelled";case"change_requested":return"status-badge status-change-requested";case"refunded":return"status-badge status-refunded";case"partial":return"status-badge status-partial";case"empty":return"status-badge status-empty";default:return"status-badge"}}function Ie(i){switch(i){case"locked":return"Awaiting Screenshot";case"submitted":return"Pending Payment";case"secured":return"Deposit Paid";case"paid":return"Paid";case"cancelled":return"Cancelled";case"change_requested":return"Change Requested";case"refunded":return"Refunded";case"partial":return"Partially Paid";case"empty":return"Empty";default:return i}}function Ae(i){switch(i){case"locked":return"item-status-badge item-status-locked";case"submitted":return"item-status-badge item-status-submitted";case"secured":return"item-status-badge item-status-secured";case"paid":return"item-status-badge item-status-paid";case"cancelled":return"item-status-badge item-status-cancelled";case"refunded":return"item-status-badge item-status-refunded";default:return"item-status-badge"}}function Ee(i){switch(i){case"locked":return"Awaiting Screenshot";case"submitted":return"Pending";case"secured":return"Deposit Paid";case"paid":return"Paid";case"cancelled":return"Cancelled";case"refunded":return"Refunded";default:return i}}function ke(i){return`$${(i/100).toFixed(2)}`}function F(i){let t=i.replace(/[^0-9.]/g,""),e=parseFloat(t)||0;return Math.round(e*100)}function q(i){return(i/100).toFixed(2)}var Le=(i,t)=>({"text-danger":i,"text-warning":t}),Fe=(i,t)=>t.sessionId,We=(i,t)=>t.id,ze=(i,t)=>t.sessionId+"-"+t.studentId;function Be(i,t){i&1&&(n(0,"div",2),M(1,"div",6),n(2,"p"),a(3,"Loading order details..."),o()())}function Ge(i,t){if(i&1){let e=b();n(0,"div",3)(1,"strong"),a(2,"Error:"),o(),a(3),n(4,"button",7),g("click",function(){m(e);let r=l();return u(r.clearError())}),a(5,"\xD7"),o()()}if(i&2){let e=l();d(3),v(" ",e.error()," ")}}function $e(i,t){if(i&1&&(n(0,"div",18)(1,"span",10),a(2,"Phone:"),o(),n(3,"span",11),a(4),o()()),i&2){let e=l(3);d(4),C(e.userData().phone)}}function Ue(i,t){if(i&1&&(n(0,"div",18)(1,"span",10),a(2,"Address:"),o(),n(3,"span",11),a(4),o()()),i&2){let e=l(3);d(4),C(e.userData().address)}}function He(i,t){if(i&1&&(n(0,"div",15)(1,"h2"),a(2,"User Information"),o(),n(3,"div",29)(4,"div",18)(5,"span",10),a(6,"Name:"),o(),n(7,"span",11),a(8),o()(),n(9,"div",18)(10,"span",10),a(11,"Email:"),o(),n(12,"span",11),a(13),o()(),p(14,$e,5,1,"div",18),p(15,Ue,5,1,"div",18),o()()),i&2){let e=l(2);d(8),C(e.userData().displayName),d(5),C(e.userData().email),d(),_(e.userData().phone?14:-1),d(),_(e.userData().address?15:-1)}}function Ke(i,t){if(i&1&&(n(0,"span",31),a(1),o()),i&2){let e=l(3);d(),z(" (",e.remainingLockTime().hours,"h ",e.remainingLockTime().minutes,"m remaining) ")}}function Ye(i,t){if(i&1&&(n(0,"div",18)(1,"span",10),a(2,"Lock Expires:"),o(),n(3,"span",30),a(4),p(5,Ke,2,2,"span",31),o()()),i&2){let e=l(2);d(3),f("ngClass",K(3,Le,e.isOverdue(),e.isExpiringSoon())),d(),v(" ",e.formatDateTime(e.order().lockExpiresAt)," "),d(),_(e.remainingLockTime()?5:-1)}}function Je(i,t){i&1&&(n(0,"div",20)(1,"strong"),a(2,"\u26A0\uFE0F Overdue:"),o(),a(3," This order's payment lock has expired. Items may be released. "),o())}function Ze(i,t){i&1&&(n(0,"div",21)(1,"p"),a(2,"No items in this order."),o()())}function Qe(i,t){if(i&1){let e=b();n(0,"app-ledger-order-items",32),g("cancelItemsClick",function(){m(e);let r=l(2);return u(r.openCancelItemsDialog())})("confirmScreenshot",function(r){m(e);let c=l(2);return u(c.confirmScreenshotPayment(r))})("rejectScreenshot",function(r){m(e);let c=l(2);return u(c.rejectScreenshotPayment(r))}),o()}if(i&2){let e=l(2);f("lockedItems",e.lockedItemsTransformed())("submittedItems",e.submittedItemsTransformed())("securedItems",e.securedItemsTransformed())("paidItems",e.paidItemsTransformed())("editable",!1)("isAdmin",!0)("screenshotGroups",e.screenshotGroups())}}function Xe(i,t){if(i&1&&(n(0,"tr")(1,"td"),a(2),o(),n(3,"td",34),a(4),o(),n(5,"td")(6,"span",35),a(7),o()(),n(8,"td"),a(9),o(),n(10,"td"),a(11),o()()),i&2){let e=t.$implicit,s=l(3);d(2),C(s.formatDateTime(e.recordedAt)),d(2),C(s.formatCurrency(e.amount)),d(3),C(e.method),d(2),C(e.reference),d(2),C(e.notes||"-")}}function et(i,t){if(i&1&&(n(0,"div",23)(1,"h2"),a(2,"Payment History"),o(),n(3,"table",33)(4,"thead")(5,"tr")(6,"th"),a(7,"Date"),o(),n(8,"th"),a(9,"Amount"),o(),n(10,"th"),a(11,"Method"),o(),n(12,"th"),a(13,"Reference"),o(),n(14,"th"),a(15,"Notes"),o()()(),n(16,"tbody"),A(17,Xe,12,5,"tr",null,V),o()()()),i&2){let e=l(2);d(17),E(e.payments())}}function tt(i,t){if(i&1){let e=b();n(0,"div",37)(1,"div",38)(2,"span",39),a(3),o()(),n(4,"div",40)(5,"div",41)(6,"span",10),a(7,"Joined:"),o(),n(8,"span",11),a(9),o()()(),n(10,"button",42),g("click",function(){let r=m(e).$implicit,c=l(3);return u(c.openRemoveWaitlistDialog(r.sessionId))}),a(11," Remove Entry "),o()()}if(i&2){let e=t.$implicit,s=l(3);d(3),C(s.getClassName(e.sessionId)),d(6),C(s.formatDateTime(e.joinedAt))}}function nt(i,t){if(i&1&&(n(0,"div",24)(1,"h2"),a(2,"Waitlist Entries"),o(),n(3,"div",36),A(4,tt,12,2,"div",37,Fe),o()()),i&2){let e=l(2);d(4),E(e.waitlistEntries())}}function it(i,t){if(i&1&&(n(0,"div",51),a(1),o()),i&2){let e=t.$implicit,s=l(4);d(),v(" ",s.getActionDescription(e)," ")}}function ot(i,t){if(i&1&&(n(0,"div",53)(1,"span",10),a(2,"Reason:"),o(),n(3,"span",11),a(4),o()()),i&2){let e=l().$implicit;d(4),C(e.reason)}}function rt(i,t){if(i&1&&(n(0,"div",53)(1,"span",10),a(2,"Admin Adjustment:"),o(),n(3,"span",30),a(4),o()()),i&2){let e=l().$implicit,s=l(3);d(3),f("ngClass",e.adminAdjustment<0?"text-success":"text-danger"),d(),z(" ",e.adminAdjustment<0?"-":"+","",s.formatCurrency(s.Math.abs(e.adminAdjustment))," ")}}function at(i,t){if(i&1&&(n(0,"div",53)(1,"span",10),a(2,"Adjustment Reason:"),o(),n(3,"span",11),a(4),o()()),i&2){let e=l().$implicit;d(4),C(e.adminAdjustmentReason)}}function dt(i,t){if(i&1&&(n(0,"div",53)(1,"span",10),a(2,"Processed:"),o(),n(3,"span",11),a(4),o()()),i&2){let e=l().$implicit,s=l(3);d(4),C(s.formatDateTime(e.processedAt))}}function st(i,t){if(i&1&&(n(0,"div",53)(1,"span",10),a(2,"Admin Notes:"),o(),n(3,"span",11),a(4),o()()),i&2){let e=l().$implicit;d(4),C(e.adminNotes)}}function lt(i,t){if(i&1){let e=b();n(0,"button",55),g("click",function(){m(e);let r=l().$implicit,c=l(3);return u(c.openUpdateAdjustmentDialog(r))}),a(1," Edit Adjustment "),o(),n(2,"button",56),g("click",function(){m(e);let r=l().$implicit,c=l(3);return u(c.openApproveChangeDialog(r))}),a(3," Approve "),o(),n(4,"button",42),g("click",function(){m(e);let r=l().$implicit,c=l(3);return u(c.openDenyChangeDialog(r))}),a(5," Deny "),o()}}function ct(i,t){if(i&1&&(n(0,"div",44)(1,"div",45)(2,"div",46)(3,"span",47),a(4),o(),n(5,"span",48),a(6),o()()(),n(7,"div",49)(8,"div",50)(9,"strong"),a(10,"Actions:"),o(),A(11,it,2,1,"div",51,V),o(),n(13,"div",52)(14,"div",53)(15,"span",10),a(16,"Requested:"),o(),n(17,"span",11),a(18),o()(),p(19,ot,5,1,"div",53),p(20,rt,5,3,"div",53),p(21,at,5,1,"div",53),p(22,dt,5,1,"div",53),p(23,st,5,1,"div",53),o()(),n(24,"div",54),p(25,lt,6,0),o()()),i&2){let e=t.$implicit,s=l(3);f("ngClass","status-"+e.status),d(4),C(e.id),d(),f("ngClass","status-"+e.status),d(),v(" ",s.getChangeStatusLabel(e.status)," "),d(5),E(e.actions),d(7),C(s.formatDateTime(e.requestedAt)),d(),_(e.reason?19:-1),d(),_(e.adminAdjustment!==0?20:-1),d(),_(e.adminAdjustmentReason?21:-1),d(),_(e.processedAt?22:-1),d(),_(e.adminNotes?23:-1),d(2),_(e.status==="pending"?25:-1)}}function mt(i,t){if(i&1&&(n(0,"div",25)(1,"h2"),a(2,"Change Requests"),o(),n(3,"div",43),A(4,ct,26,11,"div",44,We),o()()),i&2){let e=l(2);d(4),E(e.changeRequests())}}function ut(i,t){if(i&1&&(n(0,"div",64),a(1),o()),i&2){let e=l().$implicit;d(),C(e.details)}}function pt(i,t){i&1&&(n(0,"span",70),a(1,"Lunch"),o())}function _t(i,t){i&1&&(n(0,"span",70),a(1,"Extended Care"),o())}function gt(i,t){if(i&1&&(n(0,"span",69),p(1,pt,2,0,"span",70),p(2,_t,2,0,"span",70),o()),i&2){let e=l().$implicit;d(),_(e.options.lunch?1:-1),d(),_(e.options.extendedCare?2:-1)}}function Ct(i,t){if(i&1&&(n(0,"div",66)(1,"span",67),a(2),o(),n(3,"span",68),a(4),o(),p(5,gt,3,2,"span",69),o()),i&2){let e=t.$implicit,s=l(6);d(2),C(e.className),d(2),C(s.getStudentName(e.studentId)),d(),_(e.options?5:-1)}}function ft(i,t){if(i&1&&(n(0,"div",65),A(1,Ct,6,3,"div",66,V),o()),i&2){let e=l().$implicit;d(),E(e.affectedItems)}}function xt(i,t){if(i&1&&(n(0,"div",60)(1,"div",61),a(2),o(),n(3,"div",62)(4,"div",63),a(5),o(),p(6,ut,2,1,"div",64),p(7,ft,3,0,"div",65),o()()),i&2){let e=t.$implicit,s=l(4);d(2),C(s.formatDateTime(e.timestamp)),d(3),C(e.action),d(),_(e.details?6:-1),d(),_(e.affectedItems&&e.affectedItems.length>0?7:-1)}}function ht(i,t){if(i&1&&(n(0,"div",59),A(1,xt,8,4,"div",60,V),o()),i&2){let e=l(3);d(),E(e.reversedHistory())}}function bt(i,t){if(i&1){let e=b();n(0,"div",26)(1,"div",57),g("click",function(){m(e);let r=l(2);return u(r.historyExpanded.set(!r.historyExpanded()))}),n(2,"h2"),a(3),o(),n(4,"button",58),a(5),o()(),p(6,ht,3,0,"div",59),o()}if(i&2){let e=l(2);d(3),v("Order History (",e.reversedHistory().length,")"),d(2),v(" ",e.historyExpanded()?"\u25BC":"\u25B6"," "),d(),_(e.historyExpanded()?6:-1)}}function vt(i,t){if(i&1){let e=b();n(0,"div",4)(1,"div",8)(2,"div",9)(3,"span",10),a(4,"User ID:"),o(),n(5,"span",11),a(6),o()(),n(7,"span",12),a(8),o()(),n(9,"div",13)(10,"div",14),p(11,He,16,4,"div",15),n(12,"div",16)(13,"h2"),a(14,"Order Status"),o(),n(15,"div",17)(16,"div",18)(17,"span",10),a(18,"Status:"),o(),n(19,"span",19),a(20),o()(),p(21,Ye,6,6,"div",18),n(22,"div",18)(23,"span",10),a(24,"Created:"),o(),n(25,"span",11),a(26),o()(),n(27,"div",18)(28,"span",10),a(29,"Last Updated:"),o(),n(30,"span",11),a(31),o()()(),p(32,Je,4,0,"div",20),o(),p(33,Ze,3,0,"div",21)(34,Qe,1,7,"app-ledger-order-items",22),p(35,et,19,0,"div",23),p(36,nt,6,0,"div",24),p(37,mt,6,0,"div",25),p(38,bt,7,3,"div",26),o(),n(39,"div",27)(40,"app-ledger-settlement-sidebar",28),g("recordPaymentClick",function(){m(e);let r=l();return u(r.openRecordPaymentDialog())})("addAdjustmentClick",function(){m(e);let r=l();return u(r.openAddAdjustmentDialog())}),o()()()()}if(i&2){let e=l();d(6),C(e.order().userDisplayId),d(),f("ngClass",e.getStatusBadgeClass(e.getOrderStatus(e.order()))),d(),v(" ",e.getStatusLabel(e.getOrderStatus(e.order()))," "),d(3),_(e.userData()?11:-1),d(8),f("ngClass",e.getStatusBadgeClass(e.getOrderStatus(e.order()))),d(),v(" ",e.getStatusLabel(e.getOrderStatus(e.order()))," "),d(),_(e.order().lockExpiresAt?21:-1),d(5),C(e.formatDateTime(e.order().createdAt)),d(5),C(e.formatDateTime(e.order().updatedAt)),d(),_(e.isOverdue()?32:-1),d(),_(e.allItems().length===0?33:34),d(2),_(e.payments().length>0?35:-1),d(),_(e.waitlistEntries().length>0?36:-1),d(),_(e.changeRequests().length>0?37:-1),d(),_(e.reversedHistory().length>0?38:-1),d(2),f("isAdmin",!0)("canRecordPayment",e.canRecordPayment())("orderSummary",e.orderSummaryData())}}function yt(i,t){if(i&1&&(n(0,"div",86)(1,"div",95)(2,"span"),a(3,"Original Amount Due:"),o(),n(4,"span"),a(5),o()(),n(6,"div",96)(7,"span"),a(8,"Cash Discount (3%):"),o(),n(9,"span"),a(10),o()(),n(11,"div",97)(12,"span"),a(13,"Cash Amount Due:"),o(),n(14,"span"),a(15),o()(),n(16,"small",79),a(17),o()()),i&2){let e=l(2);d(5),C(e.formatCurrency(e.amountDue())),d(5),v("-",e.formatCurrency(e.cashDiscount())),d(5),C(e.formatCurrency(e.cashAmountDue())),d(2),v(" A credit of ",e.formatCurrency(e.cashDiscount())," will be automatically applied. ")}}function Ot(i,t){if(i&1){let e=b();n(0,"div",91)(1,"label",98)(2,"input",99),w("ngModelChange",function(r){m(e);let c=l(2);return S(c.formPayment.isDepositConfirmation,r)||(c.formPayment.isDepositConfirmation=r),u(r)}),o(),n(3,"span"),a(4,"Deposit Only (mark as secured, not fully paid)"),o()(),n(5,"small",79),a(6,' Check this for cash deposit confirmations. Items will be marked as "secured" instead of "paid", and user keeps their spot until full payment. '),o()()}if(i&2){let e=l(2);d(2),O("ngModel",e.formPayment.isDepositConfirmation)}}function St(i,t){if(i&1&&(n(0,"div",20),a(1),o()),i&2){let e=l(2);d(),C(e.actionError())}}function wt(i,t){i&1&&(M(0,"span",100),a(1," Recording... "))}function Dt(i,t){i&1&&a(0," Record Payment ")}function Mt(i,t){if(i&1){let e=b();n(0,"div",71),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),n(1,"div",72),g("click",function(r){return m(e),u(r.stopPropagation())}),n(2,"div",73)(3,"h3"),a(4,"Record Payment"),o(),n(5,"button",7),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(6,"\xD7"),o()(),n(7,"div",74)(8,"form",75),g("ngSubmit",function(){m(e);let r=l();return u(r.recordPayment())}),n(9,"div",76)(10,"label",77),a(11,"Amount *"),o(),n(12,"input",78),w("ngModelChange",function(r){m(e);let c=l();return S(c.formPayment.amountInput,r)||(c.formPayment.amountInput=r),u(r)}),o(),n(13,"small",79),a(14),o()(),n(15,"div",76)(16,"label",80),a(17,"Payment Method *"),o(),n(18,"select",81),w("ngModelChange",function(r){m(e);let c=l();return S(c.formPayment.method,r)||(c.formPayment.method=r),u(r)}),g("ngModelChange",function(r){m(e);let c=l();return u(c.onPaymentMethodChange(r))}),n(19,"option",82),a(20,"Zelle"),o(),n(21,"option",83),a(22,"Check"),o(),n(23,"option",84),a(24,"Cash (3% off)"),o(),n(25,"option",85),a(26,"Other"),o()()(),p(27,yt,18,4,"div",86),n(28,"div",76)(29,"label",87),a(30," Reference (optional) "),o(),n(31,"input",88),w("ngModelChange",function(r){m(e);let c=l();return S(c.formPayment.reference,r)||(c.formPayment.reference=r),u(r)}),o()(),n(32,"div",76)(33,"label",89),a(34,"Notes"),o(),n(35,"textarea",90),w("ngModelChange",function(r){m(e);let c=l();return S(c.formPayment.notes,r)||(c.formPayment.notes=r),u(r)}),o()(),p(36,Ot,7,1,"div",91),p(37,St,2,1,"div",20),n(38,"div",92)(39,"button",93),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(40," Cancel "),o(),n(41,"button",94),p(42,wt,2,0)(43,Dt,1,0),o()()()()()()}if(i&2){let e=l();d(12),O("ngModel",e.formPayment.amountInput),d(2),v(" Amount due: ",e.formatCurrency(e.amountDue())," "),d(4),O("ngModel",e.formPayment.method),d(9),_(e.formPayment.method==="cash"&&e.cashDiscount()>0?27:-1),d(4),O("ngModel",e.formPayment.reference),d(4),O("ngModel",e.formPayment.notes),d(),_(e.submittedItems().length>0?36:-1),d(),_(e.actionError()?37:-1),d(2),f("disabled",e.actionLoading()),d(2),f("disabled",e.actionLoading()),d(),_(e.actionLoading()?42:43)}}function Pt(i,t){if(i&1){let e=b();n(0,"label",102)(1,"input",106),g("change",function(){let r=m(e).$implicit,c=l(2);return u(c.toggleItemSelection(r))}),o(),n(2,"span",107)(3,"span",39),a(4),o(),a(5," - "),n(6,"span",108),a(7),o(),n(8,"span",109),a(9),o()()()}if(i&2){let e=t.$implicit,s=l(2);d(),f("checked",s.isItemSelected(e)),d(3),C(s.getClassName(e.sessionId)),d(3),C(s.getStudentName(e.studentId)),d(),f("ngClass",s.getItemStatusBadgeClass(e.status)),d(),v(" ",s.getItemStatusLabel(e.status)," ")}}function It(i,t){if(i&1&&(n(0,"div",20),a(1),o()),i&2){let e=l(2);d(),C(e.actionError())}}function At(i,t){i&1&&(M(0,"span",100),a(1," Cancelling... "))}function Et(i,t){if(i&1&&a(0),i&2){let e=l(2);v(" Cancel ",e.selectedItems().size," Item(s) ")}}function kt(i,t){if(i&1){let e=b();n(0,"div",71),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),n(1,"div",72),g("click",function(r){return m(e),u(r.stopPropagation())}),n(2,"div",73)(3,"h3"),a(4,"Cancel Order Items"),o(),n(5,"button",7),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(6,"\xD7"),o()(),n(7,"div",74)(8,"form",75),g("ngSubmit",function(){m(e);let r=l();return u(r.cancelItems())}),n(9,"div",76)(10,"label"),a(11,"Select items to cancel:"),o(),n(12,"div",101),A(13,Pt,10,5,"label",102,ze),o()(),n(15,"div",76)(16,"label",103),a(17,"Cancellation Reason *"),o(),n(18,"textarea",104),w("ngModelChange",function(r){m(e);let c=l();return S(c.formCancel.reason,r)||(c.formCancel.reason=r),u(r)}),o()(),p(19,It,2,1,"div",20),n(20,"div",92)(21,"button",93),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(22," Cancel "),o(),n(23,"button",105),p(24,At,2,0)(25,Et,1,1),o()()()()()()}if(i&2){let e=l();d(13),E(e.cancellableItems()),d(5),O("ngModel",e.formCancel.reason),d(),_(e.actionError()?19:-1),d(2),f("disabled",e.actionLoading()),d(2),f("disabled",e.actionLoading()||e.selectedItems().size===0),d(),_(e.actionLoading()?24:25)}}function Tt(i,t){if(i&1&&(n(0,"div",20),a(1),o()),i&2){let e=l(2);d(),C(e.actionError())}}function Vt(i,t){i&1&&(M(0,"span",100),a(1," Removing... "))}function Rt(i,t){i&1&&a(0," Remove Entry ")}function qt(i,t){if(i&1){let e=b();n(0,"div",71),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),n(1,"div",72),g("click",function(r){return m(e),u(r.stopPropagation())}),n(2,"div",73)(3,"h3"),a(4,"Remove Waitlist Entry"),o(),n(5,"button",7),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(6,"\xD7"),o()(),n(7,"div",74)(8,"form",75),g("ngSubmit",function(){m(e);let r=l();return u(r.removeWaitlist())}),n(9,"div",76)(10,"label"),a(11,"Class:"),o(),n(12,"div",110),a(13),o()(),n(14,"div",111),a(15," This will remove the user from the waitlist for this class. "),o(),p(16,Tt,2,1,"div",20),n(17,"div",92)(18,"button",93),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(19," Cancel "),o(),n(20,"button",105),p(21,Vt,2,0)(22,Rt,1,0),o()()()()()()}if(i&2){let e=l();d(13),v(" ",e.getClassName(e.formRemoveWaitlist.sessionId)," "),d(3),_(e.actionError()?16:-1),d(2),f("disabled",e.actionLoading()),d(2),f("disabled",e.actionLoading()),d(),_(e.actionLoading()?21:22)}}function jt(i,t){if(i&1&&(n(0,"div",20),a(1),o()),i&2){let e=l(2);d(),C(e.actionError())}}function Nt(i,t){i&1&&(M(0,"span",100),a(1," Saving... "))}function Lt(i,t){i&1&&a(0," Save Adjustment ")}function Ft(i,t){if(i&1){let e=b();n(0,"div",71),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),n(1,"div",72),g("click",function(r){return m(e),u(r.stopPropagation())}),n(2,"div",73)(3,"h3"),a(4,"Update Adjustment"),o(),n(5,"button",7),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(6,"\xD7"),o()(),n(7,"div",74)(8,"form",75),g("ngSubmit",function(){m(e);let r=l();return u(r.updateAdjustment())}),n(9,"div",76)(10,"label"),a(11,"Request ID:"),o(),n(12,"div",110),a(13),o()(),n(14,"div",76)(15,"label",112),a(16,"Extra Fee (+) or Credit (-)"),o(),n(17,"input",113),w("ngModelChange",function(r){m(e);let c=l();return S(c.formChangeRequest.adjustmentInput,r)||(c.formChangeRequest.adjustmentInput=r),u(r)}),o(),n(18,"small",79),a(19,"Positive values add a fee, negative values give a credit"),o()(),n(20,"div",76)(21,"label",114),a(22,"Reason"),o(),n(23,"textarea",115),w("ngModelChange",function(r){m(e);let c=l();return S(c.formChangeRequest.adjustmentReason,r)||(c.formChangeRequest.adjustmentReason=r),u(r)}),o()(),n(24,"div",76)(25,"label",116),a(26,"Admin Notes"),o(),n(27,"textarea",117),w("ngModelChange",function(r){m(e);let c=l();return S(c.formChangeRequest.adminNotes,r)||(c.formChangeRequest.adminNotes=r),u(r)}),o()(),n(28,"div",118),a(29," The user will see this adjustment. You can update it multiple times before approving. "),o(),p(30,jt,2,1,"div",20),n(31,"div",92)(32,"button",93),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(33," Cancel "),o(),n(34,"button",94),p(35,Nt,2,0)(36,Lt,1,0),o()()()()()()}if(i&2){let e=l();d(13),C(e.formChangeRequest.requestId),d(4),O("ngModel",e.formChangeRequest.adjustmentInput),d(6),O("ngModel",e.formChangeRequest.adjustmentReason),d(4),O("ngModel",e.formChangeRequest.adminNotes),d(3),_(e.actionError()?30:-1),d(2),f("disabled",e.actionLoading()),d(2),f("disabled",e.actionLoading()),d(),_(e.actionLoading()?35:36)}}function Wt(i,t){if(i&1&&(n(0,"div",120),a(1),o()),i&2){let e=t.$implicit,s=l(2);d(),C(s.getActionDescription(e))}}function zt(i,t){if(i&1&&(n(0,"div",20),a(1),o()),i&2){let e=l(2);d(),C(e.actionError())}}function Bt(i,t){i&1&&(M(0,"span",100),a(1," Approving... "))}function Gt(i,t){i&1&&a(0," Approve Changes ")}function $t(i,t){if(i&1){let e=b();n(0,"div",71),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),n(1,"div",72),g("click",function(r){return m(e),u(r.stopPropagation())}),n(2,"div",73)(3,"h3"),a(4,"Approve Change Request"),o(),n(5,"button",7),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(6,"\xD7"),o()(),n(7,"div",74)(8,"form",75),g("ngSubmit",function(){m(e);let r=l();return u(r.approveChange())}),n(9,"div",76)(10,"label"),a(11,"Request ID:"),o(),n(12,"div",110),a(13),o()(),n(14,"div",76)(15,"label"),a(16,"Actions to apply:"),o(),n(17,"div",119),A(18,Wt,2,1,"div",120,V),o()(),n(20,"div",76)(21,"label",121),a(22,"Admin Notes"),o(),n(23,"textarea",122),w("ngModelChange",function(r){m(e);let c=l();return S(c.formChangeRequest.adminNotes,r)||(c.formChangeRequest.adminNotes=r),u(r)}),o()(),n(24,"div",111),a(25," Approving will apply all changes to the order. Class removals will create vacancy holds for waitlist members. The order pricing will be recalculated. "),o(),p(26,zt,2,1,"div",20),n(27,"div",92)(28,"button",93),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(29," Cancel "),o(),n(30,"button",94),p(31,Bt,2,0)(32,Gt,1,0),o()()()()()()}if(i&2){let e=l();d(13),C(e.formChangeRequest.requestId),d(5),E(e.formChangeRequest.actions),d(5),O("ngModel",e.formChangeRequest.adminNotes),d(3),_(e.actionError()?26:-1),d(2),f("disabled",e.actionLoading()),d(2),f("disabled",e.actionLoading()),d(),_(e.actionLoading()?31:32)}}function Ut(i,t){if(i&1&&(n(0,"div",20),a(1),o()),i&2){let e=l(2);d(),C(e.actionError())}}function Ht(i,t){i&1&&(M(0,"span",100),a(1," Denying... "))}function Kt(i,t){i&1&&a(0," Deny Request ")}function Yt(i,t){if(i&1){let e=b();n(0,"div",71),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),n(1,"div",72),g("click",function(r){return m(e),u(r.stopPropagation())}),n(2,"div",73)(3,"h3"),a(4,"Deny Change Request"),o(),n(5,"button",7),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(6,"\xD7"),o()(),n(7,"div",74)(8,"form",75),g("ngSubmit",function(){m(e);let r=l();return u(r.denyChange())}),n(9,"div",76)(10,"label"),a(11,"Request ID:"),o(),n(12,"div",110),a(13),o()(),n(14,"div",76)(15,"label",123),a(16,"Reason for Denial *"),o(),n(17,"textarea",124),w("ngModelChange",function(r){m(e);let c=l();return S(c.formChangeRequest.adminNotes,r)||(c.formChangeRequest.adminNotes=r),u(r)}),o()(),n(18,"div",118),a(19," The user will be notified that their change request was denied. No changes will be applied to their order. "),o(),p(20,Ut,2,1,"div",20),n(21,"div",92)(22,"button",93),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(23," Cancel "),o(),n(24,"button",105),p(25,Ht,2,0)(26,Kt,1,0),o()()()()()()}if(i&2){let e=l();d(13),C(e.formChangeRequest.requestId),d(4),O("ngModel",e.formChangeRequest.adminNotes),d(3),_(e.actionError()?20:-1),d(2),f("disabled",e.actionLoading()),d(2),f("disabled",e.actionLoading()||!e.formChangeRequest.adminNotes.trim()),d(),_(e.actionLoading()?25:26)}}function Jt(i,t){if(i&1&&(n(0,"div",20),a(1),o()),i&2){let e=l(2);d(),C(e.actionError())}}function Zt(i,t){i&1&&(M(0,"span",100),a(1," Adding... "))}function Qt(i,t){if(i&1&&a(0),i&2){let e=l(2);v(" Add ",e.formAdjustment.type==="credit"?"Credit":"Fee"," ")}}function Xt(i,t){if(i&1){let e=b();n(0,"div",71),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),n(1,"div",72),g("click",function(r){return m(e),u(r.stopPropagation())}),n(2,"div",73)(3,"h3"),a(4,"Add Credit or Fee"),o(),n(5,"button",7),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(6,"\xD7"),o()(),n(7,"div",74)(8,"form",75),g("ngSubmit",function(){m(e);let r=l();return u(r.addAdjustment())}),n(9,"div",76)(10,"label",125),a(11,"Type *"),o(),n(12,"select",126),w("ngModelChange",function(r){m(e);let c=l();return S(c.formAdjustment.type,r)||(c.formAdjustment.type=r),u(r)}),n(13,"option",127),a(14,"Credit (reduce amount due)"),o(),n(15,"option",128),a(16,"Fee (increase amount due)"),o()()(),n(17,"div",76)(18,"label",112),a(19,"Amount *"),o(),n(20,"input",129),w("ngModelChange",function(r){m(e);let c=l();return S(c.formAdjustment.amountInput,r)||(c.formAdjustment.amountInput=r),u(r)}),o(),n(21,"small",79),a(22," Enter the amount in dollars (e.g., 25.00) "),o()(),n(23,"div",76)(24,"label",114),a(25,"Reason *"),o(),n(26,"textarea",130),w("ngModelChange",function(r){m(e);let c=l();return S(c.formAdjustment.reason,r)||(c.formAdjustment.reason=r),u(r)}),o()(),n(27,"div",118),a(28),o(),p(29,Jt,2,1,"div",20),n(30,"div",92)(31,"button",93),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(32," Cancel "),o(),n(33,"button",94),p(34,Zt,2,0)(35,Qt,1,1),o()()()()()()}if(i&2){let e=l();d(12),O("ngModel",e.formAdjustment.type),d(8),O("ngModel",e.formAdjustment.amountInput),d(6),O("ngModel",e.formAdjustment.reason),d(2),v(" ",e.formAdjustment.type==="credit"?"A credit will reduce the amount the user owes.":"A fee will increase the amount the user owes."," "),d(),_(e.actionError()?29:-1),d(2),f("disabled",e.actionLoading()),d(2),f("disabled",e.actionLoading()||!e.formAdjustment.amountInput||!e.formAdjustment.reason.trim()),d(),_(e.actionLoading()?34:35)}}function en(i,t){if(i&1&&(n(0,"div",20),a(1),o()),i&2){let e=l(2);d(),C(e.actionError())}}function tn(i,t){i&1&&(M(0,"span",100),a(1," Rejecting... "))}function nn(i,t){i&1&&a(0," Reject Screenshot ")}function on(i,t){if(i&1){let e=b();n(0,"div",71),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),n(1,"div",72),g("click",function(r){return m(e),u(r.stopPropagation())}),n(2,"div",73)(3,"h3"),a(4,"Reject Screenshot"),o(),n(5,"button",7),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(6,"\xD7"),o()(),n(7,"div",74)(8,"form",75),g("ngSubmit",function(){m(e);let r=l();return u(r.submitRejectScreenshot())}),n(9,"div",76)(10,"label",131),a(11,"Rejection Reason *"),o(),n(12,"textarea",132),w("ngModelChange",function(r){m(e);let c=l();return S(c.formRejectScreenshot.reason,r)||(c.formRejectScreenshot.reason=r),u(r)}),o(),n(13,"small",79),a(14," This message will be shown to the user explaining why their screenshot was rejected. "),o()(),p(15,en,2,1,"div",20),n(16,"div",92)(17,"button",93),g("click",function(){m(e);let r=l();return u(r.closeDialog())}),a(18," Cancel "),o(),n(19,"button",105),p(20,tn,2,0)(21,nn,1,0),o()()()()()()}if(i&2){let e=l();d(12),O("ngModel",e.formRejectScreenshot.reason),d(3),_(e.actionError()?15:-1),d(2),f("disabled",e.actionLoading()),d(2),f("disabled",e.actionLoading()||!e.formRejectScreenshot.reason.trim()),d(),_(e.actionLoading()?20:21)}}var Te=class i{orderId=Y.required();adminOrdersStore=T(Me);orderRpc=T(de);userService=T(ce);seasonService=T(le);configService=T(se);router=T(Q);notificationService=T(we);unsubscribeOrder=null;order=I(null);loading=I(!1);error=I(null);userData=I(null);studentMap=I(new Map);actionLoading=this.orderRpc.loading;actionError=this.orderRpc.error;dialogMode=I(null);formPayment={amountInput:"",method:"zelle",reference:"",notes:"",isDepositConfirmation:!1};formCancel={reason:""};selectedItems=I(new Set);historyExpanded=I(!1);reversedHistory=x(()=>{let t=this.order()?.history;return t?[...t].reverse():[]});formRemoveWaitlist={sessionId:""};formChangeRequest={requestId:"",actions:[],adjustmentInput:"",adjustmentReason:"",adminNotes:""};formAdjustment={type:"credit",amountInput:"",reason:""};formRejectScreenshot={screenshotId:"",reason:"Please re-upload a clearer image of your payment receipt."};Math=Math;allItems=x(()=>this.order()?.items??[]);paidItems=x(()=>{let t=this.order();return t?ee(t):[]});submittedItems=x(()=>{let t=this.order();return t?X(t):[]});securedItems=x(()=>{let t=this.order();return t?te(t):[]});lockedItems=x(()=>this.allItems().filter(t=>t.status==="locked"));cancellableItems=x(()=>[...this.lockedItems(),...this.paidItems(),...this.submittedItems(),...this.securedItems()]);waitlistEntries=x(()=>this.order()?.waitlist??[]);payments=x(()=>this.order()?.payments??[]);changeRequests=x(()=>this.order()?.changeRequests??[]);totalDue=x(()=>{let t=this.order();return t?ie(t):0});amountDue=x(()=>{let t=this.order();return t?ne(t):0});cashDiscount=x(()=>{let t=this.amountDue();return t<=0?0:re(t)});cashAmountDue=x(()=>{let t=this.amountDue();return t<=0?0:ae(t)});isOverdue=x(()=>{let t=this.order();if(!t||!t.lockExpiresAt)return!1;let e=this.configService.currentTime();return new Date(t.lockExpiresAt)<new Date(e)});isExpiringSoon=x(()=>{let t=this.order();if(!t||!t.lockExpiresAt)return!1;let e=this.configService.currentTime(),s=new Date(t.lockExpiresAt),r=new Date(e),c=(s.getTime()-r.getTime())/(1e3*60*60);return c>0&&c<=12});remainingLockTime=x(()=>{let t=this.order();if(!t||!t.lockExpiresAt)return null;let e=this.configService.currentTime(),s=new Date(t.lockExpiresAt),r=new Date(e),c=s.getTime()-r.getTime();if(c<=0)return null;let P=Math.floor(c/(1e3*60*60)),D=Math.floor(c%(1e3*60*60)/(1e3*60));return{hours:P,minutes:D}});canRecordPayment=x(()=>this.amountDue()>0);transformToLedgerItem(t){return{sessionId:t.sessionId,studentId:t.studentId,studentName:this.getStudentName(t.studentId),className:this.getClassName(t.sessionId),startDate:t.snapshot?.startDate??"",endDate:t.snapshot?.endDate??"",status:t.status,options:t.options,pricing:{basePrice:t.snapshot?.priceSnapshot?.basePrice??0,lunchPrice:t.snapshot?.priceSnapshot?.lunchPrice??0,extendedCarePrice:t.snapshot?.priceSnapshot?.extendedCarePrice??0,itemTotal:t.snapshot?.priceSnapshot?.itemTotal??0}}}lockedItemsTransformed=x(()=>this.lockedItems().map(t=>this.transformToLedgerItem(t)));submittedItemsTransformed=x(()=>this.submittedItems().map(t=>this.transformToLedgerItem(t)));securedItemsTransformed=x(()=>this.securedItems().map(t=>this.transformToLedgerItem(t)));paidItemsTransformed=x(()=>this.paidItems().map(t=>this.transformToLedgerItem(t)));screenshotGroups=x(()=>{let t=this.order();if(!t)return[];let e=t.paymentScreenshots??[],s=this.submittedItemsTransformed();return e.map(r=>{let c=new Set(r.lockedItemKeys),P=s.filter(D=>{let $=`${D.sessionId}:${D.studentId}`;return c.has($)});return{screenshot:r,items:P}}).filter(r=>r.items.length>0)});orderSummaryData=x(()=>{let t=this.order(),e=t?.pricing;if(!e)return null;let r=[...this.lockedItemsTransformed(),...this.submittedItemsTransformed(),...this.securedItemsTransformed(),...this.paidItemsTransformed()].reduce((h,y)=>h+y.pricing.itemTotal,0),c=new Map;for(let h of e.discounts){let y=c.get(h.type)??0;c.set(h.type,y+h.amount)}for(let h of t.processingFees??[]){let y=c.get(h.type)??0;c.set(h.type,y+h.amount)}let P=[],D={returning_family:"\u{1F468}\u200D\u{1F469}\u200D\u{1F467} Returning Family",returning_student:"\u{1F393} Returning Student",sibling:"\u{1F46B} Sibling Discount",multi_session:"\u{1F4C5} Multi-Session",coupon:"\u{1F39F}\uFE0F Coupon Credit",manual:"\u270F\uFE0F Manual Adjustment",referral:"\u{1F91D} Referral Bonus",cash_discount:"\u{1F4B5} Cash Discount (3%)",adjustment:"\u270F\uFE0F Adjustment",forfeited_deposit:"\u26A0\uFE0F Forfeited Deposit"};for(let[h,y]of c)y!==0&&P.push({type:h,label:D[h]??h,amount:y});let Ve=(t.paymentScreenshots??[]).reduce((h,y)=>h+(y.claimedAmountCents??0),0),j=(t.payments??[]).reduce((h,y)=>h+y.amount,0),R=this.securedItems().length,N=this.paidItems().length,Re=5e3,L=0,W=0;R>0&&N===0?L=j:R===0&&N>0?W=j:R>0&&N>0&&(L=Math.min(R*Re,j),W=j-L);let qe=[{status:"locked",label:"Awaiting Payment",count:this.lockedItems().length,total:this.lockedItemsTransformed().reduce((h,y)=>h+y.pricing.itemTotal,0)},{status:"submitted",label:"Pending Verification",count:this.submittedItems().length,total:Ve},{status:"secured",label:"Deposit Confirmed",count:R,total:L},{status:"paid",label:"Payment Confirmed",count:N,total:W}],je=P.reduce((h,y)=>h+y.amount,0),U=t.totalPaid??0,Ne=Math.max(0,r+je-U);return{subtotal:r,totalPaid:U,discounts:P,amountDue:Ne,statusCounts:qe}});formatCurrency=ke;formatDate=B;formatDateTime=G;getOrderStatus=oe;getStatusBadgeClass=Pe;getStatusLabel=Ie;getItemStatusBadgeClass=Ae;getItemStatusLabel=Ee;async ngOnInit(){if(!this.userService.isAuthenticated()){await this.router.navigate(["/login"]);return}this.subscribeToOrder()}ngOnDestroy(){this.unsubscribeOrder&&(this.unsubscribeOrder(),this.unsubscribeOrder=null)}subscribeToOrder(){this.loading.set(!0),this.error.set(null),this.unsubscribeOrder=this.adminOrdersStore.subscribeToOrder(this.orderId(),async t=>{this.order.set(t),this.loading.set(!1),t&&await this.loadUserData(t.userDisplayId)},t=>{let e=t instanceof Error?t.message:String(t);this.error.set(e),this.loading.set(!1)})}async loadUserData(t){try{let e=await this.userService.getUserByDisplayId(t);if(e){this.userData.set({displayName:e.displayName,email:e.email,phone:e.primaryGuardian?.phone,address:e.primaryGuardian?.address?`${e.primaryGuardian.address.street}, ${e.primaryGuardian.address.city}, ${e.primaryGuardian.address.state} ${e.primaryGuardian.address.zipCode}`:void 0});let s=new Map;for(let r of e.students??[])s.set(r.id,`${r.firstName} ${r.lastName}`);this.studentMap.set(s)}}catch(e){console.error("Failed to load user data:",e)}}getClassName(t){return this.seasonService.classes().find(s=>s.id===t)?.name??t}getStudentName(t){return this.studentMap().get(t)??t}getItemsTotal(t){return t.reduce((e,s)=>e+(s.snapshot?.priceSnapshot?.itemTotal??0),0)}openRecordPaymentDialog(){this.formPayment.amountInput=q(this.amountDue()),this.formPayment.method="zelle",this.formPayment.reference="",this.formPayment.notes="",this.formPayment.isDepositConfirmation=!1,this.dialogMode.set("record-payment")}openCancelItemsDialog(){this.selectedItems.set(new Set),this.formCancel.reason="",this.dialogMode.set("cancel-items")}openRemoveWaitlistDialog(t){this.formRemoveWaitlist.sessionId=t,this.dialogMode.set("remove-waitlist")}openAddAdjustmentDialog(){this.formAdjustment.type="credit",this.formAdjustment.amountInput="",this.formAdjustment.reason="",this.dialogMode.set("add-adjustment")}closeDialog(){this.dialogMode.set(null),this.orderRpc.clearError()}onPaymentMethodChange(t){t==="cash"?this.formPayment.amountInput=q(this.cashAmountDue()):this.formPayment.amountInput=q(this.amountDue())}isItemSelected(t){let e=`${t.sessionId}::${t.studentId}`;return this.selectedItems().has(e)}toggleItemSelection(t){let e=`${t.sessionId}::${t.studentId}`,s=new Set(this.selectedItems());s.has(e)?s.delete(e):s.add(e),this.selectedItems.set(s)}async recordPayment(){let t=this.order();if(!t)return;let e=F(this.formPayment.amountInput);if(e<=0){this.notificationService.warning("Please enter a valid payment amount.");return}try{this.formPayment.method==="cash"&&this.cashDiscount()>0&&await this.orderRpc.addAdjustment({year:2026,seasonId:t.seasonId,userAuthId:t.userAuthId,amount:-this.cashDiscount(),reason:"Cash payment discount (3%)"}),await this.orderRpc.recordPayment({year:2026,seasonId:t.seasonId,userAuthId:t.userAuthId,amount:e,reference:this.formPayment.reference||null,method:this.formPayment.method,notes:this.formPayment.notes||null,isDepositConfirmation:this.formPayment.isDepositConfirmation,itemKeys:null}),this.closeDialog()}catch(s){console.error("Failed to record payment:",s)}}async confirmScreenshotPayment(t){let e=this.order();if(!e)return;let s=e.paymentScreenshots?.find(D=>D.id===t);if(!s){this.notificationService.error("Screenshot not found");return}let r=s.claimedAmountCents??0;if(r<=0){this.notificationService.warning("No claimed amount on this screenshot");return}let c=s.paymentOption==="cash_deposit",P=c?"cash":"zelle";try{await this.orderRpc.recordPayment({year:2026,seasonId:e.seasonId,userAuthId:e.userAuthId,amount:r,reference:t,method:P,notes:c?"Deposit confirmed via screenshot":"Payment confirmed via screenshot",isDepositConfirmation:c,itemKeys:s.lockedItemKeys}),this.notificationService.success(c?"Deposit confirmed":"Payment confirmed")}catch(D){console.error("Failed to confirm screenshot payment:",D),this.notificationService.error("Failed to confirm payment")}}rejectScreenshotPayment(t){this.formRejectScreenshot.screenshotId=t,this.formRejectScreenshot.reason="Please re-upload a clearer image of your payment receipt.",this.dialogMode.set("reject-screenshot")}async submitRejectScreenshot(){let t=this.order();if(!t)return;let{screenshotId:e,reason:s}=this.formRejectScreenshot;if(!(!e||!s.trim()))try{await this.orderRpc.deleteScreenshot({seasonId:t.seasonId,screenshotId:e,userAuthId:t.userAuthId,rejectionReason:s.trim()}),this.notificationService.success("Screenshot rejected, items reverted to awaiting payment"),this.closeDialog()}catch(r){console.error("Failed to reject screenshot:",r),this.notificationService.error("Failed to reject screenshot")}}async cancelItems(){let t=this.order();if(t){if(this.selectedItems().size===0){this.notificationService.warning("Please select at least one item to cancel.");return}if(!this.formCancel.reason.trim()){this.notificationService.warning("Please enter a cancellation reason.");return}try{let e=Array.from(this.selectedItems()).map(s=>{let[r,c]=s.split("::");return{sessionId:r,studentId:c}});await this.orderRpc.cancelItems({year:2026,seasonId:t.seasonId,items:e,reason:this.formCancel.reason,userAuthId:t.userAuthId}),this.closeDialog()}catch(e){console.error("Failed to cancel items:",e)}}}async removeWaitlist(){let t=this.order();if(t)try{await this.orderRpc.removeWaitlistEntry({year:2026,seasonId:t.seasonId,userAuthId:t.userAuthId,sessionId:this.formRemoveWaitlist.sessionId}),this.closeDialog()}catch(e){console.error("Failed to remove waitlist entry:",e)}}async addAdjustment(){let t=this.order();if(!t)return;let e=F(this.formAdjustment.amountInput);if(e<=0){this.notificationService.warning("Please enter a valid amount.");return}if(!this.formAdjustment.reason.trim()){this.notificationService.warning("Please enter a reason for the adjustment.");return}let s=this.formAdjustment.type==="credit"?-e:e;try{await this.orderRpc.addAdjustment({year:2026,seasonId:t.seasonId,userAuthId:t.userAuthId,amount:s,reason:this.formAdjustment.reason}),this.closeDialog(),this.notificationService.success(this.formAdjustment.type==="credit"?"Credit added successfully.":"Fee added successfully.")}catch(r){console.error("Failed to add adjustment:",r)}}getChangeStatusLabel(t){switch(t){case"pending":return"Pending";case"approved":return"Approved";case"denied":return"Denied";default:return t}}getActionDescription(t){let e=this.getClassName(t.target.sessionId),s=this.getStudentName(t.target.studentId);switch(t.type){case"remove_class":return`Remove from class: ${e} - ${s}`;case"add_addon":return`Add ${t.addon==="lunch"?"Lunch":"Extended Care"}: ${e} - ${s}`;case"remove_addon":return`Remove ${t.addon==="lunch"?"Lunch":"Extended Care"}: ${e} - ${s}`}}openUpdateAdjustmentDialog(t){this.formChangeRequest.requestId=t.id,this.formChangeRequest.actions=[...t.actions],this.formChangeRequest.adjustmentInput=t.adminAdjustment!==0?q(t.adminAdjustment):"",this.formChangeRequest.adjustmentReason=t.adminAdjustmentReason??"",this.formChangeRequest.adminNotes=t.adminNotes??"",this.dialogMode.set("update-adjustment")}openApproveChangeDialog(t){this.formChangeRequest.requestId=t.id,this.formChangeRequest.actions=[...t.actions],this.formChangeRequest.adminNotes=t.adminNotes??"",this.dialogMode.set("approve-change")}openDenyChangeDialog(t){this.formChangeRequest.requestId=t.id,this.formChangeRequest.actions=[...t.actions],this.formChangeRequest.adminNotes="",this.dialogMode.set("deny-change")}async updateAdjustment(){let t=this.order();if(t)try{let e=this.formChangeRequest.adjustmentInput.trim()?F(this.formChangeRequest.adjustmentInput):0;await this.orderRpc.updateChangeRequest({year:2026,seasonId:t.seasonId,userAuthId:t.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminAdjustment:e,adminAdjustmentReason:this.formChangeRequest.adjustmentReason||null,adminNotes:this.formChangeRequest.adminNotes||null}),this.closeDialog()}catch(e){console.error("Failed to update adjustment:",e)}}async approveChange(){let t=this.order();if(t)try{await this.orderRpc.approveChangeRequest({year:2026,seasonId:t.seasonId,userAuthId:t.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminNotes:this.formChangeRequest.adminNotes||null}),this.closeDialog()}catch(e){console.error("Failed to approve change request:",e)}}async denyChange(){let t=this.order();if(t&&this.formChangeRequest.adminNotes.trim())try{await this.orderRpc.denyChangeRequest({year:2026,seasonId:t.seasonId,userAuthId:t.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminNotes:this.formChangeRequest.adminNotes}),this.closeDialog()}catch(e){console.error("Failed to deny change request:",e)}}clearError(){this.error.set(null)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=H({type:i,selectors:[["app-admin-order-detail"]],inputs:{orderId:[1,"orderId"]},decls:13,vars:11,consts:[["pageTitle","Order Details","pageSubtitle","View and manage order"],[1,"admin-order-detail-container"],[1,"loading-state"],[1,"error-banner"],[1,"order-content"],[1,"modal-overlay"],[1,"spinner"],["type","button",1,"btn-close",3,"click"],[1,"order-header-info"],[1,"order-user-id"],[1,"label"],[1,"value"],[1,"status-badge",3,"ngClass"],[1,"order-layout"],[1,"main-column"],[1,"info-card","user-info-card"],[1,"info-card","status-card"],[1,"status-details"],[1,"detail-row"],[1,"value","status-badge",3,"ngClass"],[1,"alert","alert-danger"],[1,"empty-state"],[3,"lockedItems","submittedItems","securedItems","paidItems","editable","isAdmin","screenshotGroups"],[1,"info-card","payments-card"],[1,"info-card","waitlist-card"],[1,"info-card","change-requests-card"],[1,"info-card","history-card"],[1,"sidebar-column"],[3,"recordPaymentClick","addAdjustmentClick","isAdmin","canRecordPayment","orderSummary"],[1,"user-details"],[1,"value",3,"ngClass"],[1,"remaining-time"],[3,"cancelItemsClick","confirmScreenshot","rejectScreenshot","lockedItems","submittedItems","securedItems","paidItems","editable","isAdmin","screenshotGroups"],[1,"payments-table"],[1,"amount"],[1,"method-badge"],[1,"waitlist-list"],[1,"waitlist-item"],[1,"waitlist-header"],[1,"class-name"],[1,"waitlist-details"],[1,"detail-item"],["type","button",1,"btn","btn-danger-outline","btn-sm",3,"click"],[1,"change-requests-list"],[1,"change-request-item",3,"ngClass"],[1,"request-header"],[1,"request-info"],[1,"request-id"],[1,"request-status-badge",3,"ngClass"],[1,"request-details"],[1,"request-actions-list"],[1,"request-action-row"],[1,"request-meta"],[1,"meta-item"],[1,"request-actions"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"section-header",3,"click"],["type","button",1,"toggle-btn"],[1,"history-timeline"],[1,"history-event"],[1,"event-time"],[1,"event-details"],[1,"event-action"],[1,"event-metadata"],[1,"affected-items"],[1,"affected-item"],[1,"item-class"],[1,"item-student"],[1,"item-options"],[1,"option-tag"],[1,"modal-overlay",3,"click"],[1,"modal-dialog",3,"click"],[1,"modal-header"],[1,"modal-body"],[3,"ngSubmit"],[1,"form-group"],["for","payment-amount"],["type","text","id","payment-amount","name","amount","placeholder","0.00","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text"],["for","payment-method"],["id","payment-method","name","method","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","zelle"],["value","check"],["value","cash"],["value","other"],[1,"cash-discount-info"],["for","payment-reference"],["type","text","id","payment-reference","name","reference","placeholder","Confirmation number, check number, etc.",1,"form-control",3,"ngModelChange","ngModel"],["for","payment-notes"],["id","payment-notes","name","notes","rows","3","placeholder","Optional notes...",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-group","deposit-confirmation"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"cash-info-row"],[1,"cash-info-row","discount"],[1,"cash-info-row","total"],[1,"checkbox-label"],["type","checkbox","name","isDepositConfirmation",3,"ngModelChange","ngModel"],[1,"spinner-small"],[1,"items-checklist"],[1,"checkbox-item"],["for","cancel-reason"],["id","cancel-reason","name","reason","rows","3","placeholder","Enter reason for cancellation...","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-danger",3,"disabled"],["type","checkbox",3,"change","checked"],[1,"item-info"],[1,"student-name"],[1,"item-status-badge",3,"ngClass"],[1,"read-only-value"],[1,"alert","alert-warning"],["for","adjustment-amount"],["type","text","id","adjustment-amount","name","adjustment","placeholder","0.00 (positive = fee, negative = credit)",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-reason"],["id","adjustment-reason","name","adjustmentReason","rows","2","placeholder","Explain the adjustment...",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-notes"],["id","adjustment-notes","name","notes","rows","2","placeholder","Optional notes (visible to user)...",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-info"],[1,"items-list-readonly"],[1,"item-row"],["for","approve-notes"],["id","approve-notes","name","notes","rows","3","placeholder","Optional notes...",1,"form-control",3,"ngModelChange","ngModel"],["for","deny-notes"],["id","deny-notes","name","notes","rows","3","placeholder","Please provide a reason for denying this request...","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-type"],["id","adjustment-type","name","type","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","credit"],["value","fee"],["type","text","id","adjustment-amount","name","amount","placeholder","0.00","required","",1,"form-control",3,"ngModelChange","ngModel"],["id","adjustment-reason","name","reason","rows","3","placeholder","Explain the reason for this adjustment...","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","reject-reason"],["id","reject-reason","name","reason","rows","3","required","","placeholder","Enter reason shown to user...",1,"form-control",3,"ngModelChange","ngModel"]],template:function(e,s){e&1&&(n(0,"app-admin-layout",0)(1,"div",1),p(2,Be,4,0,"div",2),p(3,Ge,6,1,"div",3),p(4,vt,41,18,"div",4),p(5,Mt,44,11,"div",5),p(6,kt,26,5,"div",5),p(7,qt,23,5,"div",5),p(8,Ft,37,8,"div",5),p(9,$t,33,6,"div",5),p(10,Yt,27,6,"div",5),p(11,Xt,36,8,"div",5),p(12,on,22,5,"div",5),o()()),e&2&&(d(2),_(s.loading()?2:-1),d(),_(s.error()&&!s.loading()?3:-1),d(),_(s.order()&&!s.loading()?4:-1),d(),_(s.dialogMode()==="record-payment"?5:-1),d(),_(s.dialogMode()==="cancel-items"?6:-1),d(),_(s.dialogMode()==="remove-waitlist"?7:-1),d(),_(s.dialogMode()==="update-adjustment"?8:-1),d(),_(s.dialogMode()==="approve-change"?9:-1),d(),_(s.dialogMode()==="deny-change"?10:-1),d(),_(s.dialogMode()==="add-adjustment"?11:-1),d(),_(s.dialogMode()==="reject-screenshot"?12:-1))},dependencies:[Z,J,ye,fe,he,be,ue,me,xe,pe,_e,ve,Ce,ge,Se,Oe,De],styles:[".admin-order-detail-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #3498db;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-banner[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:15px;border-radius:4px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.btn-close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:24px;cursor:pointer;color:inherit}.order-header-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem;padding:1rem;background:#fff;border:1px solid #e0e0e0;border-radius:8px}.order-user-id[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.order-user-id[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.875rem;color:#666}.order-user-id[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:monospace;font-weight:500;font-size:.9375rem}.order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:30px;padding-bottom:20px;border-bottom:2px solid #e0e0e0}.user-id[_ngcontent-%COMP%]{color:#666;font-size:14px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.order-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 350px;gap:1.5rem;align-items:start}.main-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.sidebar-column[_ngcontent-%COMP%]{position:sticky;top:20px}@media(max-width:900px){.order-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.sidebar-column[_ngcontent-%COMP%]{position:static;order:-1}}.info-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:20px;margin-bottom:20px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 20px;font-size:20px;color:#333}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.user-details[_ngcontent-%COMP%], .status-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:4px;font-size:12px;font-weight:600;text-transform:uppercase;display:inline-block}.status-submitted[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-paid[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-cancelled[_ngcontent-%COMP%], .status-refunded[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.status-partial[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status-empty[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.text-warning[_ngcontent-%COMP%]{color:#ffc107!important}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.remaining-time[_ngcontent-%COMP%]{font-size:12px;color:#666}.alert[_ngcontent-%COMP%]{padding:12px 16px;border-radius:4px;margin-top:15px}.alert-danger[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.alert-warning[_ngcontent-%COMP%]{background:#fff3cd;color:#856404;border:1px solid #ffeaa7}.alert-info[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460;border:1px solid #bee5eb}.items-section[_ngcontent-%COMP%]{margin-bottom:30px}.items-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:15px;color:#333}.item-count[_ngcontent-%COMP%]{color:#666;font-weight:400;font-size:14px}.items-list[_ngcontent-%COMP%]{display:grid;gap:12px}.item-card[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dee2e6;border-radius:6px;padding:15px}.item-card.locked[_ngcontent-%COMP%]{background:#f3e5f5;border-color:#ce93d8}.item-card.pending[_ngcontent-%COMP%]{background:#fff3cd;border-color:#ffeaa7}.item-card.secured[_ngcontent-%COMP%]{background:#f3e5f5;border-color:#ce93d8}.item-card.cancelled[_ngcontent-%COMP%]{background:#f8d7da;border-color:#f5c6cb;opacity:.7}.item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.class-name[_ngcontent-%COMP%]{font-weight:600;color:#333}.item-status-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:3px;font-size:11px;font-weight:600;text-transform:uppercase}.item-status-locked[_ngcontent-%COMP%]{background:#7b1fa2;color:#fff}.item-status-submitted[_ngcontent-%COMP%]{background:#ffc107;color:#000}.item-status-paid[_ngcontent-%COMP%]{background:#28a745;color:#fff}.item-status-secured[_ngcontent-%COMP%]{background:#7b1fa2;color:#fff}.item-status-cancelled[_ngcontent-%COMP%], .item-status-refunded[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.item-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.detail-item[_ngcontent-%COMP%]{display:flex;gap:8px;font-size:14px}.detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.option-badge[_ngcontent-%COMP%]{background:#007bff;color:#fff;padding:2px 8px;border-radius:3px;font-size:11px;margin-right:4px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#666}.payments-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.payments-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:12px;background:#f8f9fa;border-bottom:2px solid #dee2e6;font-weight:600}.payments-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #dee2e6}.payments-table[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600}.method-badge[_ngcontent-%COMP%]{background:#6c757d;color:#fff;padding:4px 8px;border-radius:3px;font-size:12px;text-transform:uppercase}.waitlist-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.waitlist-item[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dee2e6;border-radius:6px;padding:15px}.waitlist-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.promoted-badge[_ngcontent-%COMP%]{background:#28a745;color:#fff;padding:4px 8px;border-radius:3px;font-size:12px;font-weight:600}.waitlist-details[_ngcontent-%COMP%]{margin-bottom:10px}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;cursor:pointer;-webkit-user-select:none;user-select:none;margin-bottom:15px}.section-header[_ngcontent-%COMP%]:hover{opacity:.8}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.toggle-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:14px;color:#666;cursor:pointer;padding:4px 8px}.history-timeline[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px}.history-event[_ngcontent-%COMP%]{display:flex;gap:15px;padding:12px;background:#f8f9fa;border-radius:6px}.event-time[_ngcontent-%COMP%]{color:#666;font-size:12px;white-space:nowrap;min-width:150px}.event-details[_ngcontent-%COMP%]{flex:1}.event-action[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}.event-metadata[_ngcontent-%COMP%]{color:#666;font-size:14px}.affected-items[_ngcontent-%COMP%]{margin-top:8px;padding:8px;background:#e9ecef;border-radius:4px}.affected-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:4px 0;font-size:13px;border-bottom:1px solid #dee2e6}.affected-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.affected-item[_ngcontent-%COMP%]   .item-class[_ngcontent-%COMP%]{font-weight:500;color:#333}.affected-item[_ngcontent-%COMP%]   .item-student[_ngcontent-%COMP%]{color:#666}.affected-item[_ngcontent-%COMP%]   .item-options[_ngcontent-%COMP%]{display:flex;gap:4px;margin-left:auto}.affected-item[_ngcontent-%COMP%]   .option-tag[_ngcontent-%COMP%]{background:#6c757d;color:#fff;padding:2px 6px;border-radius:3px;font-size:10px}.btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.btn-primary-outline[_ngcontent-%COMP%]{background:#fff;color:#007bff;border:1px solid #007bff}.btn-primary-outline[_ngcontent-%COMP%]:hover:not(:disabled){background:#007bff;color:#fff}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6268}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#c82333}.btn-danger-outline[_ngcontent-%COMP%]{background:#fff;color:#dc3545;border:1px solid #dc3545}.btn-danger-outline[_ngcontent-%COMP%]:hover:not(:disabled){background:#dc3545;color:#fff}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:20px}.modal-body[_ngcontent-%COMP%]{padding:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;margin-bottom:8px;color:#333}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ced4da;border-radius:4px;font-size:14px}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 .2rem #007bff40}.form-text[_ngcontent-%COMP%]{display:block;margin-top:4px;font-size:12px;color:#6c757d}.items-checklist[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-height:300px;overflow-y:auto;padding:8px;background:#f8f9fa;border-radius:4px}.checkbox-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px;cursor:pointer}.checkbox-item[_ngcontent-%COMP%]:hover{background:#e9ecef;border-radius:4px}.checkbox-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}.item-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.read-only-value[_ngcontent-%COMP%]{padding:8px 12px;background:#f8f9fa;border-radius:4px;font-weight:500}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px;padding-top:20px;border-top:1px solid #dee2e6}.spinner-small[_ngcontent-%COMP%]{display:inline-block;width:14px;height:14px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite;margin-right:8px}.btn-success[_ngcontent-%COMP%]{background:#28a745;color:#fff}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#218838}.change-requests-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.change-request-item[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:8px;padding:16px;background:#f8f9fa}.change-request-item.status-pending[_ngcontent-%COMP%]{border-left:4px solid #ffc107}.change-request-item.status-approved[_ngcontent-%COMP%]{border-left:4px solid #28a745}.change-request-item.status-denied[_ngcontent-%COMP%]{border-left:4px solid #dc3545;opacity:.7}.change-request-item[_ngcontent-%COMP%]   .request-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.change-request-item[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.change-request-item[_ngcontent-%COMP%]   .request-id[_ngcontent-%COMP%]{font-weight:600;color:#495057}.request-status-badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:12px;font-size:11px;font-weight:600;text-transform:uppercase}.request-status-badge.status-pending[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.request-status-badge.status-approved[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.request-status-badge.status-denied[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.change-request-item[_ngcontent-%COMP%]   .request-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:16px}.change-request-item[_ngcontent-%COMP%]   .request-actions-list[_ngcontent-%COMP%]{font-size:14px}.change-request-item[_ngcontent-%COMP%]   .request-action-row[_ngcontent-%COMP%]{margin-left:16px;color:#666;padding:4px 0}.change-request-item[_ngcontent-%COMP%]   .request-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;font-size:13px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;gap:8px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666;min-width:130px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.change-request-item[_ngcontent-%COMP%]   .request-actions[_ngcontent-%COMP%]{display:flex;gap:10px;padding-top:12px;border-top:1px solid #dee2e6}.text-success[_ngcontent-%COMP%]{color:#28a745!important}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important}.items-list-readonly[_ngcontent-%COMP%]{background:#f8f9fa;padding:12px;border-radius:4px}.items-list-readonly[_ngcontent-%COMP%]   .item-row[_ngcontent-%COMP%]{padding:4px 0;color:#495057}.cash-discount-info[_ngcontent-%COMP%]{background:#e8f5e9;border:1px solid #c8e6c9;border-radius:8px;padding:12px;margin-bottom:15px}.cash-info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:4px 0;font-size:14px}.cash-info-row.discount[_ngcontent-%COMP%]{color:#2e7d32}.cash-info-row.total[_ngcontent-%COMP%]{font-weight:600;font-size:16px;border-top:1px solid #c8e6c9;padding-top:8px;margin-top:4px}.cash-discount-info[_ngcontent-%COMP%]   .form-text[_ngcontent-%COMP%]{margin-top:8px;color:#666;font-style:italic}.deposit-confirmation[_ngcontent-%COMP%]{background:#f3e5f5;border:1px solid #ce93d8;border-radius:8px;padding:12px}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer;accent-color:#7b1fa2}.deposit-confirmation[_ngcontent-%COMP%]   .form-text[_ngcontent-%COMP%]{margin-top:8px;color:#7b1fa2}"]})};export{Te as AdminOrderDetailComponent};
