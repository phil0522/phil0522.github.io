import{a as E}from"./chunk-U3TRPSTB.js";import{$ as D,L as _,Q as g,U as y,Y as M,Z as q,d as S,j as P,k as O}from"./chunk-E56DX7VV.js";import"./chunk-UYHN5VVP.js";import{Ea as a,Jb as m,N as d,Pa as h,Za as x,_a as C,da as c,db as l,eb as e,fb as t,gb as b,ob as k,yb as n,zb as p}from"./chunk-DU5POHF6.js";import"./chunk-Q7L6LLAK.js";var A=()=>({filter:"submitted"}),z=()=>({filter:"overdue"}),I=()=>({filter:"locked"});function F(r,i){r&1&&(e(0,"div",1),b(1,"div",2),t())}function L(r,i){if(r&1&&(e(0,"div",3)(1,"a",4)(2,"div",5)(3,"div",6)(4,"span"),n(5,"\u25F7"),t()(),e(6,"span",7),n(7,"Review \u203A"),t()(),e(8,"div",8),n(9),t(),e(10,"div",9),n(11,"Pending Orders"),t(),e(12,"div",10),n(13,"Receipts waiting for review"),t()(),e(14,"a",4)(15,"div",5)(16,"div",11)(17,"span"),n(18,"\u26A0"),t()(),e(19,"span",7),n(20,"Handle \u203A"),t()(),e(21,"div",8),n(22),t(),e(23,"div",9),n(24,"Overdue Payments"),t(),e(25,"div",10),n(26,"Payments past deadline"),t()(),e(27,"a",4)(28,"div",5)(29,"div",12)(30,"span"),n(31,"\u{1F512}"),t()(),e(32,"span",7),n(33,"View \u203A"),t()(),e(34,"div",8),n(35),t(),e(36,"div",9),n(37,"Locked Spots"),t(),e(38,"div",10),n(39,"Active holds in system"),t()()(),e(40,"div",13)(41,"div",14)(42,"h3"),n(43,"Quick Actions"),t(),e(44,"p"),n(45,"Common management tasks"),t()(),e(46,"div",15)(47,"a",16)(48,"div",17)(49,"span"),n(50,"\u{1F4C4}"),t()(),e(51,"div",18)(52,"span",19),n(53,"Process Applications"),t(),e(54,"span",20),n(55,"Review new camp applications"),t()(),e(56,"span",21),n(57,"\u203A"),t()(),e(58,"a",22)(59,"div",23)(60,"span"),n(61,"\u{1F4DA}"),t()(),e(62,"div",18)(63,"span",19),n(64,"Manage Catalog"),t(),e(65,"span",20),n(66,"Edit seasons, classes, and pricing"),t()(),e(67,"span",21),n(68,"\u203A"),t()(),e(69,"a",24)(70,"div",25)(71,"span"),n(72,"\u2B07"),t()(),e(73,"div",18)(74,"span",19),n(75,"Export Data"),t(),e(76,"span",20),n(77,"Download full registration roster (CSV)"),t()(),e(78,"span",21),n(79,"\u203A"),t()()()()),r&2){let o=k();a(),l("queryParams",m(7,A)),a(8),p(o.pendingCount()),a(5),l("queryParams",m(8,z)),a(8),p(o.overdueCount()),a(5),l("queryParams",m(9,I)),a(8),p(o.lockedCount()),a(12),l("queryParams",m(10,A))}}var w=class r{userService=d(D);router=d(P);orderDatastore=d(y);seasonService=d(q);configService=d(M);loading=c(!0);pendingCount=c(0);overdueCount=c(0);lockedCount=c(0);async ngOnInit(){if(console.log("[AdminDashboard] ngOnInit start"),!this.userService.isAuthenticated()){console.log("[AdminDashboard] not authenticated, redirecting to login"),this.router.navigate(["/login"]);return}if(!this.userService.isAdmin()){console.log("[AdminDashboard] not admin, redirecting to home"),this.router.navigate(["/"]);return}try{console.log("[AdminDashboard] calling loadSeasons..."),await this.seasonService.loadSeasons(),console.log("[AdminDashboard] loadSeasons complete, selectedSeason:",this.seasonService.selectedSeason()?.id),await this.loadStats()}finally{this.loading.set(!1)}}async loadStats(){console.log("[AdminDashboard] loadStats: loading from all seasons");try{let i=await this.orderDatastore.listAllSeasonOrders();console.log("[AdminDashboard] fetched orders from all seasons:",i.length);let o=this.configService.currentTime(),u=i.filter(s=>g(s)==="submitted").length,f=i.filter(s=>g(s)==="locked").length,v=i.filter(s=>_(s,o)).length;console.log("[AdminDashboard] stats:",{pending:u,locked:f,overdue:v,total:i.length}),this.pendingCount.set(u),this.lockedCount.set(f),this.overdueCount.set(v)}catch(i){console.error("[AdminDashboard] Failed to load dashboard stats:",i)}}static \u0275fac=function(o){return new(o||r)};static \u0275cmp=h({type:r,selectors:[["app-admin-dashboard"]],decls:3,vars:1,consts:[["pageTitle","Welcome back, Admin","pageSubtitle","Here's what's happening with your camp registration today."],[1,"loading-state"],[1,"spinner"],[1,"stats-grid"],["routerLink","/admin/orders",1,"stat-card",3,"queryParams"],[1,"stat-header"],[1,"stat-icon","blue"],[1,"stat-link"],[1,"stat-number"],[1,"stat-label"],[1,"stat-subtitle"],[1,"stat-icon","orange"],[1,"stat-icon","purple"],[1,"quick-actions-card"],[1,"quick-actions-header"],[1,"quick-actions-list"],["routerLink","/admin/orders",1,"quick-action",3,"queryParams"],[1,"quick-action-icon","blue"],[1,"quick-action-text"],[1,"quick-action-title"],[1,"quick-action-desc"],[1,"quick-action-chevron"],["routerLink","/admin/catalog",1,"quick-action"],[1,"quick-action-icon","purple"],["routerLink","/admin/export",1,"quick-action"],[1,"quick-action-icon","red"]],template:function(o,u){o&1&&(e(0,"app-admin-layout",0),x(1,F,2,0,"div",1)(2,L,80,11),t()),o&2&&(a(),C(u.loading()?1:2))},dependencies:[S,O,E],styles:[".loading-state[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:4rem}.spinner[_ngcontent-%COMP%]{width:32px;height:32px;border:3px solid #eee;border-top-color:#c62828;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:1.5rem}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.25rem;text-decoration:none;border:1px solid #e8e8e8;transition:all .2s ease;display:flex;flex-direction:column}.stat-card[_ngcontent-%COMP%]:hover{border-color:#ddd;transform:translateY(-2px);box-shadow:0 4px 12px #0000000f}.stat-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:1rem}.stat-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.125rem}.stat-icon.blue[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.stat-icon.orange[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.stat-icon.purple[_ngcontent-%COMP%]{background:#f3e5f5;color:#7b1fa2}.stat-link[_ngcontent-%COMP%]{font-size:.75rem;color:#888;font-weight:500}.stat-card[_ngcontent-%COMP%]:hover   .stat-link[_ngcontent-%COMP%]{color:#c62828}.stat-number[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#212121;line-height:1;margin-bottom:.375rem}.stat-label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#333;margin-bottom:.25rem}.stat-subtitle[_ngcontent-%COMP%]{font-size:.75rem;color:#888}.quick-actions-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid #e8e8e8;overflow:hidden}.quick-actions-header[_ngcontent-%COMP%]{padding:1.25rem 1.25rem 1rem;border-bottom:1px solid #f0f0f0}.quick-actions-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1rem;font-weight:600;color:#212121}.quick-actions-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.8rem;color:#888}.quick-actions-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.quick-action[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem 1.25rem;text-decoration:none;transition:background .15s ease;border-bottom:1px solid #f5f5f5}.quick-action[_ngcontent-%COMP%]:last-child{border-bottom:none}.quick-action[_ngcontent-%COMP%]:hover{background:#fafafa}.quick-action-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:1.125rem;flex-shrink:0}.quick-action-icon.blue[_ngcontent-%COMP%]{background:#e3f2fd}.quick-action-icon.purple[_ngcontent-%COMP%]{background:#f3e5f5}.quick-action-icon.red[_ngcontent-%COMP%]{background:#ffebee}.quick-action-text[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.125rem}.quick-action-title[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#333}.quick-action-desc[_ngcontent-%COMP%]{font-size:.75rem;color:#888}.quick-action-chevron[_ngcontent-%COMP%]{font-size:1.25rem;color:#ccc;font-weight:300}.quick-action[_ngcontent-%COMP%]:hover   .quick-action-chevron[_ngcontent-%COMP%]{color:#999}@media(max-width:768px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})};export{w as AdminDashboardComponent};
