import{a as ne}from"./chunk-5Q2ELU6L.js";import{a as L}from"./chunk-PEKDIMLT.js";import{b as J,c as X,f as ee,r as te}from"./chunk-5M3WJSTJ.js";import{a as I}from"./chunk-6THQUTU6.js";import{a as H}from"./chunk-35QEJLB4.js";import"./chunk-BV4MKCLK.js";import{a as Z}from"./chunk-TZNWTF3S.js";import{b as G}from"./chunk-VVYVTIM6.js";import{Ia as K,Ja as D,d as P,h as Q,j as W,k as Y}from"./chunk-UBU22GLA.js";import{Ab as x,Bb as B,Cb as a,Db as h,Eb as C,Ia as o,Ib as R,Jb as z,Kb as U,R as S,Ta as M,Tb as w,Vb as A,W as _,Wb as q,X as f,bb as g,cb as p,fb as E,gb as k,ha as b,hb as T,ib as c,jb as l,kb as $,lb as s,mb as d,ob as y,pb as j,qb as v,rb as O,sb as m}from"./chunk-UKFGIOHC.js";var de=(r,t)=>t.userAuthId;function ce(r,t){r&1&&(s(0,"span",10),a(1,"Pending"),d())}function le(r,t){if(r&1){let e=y();s(0,"tr",4),O("click",function(){let i=_(e).$implicit,u=m();return f(u.rowClick.emit(i.userAuthId))}),s(1,"td",5),a(2),d(),s(3,"td",6),a(4),d(),s(5,"td",7),a(6),d(),s(7,"td")(8,"span",8),a(9),d()(),s(10,"td",2),a(11),d(),s(12,"td",2),a(13),d(),s(14,"td",9),a(15),d(),s(16,"td"),g(17,ce,2,0,"span",10),d(),s(18,"td",11),a(19),d()()}if(r&2){let e=t.$implicit,n=m();o(2),h(n.getParentName(e)),o(2),h(n.getStudentNames(e)),o(2),h(n.getSessionNames(e)),o(2),B("status-"+n.getStatusClass(e)),o(),C(" ",n.getStatusLabel(e)," "),o(2),C("$",n.formatCents(n.getTotal(e))),o(2),C("$",n.formatCents(n.getPaid(e))),o(2),h(n.formatDeadline(e)),o(2),p(n.hasPendingChangeRequest(e)?17:-1),o(2),h(n.formatDate(e.createdAt))}}var N=class r{orders=q.required();userCache=q(new Map);rowClick=A();getParentName(t){return this.userCache().get(t.userAuthId)?.parentName??t.userDisplayId}getStudentNames(t){let e=this.userCache().get(t.userAuthId);return e?.studentNames?.length?e.studentNames.join(", "):[...new Set(t.items.map(i=>i.studentId))].join(", ")}getSessionNames(t){let e=t.items.map(i=>i.snapshot.className);return[...new Set(e)].join(", ")}getStatusClass(t){return t.orderStatus??"submitted"}getStatusLabel(t){return{locked:"Locked",submitted:"Submitted",paid:"Paid",mixed:"Mixed",cancelled:"Cancelled"}[t.orderStatus??""]??"Unknown"}getTotal(t){return D(t)}getPaid(t){return K(t)}formatCents(t){return(t/100).toFixed(2)}formatDeadline(t){if(!t.lockExpiresAt)return"-";let e=new Date(t.lockExpiresAt);return e<new Date?"Overdue":e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}formatDate(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric"})}hasPendingChangeRequest(t){return t.changeRequests?.some(e=>e.status==="pending")??!1}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=M({type:r,selectors:[["app-admin-order-table"]],inputs:{orders:[1,"orders"],userCache:[1,"userCache"]},outputs:{rowClick:"rowClick"},decls:25,vars:0,consts:[[1,"table-container"],[1,"order-table"],[1,"col-amount"],[1,"order-row"],[1,"order-row",3,"click"],[1,"col-name"],[1,"col-students"],[1,"col-sessions"],[1,"status-badge"],[1,"col-deadline"],[1,"badge","badge-warning"],[1,"col-date"]],template:function(e,n){e&1&&(s(0,"div",0)(1,"table",1)(2,"thead")(3,"tr")(4,"th"),a(5,"Parent Name"),d(),s(6,"th"),a(7,"Students"),d(),s(8,"th"),a(9,"Sessions"),d(),s(10,"th"),a(11,"Status"),d(),s(12,"th",2),a(13,"Total"),d(),s(14,"th",2),a(15,"Paid"),d(),s(16,"th"),a(17,"Deadline"),d(),s(18,"th"),a(19,"Change Req"),d(),s(20,"th"),a(21,"Created"),d()()(),s(22,"tbody"),E(23,le,20,11,"tr",3,de),d()()()),e&2&&(o(23),k(n.orders()))},dependencies:[P],styles:[".table-container[_ngcontent-%COMP%]{overflow-x:auto}.order-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.85rem}.order-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:.625rem .75rem;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:var(--sys-on-surface-variant, #666);border-bottom:2px solid var(--sys-outline-variant, #e0e0e0);white-space:nowrap}.order-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.625rem .75rem;border-bottom:1px solid var(--sys-outline-variant, #f0f0f0);color:var(--sys-on-surface, #212121);vertical-align:middle}.order-row[_ngcontent-%COMP%]{cursor:pointer;transition:background .15s ease}.order-row[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}.col-name[_ngcontent-%COMP%]{font-weight:500;max-width:150px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.col-students[_ngcontent-%COMP%], .col-sessions[_ngcontent-%COMP%]{max-width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.col-amount[_ngcontent-%COMP%]{text-align:right;font-variant-numeric:tabular-nums;white-space:nowrap}.col-deadline[_ngcontent-%COMP%]{white-space:nowrap;font-size:.8rem}.col-date[_ngcontent-%COMP%]{white-space:nowrap;font-size:.8rem;color:var(--sys-on-surface-variant, #666)}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:.2rem .5rem;border-radius:10px;font-size:.75rem;font-weight:500;white-space:nowrap}.status-locked[_ngcontent-%COMP%]{background:#f3e5f5;color:#6a1b9a}.status-submitted[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.status-paid[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.status-mixed[_ngcontent-%COMP%]{background:#e3f2fd;color:#1565c0}.status-cancelled[_ngcontent-%COMP%]{background:#fafafa;color:#757575}.badge[_ngcontent-%COMP%]{display:inline-block;padding:.15rem .4rem;border-radius:8px;font-size:.7rem;font-weight:500}.badge-warning[_ngcontent-%COMP%]{background:#fff8e1;color:#f57f17}"]})};var oe=(r,t)=>t.id;function me(r,t){if(r&1){let e=y();s(0,"button",6),O("click",function(){_(e);let i=m();return f(i.onClear())}),a(1,"x"),d()}}function ue(r,t){if(r&1){let e=y();s(0,"div",10),O("mousedown",function(){let i=_(e).$implicit,u=m(3);return f(u.selectSuggestion(i))})("mouseenter",function(){let i=_(e).$index,u=m(3);return f(u.highlightedIndex.set(i))}),s(1,"span",11),a(2),d(),s(3,"span",12),a(4),d()()}if(r&2){let e=t.$implicit,n=t.$index,i=m(3);x("highlighted",i.highlightedIndex()===n),o(2),h(e.label),o(2),h(e.sublabel)}}function ge(r,t){if(r&1&&(s(0,"div",7)(1,"div",8),a(2,"Students / Parents"),d(),E(3,ue,5,4,"div",9,oe),d()),r&2){let e=m(2);o(3),k(e.userSuggestions())}}function pe(r,t){if(r&1){let e=y();s(0,"div",10),O("mousedown",function(){let i=_(e).$implicit,u=m(3);return f(u.selectSuggestion(i))})("mouseenter",function(){let i=_(e).$index,u=m(3);return f(u.highlightedIndex.set(u.userSuggestions().length+i))}),s(1,"span",11),a(2),d(),s(3,"span",12),a(4),d()()}if(r&2){let e=t.$implicit,n=t.$index,i=m(3);x("highlighted",i.highlightedIndex()===i.userSuggestions().length+n),o(2),h(e.label),o(2),h(e.sublabel)}}function _e(r,t){if(r&1&&(s(0,"div",7)(1,"div",8),a(2,"Sessions"),d(),E(3,pe,5,4,"div",9,oe),d()),r&2){let e=m(2);o(3),k(e.sessionSuggestions())}}function fe(r,t){if(r&1&&(s(0,"div",4),g(1,ge,5,0,"div",7),g(2,_e,5,0,"div",7),d()),r&2){let e=m();o(),p(e.userSuggestions().length>0?1:-1),o(),p(e.sessionSuggestions().length>0?2:-1)}}function he(r,t){if(r&1&&(s(0,"div",5),a(1," Showing results for: "),s(2,"strong"),a(3),d(),a(4),d()),r&2){let e=m();o(3),h(e.activeSelection().label),o(),C(" (",e.activeSelection().type==="user"?"Parent/Student":"Session",") ")}}var V=class r{userCacheService=S(L);seasonService=S(I);searchSelect=A();searchClear=A();query=b("");showSuggestions=b(!1);highlightedIndex=b(-1);activeSelection=b(null);debounceTimer=null;debouncedQuery=b("");userSuggestions=w(()=>{let t=this.debouncedQuery().toLowerCase().trim();if(t.length<2)return[];let e=this.userCacheService.users(),n=[];for(let i of e){if(n.length>=8)break;let u=i.parentName.toLowerCase().includes(t),F=i.studentNames.find(se=>se.toLowerCase().includes(t));(u||F)&&n.push({type:"user",id:i.authId,label:F??i.parentName,sublabel:F?`Parent: ${i.parentName}`:"Parent"})}return n});sessionSuggestions=w(()=>{let t=this.debouncedQuery().toLowerCase().trim();if(t.length<2)return[];let e=this.seasonService.classes(),n=[];for(let i of e){if(n.length>=5)break;i.name.toLowerCase().includes(t)&&n.push({type:"session",id:i.id,label:i.name,sublabel:"Session"})}return n});allSuggestions=w(()=>[...this.userSuggestions(),...this.sessionSuggestions()]);onInput(t){this.query.set(t),this.highlightedIndex.set(-1),this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.debouncedQuery.set(t),t.trim().length>=2?this.showSuggestions.set(!0):this.showSuggestions.set(!1)},200)}onFocus(){this.debouncedQuery().trim().length>=2&&this.allSuggestions().length>0&&this.showSuggestions.set(!0)}closeSuggestions(){this.showSuggestions.set(!1)}selectSuggestion(t){let e={type:t.type,id:t.id,label:t.label};this.activeSelection.set(e),this.query.set(t.label),this.showSuggestions.set(!1),this.searchSelect.emit(e)}onClear(){this.query.set(""),this.debouncedQuery.set(""),this.activeSelection.set(null),this.showSuggestions.set(!1),this.highlightedIndex.set(-1),this.searchClear.emit()}onKeydown(t){let e=this.allSuggestions();if(!(!this.showSuggestions()||e.length===0))switch(t.key){case"ArrowDown":t.preventDefault(),this.highlightedIndex.update(i=>Math.min(i+1,e.length-1));break;case"ArrowUp":t.preventDefault(),this.highlightedIndex.update(i=>Math.max(i-1,0));break;case"Enter":t.preventDefault();let n=this.highlightedIndex();n>=0&&n<e.length&&this.selectSuggestion(e[n]);break;case"Escape":this.closeSuggestions();break}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=M({type:r,selectors:[["app-admin-order-search"]],outputs:{searchSelect:"searchSelect",searchClear:"searchClear"},decls:6,vars:4,consts:[[1,"search-container",3,"clickOutside"],[1,"search-input-wrapper"],["type","text","placeholder","Search by parent, student, or session name...",1,"search-input",3,"input","focus","keydown","value"],[1,"btn-clear"],[1,"suggestions-dropdown"],[1,"active-selection"],[1,"btn-clear",3,"click"],[1,"suggestion-section"],[1,"section-label"],[1,"suggestion-item",3,"highlighted"],[1,"suggestion-item",3,"mousedown","mouseenter"],[1,"suggestion-label"],[1,"suggestion-sublabel"]],template:function(e,n){e&1&&(s(0,"div",0),O("clickOutside",function(){return n.closeSuggestions()}),s(1,"div",1)(2,"input",2),O("input",function(u){return n.onInput(u.target.value)})("focus",function(){return n.onFocus()})("keydown",function(u){return n.onKeydown(u)}),d(),g(3,me,2,0,"button",3),d(),g(4,fe,3,2,"div",4),g(5,he,5,2,"div",5),d()),e&2&&(o(2),j("value",n.query()),o(),p(n.query()||n.activeSelection()?3:-1),o(),p(n.showSuggestions()&&n.allSuggestions().length>0?4:-1),o(),p(n.activeSelection()?5:-1))},dependencies:[P],styles:[".search-container[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem}.search-input-wrapper[_ngcontent-%COMP%]{position:relative}.search-input[_ngcontent-%COMP%]{width:100%;padding:.75rem 2.5rem .75rem .875rem;border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-size:.875rem;background:#fff;box-sizing:border-box}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--sys-primary, #c62828)}.search-input[_ngcontent-%COMP%]::placeholder{color:var(--sys-on-surface-variant, #999)}.btn-clear[_ngcontent-%COMP%]{position:absolute;right:.5rem;top:50%;transform:translateY(-50%);background:transparent;border:none;font-size:1rem;color:var(--sys-on-surface-variant, #666);cursor:pointer;padding:.25rem .5rem;line-height:1}.btn-clear[_ngcontent-%COMP%]:hover{color:var(--sys-on-surface, #212121)}.suggestions-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;box-shadow:0 4px 16px #0000001f;z-index:100;max-height:320px;overflow-y:auto;margin-top:4px}.suggestion-section[_ngcontent-%COMP%]{padding:.25rem 0}.suggestion-section[_ngcontent-%COMP%] + .suggestion-section[_ngcontent-%COMP%]{border-top:1px solid var(--sys-outline-variant, #f0f0f0)}.section-label[_ngcontent-%COMP%]{padding:.5rem .875rem .25rem;font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;color:var(--sys-on-surface-variant, #666)}.suggestion-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.5rem .875rem;cursor:pointer;transition:background .1s ease}.suggestion-item[_ngcontent-%COMP%]:hover, .suggestion-item.highlighted[_ngcontent-%COMP%]{background:var(--sys-surface-variant, #f5f5f5)}.suggestion-label[_ngcontent-%COMP%]{font-size:.85rem;color:var(--sys-on-surface, #212121)}.suggestion-sublabel[_ngcontent-%COMP%]{font-size:.75rem;color:var(--sys-on-surface-variant, #999);margin-left:.5rem;white-space:nowrap}.active-selection[_ngcontent-%COMP%]{margin-top:.5rem;font-size:.8rem;color:var(--sys-on-surface-variant, #666)}.active-selection[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--sys-on-surface, #212121)}"]})};function Ce(r,t){r&1&&(c(0,"div",8),$(1,"div",12),c(2,"p"),a(3,"Loading orders..."),l()())}function ve(r,t){if(r&1){let e=y();c(0,"div",9)(1,"div",13),a(2,"!"),l(),c(3,"p"),a(4),l(),c(5,"button",14),v("click",function(){_(e);let i=m();return f(i.loadOrders())}),a(6,"Retry"),l()()}if(r&2){let e=m();o(4),h(e.adminService.error())}}function be(r,t){r&1&&(c(0,"h2"),a(1,"No orders match your search"),l(),c(2,"p"),a(3,"Try adjusting your search query"),l())}function ye(r,t){r&1&&(c(0,"p"),a(1,"No orders in the system yet"),l())}function Se(r,t){r&1&&(c(0,"p"),a(1,"Try another filter"),l())}function xe(r,t){if(r&1&&(c(0,"h2"),a(1),l(),g(2,ye,2,0,"p")(3,Se,2,0,"p")),r&2){let e=m(2);o(),C("No ",e.getFilterName()," orders"),o(),p(e.adminService.activeFilter()==="all"?2:3)}}function Oe(r,t){if(r&1&&(c(0,"div",10)(1,"div",15),a(2,"\u{1F4CB}"),l(),g(3,be,4,0)(4,xe,4,2),l()),r&2){let e=m();o(3),p(e.isSearchMode()?3:4)}}function we(r,t){if(r&1){let e=y();c(0,"div",17)(1,"button",18),v("click",function(){_(e);let i=m(2);return f(i.onLoadMore())}),a(2),l()()}if(r&2){let e=m(2);o(),T("disabled",e.adminService.loadingMore()),o(),C(" ",e.adminService.loadingMore()?"Loading...":"Load More"," ")}}function Me(r,t){if(r&1){let e=y();c(0,"app-admin-order-table",16),v("rowClick",function(i){_(e);let u=m();return f(u.onViewDetails(i))}),l(),g(1,we,3,2,"div",17)}if(r&2){let e=m();T("orders",e.displayedOrders())("userCache",e.userCacheMap()),o(),p(!e.isSearchMode()&&e.adminService.hasMore()?1:-1)}}function Pe(r,t){if(r&1){let e=y();c(0,"div",21)(1,"label",26),a(2,"Payment Reference"),l(),c(3,"input",27),U("ngModelChange",function(i){_(e);let u=m(2);return z(u.paymentReference,i)||(u.paymentReference=i),f(i)}),l()()}if(r&2){let e=m(2);o(3),R("ngModel",e.paymentReference)}}function Ee(r,t){if(r&1){let e=y();c(0,"div",21)(1,"label",28),a(2,"Cancellation Reason"),l(),c(3,"textarea",29),U("ngModelChange",function(i){_(e);let u=m(2);return z(u.cancelReason,i)||(u.cancelReason=i),f(i)}),l()()}if(r&2){let e=m(2);o(3),R("ngModel",e.cancelReason)}}function ke(r,t){if(r&1&&(c(0,"div",22),a(1),l()),r&2){let e=m(2);o(),h(e.adminService.actionError())}}function Ae(r,t){if(r&1){let e=y();c(0,"div",19),v("click",function(){_(e);let i=m();return f(i.closeDialog())}),c(1,"div",20),v("click",function(i){return _(e),f(i.stopPropagation())}),c(2,"h3"),a(3),l(),c(4,"p"),a(5),l(),g(6,Pe,4,1,"div",21),g(7,Ee,4,1,"div",21),g(8,ke,2,1,"div",22),c(9,"div",23)(10,"button",24),v("click",function(){_(e);let i=m();return f(i.confirmAction())}),a(11),l(),c(12,"button",25),v("click",function(){_(e);let i=m();return f(i.closeDialog())}),a(13,"Cancel"),l()()()()}if(r&2){let e=m();o(3),h(e.dialogTitle()),o(2),h(e.dialogMessage()),o(),p(e.dialogType()==="confirm-payment"?6:-1),o(),p(e.dialogType()==="cancel"?7:-1),o(),p(e.adminService.actionError()?8:-1),o(2),T("disabled",e.adminService.actionLoading()),o(),C(" ",e.adminService.actionLoading()?"Processing...":"Confirm"," ")}}var ae=class r{adminService=S(ne);seasonService=S(I);configService=S(Z);userService=S(G);userCacheService=S(L);orderDatastore=S(H);router=S(W);route=S(Q);userCacheMap=w(()=>{let t=this.userCacheService.users(),e=new Map;for(let n of t)e.set(n.authId,n);return e});isSearchMode=b(!1);_searchResults=b([]);showDialog=b(!1);dialogType=b(null);dialogTitle=b("");dialogMessage=b("");selectedOrder=null;paymentReference="";cancelReason="";displayedOrders=w(()=>this.isSearchMode()?this._searchResults():this.adminService.filteredOrders());async ngOnInit(){if(!this.userService.isAuthenticated()){this.router.navigate(["/login"]);return}if(!this.userService.isAdmin()){this.router.navigate(["/"]);return}this.route.queryParams.subscribe(e=>{let n=e.filter;n&&["all","locked","submitted","overdue","paid"].includes(n)&&this.adminService.setFilter(n)});let t=this.configService.currentActiveYear();await this.seasonService.loadSeasons(t),await this.seasonService.loadClassesByYear(t),this.userCacheService.isLoaded()||await this.userCacheService.loadCache(),await this.loadOrders()}async loadOrders(){try{await this.adminService.loadPage()}catch{}}setFilter(t){this.adminService.setFilter(t),this.router.navigate([],{relativeTo:this.route,queryParams:{filter:t},queryParamsHandling:"merge"}),this.loadOrders()}async onLoadMore(){try{await this.adminService.loadMore()}catch{}}async onSearchSelect(t){this.isSearchMode.set(!0),this._searchResults.set([]);try{let e=this.configService.currentActiveYear();if(t.type==="user"){let n=await this.orderDatastore.listOrdersByUserIds(e,[t.id]);this._searchResults.set(n)}else if(t.type==="session"){let n=this.seasonService.selectedSeason();if(n){let i=await this.orderDatastore.listOrdersBySessionId(e,n.id,t.id);this._searchResults.set(i)}}}catch{}}onSearchClear(){this.isSearchMode.set(!1),this._searchResults.set([])}getFilterName(){return{all:"",locked:"locked",submitted:"submitted",overdue:"overdue",paid:"paid"}[this.adminService.activeFilter()]}onConfirmPayment(t){let e=this.adminService.filteredOrders().find(n=>n.userAuthId===t);e&&(this.selectedOrder=e,this.paymentReference="",this.dialogType.set("confirm-payment"),this.dialogTitle.set("Confirm Payment"),this.dialogMessage.set("Enter payment reference to confirm receipt."),this.showDialog.set(!0))}onCancelOrder(t){let e=this.adminService.filteredOrders().find(n=>n.userAuthId===t);e&&(this.selectedOrder=e,this.cancelReason="",this.dialogType.set("cancel"),this.dialogTitle.set("Cancel Order"),this.dialogMessage.set("Are you sure you want to cancel this order? Inventory will be released."),this.showDialog.set(!0))}onViewDetails(t){this.router.navigate(["/admin/orders",t])}closeDialog(){this.showDialog.set(!1),this.dialogType.set(null),this.selectedOrder=null,this.adminService.clearError()}async confirmAction(){if(this.selectedOrder)try{switch(this.dialogType()){case"confirm-payment":if(!this.paymentReference.trim())return;let t=D(this.selectedOrder)-this.selectedOrder.totalPaid,e=this.configService.currentActiveYear();await this.adminService.recordPayment(e,this.selectedOrder.userAuthId,t,this.paymentReference.trim(),"zelle");break;case"cancel":let n=this.selectedOrder.items.filter(i=>i.status==="locked"||i.status==="submitted"||i.status==="paid").map(i=>({sessionId:i.sessionId,studentId:i.studentId}));if(n.length===0)return;await this.adminService.cancelOrder(this.selectedOrder.userAuthId,n,this.cancelReason.trim()||"Cancelled by admin");break}this.closeDialog()}catch{}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=M({type:r,selectors:[["app-admin-order-list"]],decls:25,vars:20,consts:[[1,"admin-order-list"],[1,"page-header"],["routerLink","/admin",1,"back-link"],[1,"subtitle"],[1,"filter-tabs"],[1,"tab",3,"click"],[1,"tab","tab-warning",3,"click"],[3,"searchSelect","searchClear"],[1,"loading-container"],[1,"error-container"],[1,"empty-container"],[1,"dialog-overlay"],[1,"spinner"],[1,"error-icon"],[1,"btn-retry",3,"click"],[1,"empty-icon"],[3,"rowClick","orders","userCache"],[1,"load-more-container"],[1,"btn-load-more",3,"click","disabled"],[1,"dialog-overlay",3,"click"],[1,"dialog",3,"click"],[1,"form-group"],[1,"dialog-error"],[1,"dialog-actions"],[1,"btn","btn-primary",3,"click","disabled"],[1,"btn","btn-outline",3,"click"],["for","paymentRef"],["type","text","id","paymentRef","placeholder","Zelle confirmation / Bank transfer number",3,"ngModelChange","ngModel"],["for","cancelReason"],["id","cancelReason","rows","3","placeholder","Enter cancellation reason",3,"ngModelChange","ngModel"]],template:function(e,n){e&1&&(c(0,"div",0)(1,"header",1)(2,"a",2),a(3,"\u2190 Back to Dashboard"),l(),c(4,"h1"),a(5,"Order Management"),l(),c(6,"p",3),a(7,"Manage all orders"),l()(),c(8,"div",4)(9,"button",5),v("click",function(){return n.setFilter("all")}),a(10),l(),c(11,"button",5),v("click",function(){return n.setFilter("locked")}),a(12),l(),c(13,"button",5),v("click",function(){return n.setFilter("submitted")}),a(14),l(),c(15,"button",6),v("click",function(){return n.setFilter("overdue")}),a(16),l(),c(17,"button",5),v("click",function(){return n.setFilter("paid")}),a(18),l()(),c(19,"app-admin-order-search",7),v("searchSelect",function(u){return n.onSearchSelect(u)})("searchClear",function(){return n.onSearchClear()}),l(),g(20,Ce,4,0,"div",8),g(21,ve,7,1,"div",9),g(22,Oe,5,1,"div",10),g(23,Me,2,3),g(24,Ae,14,7,"div",11),l()),e&2&&(o(9),x("active",n.adminService.activeFilter()==="all"),o(),C(" All (",n.adminService.orderCount(),") "),o(),x("active",n.adminService.activeFilter()==="locked"),o(),C(" Locked (",n.adminService.lockedCount(),") "),o(),x("active",n.adminService.activeFilter()==="submitted"),o(),C(" Submitted (",n.adminService.submittedCount(),") "),o(),x("active",n.adminService.activeFilter()==="overdue"),o(),C(" Overdue (",n.adminService.overdueCount(),") "),o(),x("active",n.adminService.activeFilter()==="paid"),o(),C(" Paid (",n.adminService.paidCount(),") "),o(2),p(n.adminService.loading()?20:-1),o(),p(n.adminService.error()?21:-1),o(),p(!n.adminService.loading()&&!n.adminService.error()&&n.displayedOrders().length===0?22:-1),o(),p(!n.adminService.loading()&&n.displayedOrders().length>0?23:-1),o(),p(n.showDialog()?24:-1))},dependencies:[P,te,J,X,ee,Y,N,V],styles:[".admin-order-list[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:1.5rem}.page-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.back-link[_ngcontent-%COMP%]{display:inline-block;color:var(--sys-primary, #c62828);text-decoration:none;font-size:.875rem;margin-bottom:.5rem}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.75rem;color:var(--sys-on-surface, #212121)}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;color:var(--sys-on-surface-variant, #666)}.filter-tabs[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid var(--sys-outline-variant, #f0f0f0);overflow-x:auto}.tab[_ngcontent-%COMP%]{padding:.5rem 1rem;background:transparent;border:1px solid var(--sys-outline, #e0e0e0);border-radius:20px;font-size:.875rem;color:var(--sys-on-surface-variant, #666);cursor:pointer;white-space:nowrap;transition:all .2s ease}.tab[_ngcontent-%COMP%]:hover{border-color:var(--sys-primary, #c62828);color:var(--sys-primary, #c62828)}.tab.active[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);border-color:var(--sys-primary, #c62828);color:#fff}.tab-warning[_ngcontent-%COMP%]{border-color:var(--sys-error, #d32f2f);color:var(--sys-error, #d32f2f)}.tab-warning.active[_ngcontent-%COMP%]{background:var(--sys-error, #d32f2f);border-color:var(--sys-error, #d32f2f)}.loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%], .empty-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{background:var(--sys-error-container, #ffebee);border-radius:12px}.error-icon[_ngcontent-%COMP%]{width:48px;height:48px;background:var(--sys-error, #c62828);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;margin-bottom:1rem}.btn-retry[_ngcontent-%COMP%]{padding:.5rem 1.5rem;background:var(--sys-error, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem}.empty-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--sys-on-surface, #212121)}.empty-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--sys-on-surface-variant, #666)}.load-more-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:1.5rem 0}.btn-load-more[_ngcontent-%COMP%]{padding:.625rem 2rem;background:transparent;border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-size:.875rem;color:var(--sys-primary, #c62828);cursor:pointer;transition:all .2s ease}.btn-load-more[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-surface-variant, #f5f5f5);border-color:var(--sys-primary, #c62828)}.btn-load-more[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.dialog[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:1.5rem;max-width:400px;width:100%;box-shadow:0 8px 32px #0003}.dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.25rem;color:var(--sys-on-surface, #212121)}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-on-surface-variant, #666);font-size:.875rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-size:.875rem;font-weight:500;color:var(--sys-on-surface, #212121)}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-size:.875rem;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--sys-primary, #c62828)}.dialog-error[_ngcontent-%COMP%]{padding:.75rem;background:var(--sys-error-container, #ffebee);color:var(--sys-error, #d32f2f);border-radius:8px;font-size:.875rem;margin-bottom:1rem}.dialog-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:flex-end}.btn[_ngcontent-%COMP%]{padding:.75rem 1.25rem;border-radius:8px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease;border:none}.btn-primary[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-primary-dark, #a51c1c)}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-outline[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--sys-outline, #e0e0e0);color:var(--sys-on-surface-variant, #666)}.btn-outline[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}.search-filters[_ngcontent-%COMP%]{margin-bottom:1.5rem;padding:1rem;background:var(--sys-surface-variant, #f5f5f5);border-radius:12px}.filter-row[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;align-items:flex-end}.filter-group[_ngcontent-%COMP%]{flex:1;min-width:200px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.375rem;font-size:.8rem;font-weight:500;color:var(--sys-on-surface-variant, #666)}.filter-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{width:100%;padding:.625rem .875rem;border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-size:.875rem;background:#fff;box-sizing:border-box}.filter-input[_ngcontent-%COMP%]:focus, .filter-select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--sys-primary, #c62828)}.filter-input[_ngcontent-%COMP%]::placeholder{color:var(--sys-on-surface-variant, #999)}.btn-clear-filters[_ngcontent-%COMP%]{padding:.625rem 1rem;background:transparent;border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-size:.875rem;color:var(--sys-on-surface-variant, #666);cursor:pointer;white-space:nowrap}.btn-clear-filters[_ngcontent-%COMP%]:hover{background:#fff;border-color:var(--sys-primary, #c62828);color:var(--sys-primary, #c62828)}.filter-results-info[_ngcontent-%COMP%]{margin-top:.75rem;font-size:.8rem;color:var(--sys-on-surface-variant, #666)}@media(max-width:640px){.filter-group[_ngcontent-%COMP%]{min-width:100%}}"]})};export{ae as AdminOrderListComponent};
