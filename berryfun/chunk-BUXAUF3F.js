import{a as ae}from"./chunk-C732UDYV.js";import{b as G,c as J,d as Z,e as K,f as Q,g as X,i as ee,j as te,k as ne,n as ie,r as oe}from"./chunk-S2KOEWNW.js";import{b as H}from"./chunk-IF3UYB7X.js";import{b as $}from"./chunk-U2XZRBUO.js";import{a as Y}from"./chunk-2JJ6EU5R.js";import"./chunk-EPAUVA6W.js";import{a as U}from"./chunk-6IBDFWE3.js";import{Aa as B,b as N,d as L,j,k as F,oa as W,pa as z}from"./chunk-MC2IQD7Q.js";import{Ab as a,Bb as g,Cb as f,Db as A,Gb as O,Ha as r,Hb as S,Ib as w,Nb as k,R as P,Rb as h,Sa as R,Ub as V,W as u,X as _,ab as c,bb as m,cb as E,db as b,eb as y,fb as C,gb as t,ha as D,hb as i,ib as M,mb as v,ob as x,qb as s}from"./chunk-EVJ2WVWM.js";function re(n){switch(n){case"submitted":return"status-badge status-submitted";case"paid":return"status-badge status-paid";case"cancelled":return"status-badge status-cancelled";case"change_requested":return"status-badge status-change-requested";case"refunded":return"status-badge status-refunded";case"partial":return"status-badge status-partial";case"empty":return"status-badge status-empty";default:return"status-badge"}}function de(n){switch(n){case"submitted":return"Pending Payment";case"paid":return"Paid";case"cancelled":return"Cancelled";case"change_requested":return"Change Requested";case"refunded":return"Refunded";case"partial":return"Partially Paid";case"empty":return"Empty";default:return n}}function le(n){switch(n){case"submitted":return"item-status-badge item-status-submitted";case"paid":return"item-status-badge item-status-paid";case"cancelled":return"item-status-badge item-status-cancelled";case"refunded":return"item-status-badge item-status-refunded";default:return"item-status-badge"}}function se(n){switch(n){case"submitted":return"Pending";case"paid":return"Paid";case"cancelled":return"Cancelled";case"refunded":return"Refunded";default:return n}}function ce(n){return`$${(n/100).toFixed(2)}`}function T(n){let o=n.replace(/[^0-9.]/g,""),e=parseFloat(o)||0;return Math.round(e*100)}function q(n){return(n/100).toFixed(2)}function me(n){return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function pe(n){return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}var xe=(n,o)=>({"text-danger":n,"text-warning":o}),Ce=(n,o)=>({"text-success":n,"text-danger":o}),I=(n,o)=>o.sessionId+"-"+o.studentId,fe=(n,o)=>o.sessionId,he=(n,o)=>o.id;function ve(n,o){n&1&&(t(0,"div",1),M(1,"div",5),t(2,"p"),a(3,"Loading order details..."),i()())}function be(n,o){if(n&1){let e=v();t(0,"div",2)(1,"strong"),a(2,"Error:"),i(),a(3),t(4,"button",6),x("click",function(){u(e);let d=s();return _(d.clearError())}),a(5,"\xD7"),i()()}if(n&2){let e=s();r(3),f(" ",e.error()," ")}}function ye(n,o){if(n&1&&(t(0,"div",18)(1,"span",19),a(2,"Phone:"),i(),t(3,"span",21),a(4),i()()),n&2){let e=s(3);r(4),g(e.userData().phone)}}function Oe(n,o){if(n&1&&(t(0,"div",18)(1,"span",19),a(2,"Address:"),i(),t(3,"span",21),a(4),i()()),n&2){let e=s(3);r(4),g(e.userData().address)}}function Se(n,o){if(n&1&&(t(0,"div",15)(1,"h2"),a(2,"User Information"),i(),t(3,"div",33)(4,"div",18)(5,"span",19),a(6,"Name:"),i(),t(7,"span",21),a(8),i()(),t(9,"div",18)(10,"span",19),a(11,"Email:"),i(),t(12,"span",21),a(13),i()(),c(14,ye,5,1,"div",18),c(15,Oe,5,1,"div",18),i()()),n&2){let e=s(2);r(8),g(e.userData().displayName),r(5),g(e.userData().email),r(),m(e.userData().phone?14:-1),r(),m(e.userData().address?15:-1)}}function we(n,o){if(n&1&&(t(0,"span",35),a(1),i()),n&2){let e=s(3);r(),A(" (",e.remainingLockTime().hours,"h ",e.remainingLockTime().minutes,"m remaining) ")}}function Me(n,o){if(n&1&&(t(0,"div",18)(1,"span",19),a(2,"Lock Expires:"),i(),t(3,"span",34),a(4),c(5,we,2,2,"span",35),i()()),n&2){let e=s(2);r(3),C("ngClass",k(3,xe,e.isOverdue(),e.isExpiringSoon())),r(),f(" ",e.formatDateTime(e.order().lockExpiresAt)," "),r(),m(e.remainingLockTime()?5:-1)}}function Pe(n,o){n&1&&(t(0,"div",22)(1,"strong"),a(2,"\u26A0\uFE0F Overdue:"),i(),a(3," This order's payment lock has expired. Items may be released. "),i())}function De(n,o){if(n&1){let e=v();t(0,"button",36),x("click",function(){u(e);let d=s(2);return _(d.openCancelItemsDialog())}),a(1," Cancel Items "),i()}}function Ee(n,o){n&1&&(t(0,"span",46),a(1,"Lunch"),i())}function Ie(n,o){n&1&&(t(0,"span",46),a(1,"Extended Care"),i())}function Ae(n,o){n&1&&(t(0,"span",47),a(1,"None"),i())}function ke(n,o){if(n&1&&(t(0,"div",40)(1,"div",41)(2,"span",42),a(3),i(),t(4,"span",43),a(5),i()(),t(6,"div",44)(7,"div",45)(8,"span",19),a(9,"Student:"),i(),t(10,"span",21),a(11),i()(),t(12,"div",45)(13,"span",19),a(14,"Options:"),i(),t(15,"span",21),c(16,Ee,2,0,"span",46),c(17,Ie,2,0,"span",46),c(18,Ae,2,0,"span",47),i()()()()),n&2){let e=o.$implicit,l=s(3);r(3),g(l.getClassName(e.sessionId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," "),r(6),g(l.getStudentName(e.studentId)),r(5),m(e.options.lunch?16:-1),r(),m(e.options.extendedCare?17:-1),r(),m(!e.options.lunch&&!e.options.extendedCare?18:-1)}}function Te(n,o){if(n&1&&(t(0,"div",26)(1,"h3",37),a(2," Paid Items "),t(3,"span",38),a(4),i()(),t(5,"div",39),b(6,ke,19,7,"div",40,I),i()()),n&2){let e=s(2);r(4),f("(",e.paidItems().length,")"),r(2),y(e.paidItems())}}function qe(n,o){n&1&&(t(0,"span",46),a(1,"Lunch"),i())}function Re(n,o){n&1&&(t(0,"span",46),a(1,"Extended Care"),i())}function Ve(n,o){n&1&&(t(0,"span",47),a(1,"None"),i())}function Ne(n,o){if(n&1&&(t(0,"div",48)(1,"div",41)(2,"span",42),a(3),i(),t(4,"span",43),a(5),i()(),t(6,"div",44)(7,"div",45)(8,"span",19),a(9,"Student:"),i(),t(10,"span",21),a(11),i()(),t(12,"div",45)(13,"span",19),a(14,"Options:"),i(),t(15,"span",21),c(16,qe,2,0,"span",46),c(17,Re,2,0,"span",46),c(18,Ve,2,0,"span",47),i()()()()),n&2){let e=o.$implicit,l=s(3);r(3),g(l.getClassName(e.sessionId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," "),r(6),g(l.getStudentName(e.studentId)),r(5),m(e.options.lunch?16:-1),r(),m(e.options.extendedCare?17:-1),r(),m(!e.options.lunch&&!e.options.extendedCare?18:-1)}}function Le(n,o){if(n&1&&(t(0,"div",26)(1,"h3",37),a(2," Pending Payment "),t(3,"span",38),a(4),i()(),t(5,"div",39),b(6,Ne,19,7,"div",48,I),i()()),n&2){let e=s(2);r(4),f("(",e.submittedItems().length,")"),r(2),y(e.submittedItems())}}function je(n,o){if(n&1&&(t(0,"div",49)(1,"div",41)(2,"span",42),a(3),i(),t(4,"span",43),a(5),i()(),t(6,"div",44)(7,"div",45)(8,"span",19),a(9,"Student:"),i(),t(10,"span",21),a(11),i()()()()),n&2){let e=o.$implicit,l=s(3);r(3),g(l.getClassName(e.sessionId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," "),r(6),g(l.getStudentName(e.studentId))}}function Fe(n,o){if(n&1&&(t(0,"div",26)(1,"h3",37),a(2," Cancelled Items "),t(3,"span",38),a(4),i()(),t(5,"div",39),b(6,je,12,4,"div",49,I),i()()),n&2){let e=s(2);r(4),f("(",e.cancelledItems().length,")"),r(2),y(e.cancelledItems())}}function We(n,o){n&1&&(t(0,"div",27)(1,"p"),a(2,"No items in this order."),i()())}function ze(n,o){if(n&1&&(t(0,"div",58)(1,"span",19),a(2),i(),t(3,"span",59),a(4),i()()),n&2){let e=o.$implicit,l=s(4);r(2),f("",e.type,":"),r(2),f(" ",l.formatCurrency(e.amount)," ")}}function Be(n,o){if(n&1&&(t(0,"div",52)(1,"div",57),a(2,"Discounts:"),i(),b(3,ze,5,2,"div",58,E),i()),n&2){let e=s(3);r(3),y(e.order().pricing.discounts)}}function $e(n,o){if(n&1&&(t(0,"div",28)(1,"h2"),a(2,"Pricing Summary"),i(),t(3,"div",50)(4,"div",51)(5,"span",19),a(6,"Subtotal:"),i(),t(7,"span",21),a(8),i()(),c(9,Be,5,0,"div",52),t(10,"div",53)(11,"span",19),a(12,"Total Due:"),i(),t(13,"span",54),a(14),i()(),t(15,"div",51)(16,"span",19),a(17,"Total Paid:"),i(),t(18,"span",21),a(19),i()(),t(20,"div",55)(21,"span",19),a(22,"Balance:"),i(),t(23,"span",56),a(24),i()()()()),n&2){let e=s(2);r(8),g(e.formatCurrency(e.order().pricing.subtotal)),r(),m(e.order().pricing.discounts.length>0?9:-1),r(5),g(e.formatCurrency(e.totalDue())),r(5),g(e.formatCurrency(e.order().totalPaid)),r(),C("ngClass",k(6,Ce,e.amountDue()<=0,e.amountDue()>0)),r(4),g(e.formatCurrency(e.amountDue()))}}function Ue(n,o){if(n&1&&(t(0,"tr")(1,"td"),a(2),i(),t(3,"td",61),a(4),i(),t(5,"td")(6,"span",62),a(7),i()(),t(8,"td"),a(9),i(),t(10,"td"),a(11),i()()),n&2){let e=o.$implicit,l=s(3);r(2),g(l.formatDateTime(e.recordedAt)),r(2),g(l.formatCurrency(e.amount)),r(3),g(e.method),r(2),g(e.reference),r(2),g(e.notes||"-")}}function Ye(n,o){if(n&1&&(t(0,"div",29)(1,"h2"),a(2,"Payment History"),i(),t(3,"table",60)(4,"thead")(5,"tr")(6,"th"),a(7,"Date"),i(),t(8,"th"),a(9,"Amount"),i(),t(10,"th"),a(11,"Method"),i(),t(12,"th"),a(13,"Reference"),i(),t(14,"th"),a(15,"Notes"),i()()(),t(16,"tbody"),b(17,Ue,12,5,"tr",null,E),i()()()),n&2){let e=s(2);r(17),y(e.payments())}}function He(n,o){n&1&&(t(0,"span",66),a(1,"Promoted"),i())}function Ge(n,o){if(n&1){let e=v();t(0,"button",69),x("click",function(){u(e);let d=s().$implicit,p=s(3);return _(p.openPromoteWaitlistDialog(d.sessionId))}),a(1," Promote Entry "),i()}}function Je(n,o){if(n&1&&(t(0,"div",64)(1,"div",65)(2,"span",42),a(3),i(),c(4,He,2,0,"span",66),i(),t(5,"div",67)(6,"div",45)(7,"span",19),a(8,"Joined:"),i(),t(9,"span",21),a(10),i()()(),c(11,Ge,2,0,"button",68),i()),n&2){let e=o.$implicit,l=s(3);r(3),g(l.getClassName(e.sessionId)),r(),m(e.isPromoted?4:-1),r(6),g(l.formatDateTime(e.joinedAt)),r(),m(e.isPromoted?-1:11)}}function Ze(n,o){if(n&1&&(t(0,"div",30)(1,"h2"),a(2,"Waitlist Entries"),i(),t(3,"div",63),b(4,Je,12,4,"div",64,fe),i()()),n&2){let e=s(2);r(4),y(e.waitlistEntries())}}function Ke(n,o){if(n&1&&(t(0,"div",78),a(1),i()),n&2){let e=o.$implicit,l=s(4);r(),f(" ",l.getActionDescription(e)," ")}}function Qe(n,o){if(n&1&&(t(0,"div",80)(1,"span",19),a(2,"Reason:"),i(),t(3,"span",21),a(4),i()()),n&2){let e=s().$implicit;r(4),g(e.reason)}}function Xe(n,o){if(n&1&&(t(0,"div",80)(1,"span",19),a(2,"Admin Adjustment:"),i(),t(3,"span",34),a(4),i()()),n&2){let e=s().$implicit,l=s(3);r(3),C("ngClass",e.adminAdjustment<0?"text-success":"text-danger"),r(),A(" ",e.adminAdjustment<0?"-":"+","",l.formatCurrency(l.Math.abs(e.adminAdjustment))," ")}}function et(n,o){if(n&1&&(t(0,"div",80)(1,"span",19),a(2,"Adjustment Reason:"),i(),t(3,"span",21),a(4),i()()),n&2){let e=s().$implicit;r(4),g(e.adminAdjustmentReason)}}function tt(n,o){if(n&1&&(t(0,"div",80)(1,"span",19),a(2,"Processed:"),i(),t(3,"span",21),a(4),i()()),n&2){let e=s().$implicit,l=s(3);r(4),g(l.formatDateTime(e.processedAt))}}function nt(n,o){if(n&1&&(t(0,"div",80)(1,"span",19),a(2,"Admin Notes:"),i(),t(3,"span",21),a(4),i()()),n&2){let e=s().$implicit;r(4),g(e.adminNotes)}}function it(n,o){if(n&1){let e=v();t(0,"button",82),x("click",function(){u(e);let d=s().$implicit,p=s(3);return _(p.openUpdateAdjustmentDialog(d))}),a(1," Edit Adjustment "),i(),t(2,"button",83),x("click",function(){u(e);let d=s().$implicit,p=s(3);return _(p.openApproveChangeDialog(d))}),a(3," Approve "),i(),t(4,"button",36),x("click",function(){u(e);let d=s().$implicit,p=s(3);return _(p.openDenyChangeDialog(d))}),a(5," Deny "),i()}}function ot(n,o){if(n&1&&(t(0,"div",71)(1,"div",72)(2,"div",73)(3,"span",74),a(4),i(),t(5,"span",75),a(6),i()()(),t(7,"div",76)(8,"div",77)(9,"strong"),a(10,"Actions:"),i(),b(11,Ke,2,1,"div",78,E),i(),t(13,"div",79)(14,"div",80)(15,"span",19),a(16,"Requested:"),i(),t(17,"span",21),a(18),i()(),c(19,Qe,5,1,"div",80),c(20,Xe,5,3,"div",80),c(21,et,5,1,"div",80),c(22,tt,5,1,"div",80),c(23,nt,5,1,"div",80),i()(),t(24,"div",81),c(25,it,6,0),i()()),n&2){let e=o.$implicit,l=s(3);C("ngClass","status-"+e.status),r(4),g(e.id),r(),C("ngClass","status-"+e.status),r(),f(" ",l.getChangeStatusLabel(e.status)," "),r(5),y(e.actions),r(7),g(l.formatDateTime(e.requestedAt)),r(),m(e.reason?19:-1),r(),m(e.adminAdjustment!==0?20:-1),r(),m(e.adminAdjustmentReason?21:-1),r(),m(e.processedAt?22:-1),r(),m(e.adminNotes?23:-1),r(2),m(e.status==="pending"?25:-1)}}function at(n,o){if(n&1&&(t(0,"div",31)(1,"h2"),a(2,"Change Requests"),i(),t(3,"div",70),b(4,ot,26,11,"div",71,he),i()()),n&2){let e=s(2);r(4),y(e.changeRequests())}}function rt(n,o){if(n&1&&(t(0,"div",89),a(1),i()),n&2){let e=s().$implicit;r(),g(e.details)}}function dt(n,o){if(n&1&&(t(0,"div",85)(1,"div",86),a(2),i(),t(3,"div",87)(4,"div",88),a(5),i(),c(6,rt,2,1,"div",89),i()()),n&2){let e=o.$implicit,l=s(3);r(2),g(l.formatDateTime(e.timestamp)),r(3),g(e.action),r(),m(e.details?6:-1)}}function lt(n,o){if(n&1&&(t(0,"div",32)(1,"h2"),a(2,"Order History"),i(),t(3,"div",84),b(4,dt,7,3,"div",85,E),i()()),n&2){let e=s(2);r(4),y(e.order().history)}}function st(n,o){if(n&1){let e=v();t(0,"div",3)(1,"div",7)(2,"div",8)(3,"a",9),a(4,"\u2190 Back to Orders"),i(),t(5,"h1"),a(6,"Order Details"),i(),t(7,"div",10)(8,"span",11),a(9),i(),t(10,"span",12),a(11),i()()(),t(12,"div",13)(13,"button",14),x("click",function(){u(e);let d=s();return _(d.openRecordPaymentDialog())}),a(14," Record Payment "),i()()(),c(15,Se,16,4,"div",15),t(16,"div",16)(17,"h2"),a(18,"Order Status"),i(),t(19,"div",17)(20,"div",18)(21,"span",19),a(22,"Status:"),i(),t(23,"span",20),a(24),i()(),c(25,Me,6,6,"div",18),t(26,"div",18)(27,"span",19),a(28,"Created:"),i(),t(29,"span",21),a(30),i()(),t(31,"div",18)(32,"span",19),a(33,"Last Updated:"),i(),t(34,"span",21),a(35),i()()(),c(36,Pe,4,0,"div",22),i(),t(37,"div",23)(38,"div",24)(39,"h2"),a(40,"Order Items"),i(),c(41,De,2,0,"button",25),i(),c(42,Te,8,1,"div",26),c(43,Le,8,1,"div",26),c(44,Fe,8,1,"div",26),c(45,We,3,0,"div",27),i(),c(46,$e,25,9,"div",28),c(47,Ye,19,0,"div",29),c(48,Ze,6,0,"div",30),c(49,at,6,0,"div",31),c(50,lt,6,0,"div",32),i()}if(n&2){let e=s();r(9),f("User: ",e.order().userDisplayId),r(),C("ngClass",e.getStatusBadgeClass(e.getOrderStatus(e.order()))),r(),f(" ",e.getStatusLabel(e.getOrderStatus(e.order()))," "),r(2),C("disabled",!e.canRecordPayment()),r(2),m(e.userData()?15:-1),r(8),C("ngClass",e.getStatusBadgeClass(e.getOrderStatus(e.order()))),r(),f(" ",e.getStatusLabel(e.getOrderStatus(e.order()))," "),r(),m(e.order().lockExpiresAt?25:-1),r(5),g(e.formatDateTime(e.order().createdAt)),r(5),g(e.formatDateTime(e.order().updatedAt)),r(),m(e.isOverdue()?36:-1),r(5),m(e.cancellableItems().length>0?41:-1),r(),m(e.paidItems().length>0?42:-1),r(),m(e.submittedItems().length>0?43:-1),r(),m(e.cancelledItems().length>0?44:-1),r(),m(e.allItems().length===0?45:-1),r(),m(e.order().pricing?46:-1),r(),m(e.payments().length>0?47:-1),r(),m(e.waitlistEntries().length>0?48:-1),r(),m(e.changeRequests().length>0?49:-1),r(),m(e.order().history&&e.order().history.length>0?50:-1)}}function ct(n,o){if(n&1&&(t(0,"div",22),a(1),i()),n&2){let e=s(2);r(),g(e.actionError())}}function mt(n,o){n&1&&(M(0,"span",112),a(1," Recording... "))}function pt(n,o){n&1&&a(0," Record Payment ")}function ut(n,o){if(n&1){let e=v();t(0,"div",90),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),t(1,"div",91),x("click",function(d){return u(e),_(d.stopPropagation())}),t(2,"div",92)(3,"h3"),a(4,"Record Payment"),i(),t(5,"button",6),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",93)(8,"form",94),x("ngSubmit",function(){u(e);let d=s();return _(d.recordPayment())}),t(9,"div",95)(10,"label",96),a(11,"Amount *"),i(),t(12,"input",97),w("ngModelChange",function(d){u(e);let p=s();return S(p.formPayment.amountInput,d)||(p.formPayment.amountInput=d),_(d)}),i(),t(13,"small",98),a(14),i()(),t(15,"div",95)(16,"label",99),a(17,"Payment Method *"),i(),t(18,"select",100),w("ngModelChange",function(d){u(e);let p=s();return S(p.formPayment.method,d)||(p.formPayment.method=d),_(d)}),t(19,"option",101),a(20,"Zelle"),i(),t(21,"option",102),a(22,"Check"),i(),t(23,"option",103),a(24,"Cash"),i(),t(25,"option",104),a(26,"Other"),i()()(),t(27,"div",95)(28,"label",105),a(29,"Reference *"),i(),t(30,"input",106),w("ngModelChange",function(d){u(e);let p=s();return S(p.formPayment.reference,d)||(p.formPayment.reference=d),_(d)}),i()(),t(31,"div",95)(32,"label",107),a(33,"Notes"),i(),t(34,"textarea",108),w("ngModelChange",function(d){u(e);let p=s();return S(p.formPayment.notes,d)||(p.formPayment.notes=d),_(d)}),i()(),c(35,ct,2,1,"div",22),t(36,"div",109)(37,"button",110),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(38," Cancel "),i(),t(39,"button",111),c(40,mt,2,0)(41,pt,1,0),i()()()()()()}if(n&2){let e=s();r(12),O("ngModel",e.formPayment.amountInput),r(2),f(" Amount due: ",e.formatCurrency(e.amountDue())," "),r(4),O("ngModel",e.formPayment.method),r(12),O("ngModel",e.formPayment.reference),r(4),O("ngModel",e.formPayment.notes),r(),m(e.actionError()?35:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),m(e.actionLoading()?40:41)}}function _t(n,o){if(n&1){let e=v();t(0,"label",114)(1,"input",119),x("change",function(){let d=u(e).$implicit,p=s(2);return _(p.toggleItemSelection(d))}),i(),t(2,"span",120)(3,"span",42),a(4),i(),a(5," - "),t(6,"span",121),a(7),i(),t(8,"span",43),a(9),i()()()}if(n&2){let e=o.$implicit,l=s(2);r(),C("checked",l.isItemSelected(e)),r(3),g(l.getClassName(e.sessionId)),r(3),g(l.getStudentName(e.studentId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," ")}}function gt(n,o){if(n&1&&(t(0,"div",22),a(1),i()),n&2){let e=s(2);r(),g(e.actionError())}}function xt(n,o){n&1&&(M(0,"span",112),a(1," Cancelling... "))}function Ct(n,o){if(n&1&&a(0),n&2){let e=s(2);f(" Cancel ",e.selectedItems().size," Item(s) ")}}function ft(n,o){if(n&1){let e=v();t(0,"div",90),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),t(1,"div",91),x("click",function(d){return u(e),_(d.stopPropagation())}),t(2,"div",92)(3,"h3"),a(4,"Cancel Order Items"),i(),t(5,"button",6),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",93)(8,"form",94),x("ngSubmit",function(){u(e);let d=s();return _(d.cancelItems())}),t(9,"div",95)(10,"label"),a(11,"Select items to cancel:"),i(),t(12,"div",113),b(13,_t,10,5,"label",114,I),i()(),t(15,"div",95)(16,"label",115),a(17,"Cancellation Reason *"),i(),t(18,"textarea",116),w("ngModelChange",function(d){u(e);let p=s();return S(p.formCancel.reason,d)||(p.formCancel.reason=d),_(d)}),i()(),t(19,"div",117)(20,"strong"),a(21,"Refund Policy:"),i(),a(22),i(),c(23,gt,2,1,"div",22),t(24,"div",109)(25,"button",110),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(26," Cancel "),i(),t(27,"button",118),c(28,xt,2,0)(29,Ct,1,1),i()()()()()()}if(n&2){let e=s();r(13),y(e.cancellableItems()),r(5),O("ngModel",e.formCancel.reason),r(4),f(" Cancelling paid items may incur a refund processing fee of ",e.formatCurrency(e.refundFee()),". "),r(),m(e.actionError()?23:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()||e.selectedItems().size===0),r(),m(e.actionLoading()?28:29)}}function ht(n,o){if(n&1&&(t(0,"div",22),a(1),i()),n&2){let e=s(2);r(),g(e.actionError())}}function vt(n,o){n&1&&(M(0,"span",112),a(1," Promoting... "))}function bt(n,o){n&1&&a(0," Promote Entry ")}function yt(n,o){if(n&1){let e=v();t(0,"div",90),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),t(1,"div",91),x("click",function(d){return u(e),_(d.stopPropagation())}),t(2,"div",92)(3,"h3"),a(4,"Promote Waitlist Entry"),i(),t(5,"button",6),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",93)(8,"form",94),x("ngSubmit",function(){u(e);let d=s();return _(d.promoteWaitlist())}),t(9,"div",95)(10,"label"),a(11,"Class:"),i(),t(12,"div",122),a(13),i()(),t(14,"div",95)(15,"label",123),a(16,"Notes"),i(),t(17,"textarea",124),w("ngModelChange",function(d){u(e);let p=s();return S(p.formPromoteWaitlist.notes,d)||(p.formPromoteWaitlist.notes=d),_(d)}),i()(),t(18,"div",125),a(19," This will bypass the waitlist maturity rule and allow the user to immediately claim a spot if a vacancy becomes available. "),i(),c(20,ht,2,1,"div",22),t(21,"div",109)(22,"button",110),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(23," Cancel "),i(),t(24,"button",111),c(25,vt,2,0)(26,bt,1,0),i()()()()()()}if(n&2){let e=s();r(13),f(" ",e.getClassName(e.formPromoteWaitlist.sessionId)," "),r(4),O("ngModel",e.formPromoteWaitlist.notes),r(3),m(e.actionError()?20:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),m(e.actionLoading()?25:26)}}function Ot(n,o){if(n&1&&(t(0,"div",22),a(1),i()),n&2){let e=s(2);r(),g(e.actionError())}}function St(n,o){n&1&&(M(0,"span",112),a(1," Saving... "))}function wt(n,o){n&1&&a(0," Save Adjustment ")}function Mt(n,o){if(n&1){let e=v();t(0,"div",90),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),t(1,"div",91),x("click",function(d){return u(e),_(d.stopPropagation())}),t(2,"div",92)(3,"h3"),a(4,"Update Adjustment"),i(),t(5,"button",6),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",93)(8,"form",94),x("ngSubmit",function(){u(e);let d=s();return _(d.updateAdjustment())}),t(9,"div",95)(10,"label"),a(11,"Request ID:"),i(),t(12,"div",122),a(13),i()(),t(14,"div",95)(15,"label",126),a(16,"Extra Fee (+) or Credit (-)"),i(),t(17,"input",127),w("ngModelChange",function(d){u(e);let p=s();return S(p.formChangeRequest.adjustmentInput,d)||(p.formChangeRequest.adjustmentInput=d),_(d)}),i(),t(18,"small",98),a(19,"Positive values add a fee, negative values give a credit"),i()(),t(20,"div",95)(21,"label",128),a(22,"Reason"),i(),t(23,"textarea",129),w("ngModelChange",function(d){u(e);let p=s();return S(p.formChangeRequest.adjustmentReason,d)||(p.formChangeRequest.adjustmentReason=d),_(d)}),i()(),t(24,"div",95)(25,"label",130),a(26,"Admin Notes"),i(),t(27,"textarea",131),w("ngModelChange",function(d){u(e);let p=s();return S(p.formChangeRequest.adminNotes,d)||(p.formChangeRequest.adminNotes=d),_(d)}),i()(),t(28,"div",125),a(29," The user will see this adjustment. You can update it multiple times before approving. "),i(),c(30,Ot,2,1,"div",22),t(31,"div",109)(32,"button",110),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(33," Cancel "),i(),t(34,"button",111),c(35,St,2,0)(36,wt,1,0),i()()()()()()}if(n&2){let e=s();r(13),g(e.formChangeRequest.requestId),r(4),O("ngModel",e.formChangeRequest.adjustmentInput),r(6),O("ngModel",e.formChangeRequest.adjustmentReason),r(4),O("ngModel",e.formChangeRequest.adminNotes),r(3),m(e.actionError()?30:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),m(e.actionLoading()?35:36)}}function Pt(n,o){if(n&1&&(t(0,"div",133),a(1),i()),n&2){let e=o.$implicit,l=s(2);r(),g(l.getActionDescription(e))}}function Dt(n,o){if(n&1&&(t(0,"div",22),a(1),i()),n&2){let e=s(2);r(),g(e.actionError())}}function Et(n,o){n&1&&(M(0,"span",112),a(1," Approving... "))}function It(n,o){n&1&&a(0," Approve Changes ")}function At(n,o){if(n&1){let e=v();t(0,"div",90),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),t(1,"div",91),x("click",function(d){return u(e),_(d.stopPropagation())}),t(2,"div",92)(3,"h3"),a(4,"Approve Change Request"),i(),t(5,"button",6),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",93)(8,"form",94),x("ngSubmit",function(){u(e);let d=s();return _(d.approveChange())}),t(9,"div",95)(10,"label"),a(11,"Request ID:"),i(),t(12,"div",122),a(13),i()(),t(14,"div",95)(15,"label"),a(16,"Actions to apply:"),i(),t(17,"div",132),b(18,Pt,2,1,"div",133,E),i()(),t(20,"div",95)(21,"label",134),a(22,"Admin Notes"),i(),t(23,"textarea",135),w("ngModelChange",function(d){u(e);let p=s();return S(p.formChangeRequest.adminNotes,d)||(p.formChangeRequest.adminNotes=d),_(d)}),i()(),t(24,"div",117),a(25," Approving will apply all changes to the order. Class removals will create vacancy holds for waitlist members. The order pricing will be recalculated. "),i(),c(26,Dt,2,1,"div",22),t(27,"div",109)(28,"button",110),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(29," Cancel "),i(),t(30,"button",111),c(31,Et,2,0)(32,It,1,0),i()()()()()()}if(n&2){let e=s();r(13),g(e.formChangeRequest.requestId),r(5),y(e.formChangeRequest.actions),r(5),O("ngModel",e.formChangeRequest.adminNotes),r(3),m(e.actionError()?26:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),m(e.actionLoading()?31:32)}}function kt(n,o){if(n&1&&(t(0,"div",22),a(1),i()),n&2){let e=s(2);r(),g(e.actionError())}}function Tt(n,o){n&1&&(M(0,"span",112),a(1," Denying... "))}function qt(n,o){n&1&&a(0," Deny Request ")}function Rt(n,o){if(n&1){let e=v();t(0,"div",90),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),t(1,"div",91),x("click",function(d){return u(e),_(d.stopPropagation())}),t(2,"div",92)(3,"h3"),a(4,"Deny Change Request"),i(),t(5,"button",6),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(6,"\xD7"),i()(),t(7,"div",93)(8,"form",94),x("ngSubmit",function(){u(e);let d=s();return _(d.denyChange())}),t(9,"div",95)(10,"label"),a(11,"Request ID:"),i(),t(12,"div",122),a(13),i()(),t(14,"div",95)(15,"label",136),a(16,"Reason for Denial *"),i(),t(17,"textarea",137),w("ngModelChange",function(d){u(e);let p=s();return S(p.formChangeRequest.adminNotes,d)||(p.formChangeRequest.adminNotes=d),_(d)}),i()(),t(18,"div",125),a(19," The user will be notified that their change request was denied. No changes will be applied to their order. "),i(),c(20,kt,2,1,"div",22),t(21,"div",109)(22,"button",110),x("click",function(){u(e);let d=s();return _(d.closeDialog())}),a(23," Cancel "),i(),t(24,"button",118),c(25,Tt,2,0)(26,qt,1,0),i()()()()()()}if(n&2){let e=s();r(13),g(e.formChangeRequest.requestId),r(4),O("ngModel",e.formChangeRequest.adminNotes),r(3),m(e.actionError()?20:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()||!e.formChangeRequest.adminNotes.trim()),r(),m(e.actionLoading()?25:26)}}var ue=class n{orderId=V.required();adminOrdersStore=P(ae);orderRpc=P($);userService=P(H);seasonService=P(Y);configService=P(U);router=P(j);order=D(null);loading=D(!1);error=D(null);userData=D(null);actionLoading=this.orderRpc.loading;actionError=this.orderRpc.error;dialogMode=D(null);formPayment={amountInput:"",method:"zelle",reference:"",notes:""};formCancel={reason:""};selectedItems=D(new Set);formPromoteWaitlist={sessionId:"",notes:""};formChangeRequest={requestId:"",actions:[],adjustmentInput:"",adjustmentReason:"",adminNotes:""};Math=Math;allItems=h(()=>this.order()?.items??[]);paidItems=h(()=>{let o=this.order();return o?z(o):[]});submittedItems=h(()=>{let o=this.order();return o?W(o):[]});cancelledItems=h(()=>this.allItems().filter(o=>o.status==="cancelled"));cancellableItems=h(()=>[...this.paidItems(),...this.submittedItems()]);waitlistEntries=h(()=>this.order()?.waitlist??[]);payments=h(()=>this.order()?.payments??[]);changeRequests=h(()=>this.order()?.changeRequests??[]);totalDue=h(()=>{let o=this.order()?.pricing;return o?o.subtotal+o.discounts.reduce((e,l)=>e+l.amount,0):0});amountDue=h(()=>{let o=this.order();return o?this.totalDue()-o.totalPaid:0});refundFee=h(()=>this.seasonService.selectedSeason()?.refundProcessingFee??2e3);isOverdue=h(()=>{let o=this.order();if(!o||!o.lockExpiresAt)return!1;let e=this.configService.currentTime();return new Date(o.lockExpiresAt)<new Date(e)});isExpiringSoon=h(()=>{let o=this.order();if(!o||!o.lockExpiresAt)return!1;let e=this.configService.currentTime(),l=new Date(o.lockExpiresAt),d=new Date(e),p=(l.getTime()-d.getTime())/(1e3*60*60);return p>0&&p<=12});remainingLockTime=h(()=>{let o=this.order();if(!o||!o.lockExpiresAt)return null;let e=this.configService.currentTime(),l=new Date(o.lockExpiresAt),d=new Date(e),p=l.getTime()-d.getTime();if(p<=0)return null;let _e=Math.floor(p/(1e3*60*60)),ge=Math.floor(p%(1e3*60*60)/(1e3*60));return{hours:_e,minutes:ge}});canRecordPayment=h(()=>this.amountDue()>0);formatCurrency=ce;formatDate=me;formatDateTime=pe;getOrderStatus=B;getStatusBadgeClass=re;getStatusLabel=de;getItemStatusBadgeClass=le;getItemStatusLabel=se;async ngOnInit(){if(!this.userService.isAuthenticated()){await this.router.navigate(["/login"]);return}await this.loadOrder()}async loadOrder(){this.loading.set(!0),this.error.set(null);try{let o=await this.adminOrdersStore.getOrder(this.orderId());this.order.set(o),await this.loadUserData(o.userDisplayId)}catch(o){let e=o instanceof Error?o.message:String(o);this.error.set(e)}finally{this.loading.set(!1)}}async loadUserData(o){try{let e=await this.userService.getUserDetails(o);this.userData.set({displayName:e.displayName,email:e.email,phone:e.contactInfo?.phone,address:e.contactInfo?.address?`${e.contactInfo.address.street}, ${e.contactInfo.address.city}, ${e.contactInfo.address.state} ${e.contactInfo.address.zipCode}`:void 0})}catch(e){console.error("Failed to load user data:",e)}}getClassName(o){return this.seasonService.classes().find(l=>l.id===o)?.name??o}getStudentName(o){return this.userData()?o:"Unknown Student"}openRecordPaymentDialog(){this.formPayment.amountInput=q(this.amountDue()),this.formPayment.method="zelle",this.formPayment.reference="",this.formPayment.notes="",this.dialogMode.set("record-payment")}openCancelItemsDialog(){this.selectedItems.set(new Set),this.formCancel.reason="",this.dialogMode.set("cancel-items")}openPromoteWaitlistDialog(o){this.formPromoteWaitlist.sessionId=o,this.formPromoteWaitlist.notes="",this.dialogMode.set("promote-waitlist")}closeDialog(){this.dialogMode.set(null),this.orderRpc.clearError()}isItemSelected(o){let e=`${o.sessionId}-${o.studentId}`;return this.selectedItems().has(e)}toggleItemSelection(o){let e=`${o.sessionId}-${o.studentId}`,l=new Set(this.selectedItems());l.has(e)?l.delete(e):l.add(e),this.selectedItems.set(l)}async recordPayment(){let o=this.order();if(!o)return;let e=T(this.formPayment.amountInput);if(e<=0){alert("Please enter a valid payment amount.");return}try{await this.orderRpc.recordPayment({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,amount:e,reference:this.formPayment.reference,method:this.formPayment.method,notes:this.formPayment.notes||void 0}),await this.loadOrder(),this.closeDialog()}catch(l){console.error("Failed to record payment:",l)}}async cancelItems(){if(this.order()){if(this.selectedItems().size===0){alert("Please select at least one item to cancel.");return}if(!this.formCancel.reason.trim()){alert("Please enter a cancellation reason.");return}try{let e=Array.from(this.selectedItems()).map(l=>{let[d,p]=l.split("-");return{sessionId:d,studentId:p}});await this.orderRpc.cancelItems({year:this.configService.currentActiveYear(),items:e,reason:this.formCancel.reason}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to cancel items:",e)}}}async promoteWaitlist(){let o=this.order();if(o)try{await this.orderRpc.promoteWaitlistEntry({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,sessionId:this.formPromoteWaitlist.sessionId,notes:this.formPromoteWaitlist.notes||void 0}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to promote waitlist entry:",e)}}getChangeStatusLabel(o){switch(o){case"pending":return"Pending";case"approved":return"Approved";case"denied":return"Denied";default:return o}}getActionDescription(o){let e=this.getClassName(o.target.sessionId),l=this.getStudentName(o.target.studentId);switch(o.type){case"remove_class":return`Remove from class: ${e} - ${l}`;case"add_addon":return`Add ${o.addon==="lunch"?"Lunch":"Extended Care"}: ${e} - ${l}`;case"remove_addon":return`Remove ${o.addon==="lunch"?"Lunch":"Extended Care"}: ${e} - ${l}`}}openUpdateAdjustmentDialog(o){this.formChangeRequest.requestId=o.id,this.formChangeRequest.actions=[...o.actions],this.formChangeRequest.adjustmentInput=o.adminAdjustment!==0?q(o.adminAdjustment):"",this.formChangeRequest.adjustmentReason=o.adminAdjustmentReason??"",this.formChangeRequest.adminNotes=o.adminNotes??"",this.dialogMode.set("update-adjustment")}openApproveChangeDialog(o){this.formChangeRequest.requestId=o.id,this.formChangeRequest.actions=[...o.actions],this.formChangeRequest.adminNotes=o.adminNotes??"",this.dialogMode.set("approve-change")}openDenyChangeDialog(o){this.formChangeRequest.requestId=o.id,this.formChangeRequest.actions=[...o.actions],this.formChangeRequest.adminNotes="",this.dialogMode.set("deny-change")}async updateAdjustment(){let o=this.order();if(o)try{let e=this.formChangeRequest.adjustmentInput.trim()?T(this.formChangeRequest.adjustmentInput):0;await this.orderRpc.updateChangeRequest({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminAdjustment:e,adminAdjustmentReason:this.formChangeRequest.adjustmentReason||void 0,adminNotes:this.formChangeRequest.adminNotes||void 0}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to update adjustment:",e)}}async approveChange(){let o=this.order();if(o)try{await this.orderRpc.approveChangeRequest({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminNotes:this.formChangeRequest.adminNotes||void 0}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to approve change request:",e)}}async denyChange(){let o=this.order();if(o&&this.formChangeRequest.adminNotes.trim())try{await this.orderRpc.denyChangeRequest({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminNotes:this.formChangeRequest.adminNotes}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to deny change request:",e)}}clearError(){this.error.set(null)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=R({type:n,selectors:[["app-admin-order-detail"]],inputs:{orderId:[1,"orderId"]},decls:10,vars:9,consts:[[1,"admin-order-detail-container"],[1,"loading-state"],[1,"error-banner"],[1,"order-content"],[1,"modal-overlay"],[1,"spinner"],["type","button",1,"btn-close",3,"click"],[1,"order-header"],[1,"header-left"],["routerLink","/admin/orders",1,"back-link"],[1,"order-meta"],[1,"user-id"],[1,"status-badge",3,"ngClass"],[1,"header-actions"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"info-card","user-info-card"],[1,"info-card","status-card"],[1,"status-details"],[1,"detail-row"],[1,"label"],[1,"value","status-badge",3,"ngClass"],[1,"value"],[1,"alert","alert-danger"],[1,"info-card","items-card"],[1,"card-header"],["type","button",1,"btn","btn-danger-outline","btn-sm"],[1,"items-section"],[1,"empty-state"],[1,"info-card","pricing-card"],[1,"info-card","payments-card"],[1,"info-card","waitlist-card"],[1,"info-card","change-requests-card"],[1,"info-card","history-card"],[1,"user-details"],[1,"value",3,"ngClass"],[1,"remaining-time"],["type","button",1,"btn","btn-danger-outline","btn-sm",3,"click"],[1,"section-title"],[1,"item-count"],[1,"items-list"],[1,"item-card"],[1,"item-header"],[1,"class-name"],[1,"item-status-badge",3,"ngClass"],[1,"item-details"],[1,"detail-item"],[1,"option-badge"],[1,"text-muted"],[1,"item-card","pending"],[1,"item-card","cancelled"],[1,"pricing-details"],[1,"pricing-row"],[1,"discounts-section"],[1,"pricing-row","total-row"],[1,"value","total"],[1,"pricing-row","balance-row",3,"ngClass"],[1,"value","balance"],[1,"discounts-header"],[1,"pricing-row","discount-row"],[1,"value","text-success"],[1,"payments-table"],[1,"amount"],[1,"method-badge"],[1,"waitlist-list"],[1,"waitlist-item"],[1,"waitlist-header"],[1,"promoted-badge"],[1,"waitlist-details"],["type","button",1,"btn","btn-primary-outline","btn-sm"],["type","button",1,"btn","btn-primary-outline","btn-sm",3,"click"],[1,"change-requests-list"],[1,"change-request-item",3,"ngClass"],[1,"request-header"],[1,"request-info"],[1,"request-id"],[1,"request-status-badge",3,"ngClass"],[1,"request-details"],[1,"request-actions-list"],[1,"request-action-row"],[1,"request-meta"],[1,"meta-item"],[1,"request-actions"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"history-timeline"],[1,"history-event"],[1,"event-time"],[1,"event-details"],[1,"event-action"],[1,"event-metadata"],[1,"modal-overlay",3,"click"],[1,"modal-dialog",3,"click"],[1,"modal-header"],[1,"modal-body"],[3,"ngSubmit"],[1,"form-group"],["for","payment-amount"],["type","text","id","payment-amount","name","amount","placeholder","0.00","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text"],["for","payment-method"],["id","payment-method","name","method","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","zelle"],["value","check"],["value","cash"],["value","other"],["for","payment-reference"],["type","text","id","payment-reference","name","reference","placeholder","Confirmation number, check number, etc.","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","payment-notes"],["id","payment-notes","name","notes","rows","3","placeholder","Optional notes...",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"spinner-small"],[1,"items-checklist"],[1,"checkbox-item"],["for","cancel-reason"],["id","cancel-reason","name","reason","rows","3","placeholder","Enter reason for cancellation...","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-warning"],["type","submit",1,"btn","btn-danger",3,"disabled"],["type","checkbox",3,"change","checked"],[1,"item-info"],[1,"student-name"],[1,"read-only-value"],["for","promote-notes"],["id","promote-notes","name","notes","rows","3","placeholder","Optional notes for promotion reason...",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-info"],["for","adjustment-amount"],["type","text","id","adjustment-amount","name","adjustment","placeholder","0.00 (positive = fee, negative = credit)",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-reason"],["id","adjustment-reason","name","adjustmentReason","rows","2","placeholder","Explain the adjustment...",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-notes"],["id","adjustment-notes","name","notes","rows","2","placeholder","Optional notes (visible to user)...",1,"form-control",3,"ngModelChange","ngModel"],[1,"items-list-readonly"],[1,"item-row"],["for","approve-notes"],["id","approve-notes","name","notes","rows","3","placeholder","Optional notes...",1,"form-control",3,"ngModelChange","ngModel"],["for","deny-notes"],["id","deny-notes","name","notes","rows","3","placeholder","Please provide a reason for denying this request...","required","",1,"form-control",3,"ngModelChange","ngModel"]],template:function(e,l){e&1&&(t(0,"div",0),c(1,ve,4,0,"div",1),c(2,be,6,1,"div",2),c(3,st,51,21,"div",3),c(4,ut,42,9,"div",4),c(5,ft,30,6,"div",4),c(6,yt,27,6,"div",4),c(7,Mt,37,8,"div",4),c(8,At,33,6,"div",4),c(9,Rt,27,6,"div",4),i()),e&2&&(r(),m(l.loading()?1:-1),r(),m(l.error()&&!l.loading()?2:-1),r(),m(l.order()&&!l.loading()?3:-1),r(),m(l.dialogMode()==="record-payment"?4:-1),r(),m(l.dialogMode()==="cancel-items"?5:-1),r(),m(l.dialogMode()==="promote-waitlist"?6:-1),r(),m(l.dialogMode()==="update-adjustment"?7:-1),r(),m(l.dialogMode()==="approve-change"?8:-1),r(),m(l.dialogMode()==="deny-change"?9:-1))},dependencies:[L,N,oe,X,te,ne,G,ee,J,Z,ie,Q,K,F],styles:[".admin-order-detail-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #3498db;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-banner[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:15px;border-radius:4px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.btn-close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:24px;cursor:pointer;color:inherit}.order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:30px;padding-bottom:20px;border-bottom:2px solid #e0e0e0}.header-left[_ngcontent-%COMP%]{flex:1}.back-link[_ngcontent-%COMP%]{color:#3498db;text-decoration:none;margin-bottom:10px;display:inline-block}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.order-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:10px 0;font-size:28px}.order-meta[_ngcontent-%COMP%]{display:flex;gap:15px;align-items:center;margin-top:10px}.user-id[_ngcontent-%COMP%]{color:#666;font-size:14px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.info-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:20px;margin-bottom:20px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 20px;font-size:20px;color:#333}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.user-details[_ngcontent-%COMP%], .status-details[_ngcontent-%COMP%], .pricing-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:4px;font-size:12px;font-weight:600;text-transform:uppercase;display:inline-block}.status-submitted[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-paid[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-cancelled[_ngcontent-%COMP%], .status-refunded[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.status-partial[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status-empty[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.text-warning[_ngcontent-%COMP%]{color:#ffc107!important}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.remaining-time[_ngcontent-%COMP%]{font-size:12px;color:#666}.alert[_ngcontent-%COMP%]{padding:12px 16px;border-radius:4px;margin-top:15px}.alert-danger[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.alert-warning[_ngcontent-%COMP%]{background:#fff3cd;color:#856404;border:1px solid #ffeaa7}.alert-info[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460;border:1px solid #bee5eb}.items-section[_ngcontent-%COMP%]{margin-bottom:30px}.items-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:15px;color:#333}.item-count[_ngcontent-%COMP%]{color:#666;font-weight:400;font-size:14px}.items-list[_ngcontent-%COMP%]{display:grid;gap:12px}.item-card[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dee2e6;border-radius:6px;padding:15px}.item-card.pending[_ngcontent-%COMP%]{background:#fff3cd;border-color:#ffeaa7}.item-card.cancelled[_ngcontent-%COMP%]{background:#f8d7da;border-color:#f5c6cb;opacity:.7}.item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.class-name[_ngcontent-%COMP%]{font-weight:600;color:#333}.item-status-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:3px;font-size:11px;font-weight:600;text-transform:uppercase}.item-status-submitted[_ngcontent-%COMP%]{background:#ffc107;color:#000}.item-status-paid[_ngcontent-%COMP%]{background:#28a745;color:#fff}.item-status-cancelled[_ngcontent-%COMP%], .item-status-refunded[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.item-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.detail-item[_ngcontent-%COMP%]{display:flex;gap:8px;font-size:14px}.detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.option-badge[_ngcontent-%COMP%]{background:#007bff;color:#fff;padding:2px 8px;border-radius:3px;font-size:11px;margin-right:4px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#666}.pricing-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0}.pricing-row.total-row[_ngcontent-%COMP%]{border-top:2px solid #dee2e6;padding-top:12px;margin-top:8px;font-size:18px;font-weight:600}.pricing-row.balance-row[_ngcontent-%COMP%]{border-top:2px solid #dee2e6;padding-top:12px;margin-top:8px;font-size:18px;font-weight:700}.discounts-section[_ngcontent-%COMP%]{background:#f8f9fa;padding:12px;border-radius:4px;margin:8px 0}.discounts-header[_ngcontent-%COMP%]{font-weight:600;margin-bottom:8px;color:#666}.discount-row[_ngcontent-%COMP%]{padding:4px 0}.payments-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.payments-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:12px;background:#f8f9fa;border-bottom:2px solid #dee2e6;font-weight:600}.payments-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #dee2e6}.payments-table[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600}.method-badge[_ngcontent-%COMP%]{background:#6c757d;color:#fff;padding:4px 8px;border-radius:3px;font-size:12px;text-transform:uppercase}.waitlist-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.waitlist-item[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dee2e6;border-radius:6px;padding:15px}.waitlist-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.promoted-badge[_ngcontent-%COMP%]{background:#28a745;color:#fff;padding:4px 8px;border-radius:3px;font-size:12px;font-weight:600}.waitlist-details[_ngcontent-%COMP%]{margin-bottom:10px}.history-timeline[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px}.history-event[_ngcontent-%COMP%]{display:flex;gap:15px;padding:12px;background:#f8f9fa;border-radius:6px}.event-time[_ngcontent-%COMP%]{color:#666;font-size:12px;white-space:nowrap;min-width:150px}.event-details[_ngcontent-%COMP%]{flex:1}.event-action[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}.event-metadata[_ngcontent-%COMP%]{color:#666;font-size:14px}.btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.btn-primary-outline[_ngcontent-%COMP%]{background:#fff;color:#007bff;border:1px solid #007bff}.btn-primary-outline[_ngcontent-%COMP%]:hover:not(:disabled){background:#007bff;color:#fff}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6268}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#c82333}.btn-danger-outline[_ngcontent-%COMP%]{background:#fff;color:#dc3545;border:1px solid #dc3545}.btn-danger-outline[_ngcontent-%COMP%]:hover:not(:disabled){background:#dc3545;color:#fff}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:20px}.modal-body[_ngcontent-%COMP%]{padding:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;margin-bottom:8px;color:#333}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ced4da;border-radius:4px;font-size:14px}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 .2rem #007bff40}.form-text[_ngcontent-%COMP%]{display:block;margin-top:4px;font-size:12px;color:#6c757d}.items-checklist[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-height:300px;overflow-y:auto;padding:8px;background:#f8f9fa;border-radius:4px}.checkbox-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px;cursor:pointer}.checkbox-item[_ngcontent-%COMP%]:hover{background:#e9ecef;border-radius:4px}.checkbox-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}.item-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.read-only-value[_ngcontent-%COMP%]{padding:8px 12px;background:#f8f9fa;border-radius:4px;font-weight:500}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px;padding-top:20px;border-top:1px solid #dee2e6}.spinner-small[_ngcontent-%COMP%]{display:inline-block;width:14px;height:14px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite;margin-right:8px}.btn-success[_ngcontent-%COMP%]{background:#28a745;color:#fff}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#218838}.change-requests-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.change-request-item[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:8px;padding:16px;background:#f8f9fa}.change-request-item.status-pending[_ngcontent-%COMP%]{border-left:4px solid #ffc107}.change-request-item.status-approved[_ngcontent-%COMP%]{border-left:4px solid #28a745}.change-request-item.status-denied[_ngcontent-%COMP%]{border-left:4px solid #dc3545;opacity:.7}.change-request-item[_ngcontent-%COMP%]   .request-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.change-request-item[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.change-request-item[_ngcontent-%COMP%]   .request-id[_ngcontent-%COMP%]{font-weight:600;color:#495057}.request-status-badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:12px;font-size:11px;font-weight:600;text-transform:uppercase}.request-status-badge.status-pending[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.request-status-badge.status-approved[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.request-status-badge.status-denied[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.change-request-item[_ngcontent-%COMP%]   .request-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:16px}.change-request-item[_ngcontent-%COMP%]   .request-actions-list[_ngcontent-%COMP%]{font-size:14px}.change-request-item[_ngcontent-%COMP%]   .request-action-row[_ngcontent-%COMP%]{margin-left:16px;color:#666;padding:4px 0}.change-request-item[_ngcontent-%COMP%]   .request-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;font-size:13px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;gap:8px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666;min-width:130px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.change-request-item[_ngcontent-%COMP%]   .request-actions[_ngcontent-%COMP%]{display:flex;gap:10px;padding-top:12px;border-top:1px solid #dee2e6}.text-success[_ngcontent-%COMP%]{color:#28a745!important}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important}.items-list-readonly[_ngcontent-%COMP%]{background:#f8f9fa;padding:12px;border-radius:4px}.items-list-readonly[_ngcontent-%COMP%]   .item-row[_ngcontent-%COMP%]{padding:4px 0;color:#495057}"]})};export{ue as AdminOrderDetailComponent};
