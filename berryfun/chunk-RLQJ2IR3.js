import{b as D,c as I,d as O}from"./chunk-APS2MS2E.js";import{i as M}from"./chunk-GQT55FUQ.js";import{K as k}from"./chunk-2NRCXSDQ.js";import{Ab as d,Ba as f,Cb as b,Ea as r,Pa as P,S as c,T as m,Ub as w,Za as g,_a as h,bb as S,cb as E,da as x,ea as C,hb as i,ib as a,jb as _,kb as y,lb as v,nb as p,ob as s}from"./chunk-WXZFQYIJ.js";var L=(o,t)=>t.id;function T(o,t){o&1&&(i(0,"div",2),d(1,"Loading screenshots..."),a())}function R(o,t){if(o&1){let e=y();i(0,"div",7),p("click",function(){let l=c(e).$implicit,u=s(2);return m(u.openLightbox(l))}),_(1,"img",8),i(2,"div",9),d(3),a()()}if(o&2){let e=t.$implicit,n=s(2);r(),v("src",e.url,f)("alt","Payment screenshot "+e.id),r(2),b(" ",n.formatDate(e.uploadedAt)," ")}}function V(o,t){if(o&1&&(i(0,"div",3),S(1,R,4,3,"div",6,L),a()),o&2){let e=s();r(),E(e.resolved())}}function z(o,t){o&1&&(i(0,"div",4),d(1,"Screenshots removed after payment confirmed."),a())}function U(o,t){if(o&1){let e=y();i(0,"div",10),p("click",function(){c(e);let l=s();return m(l.closeLightbox())}),i(1,"div",11),p("click",function(l){return c(e),m(l.stopPropagation())}),i(2,"button",12),p("click",function(){c(e);let l=s();return m(l.closeLightbox())}),d(3,"\xD7"),a(),_(4,"img",13),i(5,"div",14),d(6),a()()()}if(o&2){let e=s();r(4),v("src",e.lightboxItem().url,f)("alt","Payment screenshot "+e.lightboxItem().id),r(2),b(" Uploaded: ",e.formatDate(e.lightboxItem().uploadedAt)," ")}}var G=class o{screenshots=w([]);resolved=x([]);loading=x(!1);lightboxItem=x(null);storage=O(k());lastResolvedIds="";constructor(){C(()=>{let t=this.screenshots(),e=t.map(n=>n.id).join(",");e!==this.lastResolvedIds&&(this.lastResolvedIds=e,this.resolveUrls(t))})}async resolveUrls(t){if(t.length===0){this.resolved.set([]);return}this.loading.set(!0);let e=[];for(let n of t)try{let l=I(this.storage,n.storagePath),u=await D(l);e.push({id:n.id,url:u,uploadedAt:n.uploadedAt})}catch{}this.resolved.set(e),this.loading.set(!1)}openLightbox(t){this.lightboxItem.set(t)}closeLightbox(){this.lightboxItem.set(null)}formatDate(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=P({type:o,selectors:[["app-payment-screenshot-gallery"]],inputs:{screenshots:[1,"screenshots"]},decls:7,vars:4,consts:[[1,"screenshot-gallery"],[1,"gallery-title"],[1,"gallery-loading"],[1,"thumbnail-grid"],[1,"gallery-empty"],[1,"lightbox-overlay"],[1,"thumbnail-card"],[1,"thumbnail-card",3,"click"],[1,"thumbnail-img",3,"src","alt"],[1,"thumbnail-meta"],[1,"lightbox-overlay",3,"click"],[1,"lightbox-content",3,"click"],["type","button",1,"lightbox-close",3,"click"],[1,"lightbox-img",3,"src","alt"],[1,"lightbox-meta"]],template:function(e,n){e&1&&(i(0,"div",0)(1,"h3",1),d(2,"Payment Screenshots"),a(),g(3,T,2,0,"div",2),g(4,V,3,0,"div",3),g(5,z,2,0,"div",4),a(),g(6,U,7,3,"div",5)),e&2&&(r(3),h(n.loading()?3:-1),r(),h(n.resolved().length>0?4:-1),r(),h(!n.loading()&&n.resolved().length===0&&n.screenshots().length>0?5:-1),r(),h(n.lightboxItem()?6:-1))},dependencies:[M],styles:[".screenshot-gallery[_ngcontent-%COMP%]{margin-bottom:1rem}.gallery-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;margin:0 0 .75rem;color:#333}.gallery-loading[_ngcontent-%COMP%]{color:#666;font-size:.875rem;padding:.5rem 0}.gallery-empty[_ngcontent-%COMP%]{color:#999;font-size:.875rem;padding:.5rem 0}.thumbnail-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.75rem}.thumbnail-card[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:8px;overflow:hidden;cursor:pointer;transition:box-shadow .2s;width:120px}.thumbnail-card[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #00000026}.thumbnail-img[_ngcontent-%COMP%]{width:120px;height:90px;object-fit:cover;display:block}.thumbnail-meta[_ngcontent-%COMP%]{padding:.375rem .5rem;font-size:.75rem;color:#666;background:#f8f9fa;text-align:center}.lightbox-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000c;display:flex;align-items:center;justify-content:center;z-index:2000}.lightbox-content[_ngcontent-%COMP%]{position:relative;max-width:90vw;max-height:90vh;display:flex;flex-direction:column;align-items:center}.lightbox-close[_ngcontent-%COMP%]{position:absolute;top:-40px;right:0;background:transparent;border:none;color:#fff;font-size:32px;cursor:pointer;line-height:1;padding:4px 8px}.lightbox-img[_ngcontent-%COMP%]{max-width:90vw;max-height:80vh;object-fit:contain;border-radius:4px}.lightbox-meta[_ngcontent-%COMP%]{color:#fffc;font-size:.875rem;margin-top:.75rem}"]})};export{G as a};
