import{a as Y,d as ge,g as De}from"./chunk-ICVOX3WC.js";import"./chunk-APS2MS2E.js";import{c as we,f as Oe,i as Ie,j as Me,k as Pe,q as Ae}from"./chunk-XJ7GVLRP.js";import"./chunk-HLH3FCDR.js";import"./chunk-MPFEXNQ6.js";import{b as be}from"./chunk-JMHFOYHT.js";import{b as Ee}from"./chunk-O6AOABRK.js";import{f as me,g as ue}from"./chunk-AAZ7ILIH.js";import{Ba as X,C as G,R as fe,W as J,Y as _e,ba as K,da as Q,ha as he,t as Z,v as V,ya as z}from"./chunk-HB4R6T7X.js";import{a as ve}from"./chunk-EPAU2WC6.js";import{F as Ce,H as Se,P as ye,Q as ee,i as ce,q as xe}from"./chunk-RLRP2YP4.js";import{K as L}from"./chunk-2NRCXSDQ.js";import{Ab as c,Ba as re,Bb as $,Cb as le,Ea as g,N as U,Pa as se,S as D,T,Za as w,_a as O,bb as W,cb as q,da as b,db as P,eb as l,fb as p,gb as ie,kb as ae,mb as k,ob as E,wb as de,yb as pe}from"./chunk-WXZFQYIJ.js";import{a as ne,b as oe}from"./chunk-Q7L6LLAK.js";var Be=50,Le=30,j=class{constructor(t){this.firestore=t}async loadSeason(t){let e=V(this.firestore,`years/${2026}/seasons`,t),o=await z(e);if(!o.exists())throw new Error(`Season ${t} not found`);let n=o.data();return xe(n)}async loadOrders(t,e,o=Be){let n=[],s=Z(this.firestore,`years/${2026}/seasons/${t}/orders`),i=null,a=0;for(;;){a++,e({step:"Loading orders...",detail:`batch ${a}`});let m=i?J(s,K("userAuthId"),Q(o),he(i)):J(s,K("userAuthId"),Q(o)),d=await X(m);for(let u of d.docs)n.push(u.data());if(d.size<o)break;i=d.docs[d.docs.length-1]}return n}async loadUsers(t,e,o=Le){let n=new Map,s=[...new Set(t)];if(s.length===0)return n;let i=Z(this.firestore,"users"),a=Math.ceil(s.length/o);for(let m=0;m<s.length;m+=o){let d=Math.floor(m/o)+1;e({step:"Loading user data...",detail:`batch ${d} of ${a}`});let u=s.slice(m,m+o),f=J(i,_e(fe(),"in",u)),C=await X(f);for(let _ of C.docs){let M=_.data();n.set(M.uid,M)}}return n}async loadRegistration(t){let e=V(this.firestore,`years/${2026}/registrations`,t),o=await z(e);return o.exists()?o.data():null}async loadCoupons(t,e){let o=[...t.coupons??[]],n=new Set(o.map(i=>i.id)),s=new Set;for(let i of e)for(let a of i.appliedCouponIds??[])n.has(a)||s.add(a);for(let i of s){let a=V(this.firestore,"coupons",i),m=await z(a);m.exists()&&o.push(m.data())}return o}async loadAllData(t,e){e({step:"Loading season data..."});let o=await this.loadSeason(t),n=await this.loadOrders(t,e),s=n.map(d=>d.userAuthId),i=await this.loadUsers(s,e);e({step:"Loading registration data..."});let a=await this.loadRegistration(t);e({step:"Loading coupon data..."});let m=await this.loadCoupons(o,n);return{season:o,orders:n,users:i,registration:a,coupons:m}}};var Te="https://sheets.googleapis.com/v4/spreadsheets",H=class{async acquireAccessToken(){let t=new Y;t.addScope("https://www.googleapis.com/auth/spreadsheets");let e=await ge(De,t),o=Y.credentialFromResult(e);if(!o)throw new Error("Failed to obtain Google credentials");let n=o.accessToken;if(!n)throw new Error("Failed to obtain access token");return n}async createSpreadsheet(t,e,o){let n=await fetch(Te,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({properties:{title:t},sheets:e.map(i=>({properties:{title:i}}))})});if(!n.ok){let i=await n.text();throw new Error(`Google Sheets API error (${n.status}): ${i}`)}let s=await n.json();return{spreadsheetId:s.spreadsheetId,spreadsheetUrl:s.spreadsheetUrl}}async writeSheetData(t,e,o,n){let s=encodeURIComponent(e),i=`${Te}/${t}/values/${s}?valueInputOption=RAW`,a=await fetch(i,{method:"PUT",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({range:e,majorDimension:"ROWS",values:o})});if(!a.ok){let m=await a.text();throw new Error(`Google Sheets API error (${a.status}): ${m}`)}}};function I(r){return`$${(r/100).toFixed(2)}`}function te(r,t,e){let o=r.get(t);return o?(o.students??[]).find(n=>n.id===e)??null:null}function Ve(r,t){return r.sessions.find(e=>e.id===t)?.name??t}function ke(r,t,e){let n=["Order User Display ID","Parent Name","Parent Email","Parent Phone","Student Name","Student DOB","Student Gender","Student School","Student Allergies",...e.sessions.map(a=>a.name),"Student Subtotal","Order Discount","Order Total"],s=[];for(let a of r){let m=t.get(a.userAuthId),d=m?.displayName??"",u=a.items,f=new Map;for(let y of u){let v=f.get(y.studentId)??[];v.push(y),f.set(y.studentId,v)}if(f.size===0)continue;let C=Se(a.pricing?.discounts??[]),_=ee(a),M=[...f.keys()].sort((y,v)=>{let x=te(t,a.userAuthId,y),R=x?`${x.firstName} ${x.lastName}`.trim():"",A=te(t,a.userAuthId,v),N=A?`${A.firstName} ${A.lastName}`.trim():"";return R.localeCompare(N)}),h=[],S=!0;for(let y of M){let v=f.get(y),x=te(t,a.userAuthId,y),R=e.sessions.map(N=>{let B=v.find(je=>je.sessionId===N.id);return B?I(B.snapshot.priceSnapshot.itemTotal):""}),A=v.reduce((N,B)=>N+B.snapshot.priceSnapshot.itemTotal,0);h.push([a.userDisplayId,d,m?.email??"",m?.primaryGuardian?.phone??"",x?`${x.firstName} ${x.lastName}`.trim():"",x?.dob??"",x?.gender??"",x?.school??"",x?.allergies??"",...R,I(A),S?I(Math.abs(C)):"",S?I(_):""]),S=!1}s.push({parentName:d,rows:h})}s.sort((a,m)=>a.parentName.localeCompare(m.parentName));let i=s.flatMap(a=>a.rows);return[n,...i]}function Re(r,t){let e=["User Display ID","Parent Name","Parent Email","Order Total","Coupon Discount","Total Paid","Balance Due","Payment Count","Payment Details","Refund Total"],o=[];for(let n of r){if(!n.items.some(_=>_.status==="submitted"||_.status==="paid"))continue;let i=t.get(n.userAuthId),a=ee(n),m=n.couponDiscount??0,d=n.totalPaid??0,u=ye(n),f=Ce(n),C=(n.payments??[]).map(_=>`${_.method} ${I(_.amount)} ${_.recordedAt}${_.reference?` ref:${_.reference}`:""}`).join("; ");o.push([n.userDisplayId,i?.displayName??"",i?.email??"",I(a),I(m),I(d),I(f),String((n.payments??[]).length),C,I(u)])}return[e,...o]}function Ne(r,t){let e=["Coupon ID","Name","Description","Type","Max Credit (cents)","Eligible Emails","Used By (Order Count)"],o=new Map;for(let s of t)for(let i of s.appliedCouponIds??[])o.set(i,(o.get(i)??0)+1);let n=r.map(s=>[s.id,s.name,s.description,s.coupon_type,String(s.maxCreditCents),(s.eligible_emails??[]).join(", "),String(o.get(s.id)??0)]);return[e,...n]}function Ue(r,t,e){let o=["User Display ID","Parent Name","Parent Email","Session ID","Session Name","Joined At"],n=[];for(let s of r){let i=t.get(s.userAuthId);for(let a of s.waitlist??[])n.push([s.userDisplayId,i?.displayName??"",i?.email??"",a.sessionId,Ve(e,a.sessionId),a.joinedAt])}return[o,...n]}function $e(r,t,e,o){let n=["Session ID","Session Name","Start Date","End Date","Capacity","Enrolled Count","Waitlisted Count","Available Spots","Enrolled Students"],s=new Map,i=new Map;for(let d of t){for(let u of d.items){let f=s.get(u.sessionId)??[];f.push(u.studentId),s.set(u.sessionId,f)}for(let u of d.waitlist??[])i.set(u.sessionId,(i.get(u.sessionId)??0)+1)}let a=new Map;if(o)for(let d of o.values())for(let u of d.students??[])a.set(u.id,`${u.firstName} ${u.lastName}`.trim());let m=r.sessions.map(d=>{let u=s.get(d.id)??[],f=u.length,C=i.get(d.id)??0,_=Math.max(0,d.capacity-f),M=u.map(h=>{let S=a.get(h);return S?`${S} (${h})`:h}).join(", ");return[d.id,d.name,d.startDate,d.endDate,String(d.capacity),String(f),String(C),String(_),M]});return[n,...m]}var Ge=(r,t)=>t.id,Je=(r,t)=>t.label;function ze(r,t){r&1&&(l(0,"div",5),ie(1,"div",6),l(2,"p"),c(3,"Loading seasons..."),p()())}function He(r,t){if(r&1&&(l(0,"option",12),c(1),p()),r&2){let e=t.$implicit;P("value",e.id),g(),$(e.name)}}function We(r,t){r&1&&c(0," Exporting... ")}function qe(r,t){r&1&&c(0," Download JSON File ")}function Ye(r,t){r&1&&c(0," Export to Google Sheets ")}function Ze(r,t){r&1&&c(0," \u25CB ")}function Ke(r,t){r&1&&c(0," \u25CC ")}function Qe(r,t){r&1&&c(0," \u2713 ")}function Xe(r,t){r&1&&c(0," \u2717 ")}function et(r,t){if(r&1&&(l(0,"span",30),c(1),p()),r&2){let e=E().$implicit;g(),le("(",e.detail,")")}}function tt(r,t){if(r&1&&(l(0,"div",27)(1,"span",28),w(2,Ze,1,0)(3,Ke,1,0)(4,Qe,1,0)(5,Xe,1,0),p(),l(6,"span",29),c(7),p(),w(8,et,2,1,"span",30),p()),r&2){let e,o=t.$implicit;pe("step-pending",o.status==="pending")("step-in-progress",o.status==="in-progress")("step-completed",o.status==="completed")("step-error",o.status==="error"),g(2),O((e=o.status)==="pending"?2:e==="in-progress"?3:e==="completed"?4:e==="error"?5:-1),g(5),$(o.label),g(),O(o.detail?8:-1)}}function nt(r,t){if(r&1&&(l(0,"div",19)(1,"h3"),c(2,"Export Progress"),p(),l(3,"div",25),W(4,tt,9,11,"div",26,Je),p()()),r&2){let e=E(2);g(4),q(e.steps())}}function ot(r,t){r&1&&c(0," Importing... ")}function rt(r,t){r&1&&c(0," Select JSON File to Import ")}function st(r,t){if(r&1&&(l(0,"div",23)(1,"div",31),c(2,"\u2713"),p(),l(3,"h3"),c(4,"Export Complete"),p(),l(5,"a",32),c(6," Open Spreadsheet \u2192 "),p()()),r&2){let e=E(2);g(5),P("href",e.spreadsheetUrl(),re)}}function it(r,t){r&1&&(l(0,"div",23)(1,"div",31),c(2,"\u2713"),p(),l(3,"h3"),c(4,"JSON Export Complete"),p(),l(5,"p"),c(6,"The file has been downloaded to your device."),p()())}function at(r,t){if(r&1&&(l(0,"div",23)(1,"div",31),c(2,"\u2713"),p(),l(3,"h3"),c(4,"Import Complete"),p(),l(5,"p"),c(6),p()()),r&2){let e=E(2);g(6),$(e.importSummary())}}function dt(r,t){if(r&1&&(l(0,"div",24)(1,"p",33),c(2),p()()),r&2){let e=E(2);g(2),$(e.error())}}function pt(r,t){if(r&1){let e=ae();l(0,"div",7)(1,"h3"),c(2,"Export Season Data"),p(),l(3,"div",8)(4,"label",9),c(5,"Select Season"),p(),l(6,"select",10),k("ngModelChange",function(n){D(e);let s=E();return T(s.onSeasonChange(n))}),l(7,"option",11),c(8,"-- Select a season --"),p(),W(9,He,2,2,"option",12,Ge),p()(),l(11,"div",13)(12,"label"),c(13,"Export Format"),p(),l(14,"div",14)(15,"label",15)(16,"input",16),k("change",function(){D(e);let n=E();return T(n.onFormatChange("google-sheets"))}),p(),l(17,"span"),c(18,"Google Sheets"),p()(),l(19,"label",15)(20,"input",17),k("change",function(){D(e);let n=E();return T(n.onFormatChange("json"))}),p(),l(21,"span"),c(22,"JSON File"),p()()()(),l(23,"button",18),k("click",function(){D(e);let n=E();return T(n.startExport())}),w(24,We,1,0)(25,qe,1,0)(26,Ye,1,0),p()(),w(27,nt,6,0,"div",19),l(28,"div",7)(29,"h3"),c(30,"Import from JSON"),p(),l(31,"p",20),c(32," Import season data from a previously exported JSON file. "),p(),l(33,"input",21,0),k("change",function(n){D(e);let s=E();return T(s.onFileSelected(n))}),p(),l(35,"button",22),k("click",function(){D(e);let n=de(34);return T(n.click())}),w(36,ot,1,0)(37,rt,1,0),p()(),w(38,st,7,1,"div",23),w(39,it,7,0,"div",23),w(40,at,7,1,"div",23),w(41,dt,3,1,"div",24)}if(r&2){let e=E();g(6),P("ngModel",e.selectedSeasonId()),g(3),q(e.seasons()),g(7),P("checked",e.exportFormat()==="google-sheets"),g(4),P("checked",e.exportFormat()==="json"),g(3),P("disabled",!e.selectedSeasonId()||e.exporting()),g(),O(e.exporting()?24:e.exportFormat()==="json"?25:26),g(3),O(e.steps().length>0?27:-1),g(8),P("disabled",e.importing()),g(),O(e.importing()?36:37),g(2),O(e.spreadsheetUrl()?38:-1),g(),O(e.jsonExportComplete()?39:-1),g(),O(e.importComplete()?40:-1),g(),O(e.error()?41:-1)}}var Fe=class r{router=U(me);userService=U(Ee);configService=U(ve);seasonService=U(be);_steps=b([]);_selectedSeasonId=b(null);_exporting=b(!1);_spreadsheetUrl=b(null);_error=b(null);_loadingSeasons=b(!1);_exportFormat=b("google-sheets");_jsonExportComplete=b(!1);_importing=b(!1);_importComplete=b(!1);_importSummary=b("");steps=this._steps.asReadonly();selectedSeasonId=this._selectedSeasonId.asReadonly();exporting=this._exporting.asReadonly();spreadsheetUrl=this._spreadsheetUrl.asReadonly();error=this._error.asReadonly();loadingSeasons=this._loadingSeasons.asReadonly();exportFormat=this._exportFormat.asReadonly();jsonExportComplete=this._jsonExportComplete.asReadonly();importing=this._importing.asReadonly();importComplete=this._importComplete.asReadonly();importSummary=this._importSummary.asReadonly();seasons=this.seasonService.seasons;async ngOnInit(){if(!this.userService.isAuthenticated()){this.router.navigate(["/login"]);return}if(!this.userService.isAdmin()){this.router.navigate(["/"]);return}this._loadingSeasons.set(!0);try{await this.seasonService.loadAllSeasons()}catch(t){this._error.set(t instanceof Error?t.message:"Failed to load seasons")}finally{this._loadingSeasons.set(!1)}}onSeasonChange(t){this._selectedSeasonId.set(t||null),this._spreadsheetUrl.set(null),this._error.set(null),this._steps.set([]),this._jsonExportComplete.set(!1)}onFormatChange(t){this._exportFormat.set(t),this._spreadsheetUrl.set(null),this._jsonExportComplete.set(!1),this._error.set(null),this._steps.set([])}async startExport(){return this._exportFormat()==="json"?this.startJsonExport():this.startGoogleSheetsExport()}async startJsonExport(){let t=this._selectedSeasonId();if(t){this._exporting.set(!0),this._jsonExportComplete.set(!1),this._error.set(null),this._steps.set([{label:"Loading data from Firestore",status:"pending"},{label:"Generating JSON file",status:"pending"}]);try{this.updateStep(0,"in-progress");let e=G(L()),n=await new j(e).loadAllData(t,u=>{this.updateStep(0,"in-progress",u.detail)});this.updateStep(0,"completed"),this.updateStep(1,"in-progress");let s={exportedAt:new Date().toISOString(),year:2026,seasonId:t,season:n.season,orders:n.orders,users:Object.fromEntries(n.users),registration:n.registration,coupons:n.coupons},i=JSON.stringify(s,null,2),a=new Blob([i],{type:"application/json"}),m=URL.createObjectURL(a),d=document.createElement("a");d.href=m,d.download=`${n.season.name.replace(/[^a-zA-Z0-9]/g,"-")}-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(m),this.updateStep(1,"completed"),this._jsonExportComplete.set(!0)}catch(e){let o=this._steps().findIndex(n=>n.status==="in-progress");o>=0&&this.updateStep(o,"error"),this._error.set(e instanceof Error?e.message:"Export failed")}finally{this._exporting.set(!1)}}}async startGoogleSheetsExport(){let t=this._selectedSeasonId();if(t){this._exporting.set(!0),this._spreadsheetUrl.set(null),this._error.set(null),this._steps.set([{label:"Authenticating with Google",status:"pending"},{label:"Loading data from Firestore",status:"pending"},{label:"Building spreadsheet data",status:"pending"},{label:"Creating Google Spreadsheet",status:"pending"},{label:"Writing sheet data",status:"pending"}]);try{this.updateStep(0,"in-progress");let e=new H,o=await e.acquireAccessToken();this.updateStep(0,"completed"),this.updateStep(1,"in-progress");let n=G(L()),i=await new j(n).loadAllData(t,f=>{this.updateStep(1,"in-progress",f.detail)});this.updateStep(1,"completed"),this.updateStep(2,"in-progress");let a={Orders:ke(i.orders,i.users,i.season),Payments:Re(i.orders,i.users),Coupons:Ne(i.coupons,i.orders),Waitlist:Ue(i.orders,i.users,i.season),Sessions:$e(i.season,i.orders,i.registration,i.users)};this.updateStep(2,"completed"),this.updateStep(3,"in-progress");let m=`${i.season.name} \u2014 Export ${new Date().toLocaleDateString()}`,d=Object.keys(a),u=await e.createSpreadsheet(m,d,o);this.updateStep(3,"completed"),this.updateStep(4,"in-progress");for(let[f,C]of Object.entries(a))this.updateStep(4,"in-progress",`Writing ${f}...`),await e.writeSheetData(u.spreadsheetId,f,C,o);this.updateStep(4,"completed"),this._spreadsheetUrl.set(u.spreadsheetUrl)}catch(e){let o=this._steps().findIndex(n=>n.status==="in-progress");o>=0&&this.updateStep(o,"error"),this._error.set(e instanceof Error?e.message:"Export failed")}finally{this._exporting.set(!1)}}}updateStep(t,e,o){this._steps.update(n=>n.map((s,i)=>i===t?oe(ne({},s),{status:e,detail:o}):s))}async onFileSelected(t){let e=t.target,o=e.files?.[0];if(o){this._importing.set(!0),this._importComplete.set(!1),this._error.set(null),this._steps.set([{label:"Reading JSON file",status:"pending"},{label:"Validating data structure",status:"pending"},{label:"Importing to Firestore",status:"pending"}]);try{this.updateStep(0,"in-progress");let n=await o.text(),s=JSON.parse(n);if(this.updateStep(0,"completed"),this.updateStep(1,"in-progress"),!s.season||!s.orders)throw new Error("Invalid export file: missing season or orders data");this.updateStep(1,"completed"),this.updateStep(2,"in-progress");let i=G(L()),a=s.year??this.configService.activeYear(),{doc:m,setDoc:d,writeBatch:u}=await import("./chunk-C6LMD5IF.js"),f=m(i,`years/${a}/seasons`,s.season.id);await d(f,s.season),this.updateStep(2,"in-progress","Season imported");let C=s.orders,_=500,M=0;for(let h=0;h<C.length;h+=_){let S=u(i),y=C.slice(h,h+_);for(let v of y){let x=m(i,`years/${a}/seasons/${s.season.id}/orders`,v.userAuthId);S.set(x,v)}await S.commit(),M+=y.length,this.updateStep(2,"in-progress",`Imported ${M}/${C.length} orders`)}if(s.users&&typeof s.users=="object"){let h=Object.entries(s.users);for(let S=0;S<h.length;S+=_){let y=u(i),v=h.slice(S,S+_);for(let[x,R]of v){let A=m(i,"users",x);y.set(A,R,{merge:!0})}await y.commit()}this.updateStep(2,"in-progress",`Imported ${h.length} users`)}if(s.registration){let h=m(i,`years/${a}/registrations`,s.season.id);await d(h,s.registration)}this.updateStep(2,"completed"),this._importComplete.set(!0),this._importSummary.set(`Imported season "${s.season.name}" with ${C.length} orders.`)}catch(n){let s=this._steps().findIndex(i=>i.status==="in-progress");s>=0&&this.updateStep(s,"error"),this._error.set(n instanceof Error?n.message:"Import failed")}finally{this._importing.set(!1),e.value=""}}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=se({type:r,selectors:[["app-admin-export"]],decls:10,vars:1,consts:[["fileInput",""],[1,"admin-export"],[1,"page-header"],["routerLink","/admin",1,"back-link"],[1,"subtitle"],[1,"loading-container"],[1,"spinner"],[1,"export-card"],[1,"form-group"],["for","season-select"],["id","season-select",1,"season-select",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"format-group"],[1,"format-options"],[1,"format-option"],["type","radio","name","format","value","google-sheets",3,"change","checked"],["type","radio","name","format","value","json",3,"change","checked"],[1,"btn-export",3,"click","disabled"],[1,"steps-card"],[1,"import-description"],["type","file","accept",".json",2,"display","none",3,"change"],[1,"btn-import",3,"click","disabled"],[1,"success-card"],[1,"error-card"],[1,"steps-list"],[1,"step",3,"step-pending","step-in-progress","step-completed","step-error"],[1,"step"],[1,"step-icon"],[1,"step-label"],[1,"step-detail"],[1,"success-icon"],["target","_blank","rel","noopener",1,"spreadsheet-link",3,"href"],[1,"error-message"]],template:function(e,o){e&1&&(l(0,"div",1)(1,"header",2)(2,"a",3),c(3,"\u2190 Back to Console"),p(),l(4,"h1"),c(5,"Data Export"),p(),l(6,"p",4),c(7,"Export and import season data"),p()(),w(8,ze,4,0,"div",5)(9,pt,42,12),p()),e&2&&(g(8),O(o.loadingSeasons()?8:9))},dependencies:[ce,Ae,Me,Pe,Ie,we,Oe,ue],styles:[".admin-export[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1.5rem}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.75rem;color:var(--sys-on-surface, #212121)}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;color:var(--sys-on-surface-variant, #666)}.back-link[_ngcontent-%COMP%]{display:inline-block;margin-bottom:1rem;color:var(--sys-primary, #c62828);text-decoration:none;font-size:.875rem}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:4rem 2rem}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.export-card[_ngcontent-%COMP%], .steps-card[_ngcontent-%COMP%], .success-card[_ngcontent-%COMP%], .error-card[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline-variant, #e0e0e0);border-radius:12px;padding:1.5rem;margin-bottom:1rem}.export-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem;color:var(--sys-on-surface, #212121)}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:var(--sys-on-surface, #212121)}.season-select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid var(--sys-outline-variant, #e0e0e0);border-radius:8px;font-size:1rem;background:#fff}.format-group[_ngcontent-%COMP%]{margin-bottom:1rem}.format-group[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:var(--sys-on-surface, #212121)}.format-options[_ngcontent-%COMP%]{display:flex;gap:1.5rem}.format-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-weight:400}.format-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{cursor:pointer}.import-description[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-on-surface-variant, #666);font-size:.875rem}.btn-import[_ngcontent-%COMP%]{width:100%;padding:.75rem 1.25rem;background:var(--sys-tertiary, #1976d2);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s ease}.btn-import[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-tertiary-dark, #1565c0)}.btn-import[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-export[_ngcontent-%COMP%]{width:100%;padding:.75rem 1.25rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s ease}.btn-export[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-primary-dark, #a51c1c)}.btn-export[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.steps-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem;color:var(--sys-on-surface, #212121)}.steps-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.step[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.5rem 0}.step-icon[_ngcontent-%COMP%]{font-size:1rem;width:1.25rem;text-align:center}.step-pending[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #999)}.step-in-progress[_ngcontent-%COMP%]{color:var(--sys-tertiary, #1976d2);font-weight:500}.step-completed[_ngcontent-%COMP%]{color:var(--sys-secondary, #2e7d32)}.step-error[_ngcontent-%COMP%]{color:var(--sys-error, #c62828)}.step-detail[_ngcontent-%COMP%]{font-size:.875rem;color:var(--sys-on-surface-variant, #666)}.success-card[_ngcontent-%COMP%]{text-align:center;border-color:var(--sys-secondary, #2e7d32)}.success-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--sys-secondary, #2e7d32);margin-bottom:.5rem}.success-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-secondary, #2e7d32)}.spreadsheet-link[_ngcontent-%COMP%]{display:inline-block;padding:.75rem 1.5rem;background:var(--sys-secondary, #2e7d32);color:#fff;border-radius:8px;text-decoration:none;font-weight:500}.spreadsheet-link[_ngcontent-%COMP%]:hover{opacity:.9}.error-card[_ngcontent-%COMP%]{border-color:var(--sys-error, #c62828);background:var(--sys-error-container, #ffebee)}.error-message[_ngcontent-%COMP%]{margin:0;color:var(--sys-error, #c62828);font-weight:500}"]})};export{Fe as AdminExportComponent};
