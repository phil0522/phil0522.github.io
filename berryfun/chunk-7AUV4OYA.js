import{a as Q}from"./chunk-TPMJLM3G.js";import{a as K}from"./chunk-WZSQD3J4.js";import{$ as N,X as A,Y as J,Z as q,_ as Y,d as z,j as U}from"./chunk-JDDKB7VA.js";import"./chunk-UYHN5VVP.js";import{Ab as k,Bb as $,Ea as s,Jb as G,N as x,Pa as L,Pb as y,Rb as W,S as _,Sb as P,T as C,U as M,V as I,Ya as H,Za as c,_a as m,bb as O,cb as D,da as b,db as V,ea as F,eb as a,fb as l,gb as w,hb as u,ib as p,jb as B,kb as f,lb as j,mb as S,nb as T,ob as d,wb as h,yb as r,zb as v}from"./chunk-DU5POHF6.js";import"./chunk-Q7L6LLAK.js";var ne=(i,n)=>n.id;function ie(i,n){i&1&&(u(0,"div",8),r(1,"\u{1F389} Early Bird"),p())}function oe(i,n){i&1&&(M(),u(0,"svg",17),B(1,"path",18),p())}function re(i,n){if(i&1){let e=f();u(0,"label",14)(1,"input",15),T("change",function(o){let g=_(e).$implicit,E=d(2);return C(E.toggleStudent(g.id,o))}),p(),u(2,"span",16),r(3),p(),c(4,oe,2,0,":svg:svg",17),p()}if(i&2){let e=n.$implicit,t=d(2),o=t.reservedStudentIds().includes(e.id),g=t.selectedStudentIds().includes(e.id),E=o||t.status()==="full";h("reserved",o)("selected",g&&!o)("disabled",t.status()==="full"&&!o),s(),j("checked",o||g)("disabled",E),s(2),$("",e.firstName," ",e.lastName),s(),m(o?4:-1)}}function ae(i,n){if(i&1){let e=f();u(0,"div",12),T("click",function(o){return _(e),C(o.stopPropagation())}),O(1,re,5,11,"label",13,ne),p()}if(i&2){let e=d();s(),D(e.students())}}function se(i,n){i&1&&(u(0,"button",11),r(1,"All Students Enrolled"),p())}function le(i,n){i&1&&(u(0,"button",19),r(1,"Add Student to Enroll"),p())}function de(i,n){i&1&&(u(0,"button",19),r(1,"Complete Profile to Enroll"),p())}function ce(i,n){if(i&1){let e=f();u(0,"button",21),T("click",function(o){_(e);let g=d(2);return C(g.onReserveClick(o))}),r(1," Reserve Now "),p()}if(i&2){let e=d(2);h("active",e.hasNewSelection()),j("disabled",!e.hasNewSelection())}}function me(i,n){if(i&1&&c(0,le,2,0,"button",19)(1,de,2,0,"button",19)(2,ce,2,3,"button",20),i&2){let e=d();m(e.hasStudents()?e.isProfileComplete()?2:1:0)}}function ge(i,n){i&1&&(u(0,"button",22),r(1,"On Waitlist"),p())}function pe(i,n){if(i&1){let e=f();u(0,"button",24),T("click",function(o){_(e);let g=d(2);return C(g.onWaitlistClick(o))}),r(1,"Join Waitlist"),p()}}function ue(i,n){if(i&1&&c(0,ge,2,0,"button",22)(1,pe,2,0,"button",23),i&2){let e=d();m(e.isOnWaitlist()?0:1)}}var R=class i{userService=x(N);classData=P.required();currentPrice=P.required();status=P.required();showEarlyBird=P(!1);isOnWaitlist=P(!1);students=P([]);reservedStudentIds=P([]);cardClick=W();waitlistClick=W();reserveClick=W();_selectedStudentIds=b([]);selectedStudentIds=this._selectedStudentIds.asReadonly();isProfileComplete=y(()=>this.userService.isProfileComplete());hasStudents=y(()=>this.students().length>0);allStudentsReserved=y(()=>{let n=this.students(),e=this.reservedStudentIds();return n.length===0?!1:n.every(t=>e.includes(t.id))});hasNewSelection=y(()=>{let n=this._selectedStudentIds(),e=this.reservedStudentIds();return n.some(t=>!e.includes(t))});getStatusText(){switch(this.status()){case"available":let n=this.classData().available;return n>5?"5+ spots":`${n} spots`;case"full":return"Full";default:return"Unknown"}}formatDateRange(n,e){let t=new Date(n),o=new Date(e),g=t.toLocaleDateString("en-US",{month:"numeric",day:"numeric"}),E=o.toLocaleDateString("en-US",{month:"numeric",day:"numeric"});return`${g} - ${E}`}toggleStudent(n,e){e.stopPropagation();let t=e.target;this._selectedStudentIds.update(o=>t.checked?o.includes(n)?o:[...o,n]:o.filter(g=>g!==n))}onReserveClick(n){n.stopPropagation();let e=this._selectedStudentIds().filter(t=>!this.reservedStudentIds().includes(t));e.length>0&&(this.reserveClick.emit({sessionId:this.classData().id,studentIds:e}),this._selectedStudentIds.set([]))}onWaitlistClick(n){n.stopPropagation(),this.waitlistClick.emit(this.classData())}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=L({type:i,selectors:[["app-class-card"]],inputs:{classData:[1,"classData"],currentPrice:[1,"currentPrice"],status:[1,"status"],showEarlyBird:[1,"showEarlyBird"],isOnWaitlist:[1,"isOnWaitlist"],students:[1,"students"],reservedStudentIds:[1,"reservedStudentIds"]},outputs:{cardClick:"cardClick",waitlistClick:"waitlistClick",reserveClick:"reserveClick"},decls:20,vars:13,consts:[[1,"class-card"],[1,"class-header"],[1,"status-badge"],[1,"class-dates"],["width","16","height","16","viewBox","0 0 24 24","fill","currentColor"],["d","M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"],[1,"class-pricing"],[1,"price-value"],[1,"early-bird-badge"],[1,"student-selection"],[1,"class-action"],["disabled","",1,"btn-all-enrolled"],[1,"student-selection",3,"click"],[1,"student-checkbox",3,"reserved","selected","disabled"],[1,"student-checkbox"],["type","checkbox",3,"change","checked","disabled"],[1,"student-name"],["width","16","height","16","viewBox","0 0 24 24","fill","currentColor",1,"check-icon"],["d","M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"],["disabled","",1,"btn-profile-incomplete"],[1,"btn-reserve",3,"active","disabled"],[1,"btn-reserve",3,"click","disabled"],["disabled","",1,"btn-on-waitlist"],[1,"btn-waitlist"],[1,"btn-waitlist",3,"click"]],template:function(e,t){e&1&&(u(0,"div",0)(1,"div",1)(2,"h3"),r(3),p(),u(4,"div",2),r(5),p()(),u(6,"div",3),M(),u(7,"svg",4),B(8,"path",5),p(),I(),u(9,"span"),r(10),p()(),u(11,"div",6)(12,"span",7),r(13),p(),c(14,ie,2,0,"div",8),p(),c(15,ae,3,0,"div",9),u(16,"div",10),c(17,se,2,0,"button",11)(18,me,3,1)(19,ue,2,1),p()()),e&2&&(h("all-reserved",t.allStudentsReserved()),s(3),v(t.classData().name),s(),h("available",t.status()==="available")("full",t.status()==="full"),s(),k(" ",t.getStatusText()," "),s(5),v(t.formatDateRange(t.classData().startDate,t.classData().endDate)),s(3),v(t.currentPrice()),s(),m(t.showEarlyBird()?14:-1),s(),m(t.students().length>0?15:-1),s(2),m(t.allStudentsReserved()?17:t.status()==="available"?18:t.status()==="full"?19:-1))},dependencies:[z],styles:['.class-card[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline, #e0e0e0);border-radius:12px;padding:1.25rem;transition:all .2s ease;display:flex;flex-direction:column;gap:.75rem}.class-card[_ngcontent-%COMP%]:hover{border-color:var(--sys-primary, #c62828);box-shadow:0 4px 12px #0000001a}.class-card.all-reserved[_ngcontent-%COMP%]{border-color:var(--sys-tertiary, #2e7d32);background:linear-gradient(135deg,#fff,#f1f8e9)}.class-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;gap:.75rem}.class-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.05rem;color:var(--sys-on-surface, #212121);flex:1;font-weight:600}.status-badge[_ngcontent-%COMP%]{padding:.2rem .6rem;border-radius:12px;font-size:.7rem;font-weight:600;white-space:nowrap;text-transform:uppercase;letter-spacing:.02em}.status-badge.available[_ngcontent-%COMP%]{background-color:var(--sys-secondary-container, #e8f5e9);color:var(--sys-on-secondary-container, #1b5e20)}.status-badge.full[_ngcontent-%COMP%]{background-color:var(--sys-error-container, #ffebee);color:var(--sys-on-error-container, #b71c1c)}.class-dates[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:var(--sys-on-surface-variant, #666);font-size:.85rem}.class-dates[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;opacity:.7}.class-pricing[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.price-value[_ngcontent-%COMP%]{font-size:1.35rem;font-weight:700;color:var(--sys-primary, #c62828)}.early-bird-badge[_ngcontent-%COMP%]{background:linear-gradient(135deg,gold,orange);color:#333;padding:.2rem .6rem;border-radius:4px;font-size:.7rem;font-weight:600}.student-selection[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;padding:.75rem 0;border-top:1px solid var(--sys-outline-variant, #f0f0f0)}.student-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem .75rem;background:var(--sys-surface-variant, #f5f5f5);border-radius:8px;cursor:pointer;transition:all .15s ease;-webkit-user-select:none;user-select:none;border:1px solid transparent}.student-checkbox[_ngcontent-%COMP%]:hover:not(.reserved):not(.disabled){background:var(--sys-primary-container, #ffebee)}.student-checkbox.disabled[_ngcontent-%COMP%]{cursor:default}.student-checkbox.selected[_ngcontent-%COMP%]{background:var(--sys-primary-container, #ffebee);border:1px solid var(--sys-primary, #c62828)}.student-checkbox.reserved[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e8f5e9,#c8e6c9);border:1px solid var(--sys-tertiary, #2e7d32);cursor:default;position:relative}.student-checkbox.reserved[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:var(--sys-tertiary, #2e7d32);border-radius:8px 0 0 8px}.student-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:var(--sys-primary, #c62828);cursor:pointer}.student-checkbox.reserved[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{accent-color:var(--sys-tertiary, #2e7d32);cursor:default}.student-name[_ngcontent-%COMP%]{flex:1;font-size:.9rem;color:var(--sys-on-surface, #333)}.student-checkbox.reserved[_ngcontent-%COMP%]   .student-name[_ngcontent-%COMP%]{font-weight:600;color:var(--sys-tertiary, #2e7d32)}.check-icon[_ngcontent-%COMP%]{color:var(--sys-tertiary, #2e7d32)}.class-action[_ngcontent-%COMP%]{margin-top:auto}.class-action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:none;border-radius:8px;font-size:.9rem;font-weight:600;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn-reserve[_ngcontent-%COMP%]{background-color:var(--sys-outline, #e0e0e0);color:var(--sys-on-surface-variant, #999)}.btn-reserve.active[_ngcontent-%COMP%]{background-color:var(--sys-primary, #c62828);color:#fff}.btn-reserve.active[_ngcontent-%COMP%]:hover{background-color:var(--sys-primary-dark, #8e0000)}.btn-reserve[_ngcontent-%COMP%]:disabled{cursor:default}.btn-waitlist[_ngcontent-%COMP%]{background-color:var(--sys-tertiary, #1976d2);color:#fff}.btn-waitlist[_ngcontent-%COMP%]:hover{background-color:var(--sys-tertiary-dark, #0d47a1)}.btn-on-waitlist[_ngcontent-%COMP%]{background-color:var(--sys-tertiary-container, #e3f2fd);color:var(--sys-tertiary, #1976d2)}.btn-on-waitlist[_ngcontent-%COMP%]:disabled{cursor:default;opacity:1}.btn-all-enrolled[_ngcontent-%COMP%]{background-color:var(--sys-secondary-container, #e8f5e9);color:var(--sys-on-secondary-container, #1b5e20)}.btn-all-enrolled[_ngcontent-%COMP%]:disabled{cursor:default;opacity:1}.btn-profile-incomplete[_ngcontent-%COMP%]{background-color:var(--sys-surface-variant, #f5f5f5);color:var(--sys-on-surface-variant, #666);font-size:.85rem}.btn-profile-incomplete[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.8}']})};var _e=()=>({includeLunch:!1,includeExtendedCare:!1}),Z=(i,n)=>n.id;function Ce(i,n){i&1&&(a(0,"div",1),r(1,"Loading..."),l())}function fe(i,n){if(i&1){let e=f();a(0,"div",2)(1,"strong"),r(2,"Error:"),l(),r(3),a(4,"button",9),S("click",function(){_(e);let o=d();return C(o.seasonService.clearError())}),r(5,"Close"),l()()}if(i&2){let e=d();s(3),k(" ",e.seasonService.error()," ")}}function ve(i,n){i&1&&(a(0,"div",10)(1,"p"),r(2,"No seasons available"),l()())}function xe(i,n){if(i&1){let e=f();a(0,"div",13),S("click",function(){let o=_(e).$implicit,g=d(3);return C(g.onSeasonClick(o))}),a(1,"h3"),r(2),l(),a(3,"div",14)(4,"span"),r(5),l(),a(6,"span"),r(7," - "),l(),a(8,"span"),r(9),l()(),a(10,"div",15),r(11),l()()}if(i&2){let e,t=n.$implicit,o=d(3);h("selected",((e=o.seasonService.selectedSeason())==null?null:e.id)===t.id),s(2),v(t.name),s(3),v(o.formatDate(t.startDate)),s(4),v(o.formatDate(t.endDate)),s(2),v(t.year)}}function be(i,n){if(i&1&&(a(0,"div",11),O(1,xe,12,6,"div",12,Z),l()),i&2){let e=d();s(),D(e)}}function Se(i,n){if(i&1&&c(0,ve,3,0,"div",10)(1,be,3,0,"div",11),i&2){let e=d();m(n.length===0&&!e.seasonService.loading()?0:1)}}function he(i,n){if(i&1&&(a(0,"div",19),w(1,"app-markdown-renderer",20),l()),i&2){let e,t=d(2);s(),V("content",((e=t.seasonService.selectedSeason())==null?null:e.description)||"")}}function ye(i,n){if(i&1){let e=f();a(0,"div",3)(1,"div",16),S("click",function(){_(e);let o=d();return C(o.toggleDescription())}),a(2,"h2"),r(3),l(),a(4,"button",17),r(5),a(6,"span",18),r(7,"\u25BC"),l()()(),c(8,he,2,1,"div",19),l()}if(i&2){let e,t=d();s(3),k("",(e=t.seasonService.selectedSeason())==null?null:e.name," - Details"),s(),H("aria-expanded",t.descriptionExpanded()),s(),k(" ",t.descriptionExpanded()?"Collapse":"Expand"," "),s(),h("expanded",t.descriptionExpanded()),s(2),m(t.descriptionExpanded()?8:-1)}}function Pe(i,n){i&1&&(a(0,"strong"),r(1,"Add a student to enroll"),l(),a(2,"p"),r(3,"Please add your child's information before registering for camp sessions."),l())}function Me(i,n){i&1&&(a(0,"strong"),r(1,"Complete your profile to enroll"),l(),a(2,"p"),r(3,"Please fill in your contact information (phone, WeChat, address, emergency contact) before registering."),l())}function we(i,n){if(i&1){let e=f();a(0,"div",21)(1,"div",22),M(),a(2,"svg",23),w(3,"path",24),l()(),I(),a(4,"div",25),c(5,Pe,4,0)(6,Me,4,0),l(),a(7,"button",26),S("click",function(){_(e);let o=d(2);return C(o.goToProfile())}),r(8," Go to Profile "),M(),a(9,"svg",27),w(10,"path",28),l()()()}if(i&2){let e=d(2);s(5),m(e.userService.hasStudents()?6:5)}}function ke(i,n){i&1&&(a(0,"div",29)(1,"p"),r(2,"No classes available for this season"),l()())}function Ee(i,n){if(i&1){let e=f();a(0,"app-class-card",32),S("cardClick",function(){_(e);let o=d(4);return C(o.onClassClick())})("waitlistClick",function(o){_(e);let g=d(4);return C(g.onWaitlistClick(o))})("reserveClick",function(o){_(e);let g=d(4);return C(g.onReserveClick(o))}),l()}if(i&2){let e=n.$implicit,t=d(4);V("classData",e)("currentPrice",t.seasonService.formatPrice(t.seasonService.calculatePrice(e,G(7,_e))))("status",t.getClassStatus(e))("showEarlyBird",t.isEarlyBird(e))("isOnWaitlist",t.isOnWaitlist(e.id))("students",t.students())("reservedStudentIds",t.getReservedStudentIds(e.id))}}function Oe(i,n){if(i&1&&(a(0,"div",30),O(1,Ee,1,8,"app-class-card",31,Z),l()),i&2){let e=d();s(),D(e)}}function De(i,n){if(i&1&&c(0,ke,3,0,"div",29)(1,Oe,3,0,"div",30),i&2){let e=d(2);m(n.length===0&&!e.seasonService.loading()?0:1)}}function Te(i,n){if(i&1&&(a(0,"div",4)(1,"h2"),r(2),l(),c(3,we,11,1,"div",21),c(4,De,2,1),l()),i&2){let e,t,o=d();s(2),k("Select Session - ",(e=o.seasonService.selectedSeason())==null?null:e.name),s(),m(!o.userService.hasStudents()||!o.userService.isProfileComplete()?3:-1),s(),m((t=o.registrationService.classesWithEnrollment())?4:-1,t)}}function Ie(i,n){if(i&1){let e=f();a(0,"div",5)(1,"div",33)(2,"span",34),r(3),l(),a(4,"span",35),r(5,"item(s) in ledger"),l()(),a(6,"button",36),S("click",function(){_(e);let o=d();return C(o.goToLedger())}),r(7," Proceed to Ledger "),M(),a(8,"svg",37),w(9,"path",28),l()()()}if(i&2){let e=d();s(3),v(e.ledgerItemCount())}}function Le(i,n){i&1&&(a(0,"div",6)(1,"div",38),w(2,"div",39),a(3,"span"),r(4,"Reserving spot..."),l()()())}function Ve(i,n){if(i&1){let e=f();a(0,"div",40),S("click",function(){_(e);let o=d();return C(o.clearReservationError())}),a(1,"span"),r(2),l(),a(3,"button"),r(4,"Dismiss"),l()()}if(i&2){let e=d();s(2),v(e.reservationError())}}function We(i,n){i&1&&(a(0,"div",43),w(1,"div",39),a(2,"span"),r(3,"Processing..."),l()())}function ze(i,n){if(i&1&&(a(0,"div",44),r(1),l()),i&2){let e=d(2);s(),v(e.waitlistError())}}function Ne(i,n){if(i&1){let e=f();a(0,"div",8)(1,"div",41)(2,"h3"),r(3,"Join Waitlist"),l(),a(4,"p"),r(5," Join the waitlist for "),a(6,"strong"),r(7),l(),r(8,"? "),l(),a(9,"p",42),r(10," You'll be notified when a spot becomes available. Student selection happens at checkout. "),l(),c(11,We,4,0,"div",43),c(12,ze,2,1,"div",44),a(13,"div",45)(14,"button",46),S("click",function(){_(e);let o=d();return C(o.closeWaitlistDialog())}),r(15,"Cancel"),l(),a(16,"button",47),S("click",function(){_(e);let o=d();return C(o.joinWaitlistForClass())}),r(17," Join Waitlist "),l()()()()}if(i&2){let e,t=d();s(7),v((e=t.selectedClassForWaitlist())==null?null:e.name),s(4),m(t.joiningWaitlist()?11:-1),s(),m(t.waitlistError()?12:-1),s(4),V("disabled",t.joiningWaitlist())}}var X=class i{seasonService=x(q);registrationService=x(K);orderService=x(Y);configService=x(J);orderRpc=x(A);userService=x(N);router=x(U);descriptionExpanded=b(!0);constructor(){F(()=>{this.loadSeasonsAndSelectLatest()})}async loadSeasonsAndSelectLatest(){await this.seasonService.loadSeasons();let n=this.seasonService.seasons();if(n.length>0){let e=this.seasonService.getLastSelectedSeasonId(),o=(e?n.find(g=>g.id===e):null)??n[n.length-1];await this.onSeasonClick(o)}}reserving=b(!1);reservationError=b(null);showWaitlistDialog=b(!1);selectedClassForWaitlist=b(null);waitlistError=b(null);joiningWaitlist=b(!1);students=this.userService.students;ledgerItemCount=y(()=>this.orderService.lockedItems().length+this.orderService.submittedItems().length);registeredStudentsByClass=y(()=>{let n=this.orderService.items(),e=new Map;for(let t of n){let o=e.get(t.sessionId)||[];o.includes(t.studentId)||o.push(t.studentId),e.set(t.sessionId,o)}return e});async onSeasonClick(n){this.seasonService.selectSeason(n),await this.seasonService.loadClassesBySeason(n.id)}onClassClick(){}getClassStatus(n){let e=this.registrationService.getEnrollmentStatus(n);return e==="open"||e==="almost-full"?"available":"full"}isOnWaitlist(n){return this.orderService.isOnWaitlist(n)}isEarlyBird(n){if(!n.earlyBirdTiers||n.earlyBirdTiers.length===0)return!1;let e=this.configService.currentDate();return e?n.earlyBirdTiers.some(t=>e<=t.deadline):!1}getReservedStudentIds(n){return this.registeredStudentsByClass().get(n)||[]}async onReserveClick(n){let e=this.seasonService.selectedSeason()?.id;if(!e){this.reservationError.set("No season selected");return}this.reserving.set(!0),this.reservationError.set(null);try{let t=n.studentIds.map(o=>({sessionId:n.sessionId,studentId:o,options:{lunch:!0,extendedCare:!1}}));await this.orderRpc.lockSessions({seasonId:e,items:t,selectedCouponIds:[]})}catch(t){let o=t instanceof Error?t.message:String(t);this.reservationError.set(o),setTimeout(()=>this.clearReservationError(),5e3)}finally{this.reserving.set(!1)}}clearReservationError(){this.reservationError.set(null)}goToLedger(){this.router.navigate(["/ledger"])}goToProfile(){this.router.navigate(["/profile"])}formatDate(n){return new Date(n).toLocaleDateString("en-US",{month:"long",day:"numeric"})}toggleDescription(){this.descriptionExpanded.update(n=>!n)}onWaitlistClick(n){this.selectedClassForWaitlist.set(n),this.waitlistError.set(null),this.showWaitlistDialog.set(!0)}closeWaitlistDialog(){this.showWaitlistDialog.set(!1),this.selectedClassForWaitlist.set(null),this.waitlistError.set(null)}async joinWaitlistForClass(){let n=this.selectedClassForWaitlist();if(n){this.waitlistError.set(null),this.joiningWaitlist.set(!0);try{await this.orderService.joinWaitlist(n.id),this.closeWaitlistDialog(),this.router.navigate(["/waitlist"])}catch(e){let t=e instanceof Error?e.message:String(e);this.waitlistError.set(t)}finally{this.joiningWaitlist.set(!1)}}}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=L({type:i,selectors:[["app-season-list"]],decls:12,vars:9,consts:[[1,"season-list"],[1,"loading"],[1,"error-message"],[1,"description-section"],[1,"classes-section"],[1,"floating-ledger-bar"],[1,"reservation-overlay"],[1,"error-toast"],[1,"dialog-overlay"],[3,"click"],[1,"no-seasons"],[1,"seasons-grid"],[1,"season-card",3,"selected"],[1,"season-card",3,"click"],[1,"season-dates"],[1,"season-year"],[1,"description-header",3,"click"],[1,"toggle-btn"],[1,"toggle-icon"],[1,"description-content"],[3,"content"],[1,"profile-alert"],[1,"alert-icon"],["width","24","height","24","viewBox","0 0 24 24","fill","currentColor"],["d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"],[1,"alert-content"],[1,"btn-go-profile",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","currentColor"],["d","M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"],[1,"no-classes"],[1,"classes-grid"],[3,"classData","currentPrice","status","showEarlyBird","isOnWaitlist","students","reservedStudentIds"],[3,"cardClick","waitlistClick","reserveClick","classData","currentPrice","status","showEarlyBird","isOnWaitlist","students","reservedStudentIds"],[1,"ledger-info"],[1,"ledger-count"],[1,"ledger-label"],[1,"btn-proceed-ledger",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","currentColor"],[1,"reservation-dialog"],[1,"spinner"],[1,"error-toast",3,"click"],[1,"dialog"],[1,"dialog-note"],[1,"dialog-loading"],[1,"dialog-error"],[1,"dialog-actions"],[1,"btn-cancel",3,"click"],[1,"btn-waitlist",3,"click","disabled"]],template:function(e,t){if(e&1&&(a(0,"div",0)(1,"h2"),r(2,"Select Season"),l(),c(3,Ce,2,0,"div",1),c(4,fe,6,1,"div",2),c(5,Se,2,1),c(6,ye,9,6,"div",3),c(7,Te,5,3,"div",4),c(8,Ie,10,1,"div",5),c(9,Le,5,0,"div",6),c(10,Ve,5,1,"div",7),c(11,Ne,18,4,"div",8),l()),e&2){let o,g;s(3),m(t.seasonService.loading()?3:-1),s(),m(t.seasonService.error()?4:-1),s(),m((o=t.seasonService.seasons())?5:-1,o),s(),m((g=t.seasonService.selectedSeason())!=null&&g.description?6:-1),s(),m(t.seasonService.selectedSeason()?7:-1),s(),m(t.orderService.hasLockedItems()||t.orderService.hasSubmittedItems()?8:-1),s(),m(t.reserving()?9:-1),s(),m(t.reservationError()?10:-1),s(),m(t.showWaitlistDialog()?11:-1)}},dependencies:[z,R,Q],styles:[".season-list[_ngcontent-%COMP%]{padding:1rem}h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;color:var(--sys-primary, #c62828)}.loading[_ngcontent-%COMP%]{text-align:center;padding:2rem;color:var(--sys-on-surface-variant, #666)}.error-message[_ngcontent-%COMP%]{background-color:var(--sys-error-container, #ffebee);color:var(--sys-on-error-container, #b71c1c);padding:1rem;border-radius:8px;margin-bottom:1rem;display:flex;justify-content:space-between;align-items:center}.error-message[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:var(--sys-on-error-container, #b71c1c);cursor:pointer;text-decoration:underline}.no-seasons[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:var(--sys-on-surface-variant, #666)}.seasons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem}.season-card[_ngcontent-%COMP%]{background:#fff;border:2px solid var(--sys-outline, #ccc);border-radius:12px;padding:1.5rem;cursor:pointer;transition:all .2s ease}.season-card[_ngcontent-%COMP%]:hover{border-color:var(--sys-primary, #c62828);box-shadow:0 4px 8px #0000001a;transform:translateY(-2px)}.season-card.selected[_ngcontent-%COMP%]{border-color:var(--sys-primary, #c62828);background-color:var(--sys-primary-container, #ffebee)}.season-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .75rem;color:var(--sys-primary, #c62828);font-size:1.25rem}.season-dates[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #666);font-size:.95rem;margin-bottom:.5rem}.season-year[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #999);font-size:.875rem;margin-top:.5rem}.classes-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:2rem;border-top:1px solid var(--sys-outline-variant, #e0e0e0)}.no-classes[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:var(--sys-on-surface-variant, #666)}.profile-alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem 1.25rem;background:linear-gradient(135deg,#fff3e0,#ffe0b2);border:1px solid #ffb74d;border-radius:12px;margin-bottom:1.5rem}.alert-icon[_ngcontent-%COMP%]{flex-shrink:0;color:#f57c00}.alert-content[_ngcontent-%COMP%]{flex:1}.alert-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;color:#e65100;font-size:.95rem;margin-bottom:.25rem}.alert-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#bf360c;font-size:.85rem;line-height:1.4}.btn-go-profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.4rem;padding:.6rem 1rem;background:#f57c00;color:#fff;border:none;border-radius:8px;font-weight:600;font-size:.85rem;cursor:pointer;white-space:nowrap;transition:background .2s}.btn-go-profile[_ngcontent-%COMP%]:hover{background:#e65100}@media(max-width:600px){.profile-alert[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;text-align:left}.btn-go-profile[_ngcontent-%COMP%]{width:100%;justify-content:center}}.classes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem}.description-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--sys-outline-variant, #e0e0e0)}.description-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;cursor:pointer;padding:.5rem 0;margin-bottom:1rem}.description-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem}.toggle-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;background:var(--sys-primary-container, #ffebee);color:var(--sys-on-primary-container, #c62828);border:none;padding:.5rem 1rem;border-radius:8px;cursor:pointer;font-size:.875rem;font-weight:500;transition:background-color .2s ease}.toggle-btn[_ngcontent-%COMP%]:hover{background:var(--sys-primary, #c62828);color:#fff}.toggle-icon[_ngcontent-%COMP%]{transition:transform .3s ease;font-size:.75rem}.toggle-icon.expanded[_ngcontent-%COMP%]{transform:rotate(180deg)}.description-content[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline-variant, #e0e0e0);border-radius:12px;padding:1.5rem 2rem;max-height:70vh;overflow-y:auto;line-height:1.7;font-size:1rem;color:var(--sys-on-surface, #333)}.dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.dialog[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;max-width:400px;width:100%;box-shadow:0 8px 32px #0003}.dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-on-surface, #212121)}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-on-surface-variant, #666)}.dialog-loading[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.75rem;padding:2rem;color:var(--sys-on-surface-variant, #666)}.spinner[_ngcontent-%COMP%]{width:24px;height:24px;border:2px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.dialog-empty[_ngcontent-%COMP%]{text-align:center;padding:1rem}.dialog-empty[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem}.student-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-bottom:1rem}.student-option[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:var(--sys-surface-variant, #f5f5f5);border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;cursor:pointer;transition:all .2s ease}.student-option[_ngcontent-%COMP%]:hover{background:var(--sys-tertiary-container, #e3f2fd);border-color:var(--sys-tertiary, #1976d2)}.student-name[_ngcontent-%COMP%]{font-weight:500;color:var(--sys-on-surface, #212121)}.student-age[_ngcontent-%COMP%]{font-size:.875rem;color:var(--sys-on-surface-variant, #666)}.dialog-error[_ngcontent-%COMP%]{background:var(--sys-error-container, #ffebee);color:var(--sys-on-error-container, #b71c1c);padding:.75rem 1rem;border-radius:8px;margin-bottom:1rem;font-size:.875rem}.dialog-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-top:1rem}.btn-secondary[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--sys-tertiary, #1976d2);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:500}.btn-secondary[_ngcontent-%COMP%]:hover{background:var(--sys-tertiary-dark, #0d47a1)}.btn-cancel[_ngcontent-%COMP%]{flex:1;padding:.75rem 1rem;background:#fff;color:var(--sys-on-surface-variant, #666);border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;cursor:pointer}.btn-cancel[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}.btn-waitlist[_ngcontent-%COMP%]{flex:1;padding:.75rem 1rem;background:var(--sys-tertiary, #1976d2);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:500}.btn-waitlist[_ngcontent-%COMP%]:hover{background:var(--sys-tertiary-dark, #0d47a1)}.btn-waitlist[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.floating-ledger-bar[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:1px solid var(--sys-outline-variant, #e0e0e0);box-shadow:0 -4px 20px #00000026;padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;z-index:100}.ledger-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.ledger-count[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);color:#fff;width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.9rem}.ledger-label[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #666);font-size:.95rem}.btn-proceed-ledger[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:background .2s}.btn-proceed-ledger[_ngcontent-%COMP%]:hover{background:var(--sys-primary-dark, #8e0000)}.reservation-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0006;display:flex;align-items:center;justify-content:center;z-index:1000}.reservation-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;display:flex;align-items:center;gap:1rem;box-shadow:0 8px 32px #0003}.error-toast[_ngcontent-%COMP%]{position:fixed;bottom:80px;left:50%;transform:translate(-50%);background:var(--sys-error, #c62828);color:#fff;padding:.75rem 1.25rem;border-radius:8px;display:flex;align-items:center;gap:1rem;z-index:200;box-shadow:0 4px 12px #0003;cursor:pointer}.error-toast[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#fff3;border:none;color:#fff;padding:.25rem .75rem;border-radius:4px;cursor:pointer}@media(max-width:600px){.description-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.75rem}.description-content[_ngcontent-%COMP%]{padding:1rem;max-height:60vh}.markdown-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5em}.markdown-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.3em}.markdown-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.15em}}"]})};export{X as SeasonListComponent};
