import{a as re}from"./chunk-FYN4I52K.js";import{a as ae}from"./chunk-4CC2DXAZ.js";import{b as G,c as J,d as Z,e as K,f as Q,g as X,i as ee,j as te,k as ne,n as ie,r as oe}from"./chunk-U4YJGQVE.js";import{a as Y}from"./chunk-FYGYBRKK.js";import{b as $}from"./chunk-NR6WXTS5.js";import"./chunk-L5OFKJS2.js";import{a as U}from"./chunk-EUESG25O.js";import{b as H}from"./chunk-3NM435RE.js";import{Ga as B,b as N,d as L,j,k as W,ua as F,va as z}from"./chunk-UIQMLXH2.js";import{Bb as a,Cb as g,Db as f,Eb as A,Hb as O,Ia as r,Ib as S,Jb as w,Ob as k,R as M,Sb as h,Ta as R,Vb as V,W as m,X as p,bb as u,cb as _,db as E,eb as b,fb as y,gb as C,ha as D,hb as t,ib as n,jb as P,nb as v,pb as x,rb as s}from"./chunk-6GAPJCXB.js";function de(i){switch(i){case"submitted":return"status-badge status-submitted";case"paid":return"status-badge status-paid";case"cancelled":return"status-badge status-cancelled";case"change_requested":return"status-badge status-change-requested";case"refunded":return"status-badge status-refunded";case"partial":return"status-badge status-partial";case"empty":return"status-badge status-empty";default:return"status-badge"}}function le(i){switch(i){case"submitted":return"Pending Payment";case"paid":return"Paid";case"cancelled":return"Cancelled";case"change_requested":return"Change Requested";case"refunded":return"Refunded";case"partial":return"Partially Paid";case"empty":return"Empty";default:return i}}function se(i){switch(i){case"submitted":return"item-status-badge item-status-submitted";case"paid":return"item-status-badge item-status-paid";case"cancelled":return"item-status-badge item-status-cancelled";case"refunded":return"item-status-badge item-status-refunded";default:return"item-status-badge"}}function ce(i){switch(i){case"submitted":return"Pending";case"paid":return"Paid";case"cancelled":return"Cancelled";case"refunded":return"Refunded";default:return i}}function me(i){return`$${(i/100).toFixed(2)}`}function T(i){let o=i.replace(/[^0-9.]/g,""),e=parseFloat(o)||0;return Math.round(e*100)}function q(i){return(i/100).toFixed(2)}function pe(i){return new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}function ue(i){return new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}var Ce=(i,o)=>({"text-danger":i,"text-warning":o}),fe=(i,o)=>({"text-success":i,"text-danger":o}),I=(i,o)=>o.sessionId+"-"+o.studentId,he=(i,o)=>o.sessionId,ve=(i,o)=>o.id;function be(i,o){i&1&&(t(0,"div",1),P(1,"div",5),t(2,"p"),a(3,"Loading order details..."),n()())}function ye(i,o){if(i&1){let e=v();t(0,"div",2)(1,"strong"),a(2,"Error:"),n(),a(3),t(4,"button",6),x("click",function(){m(e);let d=s();return p(d.clearError())}),a(5,"\xD7"),n()()}if(i&2){let e=s();r(3),f(" ",e.error()," ")}}function Oe(i,o){if(i&1&&(t(0,"div",18)(1,"span",19),a(2,"Phone:"),n(),t(3,"span",21),a(4),n()()),i&2){let e=s(3);r(4),g(e.userData().phone)}}function Se(i,o){if(i&1&&(t(0,"div",18)(1,"span",19),a(2,"Address:"),n(),t(3,"span",21),a(4),n()()),i&2){let e=s(3);r(4),g(e.userData().address)}}function we(i,o){if(i&1&&(t(0,"div",15)(1,"h2"),a(2,"User Information"),n(),t(3,"div",33)(4,"div",18)(5,"span",19),a(6,"Name:"),n(),t(7,"span",21),a(8),n()(),t(9,"div",18)(10,"span",19),a(11,"Email:"),n(),t(12,"span",21),a(13),n()(),u(14,Oe,5,1,"div",18),u(15,Se,5,1,"div",18),n()()),i&2){let e=s(2);r(8),g(e.userData().displayName),r(5),g(e.userData().email),r(),_(e.userData().phone?14:-1),r(),_(e.userData().address?15:-1)}}function Pe(i,o){if(i&1&&(t(0,"span",35),a(1),n()),i&2){let e=s(3);r(),A(" (",e.remainingLockTime().hours,"h ",e.remainingLockTime().minutes,"m remaining) ")}}function Me(i,o){if(i&1&&(t(0,"div",18)(1,"span",19),a(2,"Lock Expires:"),n(),t(3,"span",34),a(4),u(5,Pe,2,2,"span",35),n()()),i&2){let e=s(2);r(3),C("ngClass",k(3,Ce,e.isOverdue(),e.isExpiringSoon())),r(),f(" ",e.formatDateTime(e.order().lockExpiresAt)," "),r(),_(e.remainingLockTime()?5:-1)}}function De(i,o){i&1&&(t(0,"div",22)(1,"strong"),a(2,"\u26A0\uFE0F Overdue:"),n(),a(3," This order's payment lock has expired. Items may be released. "),n())}function Ee(i,o){if(i&1){let e=v();t(0,"button",36),x("click",function(){m(e);let d=s(2);return p(d.openCancelItemsDialog())}),a(1," Cancel Items "),n()}}function Ie(i,o){if(i&1&&(t(0,"div",40)(1,"div",41)(2,"span",42),a(3),n(),t(4,"span",43),a(5),n()(),t(6,"div",44)(7,"div",45)(8,"span",19),a(9,"Student:"),n(),t(10,"span",21),a(11),n()(),t(12,"div",45)(13,"span",19),a(14,"Options:"),n(),t(15,"span",21),P(16,"app-option-badges",46),n()()()()),i&2){let e=o.$implicit,l=s(3);r(3),g(l.getClassName(e.sessionId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," "),r(6),g(l.getStudentName(e.studentId)),r(5),C("options",e.options)("showEmpty",!0)}}function Ae(i,o){if(i&1&&(t(0,"div",26)(1,"h3",37),a(2," Paid Items "),t(3,"span",38),a(4),n()(),t(5,"div",39),b(6,Ie,17,6,"div",40,I),n()()),i&2){let e=s(2);r(4),f("(",e.paidItems().length,")"),r(2),y(e.paidItems())}}function ke(i,o){if(i&1&&(t(0,"div",47)(1,"div",41)(2,"span",42),a(3),n(),t(4,"span",43),a(5),n()(),t(6,"div",44)(7,"div",45)(8,"span",19),a(9,"Student:"),n(),t(10,"span",21),a(11),n()(),t(12,"div",45)(13,"span",19),a(14,"Options:"),n(),t(15,"span",21),P(16,"app-option-badges",46),n()()()()),i&2){let e=o.$implicit,l=s(3);r(3),g(l.getClassName(e.sessionId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," "),r(6),g(l.getStudentName(e.studentId)),r(5),C("options",e.options)("showEmpty",!0)}}function Te(i,o){if(i&1&&(t(0,"div",26)(1,"h3",37),a(2," Pending Payment "),t(3,"span",38),a(4),n()(),t(5,"div",39),b(6,ke,17,6,"div",47,I),n()()),i&2){let e=s(2);r(4),f("(",e.submittedItems().length,")"),r(2),y(e.submittedItems())}}function qe(i,o){if(i&1&&(t(0,"div",48)(1,"div",41)(2,"span",42),a(3),n(),t(4,"span",43),a(5),n()(),t(6,"div",44)(7,"div",45)(8,"span",19),a(9,"Student:"),n(),t(10,"span",21),a(11),n()()()()),i&2){let e=o.$implicit,l=s(3);r(3),g(l.getClassName(e.sessionId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," "),r(6),g(l.getStudentName(e.studentId))}}function Re(i,o){if(i&1&&(t(0,"div",26)(1,"h3",37),a(2," Cancelled Items "),t(3,"span",38),a(4),n()(),t(5,"div",39),b(6,qe,12,4,"div",48,I),n()()),i&2){let e=s(2);r(4),f("(",e.cancelledItems().length,")"),r(2),y(e.cancelledItems())}}function Ve(i,o){i&1&&(t(0,"div",27)(1,"p"),a(2,"No items in this order."),n()())}function Ne(i,o){if(i&1&&(t(0,"div",57)(1,"span",19),a(2),n(),t(3,"span",58),a(4),n()()),i&2){let e=o.$implicit,l=s(4);r(2),f("",e.type,":"),r(2),f(" ",l.formatCurrency(e.amount)," ")}}function Le(i,o){if(i&1&&(t(0,"div",51)(1,"div",56),a(2,"Discounts:"),n(),b(3,Ne,5,2,"div",57,E),n()),i&2){let e=s(3);r(3),y(e.order().pricing.discounts)}}function je(i,o){if(i&1&&(t(0,"div",28)(1,"h2"),a(2,"Pricing Summary"),n(),t(3,"div",49)(4,"div",50)(5,"span",19),a(6,"Subtotal:"),n(),t(7,"span",21),a(8),n()(),u(9,Le,5,0,"div",51),t(10,"div",52)(11,"span",19),a(12,"Total Due:"),n(),t(13,"span",53),a(14),n()(),t(15,"div",50)(16,"span",19),a(17,"Total Paid:"),n(),t(18,"span",21),a(19),n()(),t(20,"div",54)(21,"span",19),a(22,"Balance:"),n(),t(23,"span",55),a(24),n()()()()),i&2){let e=s(2);r(8),g(e.formatCurrency(e.order().pricing.subtotal)),r(),_(e.order().pricing.discounts.length>0?9:-1),r(5),g(e.formatCurrency(e.totalDue())),r(5),g(e.formatCurrency(e.order().totalPaid)),r(),C("ngClass",k(6,fe,e.amountDue()<=0,e.amountDue()>0)),r(4),g(e.formatCurrency(e.amountDue()))}}function We(i,o){if(i&1&&(t(0,"tr")(1,"td"),a(2),n(),t(3,"td",60),a(4),n(),t(5,"td")(6,"span",61),a(7),n()(),t(8,"td"),a(9),n(),t(10,"td"),a(11),n()()),i&2){let e=o.$implicit,l=s(3);r(2),g(l.formatDateTime(e.recordedAt)),r(2),g(l.formatCurrency(e.amount)),r(3),g(e.method),r(2),g(e.reference),r(2),g(e.notes||"-")}}function Fe(i,o){if(i&1&&(t(0,"div",29)(1,"h2"),a(2,"Payment History"),n(),t(3,"table",59)(4,"thead")(5,"tr")(6,"th"),a(7,"Date"),n(),t(8,"th"),a(9,"Amount"),n(),t(10,"th"),a(11,"Method"),n(),t(12,"th"),a(13,"Reference"),n(),t(14,"th"),a(15,"Notes"),n()()(),t(16,"tbody"),b(17,We,12,5,"tr",null,E),n()()()),i&2){let e=s(2);r(17),y(e.payments())}}function ze(i,o){i&1&&(t(0,"span",65),a(1,"Promoted"),n())}function Be(i,o){if(i&1){let e=v();t(0,"button",68),x("click",function(){m(e);let d=s().$implicit,c=s(3);return p(c.openPromoteWaitlistDialog(d.sessionId))}),a(1," Promote Entry "),n()}}function $e(i,o){if(i&1&&(t(0,"div",63)(1,"div",64)(2,"span",42),a(3),n(),u(4,ze,2,0,"span",65),n(),t(5,"div",66)(6,"div",45)(7,"span",19),a(8,"Joined:"),n(),t(9,"span",21),a(10),n()()(),u(11,Be,2,0,"button",67),n()),i&2){let e=o.$implicit,l=s(3);r(3),g(l.getClassName(e.sessionId)),r(),_(e.isPromoted?4:-1),r(6),g(l.formatDateTime(e.joinedAt)),r(),_(e.isPromoted?-1:11)}}function Ue(i,o){if(i&1&&(t(0,"div",30)(1,"h2"),a(2,"Waitlist Entries"),n(),t(3,"div",62),b(4,$e,12,4,"div",63,he),n()()),i&2){let e=s(2);r(4),y(e.waitlistEntries())}}function Ye(i,o){if(i&1&&(t(0,"div",77),a(1),n()),i&2){let e=o.$implicit,l=s(4);r(),f(" ",l.getActionDescription(e)," ")}}function He(i,o){if(i&1&&(t(0,"div",79)(1,"span",19),a(2,"Reason:"),n(),t(3,"span",21),a(4),n()()),i&2){let e=s().$implicit;r(4),g(e.reason)}}function Ge(i,o){if(i&1&&(t(0,"div",79)(1,"span",19),a(2,"Admin Adjustment:"),n(),t(3,"span",34),a(4),n()()),i&2){let e=s().$implicit,l=s(3);r(3),C("ngClass",e.adminAdjustment<0?"text-success":"text-danger"),r(),A(" ",e.adminAdjustment<0?"-":"+","",l.formatCurrency(l.Math.abs(e.adminAdjustment))," ")}}function Je(i,o){if(i&1&&(t(0,"div",79)(1,"span",19),a(2,"Adjustment Reason:"),n(),t(3,"span",21),a(4),n()()),i&2){let e=s().$implicit;r(4),g(e.adminAdjustmentReason)}}function Ze(i,o){if(i&1&&(t(0,"div",79)(1,"span",19),a(2,"Processed:"),n(),t(3,"span",21),a(4),n()()),i&2){let e=s().$implicit,l=s(3);r(4),g(l.formatDateTime(e.processedAt))}}function Ke(i,o){if(i&1&&(t(0,"div",79)(1,"span",19),a(2,"Admin Notes:"),n(),t(3,"span",21),a(4),n()()),i&2){let e=s().$implicit;r(4),g(e.adminNotes)}}function Qe(i,o){if(i&1){let e=v();t(0,"button",81),x("click",function(){m(e);let d=s().$implicit,c=s(3);return p(c.openUpdateAdjustmentDialog(d))}),a(1," Edit Adjustment "),n(),t(2,"button",82),x("click",function(){m(e);let d=s().$implicit,c=s(3);return p(c.openApproveChangeDialog(d))}),a(3," Approve "),n(),t(4,"button",36),x("click",function(){m(e);let d=s().$implicit,c=s(3);return p(c.openDenyChangeDialog(d))}),a(5," Deny "),n()}}function Xe(i,o){if(i&1&&(t(0,"div",70)(1,"div",71)(2,"div",72)(3,"span",73),a(4),n(),t(5,"span",74),a(6),n()()(),t(7,"div",75)(8,"div",76)(9,"strong"),a(10,"Actions:"),n(),b(11,Ye,2,1,"div",77,E),n(),t(13,"div",78)(14,"div",79)(15,"span",19),a(16,"Requested:"),n(),t(17,"span",21),a(18),n()(),u(19,He,5,1,"div",79),u(20,Ge,5,3,"div",79),u(21,Je,5,1,"div",79),u(22,Ze,5,1,"div",79),u(23,Ke,5,1,"div",79),n()(),t(24,"div",80),u(25,Qe,6,0),n()()),i&2){let e=o.$implicit,l=s(3);C("ngClass","status-"+e.status),r(4),g(e.id),r(),C("ngClass","status-"+e.status),r(),f(" ",l.getChangeStatusLabel(e.status)," "),r(5),y(e.actions),r(7),g(l.formatDateTime(e.requestedAt)),r(),_(e.reason?19:-1),r(),_(e.adminAdjustment!==0?20:-1),r(),_(e.adminAdjustmentReason?21:-1),r(),_(e.processedAt?22:-1),r(),_(e.adminNotes?23:-1),r(2),_(e.status==="pending"?25:-1)}}function et(i,o){if(i&1&&(t(0,"div",31)(1,"h2"),a(2,"Change Requests"),n(),t(3,"div",69),b(4,Xe,26,11,"div",70,ve),n()()),i&2){let e=s(2);r(4),y(e.changeRequests())}}function tt(i,o){if(i&1&&(t(0,"div",88),a(1),n()),i&2){let e=s().$implicit;r(),g(e.details)}}function nt(i,o){if(i&1&&(t(0,"div",84)(1,"div",85),a(2),n(),t(3,"div",86)(4,"div",87),a(5),n(),u(6,tt,2,1,"div",88),n()()),i&2){let e=o.$implicit,l=s(3);r(2),g(l.formatDateTime(e.timestamp)),r(3),g(e.action),r(),_(e.details?6:-1)}}function it(i,o){if(i&1&&(t(0,"div",32)(1,"h2"),a(2,"Order History"),n(),t(3,"div",83),b(4,nt,7,3,"div",84,E),n()()),i&2){let e=s(2);r(4),y(e.order().history)}}function ot(i,o){if(i&1){let e=v();t(0,"div",3)(1,"div",7)(2,"div",8)(3,"a",9),a(4,"\u2190 Back to Orders"),n(),t(5,"h1"),a(6,"Order Details"),n(),t(7,"div",10)(8,"span",11),a(9),n(),t(10,"span",12),a(11),n()()(),t(12,"div",13)(13,"button",14),x("click",function(){m(e);let d=s();return p(d.openRecordPaymentDialog())}),a(14," Record Payment "),n()()(),u(15,we,16,4,"div",15),t(16,"div",16)(17,"h2"),a(18,"Order Status"),n(),t(19,"div",17)(20,"div",18)(21,"span",19),a(22,"Status:"),n(),t(23,"span",20),a(24),n()(),u(25,Me,6,6,"div",18),t(26,"div",18)(27,"span",19),a(28,"Created:"),n(),t(29,"span",21),a(30),n()(),t(31,"div",18)(32,"span",19),a(33,"Last Updated:"),n(),t(34,"span",21),a(35),n()()(),u(36,De,4,0,"div",22),n(),t(37,"div",23)(38,"div",24)(39,"h2"),a(40,"Order Items"),n(),u(41,Ee,2,0,"button",25),n(),u(42,Ae,8,1,"div",26),u(43,Te,8,1,"div",26),u(44,Re,8,1,"div",26),u(45,Ve,3,0,"div",27),n(),u(46,je,25,9,"div",28),u(47,Fe,19,0,"div",29),u(48,Ue,6,0,"div",30),u(49,et,6,0,"div",31),u(50,it,6,0,"div",32),n()}if(i&2){let e=s();r(9),f("User: ",e.order().userDisplayId),r(),C("ngClass",e.getStatusBadgeClass(e.getOrderStatus(e.order()))),r(),f(" ",e.getStatusLabel(e.getOrderStatus(e.order()))," "),r(2),C("disabled",!e.canRecordPayment()),r(2),_(e.userData()?15:-1),r(8),C("ngClass",e.getStatusBadgeClass(e.getOrderStatus(e.order()))),r(),f(" ",e.getStatusLabel(e.getOrderStatus(e.order()))," "),r(),_(e.order().lockExpiresAt?25:-1),r(5),g(e.formatDateTime(e.order().createdAt)),r(5),g(e.formatDateTime(e.order().updatedAt)),r(),_(e.isOverdue()?36:-1),r(5),_(e.cancellableItems().length>0?41:-1),r(),_(e.paidItems().length>0?42:-1),r(),_(e.submittedItems().length>0?43:-1),r(),_(e.cancelledItems().length>0?44:-1),r(),_(e.allItems().length===0?45:-1),r(),_(e.order().pricing?46:-1),r(),_(e.payments().length>0?47:-1),r(),_(e.waitlistEntries().length>0?48:-1),r(),_(e.changeRequests().length>0?49:-1),r(),_(e.order().history&&e.order().history.length>0?50:-1)}}function at(i,o){if(i&1&&(t(0,"div",22),a(1),n()),i&2){let e=s(2);r(),g(e.actionError())}}function rt(i,o){i&1&&(P(0,"span",111),a(1," Recording... "))}function dt(i,o){i&1&&a(0," Record Payment ")}function lt(i,o){if(i&1){let e=v();t(0,"div",89),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),t(1,"div",90),x("click",function(d){return m(e),p(d.stopPropagation())}),t(2,"div",91)(3,"h3"),a(4,"Record Payment"),n(),t(5,"button",6),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(6,"\xD7"),n()(),t(7,"div",92)(8,"form",93),x("ngSubmit",function(){m(e);let d=s();return p(d.recordPayment())}),t(9,"div",94)(10,"label",95),a(11,"Amount *"),n(),t(12,"input",96),w("ngModelChange",function(d){m(e);let c=s();return S(c.formPayment.amountInput,d)||(c.formPayment.amountInput=d),p(d)}),n(),t(13,"small",97),a(14),n()(),t(15,"div",94)(16,"label",98),a(17,"Payment Method *"),n(),t(18,"select",99),w("ngModelChange",function(d){m(e);let c=s();return S(c.formPayment.method,d)||(c.formPayment.method=d),p(d)}),t(19,"option",100),a(20,"Zelle"),n(),t(21,"option",101),a(22,"Check"),n(),t(23,"option",102),a(24,"Cash"),n(),t(25,"option",103),a(26,"Other"),n()()(),t(27,"div",94)(28,"label",104),a(29),n(),t(30,"input",105),w("ngModelChange",function(d){m(e);let c=s();return S(c.formPayment.reference,d)||(c.formPayment.reference=d),p(d)}),n()(),t(31,"div",94)(32,"label",106),a(33,"Notes"),n(),t(34,"textarea",107),w("ngModelChange",function(d){m(e);let c=s();return S(c.formPayment.notes,d)||(c.formPayment.notes=d),p(d)}),n()(),u(35,at,2,1,"div",22),t(36,"div",108)(37,"button",109),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(38," Cancel "),n(),t(39,"button",110),u(40,rt,2,0)(41,dt,1,0),n()()()()()()}if(i&2){let e=s();r(12),O("ngModel",e.formPayment.amountInput),r(2),f(" Amount due: ",e.formatCurrency(e.amountDue())," "),r(4),O("ngModel",e.formPayment.method),r(11),f(" Reference ",e.formPayment.method!=="cash"?"*":"(optional)"," "),r(),O("ngModel",e.formPayment.reference),C("placeholder",e.formPayment.method==="cash"?"Optional for cash payments":"Confirmation number, check number, etc.")("required",e.formPayment.method!=="cash"),r(4),O("ngModel",e.formPayment.notes),r(),_(e.actionError()?35:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),_(e.actionLoading()?40:41)}}function st(i,o){if(i&1){let e=v();t(0,"label",113)(1,"input",118),x("change",function(){let d=m(e).$implicit,c=s(2);return p(c.toggleItemSelection(d))}),n(),t(2,"span",119)(3,"span",42),a(4),n(),a(5," - "),t(6,"span",120),a(7),n(),t(8,"span",43),a(9),n()()()}if(i&2){let e=o.$implicit,l=s(2);r(),C("checked",l.isItemSelected(e)),r(3),g(l.getClassName(e.sessionId)),r(3),g(l.getStudentName(e.studentId)),r(),C("ngClass",l.getItemStatusBadgeClass(e.status)),r(),f(" ",l.getItemStatusLabel(e.status)," ")}}function ct(i,o){if(i&1&&(t(0,"div",22),a(1),n()),i&2){let e=s(2);r(),g(e.actionError())}}function mt(i,o){i&1&&(P(0,"span",111),a(1," Cancelling... "))}function pt(i,o){if(i&1&&a(0),i&2){let e=s(2);f(" Cancel ",e.selectedItems().size," Item(s) ")}}function ut(i,o){if(i&1){let e=v();t(0,"div",89),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),t(1,"div",90),x("click",function(d){return m(e),p(d.stopPropagation())}),t(2,"div",91)(3,"h3"),a(4,"Cancel Order Items"),n(),t(5,"button",6),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(6,"\xD7"),n()(),t(7,"div",92)(8,"form",93),x("ngSubmit",function(){m(e);let d=s();return p(d.cancelItems())}),t(9,"div",94)(10,"label"),a(11,"Select items to cancel:"),n(),t(12,"div",112),b(13,st,10,5,"label",113,I),n()(),t(15,"div",94)(16,"label",114),a(17,"Cancellation Reason *"),n(),t(18,"textarea",115),w("ngModelChange",function(d){m(e);let c=s();return S(c.formCancel.reason,d)||(c.formCancel.reason=d),p(d)}),n()(),t(19,"div",116)(20,"strong"),a(21,"Refund Policy:"),n(),a(22),n(),u(23,ct,2,1,"div",22),t(24,"div",108)(25,"button",109),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(26," Cancel "),n(),t(27,"button",117),u(28,mt,2,0)(29,pt,1,1),n()()()()()()}if(i&2){let e=s();r(13),y(e.cancellableItems()),r(5),O("ngModel",e.formCancel.reason),r(4),f(" Cancelling paid items may incur a refund processing fee of ",e.formatCurrency(e.refundFee()),". "),r(),_(e.actionError()?23:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()||e.selectedItems().size===0),r(),_(e.actionLoading()?28:29)}}function _t(i,o){if(i&1&&(t(0,"div",22),a(1),n()),i&2){let e=s(2);r(),g(e.actionError())}}function gt(i,o){i&1&&(P(0,"span",111),a(1," Promoting... "))}function xt(i,o){i&1&&a(0," Promote Entry ")}function Ct(i,o){if(i&1){let e=v();t(0,"div",89),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),t(1,"div",90),x("click",function(d){return m(e),p(d.stopPropagation())}),t(2,"div",91)(3,"h3"),a(4,"Promote Waitlist Entry"),n(),t(5,"button",6),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(6,"\xD7"),n()(),t(7,"div",92)(8,"form",93),x("ngSubmit",function(){m(e);let d=s();return p(d.promoteWaitlist())}),t(9,"div",94)(10,"label"),a(11,"Class:"),n(),t(12,"div",121),a(13),n()(),t(14,"div",94)(15,"label",122),a(16,"Notes"),n(),t(17,"textarea",123),w("ngModelChange",function(d){m(e);let c=s();return S(c.formPromoteWaitlist.notes,d)||(c.formPromoteWaitlist.notes=d),p(d)}),n()(),t(18,"div",124),a(19," This will bypass the waitlist maturity rule and allow the user to immediately claim a spot if a vacancy becomes available. "),n(),u(20,_t,2,1,"div",22),t(21,"div",108)(22,"button",109),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(23," Cancel "),n(),t(24,"button",110),u(25,gt,2,0)(26,xt,1,0),n()()()()()()}if(i&2){let e=s();r(13),f(" ",e.getClassName(e.formPromoteWaitlist.sessionId)," "),r(4),O("ngModel",e.formPromoteWaitlist.notes),r(3),_(e.actionError()?20:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),_(e.actionLoading()?25:26)}}function ft(i,o){if(i&1&&(t(0,"div",22),a(1),n()),i&2){let e=s(2);r(),g(e.actionError())}}function ht(i,o){i&1&&(P(0,"span",111),a(1," Saving... "))}function vt(i,o){i&1&&a(0," Save Adjustment ")}function bt(i,o){if(i&1){let e=v();t(0,"div",89),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),t(1,"div",90),x("click",function(d){return m(e),p(d.stopPropagation())}),t(2,"div",91)(3,"h3"),a(4,"Update Adjustment"),n(),t(5,"button",6),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(6,"\xD7"),n()(),t(7,"div",92)(8,"form",93),x("ngSubmit",function(){m(e);let d=s();return p(d.updateAdjustment())}),t(9,"div",94)(10,"label"),a(11,"Request ID:"),n(),t(12,"div",121),a(13),n()(),t(14,"div",94)(15,"label",125),a(16,"Extra Fee (+) or Credit (-)"),n(),t(17,"input",126),w("ngModelChange",function(d){m(e);let c=s();return S(c.formChangeRequest.adjustmentInput,d)||(c.formChangeRequest.adjustmentInput=d),p(d)}),n(),t(18,"small",97),a(19,"Positive values add a fee, negative values give a credit"),n()(),t(20,"div",94)(21,"label",127),a(22,"Reason"),n(),t(23,"textarea",128),w("ngModelChange",function(d){m(e);let c=s();return S(c.formChangeRequest.adjustmentReason,d)||(c.formChangeRequest.adjustmentReason=d),p(d)}),n()(),t(24,"div",94)(25,"label",129),a(26,"Admin Notes"),n(),t(27,"textarea",130),w("ngModelChange",function(d){m(e);let c=s();return S(c.formChangeRequest.adminNotes,d)||(c.formChangeRequest.adminNotes=d),p(d)}),n()(),t(28,"div",124),a(29," The user will see this adjustment. You can update it multiple times before approving. "),n(),u(30,ft,2,1,"div",22),t(31,"div",108)(32,"button",109),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(33," Cancel "),n(),t(34,"button",110),u(35,ht,2,0)(36,vt,1,0),n()()()()()()}if(i&2){let e=s();r(13),g(e.formChangeRequest.requestId),r(4),O("ngModel",e.formChangeRequest.adjustmentInput),r(6),O("ngModel",e.formChangeRequest.adjustmentReason),r(4),O("ngModel",e.formChangeRequest.adminNotes),r(3),_(e.actionError()?30:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),_(e.actionLoading()?35:36)}}function yt(i,o){if(i&1&&(t(0,"div",132),a(1),n()),i&2){let e=o.$implicit,l=s(2);r(),g(l.getActionDescription(e))}}function Ot(i,o){if(i&1&&(t(0,"div",22),a(1),n()),i&2){let e=s(2);r(),g(e.actionError())}}function St(i,o){i&1&&(P(0,"span",111),a(1," Approving... "))}function wt(i,o){i&1&&a(0," Approve Changes ")}function Pt(i,o){if(i&1){let e=v();t(0,"div",89),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),t(1,"div",90),x("click",function(d){return m(e),p(d.stopPropagation())}),t(2,"div",91)(3,"h3"),a(4,"Approve Change Request"),n(),t(5,"button",6),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(6,"\xD7"),n()(),t(7,"div",92)(8,"form",93),x("ngSubmit",function(){m(e);let d=s();return p(d.approveChange())}),t(9,"div",94)(10,"label"),a(11,"Request ID:"),n(),t(12,"div",121),a(13),n()(),t(14,"div",94)(15,"label"),a(16,"Actions to apply:"),n(),t(17,"div",131),b(18,yt,2,1,"div",132,E),n()(),t(20,"div",94)(21,"label",133),a(22,"Admin Notes"),n(),t(23,"textarea",134),w("ngModelChange",function(d){m(e);let c=s();return S(c.formChangeRequest.adminNotes,d)||(c.formChangeRequest.adminNotes=d),p(d)}),n()(),t(24,"div",116),a(25," Approving will apply all changes to the order. Class removals will create vacancy holds for waitlist members. The order pricing will be recalculated. "),n(),u(26,Ot,2,1,"div",22),t(27,"div",108)(28,"button",109),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(29," Cancel "),n(),t(30,"button",110),u(31,St,2,0)(32,wt,1,0),n()()()()()()}if(i&2){let e=s();r(13),g(e.formChangeRequest.requestId),r(5),y(e.formChangeRequest.actions),r(5),O("ngModel",e.formChangeRequest.adminNotes),r(3),_(e.actionError()?26:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()),r(),_(e.actionLoading()?31:32)}}function Mt(i,o){if(i&1&&(t(0,"div",22),a(1),n()),i&2){let e=s(2);r(),g(e.actionError())}}function Dt(i,o){i&1&&(P(0,"span",111),a(1," Denying... "))}function Et(i,o){i&1&&a(0," Deny Request ")}function It(i,o){if(i&1){let e=v();t(0,"div",89),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),t(1,"div",90),x("click",function(d){return m(e),p(d.stopPropagation())}),t(2,"div",91)(3,"h3"),a(4,"Deny Change Request"),n(),t(5,"button",6),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(6,"\xD7"),n()(),t(7,"div",92)(8,"form",93),x("ngSubmit",function(){m(e);let d=s();return p(d.denyChange())}),t(9,"div",94)(10,"label"),a(11,"Request ID:"),n(),t(12,"div",121),a(13),n()(),t(14,"div",94)(15,"label",135),a(16,"Reason for Denial *"),n(),t(17,"textarea",136),w("ngModelChange",function(d){m(e);let c=s();return S(c.formChangeRequest.adminNotes,d)||(c.formChangeRequest.adminNotes=d),p(d)}),n()(),t(18,"div",124),a(19," The user will be notified that their change request was denied. No changes will be applied to their order. "),n(),u(20,Mt,2,1,"div",22),t(21,"div",108)(22,"button",109),x("click",function(){m(e);let d=s();return p(d.closeDialog())}),a(23," Cancel "),n(),t(24,"button",117),u(25,Dt,2,0)(26,Et,1,0),n()()()()()()}if(i&2){let e=s();r(13),g(e.formChangeRequest.requestId),r(4),O("ngModel",e.formChangeRequest.adminNotes),r(3),_(e.actionError()?20:-1),r(2),C("disabled",e.actionLoading()),r(2),C("disabled",e.actionLoading()||!e.formChangeRequest.adminNotes.trim()),r(),_(e.actionLoading()?25:26)}}var _e=class i{orderId=V.required();adminOrdersStore=M(re);orderRpc=M($);userService=M(H);seasonService=M(Y);configService=M(U);router=M(j);order=D(null);loading=D(!1);error=D(null);userData=D(null);actionLoading=this.orderRpc.loading;actionError=this.orderRpc.error;dialogMode=D(null);formPayment={amountInput:"",method:"zelle",reference:"",notes:""};formCancel={reason:""};selectedItems=D(new Set);formPromoteWaitlist={sessionId:"",notes:""};formChangeRequest={requestId:"",actions:[],adjustmentInput:"",adjustmentReason:"",adminNotes:""};Math=Math;allItems=h(()=>this.order()?.items??[]);paidItems=h(()=>{let o=this.order();return o?z(o):[]});submittedItems=h(()=>{let o=this.order();return o?F(o):[]});cancelledItems=h(()=>this.allItems().filter(o=>o.status==="cancelled"));cancellableItems=h(()=>[...this.paidItems(),...this.submittedItems()]);waitlistEntries=h(()=>this.order()?.waitlist??[]);payments=h(()=>this.order()?.payments??[]);changeRequests=h(()=>this.order()?.changeRequests??[]);totalDue=h(()=>{let o=this.order()?.pricing;return o?o.subtotal+o.discounts.reduce((e,l)=>e+l.amount,0):0});amountDue=h(()=>{let o=this.order();return o?this.totalDue()-o.totalPaid:0});refundFee=h(()=>this.seasonService.selectedSeason()?.refundProcessingFee??2e3);isOverdue=h(()=>{let o=this.order();if(!o||!o.lockExpiresAt)return!1;let e=this.configService.currentTime();return new Date(o.lockExpiresAt)<new Date(e)});isExpiringSoon=h(()=>{let o=this.order();if(!o||!o.lockExpiresAt)return!1;let e=this.configService.currentTime(),l=new Date(o.lockExpiresAt),d=new Date(e),c=(l.getTime()-d.getTime())/(1e3*60*60);return c>0&&c<=12});remainingLockTime=h(()=>{let o=this.order();if(!o||!o.lockExpiresAt)return null;let e=this.configService.currentTime(),l=new Date(o.lockExpiresAt),d=new Date(e),c=l.getTime()-d.getTime();if(c<=0)return null;let ge=Math.floor(c/(1e3*60*60)),xe=Math.floor(c%(1e3*60*60)/(1e3*60));return{hours:ge,minutes:xe}});canRecordPayment=h(()=>this.amountDue()>0);formatCurrency=me;formatDate=pe;formatDateTime=ue;getOrderStatus=B;getStatusBadgeClass=de;getStatusLabel=le;getItemStatusBadgeClass=se;getItemStatusLabel=ce;async ngOnInit(){if(!this.userService.isAuthenticated()){await this.router.navigate(["/login"]);return}await this.loadOrder()}async loadOrder(){this.loading.set(!0),this.error.set(null);try{let o=await this.adminOrdersStore.getOrder(this.orderId());this.order.set(o),await this.loadUserData(o.userDisplayId)}catch(o){let e=o instanceof Error?o.message:String(o);this.error.set(e)}finally{this.loading.set(!1)}}async loadUserData(o){try{let e=await this.userService.getUserByDisplayId(o);e&&this.userData.set({displayName:e.displayName,email:e.email,phone:e.contactInfo?.phone,address:e.contactInfo?.address?`${e.contactInfo.address.street}, ${e.contactInfo.address.city}, ${e.contactInfo.address.state} ${e.contactInfo.address.zipCode}`:void 0})}catch(e){console.error("Failed to load user data:",e)}}getClassName(o){return this.seasonService.classes().find(l=>l.id===o)?.name??o}getStudentName(o){return this.userData()?o:"Unknown Student"}openRecordPaymentDialog(){this.formPayment.amountInput=q(this.amountDue()),this.formPayment.method="zelle",this.formPayment.reference="",this.formPayment.notes="",this.dialogMode.set("record-payment")}openCancelItemsDialog(){this.selectedItems.set(new Set),this.formCancel.reason="",this.dialogMode.set("cancel-items")}openPromoteWaitlistDialog(o){this.formPromoteWaitlist.sessionId=o,this.formPromoteWaitlist.notes="",this.dialogMode.set("promote-waitlist")}closeDialog(){this.dialogMode.set(null),this.orderRpc.clearError()}isItemSelected(o){let e=`${o.sessionId}-${o.studentId}`;return this.selectedItems().has(e)}toggleItemSelection(o){let e=`${o.sessionId}-${o.studentId}`,l=new Set(this.selectedItems());l.has(e)?l.delete(e):l.add(e),this.selectedItems.set(l)}async recordPayment(){let o=this.order();if(!o)return;let e=T(this.formPayment.amountInput);if(e<=0){alert("Please enter a valid payment amount.");return}try{await this.orderRpc.recordPayment({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,amount:e,reference:this.formPayment.reference||void 0,method:this.formPayment.method,notes:this.formPayment.notes||void 0}),await this.loadOrder(),this.closeDialog()}catch(l){console.error("Failed to record payment:",l)}}async cancelItems(){if(this.order()){if(this.selectedItems().size===0){alert("Please select at least one item to cancel.");return}if(!this.formCancel.reason.trim()){alert("Please enter a cancellation reason.");return}try{let e=Array.from(this.selectedItems()).map(l=>{let[d,c]=l.split("-");return{sessionId:d,studentId:c}});await this.orderRpc.cancelItems({year:this.configService.currentActiveYear(),items:e,reason:this.formCancel.reason}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to cancel items:",e)}}}async promoteWaitlist(){let o=this.order();if(o)try{await this.orderRpc.promoteWaitlistEntry({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,sessionId:this.formPromoteWaitlist.sessionId,notes:this.formPromoteWaitlist.notes||void 0}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to promote waitlist entry:",e)}}getChangeStatusLabel(o){switch(o){case"pending":return"Pending";case"approved":return"Approved";case"denied":return"Denied";default:return o}}getActionDescription(o){let e=this.getClassName(o.target.sessionId),l=this.getStudentName(o.target.studentId);switch(o.type){case"remove_class":return`Remove from class: ${e} - ${l}`;case"add_addon":return`Add ${o.addon==="lunch"?"Lunch":"Extended Care"}: ${e} - ${l}`;case"remove_addon":return`Remove ${o.addon==="lunch"?"Lunch":"Extended Care"}: ${e} - ${l}`}}openUpdateAdjustmentDialog(o){this.formChangeRequest.requestId=o.id,this.formChangeRequest.actions=[...o.actions],this.formChangeRequest.adjustmentInput=o.adminAdjustment!==0?q(o.adminAdjustment):"",this.formChangeRequest.adjustmentReason=o.adminAdjustmentReason??"",this.formChangeRequest.adminNotes=o.adminNotes??"",this.dialogMode.set("update-adjustment")}openApproveChangeDialog(o){this.formChangeRequest.requestId=o.id,this.formChangeRequest.actions=[...o.actions],this.formChangeRequest.adminNotes=o.adminNotes??"",this.dialogMode.set("approve-change")}openDenyChangeDialog(o){this.formChangeRequest.requestId=o.id,this.formChangeRequest.actions=[...o.actions],this.formChangeRequest.adminNotes="",this.dialogMode.set("deny-change")}async updateAdjustment(){let o=this.order();if(o)try{let e=this.formChangeRequest.adjustmentInput.trim()?T(this.formChangeRequest.adjustmentInput):0;await this.orderRpc.updateChangeRequest({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminAdjustment:e,adminAdjustmentReason:this.formChangeRequest.adjustmentReason||void 0,adminNotes:this.formChangeRequest.adminNotes||void 0}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to update adjustment:",e)}}async approveChange(){let o=this.order();if(o)try{await this.orderRpc.approveChangeRequest({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminNotes:this.formChangeRequest.adminNotes||void 0}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to approve change request:",e)}}async denyChange(){let o=this.order();if(o&&this.formChangeRequest.adminNotes.trim())try{await this.orderRpc.denyChangeRequest({year:this.configService.currentActiveYear(),userAuthId:o.userAuthId,changeRequestId:this.formChangeRequest.requestId,adminNotes:this.formChangeRequest.adminNotes}),await this.loadOrder(),this.closeDialog()}catch(e){console.error("Failed to deny change request:",e)}}clearError(){this.error.set(null)}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=R({type:i,selectors:[["app-admin-order-detail"]],inputs:{orderId:[1,"orderId"]},decls:10,vars:9,consts:[[1,"admin-order-detail-container"],[1,"loading-state"],[1,"error-banner"],[1,"order-content"],[1,"modal-overlay"],[1,"spinner"],["type","button",1,"btn-close",3,"click"],[1,"order-header"],[1,"header-left"],["routerLink","/admin/orders",1,"back-link"],[1,"order-meta"],[1,"user-id"],[1,"status-badge",3,"ngClass"],[1,"header-actions"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"info-card","user-info-card"],[1,"info-card","status-card"],[1,"status-details"],[1,"detail-row"],[1,"label"],[1,"value","status-badge",3,"ngClass"],[1,"value"],[1,"alert","alert-danger"],[1,"info-card","items-card"],[1,"card-header"],["type","button",1,"btn","btn-danger-outline","btn-sm"],[1,"items-section"],[1,"empty-state"],[1,"info-card","pricing-card"],[1,"info-card","payments-card"],[1,"info-card","waitlist-card"],[1,"info-card","change-requests-card"],[1,"info-card","history-card"],[1,"user-details"],[1,"value",3,"ngClass"],[1,"remaining-time"],["type","button",1,"btn","btn-danger-outline","btn-sm",3,"click"],[1,"section-title"],[1,"item-count"],[1,"items-list"],[1,"item-card"],[1,"item-header"],[1,"class-name"],[1,"item-status-badge",3,"ngClass"],[1,"item-details"],[1,"detail-item"],[3,"options","showEmpty"],[1,"item-card","pending"],[1,"item-card","cancelled"],[1,"pricing-details"],[1,"pricing-row"],[1,"discounts-section"],[1,"pricing-row","total-row"],[1,"value","total"],[1,"pricing-row","balance-row",3,"ngClass"],[1,"value","balance"],[1,"discounts-header"],[1,"pricing-row","discount-row"],[1,"value","text-success"],[1,"payments-table"],[1,"amount"],[1,"method-badge"],[1,"waitlist-list"],[1,"waitlist-item"],[1,"waitlist-header"],[1,"promoted-badge"],[1,"waitlist-details"],["type","button",1,"btn","btn-primary-outline","btn-sm"],["type","button",1,"btn","btn-primary-outline","btn-sm",3,"click"],[1,"change-requests-list"],[1,"change-request-item",3,"ngClass"],[1,"request-header"],[1,"request-info"],[1,"request-id"],[1,"request-status-badge",3,"ngClass"],[1,"request-details"],[1,"request-actions-list"],[1,"request-action-row"],[1,"request-meta"],[1,"meta-item"],[1,"request-actions"],["type","button",1,"btn","btn-secondary","btn-sm",3,"click"],["type","button",1,"btn","btn-primary","btn-sm",3,"click"],[1,"history-timeline"],[1,"history-event"],[1,"event-time"],[1,"event-details"],[1,"event-action"],[1,"event-metadata"],[1,"modal-overlay",3,"click"],[1,"modal-dialog",3,"click"],[1,"modal-header"],[1,"modal-body"],[3,"ngSubmit"],[1,"form-group"],["for","payment-amount"],["type","text","id","payment-amount","name","amount","placeholder","0.00","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text"],["for","payment-method"],["id","payment-method","name","method","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","zelle"],["value","check"],["value","cash"],["value","other"],["for","payment-reference"],["type","text","id","payment-reference","name","reference",1,"form-control",3,"ngModelChange","ngModel","placeholder","required"],["for","payment-notes"],["id","payment-notes","name","notes","rows","3","placeholder","Optional notes...",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"spinner-small"],[1,"items-checklist"],[1,"checkbox-item"],["for","cancel-reason"],["id","cancel-reason","name","reason","rows","3","placeholder","Enter reason for cancellation...","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-warning"],["type","submit",1,"btn","btn-danger",3,"disabled"],["type","checkbox",3,"change","checked"],[1,"item-info"],[1,"student-name"],[1,"read-only-value"],["for","promote-notes"],["id","promote-notes","name","notes","rows","3","placeholder","Optional notes for promotion reason...",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-info"],["for","adjustment-amount"],["type","text","id","adjustment-amount","name","adjustment","placeholder","0.00 (positive = fee, negative = credit)",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-reason"],["id","adjustment-reason","name","adjustmentReason","rows","2","placeholder","Explain the adjustment...",1,"form-control",3,"ngModelChange","ngModel"],["for","adjustment-notes"],["id","adjustment-notes","name","notes","rows","2","placeholder","Optional notes (visible to user)...",1,"form-control",3,"ngModelChange","ngModel"],[1,"items-list-readonly"],[1,"item-row"],["for","approve-notes"],["id","approve-notes","name","notes","rows","3","placeholder","Optional notes...",1,"form-control",3,"ngModelChange","ngModel"],["for","deny-notes"],["id","deny-notes","name","notes","rows","3","placeholder","Please provide a reason for denying this request...","required","",1,"form-control",3,"ngModelChange","ngModel"]],template:function(e,l){e&1&&(t(0,"div",0),u(1,be,4,0,"div",1),u(2,ye,6,1,"div",2),u(3,ot,51,21,"div",3),u(4,lt,42,12,"div",4),u(5,ut,30,6,"div",4),u(6,Ct,27,6,"div",4),u(7,bt,37,8,"div",4),u(8,Pt,33,6,"div",4),u(9,It,27,6,"div",4),n()),e&2&&(r(),_(l.loading()?1:-1),r(),_(l.error()&&!l.loading()?2:-1),r(),_(l.order()&&!l.loading()?3:-1),r(),_(l.dialogMode()==="record-payment"?4:-1),r(),_(l.dialogMode()==="cancel-items"?5:-1),r(),_(l.dialogMode()==="promote-waitlist"?6:-1),r(),_(l.dialogMode()==="update-adjustment"?7:-1),r(),_(l.dialogMode()==="approve-change"?8:-1),r(),_(l.dialogMode()==="deny-change"?9:-1))},dependencies:[L,N,oe,X,te,ne,G,ee,J,Z,ie,Q,K,W,ae],styles:[".admin-order-detail-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.spinner[_ngcontent-%COMP%]{border:3px solid #f3f3f3;border-top:3px solid #3498db;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-banner[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;padding:15px;border-radius:4px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.btn-close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:24px;cursor:pointer;color:inherit}.order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:30px;padding-bottom:20px;border-bottom:2px solid #e0e0e0}.header-left[_ngcontent-%COMP%]{flex:1}.back-link[_ngcontent-%COMP%]{color:#3498db;text-decoration:none;margin-bottom:10px;display:inline-block}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.order-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:10px 0;font-size:28px}.order-meta[_ngcontent-%COMP%]{display:flex;gap:15px;align-items:center;margin-top:10px}.user-id[_ngcontent-%COMP%]{color:#666;font-size:14px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.info-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:20px;margin-bottom:20px}.info-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 20px;font-size:20px;color:#333}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.user-details[_ngcontent-%COMP%], .status-details[_ngcontent-%COMP%], .pricing-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:4px;font-size:12px;font-weight:600;text-transform:uppercase;display:inline-block}.status-submitted[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-paid[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-cancelled[_ngcontent-%COMP%], .status-refunded[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.status-partial[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460}.status-empty[_ngcontent-%COMP%]{background:#e2e3e5;color:#383d41}.text-warning[_ngcontent-%COMP%]{color:#ffc107!important}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.remaining-time[_ngcontent-%COMP%]{font-size:12px;color:#666}.alert[_ngcontent-%COMP%]{padding:12px 16px;border-radius:4px;margin-top:15px}.alert-danger[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.alert-warning[_ngcontent-%COMP%]{background:#fff3cd;color:#856404;border:1px solid #ffeaa7}.alert-info[_ngcontent-%COMP%]{background:#d1ecf1;color:#0c5460;border:1px solid #bee5eb}.items-section[_ngcontent-%COMP%]{margin-bottom:30px}.items-section[_ngcontent-%COMP%]:last-child{margin-bottom:0}.section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:15px;color:#333}.item-count[_ngcontent-%COMP%]{color:#666;font-weight:400;font-size:14px}.items-list[_ngcontent-%COMP%]{display:grid;gap:12px}.item-card[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dee2e6;border-radius:6px;padding:15px}.item-card.pending[_ngcontent-%COMP%]{background:#fff3cd;border-color:#ffeaa7}.item-card.cancelled[_ngcontent-%COMP%]{background:#f8d7da;border-color:#f5c6cb;opacity:.7}.item-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.class-name[_ngcontent-%COMP%]{font-weight:600;color:#333}.item-status-badge[_ngcontent-%COMP%]{padding:2px 8px;border-radius:3px;font-size:11px;font-weight:600;text-transform:uppercase}.item-status-submitted[_ngcontent-%COMP%]{background:#ffc107;color:#000}.item-status-paid[_ngcontent-%COMP%]{background:#28a745;color:#fff}.item-status-cancelled[_ngcontent-%COMP%], .item-status-refunded[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.item-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.detail-item[_ngcontent-%COMP%]{display:flex;gap:8px;font-size:14px}.detail-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666}.detail-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.option-badge[_ngcontent-%COMP%]{background:#007bff;color:#fff;padding:2px 8px;border-radius:3px;font-size:11px;margin-right:4px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:#666}.pricing-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0}.pricing-row.total-row[_ngcontent-%COMP%]{border-top:2px solid #dee2e6;padding-top:12px;margin-top:8px;font-size:18px;font-weight:600}.pricing-row.balance-row[_ngcontent-%COMP%]{border-top:2px solid #dee2e6;padding-top:12px;margin-top:8px;font-size:18px;font-weight:700}.discounts-section[_ngcontent-%COMP%]{background:#f8f9fa;padding:12px;border-radius:4px;margin:8px 0}.discounts-header[_ngcontent-%COMP%]{font-weight:600;margin-bottom:8px;color:#666}.discount-row[_ngcontent-%COMP%]{padding:4px 0}.payments-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.payments-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:12px;background:#f8f9fa;border-bottom:2px solid #dee2e6;font-weight:600}.payments-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;border-bottom:1px solid #dee2e6}.payments-table[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600}.method-badge[_ngcontent-%COMP%]{background:#6c757d;color:#fff;padding:4px 8px;border-radius:3px;font-size:12px;text-transform:uppercase}.waitlist-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.waitlist-item[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dee2e6;border-radius:6px;padding:15px}.waitlist-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.promoted-badge[_ngcontent-%COMP%]{background:#28a745;color:#fff;padding:4px 8px;border-radius:3px;font-size:12px;font-weight:600}.waitlist-details[_ngcontent-%COMP%]{margin-bottom:10px}.history-timeline[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px}.history-event[_ngcontent-%COMP%]{display:flex;gap:15px;padding:12px;background:#f8f9fa;border-radius:6px}.event-time[_ngcontent-%COMP%]{color:#666;font-size:12px;white-space:nowrap;min-width:150px}.event-details[_ngcontent-%COMP%]{flex:1}.event-action[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}.event-metadata[_ngcontent-%COMP%]{color:#666;font-size:14px}.btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3}.btn-primary-outline[_ngcontent-%COMP%]{background:#fff;color:#007bff;border:1px solid #007bff}.btn-primary-outline[_ngcontent-%COMP%]:hover:not(:disabled){background:#007bff;color:#fff}.btn-secondary[_ngcontent-%COMP%]{background:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6268}.btn-danger[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#c82333}.btn-danger-outline[_ngcontent-%COMP%]{background:#fff;color:#dc3545;border:1px solid #dc3545}.btn-danger-outline[_ngcontent-%COMP%]:hover:not(:disabled){background:#dc3545;color:#fff}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:20px}.modal-body[_ngcontent-%COMP%]{padding:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;margin-bottom:8px;color:#333}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #ced4da;border-radius:4px;font-size:14px}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 .2rem #007bff40}.form-text[_ngcontent-%COMP%]{display:block;margin-top:4px;font-size:12px;color:#6c757d}.items-checklist[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;max-height:300px;overflow-y:auto;padding:8px;background:#f8f9fa;border-radius:4px}.checkbox-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px;cursor:pointer}.checkbox-item[_ngcontent-%COMP%]:hover{background:#e9ecef;border-radius:4px}.checkbox-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}.item-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:8px;flex-wrap:wrap}.read-only-value[_ngcontent-%COMP%]{padding:8px 12px;background:#f8f9fa;border-radius:4px;font-weight:500}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;margin-top:20px;padding-top:20px;border-top:1px solid #dee2e6}.spinner-small[_ngcontent-%COMP%]{display:inline-block;width:14px;height:14px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite;margin-right:8px}.btn-success[_ngcontent-%COMP%]{background:#28a745;color:#fff}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background:#218838}.change-requests-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.change-request-item[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:8px;padding:16px;background:#f8f9fa}.change-request-item.status-pending[_ngcontent-%COMP%]{border-left:4px solid #ffc107}.change-request-item.status-approved[_ngcontent-%COMP%]{border-left:4px solid #28a745}.change-request-item.status-denied[_ngcontent-%COMP%]{border-left:4px solid #dc3545;opacity:.7}.change-request-item[_ngcontent-%COMP%]   .request-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.change-request-item[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.change-request-item[_ngcontent-%COMP%]   .request-id[_ngcontent-%COMP%]{font-weight:600;color:#495057}.request-status-badge[_ngcontent-%COMP%]{padding:4px 10px;border-radius:12px;font-size:11px;font-weight:600;text-transform:uppercase}.request-status-badge.status-pending[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.request-status-badge.status-approved[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.request-status-badge.status-denied[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.change-request-item[_ngcontent-%COMP%]   .request-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;margin-bottom:16px}.change-request-item[_ngcontent-%COMP%]   .request-actions-list[_ngcontent-%COMP%]{font-size:14px}.change-request-item[_ngcontent-%COMP%]   .request-action-row[_ngcontent-%COMP%]{margin-left:16px;color:#666;padding:4px 0}.change-request-item[_ngcontent-%COMP%]   .request-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;font-size:13px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;gap:8px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#666;min-width:130px}.change-request-item[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.change-request-item[_ngcontent-%COMP%]   .request-actions[_ngcontent-%COMP%]{display:flex;gap:10px;padding-top:12px;border-top:1px solid #dee2e6}.text-success[_ngcontent-%COMP%]{color:#28a745!important}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important}.items-list-readonly[_ngcontent-%COMP%]{background:#f8f9fa;padding:12px;border-radius:4px}.items-list-readonly[_ngcontent-%COMP%]   .item-row[_ngcontent-%COMP%]{padding:4px 0;color:#495057}"]})};export{_e as AdminOrderDetailComponent};
