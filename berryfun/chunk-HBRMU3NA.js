import{a as B}from"./chunk-2OIRXN5N.js";import{a as $}from"./chunk-DN4JYJ55.js";import{a as j}from"./chunk-M6FUPIHG.js";import{b as R,c as L,f as W,q as U}from"./chunk-E62POJJA.js";import{$ as F,Y as z,d as T,j as A}from"./chunk-UHLAHZJO.js";import{F as V,aa as I,ha as N,kb as D}from"./chunk-UYHN5VVP.js";import{Ea as d,Eb as S,Fb as O,Gb as k,N as v,Pa as w,Pb as h,S as p,T as f,Za as s,_a as m,bb as M,cb as E,da as b,db as x,eb as n,fb as i,gb as y,kb as _,mb as g,ob as l,wb as P,yb as a,zb as u}from"./chunk-DU5POHF6.js";import"./chunk-Q7L6LLAK.js";var G=(e,o)=>o.id;function H(e,o){e&1&&(n(0,"div",2),y(1,"div",5),n(2,"p"),a(3,"Loading content..."),i()())}function J(e,o){if(e&1){let t=_();n(0,"div",3)(1,"div",6),a(2,"!"),i(),n(3,"p"),a(4),i(),n(5,"button",7),g("click",function(){p(t);let r=l();return f(r.loadConfig())}),a(6,"Retry"),i()()}if(e&2){let t=l();d(4),u(t.configService.error())}}function K(e,o){if(e&1){let t=_();n(0,"button",18),g("click",function(){let r=p(t).$implicit,C=l(2);return f(C.selectTab(r.id))}),n(1,"span",19),a(2),i(),n(3,"span",20),a(4),i()()}if(e&2){let t=o.$implicit,c=l(2);P("active",c.activeTab()===t.id),d(2),u(t.icon),d(2),u(t.label)}}function Q(e,o){if(e&1){let t=_();n(0,"button",21),g("click",function(){p(t);let r=l(2);return f(r.startEdit())}),a(1," Edit Content "),i()}}function X(e,o){if(e&1&&y(0,"app-markdown-renderer",28),e&2){let t=l(3);x("content",t.editContent)}}function Y(e,o){e&1&&(n(0,"p",29),a(1,"Start typing to see preview..."),i())}function Z(e,o){e&1&&a(0," Saving... ")}function tt(e,o){e&1&&a(0," Save Changes ")}function et(e,o){if(e&1){let t=_();n(0,"div",16)(1,"div",22)(2,"label",23),a(3,"Content (Markdown)"),i(),n(4,"textarea",24),k("ngModelChange",function(r){p(t);let C=l(2);return O(C.editContent,r)||(C.editContent=r),f(r)}),i(),n(5,"small",25),a(6," Supports Markdown: **bold**, *italic*, [links](url), - lists, etc. "),i()(),n(7,"div",26)(8,"label"),a(9,"Preview"),i(),n(10,"div",27),s(11,X,1,1,"app-markdown-renderer",28)(12,Y,2,0,"p",29),i()(),n(13,"div",30)(14,"button",31),g("click",function(){p(t);let r=l(2);return f(r.cancelEdit())}),a(15,"Cancel"),i(),n(16,"button",32),g("click",function(){p(t);let r=l(2);return f(r.saveContent())}),s(17,Z,1,0)(18,tt,1,0),i()()()}if(e&2){let t=l(2);d(4),S("ngModel",t.editContent),d(7),m(t.editContent?11:12),d(5),x("disabled",t.saving()),d(),m(t.saving()?17:18)}}function nt(e,o){if(e&1&&(n(0,"div",33),y(1,"app-markdown-renderer",28),i()),e&2){let t=l(3);d(),x("content",t.currentContent())}}function it(e,o){if(e&1){let t=_();n(0,"div",34)(1,"p"),a(2,"No content has been set for this section."),i(),n(3,"button",21),g("click",function(){p(t);let r=l(3);return f(r.startEdit())}),a(4," Add Content "),i()()}}function ot(e,o){if(e&1&&(n(0,"div",17),s(1,nt,2,1,"div",33)(2,it,5,0,"div",34),i()),e&2){let t=l(2);d(),m(t.currentContent()?1:2)}}function rt(e,o){if(e&1&&(n(0,"div",4)(1,"nav",8),M(2,K,5,4,"button",9,G),i(),n(4,"div",10)(5,"div",11)(6,"div",12)(7,"h2"),a(8),i(),n(9,"p",13),a(10),i()(),n(11,"div",14),s(12,Q,2,0,"button",15),i()(),s(13,et,19,4,"div",16)(14,ot,3,1,"div",17),i()()),e&2){let t,c,r=l();d(2),E(r.tabs),d(6),u((t=r.activeTabConfig())==null?null:t.label),d(2),u((c=r.activeTabConfig())==null?null:c.description),d(2),m(r.isEditing()?-1:12),d(),m(r.isEditing()?13:14)}}var q=class e{configService=v(z);userService=v(F);router=v(A);notificationService=v($);tabs=[{id:"payment",label:"Payment Instructions",description:"Instructions shown during checkout and payment",icon:"\u{1F4B3}"},{id:"release",label:"Liability Waiver",description:"Stage 1 of acknowledgement flow - liability release agreement",icon:"\u{1F4DD}"},{id:"refund",label:"Financial Terms",description:"Stage 2 of acknowledgement flow - refund and cancellation policy",icon:"\u{1F4B0}"},{id:"media",label:"Media Policy",description:"Stage 3 of acknowledgement flow - photo/video consent",icon:"\u{1F4F7}"},{id:"forms",label:"Forms Page",description:"Downloadable forms and documents shown on the Forms page",icon:"\u{1F4C4}"}];activeTab=b("payment");isEditing=b(!1);saving=b(!1);editContent="";activeTabConfig=h(()=>this.tabs.find(o=>o.id===this.activeTab()));currentContent=h(()=>{let o=this.activeTab(),t=this.configService.config();switch(o){case"payment":return t.paymentInstructions?.content||null;case"release":return t.releaseAgreementContent?.content||null;case"refund":return t.returnInstructions?.content||null;case"media":return t.mediaPolicyContent?.content||null;case"forms":return t.formsPageContent?.content||null;default:return null}});async ngOnInit(){if(!this.userService.isAuthenticated()){this.router.navigate(["/login"]);return}if(!this.userService.isAdmin()){this.router.navigate(["/"]);return}await this.loadConfig()}async loadConfig(){try{await this.configService.fetchConfig()}catch{}}selectTab(o){this.isEditing()&&this.isEditing.set(!1),this.activeTab.set(o)}startEdit(){this.editContent=this.currentContent()||"",this.isEditing.set(!0)}cancelEdit(){this.isEditing.set(!1),this.editContent=""}async saveContent(){this.saving.set(!0);let o=this.activeTab();try{let t=N(V()),c=I(t,"system","config"),C={payment:"paymentInstructions",release:"releaseAgreementContent",refund:"returnInstructions",media:"mediaPolicyContent",forms:"formsPageContent"}[o];await D(c,{[C]:{content:this.editContent}}),await this.configService.fetchConfig(),this.notificationService.success(`${this.activeTabConfig()?.label} saved successfully`),this.isEditing.set(!1)}catch(t){this.notificationService.error("Failed to save: "+t.message)}finally{this.saving.set(!1)}}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=w({type:e,selectors:[["app-admin-content-editor"]],decls:5,vars:3,consts:[["pageTitle","Content Editor","pageSubtitle","Manage all markdown content in one place"],[1,"content-editor"],[1,"loading-container"],[1,"error-container"],[1,"editor-layout"],[1,"spinner"],[1,"error-icon"],[1,"btn-retry",3,"click"],[1,"tab-nav"],[1,"tab-btn",3,"active"],[1,"editor-panel"],[1,"panel-header"],[1,"panel-title"],[1,"panel-description"],[1,"panel-actions"],[1,"btn","btn-primary"],[1,"edit-container"],[1,"view-container"],[1,"tab-btn",3,"click"],[1,"tab-icon"],[1,"tab-label"],[1,"btn","btn-primary",3,"click"],[1,"editor-area"],["for","contentEditor"],["id","contentEditor","rows","20","placeholder","Enter content in Markdown format...",1,"content-textarea",3,"ngModelChange","ngModel"],[1,"hint"],[1,"preview-area"],[1,"preview-content"],[3,"content"],[1,"empty-preview"],[1,"edit-actions"],[1,"btn","btn-outline",3,"click"],[1,"btn","btn-primary",3,"click","disabled"],[1,"content-preview"],[1,"empty-state"]],template:function(t,c){t&1&&(n(0,"app-admin-layout",0)(1,"div",1),s(2,H,4,0,"div",2),s(3,J,7,1,"div",3),s(4,rt,15,4,"div",4),i()()),t&2&&(d(2),m(c.configService.loading()?2:-1),d(),m(c.configService.error()?3:-1),d(),m(!c.configService.loading()&&!c.configService.error()?4:-1))},dependencies:[T,U,R,L,W,j,B],styles:[".content-editor[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:1.5rem}.loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{background:var(--sys-error-container, #ffebee);border-radius:12px}.error-icon[_ngcontent-%COMP%]{width:48px;height:48px;background:var(--sys-error, #c62828);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;margin-bottom:1rem}.btn-retry[_ngcontent-%COMP%]{padding:.5rem 1.5rem;background:var(--sys-error, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer}.editor-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:220px 1fr;gap:1.5rem;min-height:600px}.tab-nav[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;background:#fff;border:1px solid var(--sys-outline-variant, #e0e0e0);border-radius:12px;padding:1rem;height:fit-content}.tab-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.875rem 1rem;background:transparent;border:none;border-radius:8px;cursor:pointer;text-align:left;transition:all .2s;color:var(--sys-on-surface-variant, #666)}.tab-btn[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}.tab-btn.active[_ngcontent-%COMP%]{background:var(--sys-primary-container, #ffe0e0);color:var(--sys-primary, #c62828);font-weight:500}.tab-icon[_ngcontent-%COMP%]{font-size:1.25rem}.tab-label[_ngcontent-%COMP%]{font-size:.9rem}.editor-panel[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline-variant, #e0e0e0);border-radius:12px;padding:1.5rem;display:flex;flex-direction:column}.panel-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid var(--sys-outline-variant, #e0e0e0)}.panel-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1.25rem;color:var(--sys-on-surface, #212121)}.panel-description[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:var(--sys-on-surface-variant, #666)}.edit-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;flex:1}.editor-area[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.editor-area[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .preview-area[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:.875rem;color:var(--sys-on-surface, #212121)}.content-textarea[_ngcontent-%COMP%]{width:100%;padding:1rem;border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-family:Monaco,Menlo,Ubuntu Mono,monospace;font-size:.875rem;line-height:1.5;resize:vertical;min-height:300px}.content-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--sys-primary, #c62828)}.hint[_ngcontent-%COMP%]{font-size:.75rem;color:var(--sys-on-surface-variant, #999)}.preview-area[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.preview-content[_ngcontent-%COMP%]{padding:1rem;border:1px solid var(--sys-outline-variant, #e0e0e0);border-radius:8px;background:var(--sys-surface-variant, #fafafa);min-height:150px;max-height:300px;overflow-y:auto}.empty-preview[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #999);font-style:italic}.edit-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;padding-top:1rem;border-top:1px solid var(--sys-outline-variant, #e0e0e0)}.view-container[_ngcontent-%COMP%]{flex:1}.content-preview[_ngcontent-%COMP%]{padding:1rem;background:var(--sys-surface-variant, #fafafa);border-radius:8px;min-height:200px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center;color:var(--sys-on-surface-variant, #666)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem}.btn[_ngcontent-%COMP%]{padding:.75rem 1.25rem;border-radius:8px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease;border:none}.btn-primary[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-primary-dark, #a51c1c)}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-outline[_ngcontent-%COMP%]{background:transparent;border:1px solid var(--sys-outline, #e0e0e0);color:var(--sys-on-surface-variant, #666)}.btn-outline[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}@media(max-width:900px){.editor-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}.tab-nav[_ngcontent-%COMP%]{flex-direction:row;flex-wrap:wrap;gap:.5rem}.tab-btn[_ngcontent-%COMP%]{flex:1 1 auto;min-width:120px;justify-content:center}}"]})};export{q as AdminContentEditorComponent};
