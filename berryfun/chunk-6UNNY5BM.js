import{b as L}from"./chunk-ZWPM7P6E.js";import{h as T}from"./chunk-LUIRMBOE.js";import"./chunk-FWPBDQV6.js";import"./chunk-WG3KNEG3.js";import{z as D}from"./chunk-6E4VX3TQ.js";import{d as I,j as z}from"./chunk-NA25QKA5.js";import{$a as l,Ab as m,Bb as b,Cb as k,Da as P,Ga as d,Q as f,Qb as M,Ra as S,V as u,W as _,X as v,Y as x,ab as p,cb as y,db as E,ib as t,jb as n,kb as g,lb as O,mb as w,ob as C,pb as c,zb as i}from"./chunk-C26OXKSD.js";var V=(o,r)=>r.sessionId,F=(o,r)=>r.studentId,$=(o,r)=>r.type;function H(o,r){o&1&&(t(0,"div",1),g(1,"div",4),t(2,"span"),i(3,"Loading order information..."),n()())}function B(o,r){if(o&1){let e=O();t(0,"div",2),v(),t(1,"svg",5),g(2,"path",6),n(),x(),t(3,"h2"),i(4,"Loading Failed"),n(),t(5,"p"),i(6),n(),t(7,"button",7),C("click",function(){u(e);let s=c();return _(s.orderService.clearError())}),i(8,"Retry"),n()()}if(o&2){let e=c();d(6),m(e.orderService.error())}}function G(o,r){if(o&1&&(t(0,"div",12),v(),t(1,"svg",20),g(2,"path",21),n(),x(),t(3,"div",22)(4,"strong"),i(5,"Please complete payment within 48 hours"),n(),t(6,"span"),i(7),n()()()),o&2){let e=c(2);d(7),b("Deadline: ",e.formatDeadline(e.orderService.lockExpiresAt()))}}function j(o,r){o&1&&(t(0,"span",30),i(1,"\u{1F371} Lunch"),n())}function A(o,r){o&1&&(t(0,"span",30),i(1,"\u23F0 Extended Care"),n())}function U(o,r){if(o&1&&(t(0,"div",26)(1,"div",27)(2,"span",28),i(3),n()(),t(4,"div",29),l(5,j,2,0,"span",30),l(6,A,2,0,"span",30),n()()),o&2){let e=r.$implicit;d(3),m(e.studentName),d(2),p(e.options.lunch?5:-1),d(),p(e.options.extendedCare?6:-1)}}function R(o,r){if(o&1&&(t(0,"div",15)(1,"div",23)(2,"h4"),i(3),n(),t(4,"span",24),i(5),n()(),t(6,"div",25),y(7,U,7,3,"div",26,F),n()()),o&2){let e=r.$implicit;d(3),m(e.className),d(2),k("",e.startDate," - ",e.endDate),d(2),E(e.students)}}function Y(o,r){if(o&1&&(t(0,"div",33)(1,"span"),i(2),n(),t(3,"span",35),i(4),n()()),o&2){let e=r.$implicit,a=c(3);d(2),m(e.description),d(2),m(a.formatPrice(e.amount))}}function q(o,r){if(o&1&&(t(0,"section",13)(1,"h2"),i(2,"Price Breakdown"),n(),t(3,"div",31)(4,"div",32)(5,"span"),i(6,"Subtotal"),n(),t(7,"span"),i(8),n()(),y(9,Y,5,2,"div",33,$),t(11,"div",34)(12,"span"),i(13,"Amount Due"),n(),t(14,"span"),i(15),n()()()()),o&2){let e=c(2);d(8),m(e.formatPrice(e.pricing().subtotal)),d(),E(e.pricing().discounts),d(6),m(e.formatPrice(e.orderService.amountDue()))}}function J(o,r){if(o&1){let e=O();t(0,"div",3)(1,"div",8)(2,"div",9),v(),t(3,"svg",5),g(4,"path",10),n()(),x(),t(5,"h1"),i(6,"Order Submitted"),n(),t(7,"p",11),i(8),n()(),l(9,G,8,1,"div",12),t(10,"section",13)(11,"h2"),i(12,"Order Details"),n(),t(13,"div",14),y(14,R,9,3,"div",15,V),n()(),l(16,q,16,2,"section",13),t(17,"section",13)(18,"h2"),i(19,"Payment Methods"),n(),g(20,"div",16),n(),t(21,"div",17)(22,"button",18),C("click",function(){u(e);let s=c();return _(s.viewOrders())}),i(23,"View My Orders"),n(),t(24,"button",19),C("click",function(){u(e);let s=c();return _(s.continueShopping())}),i(25,"Continue Browsing"),n()()()}if(o&2){let e=c();d(8),b("",e.orderService.submittedCount()," enrollment(s) pending payment"),d(),p(e.orderService.lockExpiresAt()?9:-1),d(5),E(e.groupedItems()),d(2),p(e.pricing()?16:-1),d(4),w("innerHTML",e.renderPaymentMarkdown(),P)}}function K(o,r){if(o&1){let e=O();t(0,"div",2)(1,"h2"),i(2,"No Pending Orders"),n(),t(3,"p"),i(4,"You don't have any orders pending payment."),n(),t(5,"button",19),C("click",function(){u(e);let s=c();return _(s.continueShopping())}),i(6,"Browse Classes"),n()()}}var N=class o{router=f(z);configService=f(D);userService=f(L);orderService=f(T);paymentInstructions=this.configService.paymentInstructions;pricing=M(()=>this.orderService.pricing());groupedItems=M(()=>{let r=this.orderService.submittedItems();if(r.length===0)return[];let e=new Map;for(let a of r){let s=e.get(a.sessionId);s||(s={sessionId:a.sessionId,className:a.snapshot.className,startDate:this.formatDate(a.snapshot.startDate),endDate:this.formatDate(a.snapshot.endDate),students:[]},e.set(a.sessionId,s)),s.students.push({studentId:a.studentId,studentName:this.userService.getStudentById(a.studentId)?.fullName??"Unknown",options:a.options})}return Array.from(e.values()).sort((a,s)=>a.className.localeCompare(s.className))});formatDate(r){return new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"})}formatDeadline(r){return new Date(r).toLocaleString("en-US",{month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}formatPrice(r){let e=r<0,h=`$${(Math.abs(r)/100).toFixed(2)}`;return e?`-${h}`:h}renderPaymentMarkdown(){return(this.paymentInstructions()?.content??"").replace(/^## (.+)$/gm,"<h3>$1</h3>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/^---$/gm,"<hr>").replace(/\n/g,"<br>")}viewOrders(){this.router.navigate(["/orders"])}continueShopping(){this.router.navigate(["/catalog"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=S({type:o,selectors:[["app-order-confirmation"]],decls:5,vars:1,consts:[[1,"confirmation-page"],[1,"loading-state"],[1,"error-state"],[1,"confirmation-content"],[1,"spinner"],["width","48","height","48","viewBox","0 0 24 24","fill","currentColor"],["d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"],[1,"btn-retry",3,"click"],[1,"success-header"],[1,"success-icon"],["d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"],[1,"order-id"],[1,"deadline-warning"],[1,"order-section"],[1,"class-groups"],[1,"class-card"],[1,"payment-content",3,"innerHTML"],[1,"confirmation-actions"],[1,"btn-secondary",3,"click"],[1,"btn-primary",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","currentColor"],["d","M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"],[1,"deadline-text"],[1,"class-header"],[1,"class-dates"],[1,"students-list"],[1,"student-row"],[1,"student-info"],[1,"student-name"],[1,"student-options"],[1,"option-badge"],[1,"pricing-breakdown"],[1,"price-row"],[1,"price-row","discount"],[1,"price-row","total"],[1,"discount-value"]],template:function(e,a){e&1&&(t(0,"div",0),l(1,H,4,0,"div",1)(2,B,9,1,"div",2)(3,J,26,4,"div",3)(4,K,7,0,"div",2),n()),e&2&&(d(),p(a.orderService.loading()?1:a.orderService.error()?2:a.orderService.hasSubmittedItems()?3:4))},dependencies:[I],styles:[".confirmation-page[_ngcontent-%COMP%]{min-height:100vh;background:var(--sys-surface, #fafafa);padding:2rem 1rem}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:var(--sys-error, #c62828);margin-bottom:1rem}.error-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--sys-on-surface, #212121)}.error-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-on-surface-variant, #666)}.btn-retry[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:8px;padding:.75rem 1.5rem;font-size:.875rem;cursor:pointer}.confirmation-content[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.success-header[_ngcontent-%COMP%]{text-align:center;padding:2rem 0}.success-icon[_ngcontent-%COMP%]{width:80px;height:80px;background:var(--sys-secondary-container, #e8f5e9);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 1rem}.success-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:var(--sys-secondary, #2e7d32)}.success-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.5rem;color:var(--sys-on-surface, #212121)}.order-id[_ngcontent-%COMP%]{margin:0;color:var(--sys-on-surface-variant, #666);font-size:.875rem}.deadline-warning[_ngcontent-%COMP%]{display:flex;gap:1rem;padding:1rem;background:var(--sys-error-container, #ffebee);border-radius:12px;margin-bottom:1.5rem}.deadline-warning[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{flex-shrink:0;color:var(--sys-error, #c62828)}.deadline-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.deadline-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--sys-error, #c62828);font-size:.9375rem}.deadline-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--sys-on-error-container, #b71c1c);font-size:.8125rem}.order-section[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline, #e0e0e0);border-radius:12px;padding:1.25rem;margin-bottom:1rem}.order-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1rem;font-weight:600;color:var(--sys-on-surface, #212121)}.class-groups[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.class-card[_ngcontent-%COMP%]{background:var(--sys-surface-variant, #f5f5f5);border-radius:12px;overflow:hidden}.class-header[_ngcontent-%COMP%]{padding:.875rem 1rem;background:var(--sys-primary-container, #ffebee);border-bottom:1px solid var(--sys-outline, #e0e0e0)}.class-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:.9375rem;font-weight:600;color:var(--sys-on-primary-container, #212121)}.class-dates[_ngcontent-%COMP%]{font-size:.75rem;color:var(--sys-on-surface-variant, #666)}.students-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.student-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;border-bottom:1px solid var(--sys-outline-variant, #e8e8e8)}.student-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.student-row.already-claimed[_ngcontent-%COMP%]{background:var(--sys-secondary-container, #e8f5e9)}.student-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}.student-name[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--sys-primary, #c62828)}.claimed-badge[_ngcontent-%COMP%]{font-size:.6875rem;padding:.125rem .375rem;background:var(--sys-secondary-container, #e8f5e9);color:var(--sys-secondary, #2e7d32);border-radius:4px;font-weight:500}.new-badge[_ngcontent-%COMP%]{font-size:.6875rem;padding:.125rem .375rem;background:var(--sys-tertiary-container, #e3f2fd);color:var(--sys-tertiary, #1976d2);border-radius:4px;font-weight:500}.student-options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.375rem}.option-badge[_ngcontent-%COMP%]{font-size:.6875rem;padding:.25rem .5rem;background:#fff;border-radius:4px}.pricing-breakdown[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.price-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.875rem}.price-row.discount[_ngcontent-%COMP%]   .discount-value[_ngcontent-%COMP%]{color:var(--sys-secondary, #2e7d32)}.price-row.total[_ngcontent-%COMP%]{font-weight:600;font-size:1rem;padding-top:.5rem;border-top:1px solid var(--sys-outline, #e0e0e0);margin-top:.25rem}.price-row.total[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:var(--sys-primary, #c62828)}.payment-content[_ngcontent-%COMP%]{padding:1rem;background:var(--sys-surface-variant, #f5f5f5);border-radius:8px;font-size:.875rem;line-height:1.6;margin-bottom:1rem}.payment-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;margin:1rem 0 .5rem;color:var(--sys-on-surface, #212121)}.payment-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:first-child{margin-top:0}.payment-content[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{border:none;border-top:1px solid var(--sys-outline-variant, #e0e0e0);margin:1rem 0}.payment-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--sys-secondary, #2e7d32)}.payment-note[_ngcontent-%COMP%]{background:#fff;padding:1rem;border-radius:8px;border-left:4px solid var(--sys-tertiary, #1976d2)}.payment-note[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0;font-size:.875rem}.confirmation-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1.5rem}.btn-secondary[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%]{flex:1;padding:.875rem 1rem;border-radius:12px;font-size:.9375rem;font-weight:600;cursor:pointer;transition:all .2s ease}.btn-secondary[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline, #e0e0e0);color:var(--sys-on-surface, #212121)}.btn-secondary[_ngcontent-%COMP%]:hover{border-color:var(--sys-primary, #c62828);color:var(--sys-primary, #c62828)}.btn-primary[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);border:none;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--sys-primary-dark, #a51c1c)}"]})};export{N as OrderConfirmationComponent};
