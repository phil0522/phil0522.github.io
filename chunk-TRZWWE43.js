import{h as M,ma as y,n as S,na as P,oa as O}from"./chunk-CJ5JKCNL.js";import"./chunk-UYHN5VVP.js";import{$a as p,Db as n,Ea as s,Eb as E,N as l,Qa as b,S as x,T as v,U as c,V as m,ab as g,ea as w,jb as e,kb as t,lb as a,ob as C,pb as _,rb as f,sb as u}from"./chunk-5O64VQN5.js";import"./chunk-Q7L6LLAK.js";function L(i,d){i&1&&(e(0,"div",1)(1,"div",9)(2,"div",10),c(),e(3,"svg",11)(4,"defs")(5,"marker",12),a(6,"path",13),t()(),a(7,"path",14),t()(),m(),e(8,"div",15)(9,"div",16)(10,"div",17),n(11,"1"),t(),e(12,"div",18),n(13,"Tap the top-right 3-dot menu"),t(),e(14,"div",19),a(15,"span",20),t()(),e(16,"div",16)(17,"div",17),n(18,"2"),t(),e(19,"div",18),n(20,"Select"),t(),e(21,"div",21)(22,"span",22),c(),e(23,"svg",23),a(24,"path",24),t()(),m(),e(25,"span"),n(26,"Open in Default Browser"),t()()()()()())}function A(i,d){if(i&1){let o=C();e(0,"div",6),c(),e(1,"svg",25),a(2,"path",26),t(),m(),e(3,"span"),n(4),t(),e(5,"button",27),f("click",function(){x(o);let h=u();return v(h.authService.clearError())}),c(),e(6,"svg",28),a(7,"path",29),t()()()}if(i&2){let o=u();s(4),E(o.authService.error())}}function B(i,d){i&1&&(a(0,"span",30),n(1," Signing in... "))}function T(i,d){i&1&&(c(),e(0,"svg",31),a(1,"path",32)(2,"path",33)(3,"path",34)(4,"path",35),t(),n(5," Sign in with Google "))}var k=class i{authService=l(O);userService=l(P);router=l(S);isWeChatBrowser=y();constructor(){w(()=>{this.authService.loading()||this.authService.isAuthenticated()&&this.userService.currentUser()&&this.redirectAuthenticatedUser()})}redirectAuthenticatedUser(){this.userService.isAdmin()?this.router.navigate(["/admin"]):this.userService.hasStudents()?this.router.navigate(["/catalog"]):this.router.navigate(["/profile"],{queryParams:{tab:"students"}})}async onGoogleSignIn(){try{await this.authService.signInWithGoogle();let d=1e4,o=100,r=0;for(;!this.userService.currentUser()&&r<d;)await new Promise(z=>setTimeout(z,o)),r+=o;if(!this.userService.currentUser())return;this.redirectAuthenticatedUser()}catch{}}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=b({type:i,selectors:[["app-login"]],decls:16,vars:4,consts:[[1,"login-page"],["role","dialog","aria-modal","true","aria-label","Open in browser instructions",1,"wechat-overlay"],[1,"login-container"],[1,"login-header"],["src","berryfun.png","alt","BerryFun",1,"logo-icon"],[1,"login-subtitle"],[1,"error-message"],[1,"btn-google",3,"click","disabled"],[1,"login-info"],[1,"wechat-guide"],["aria-hidden","true",1,"wechat-arrow-row"],["viewBox","0 0 260 120","focusable","false",1,"wechat-arrow"],["id","wechatArrowHead","markerWidth","10","markerHeight","10","refX","7","refY","5","orient","auto","markerUnits","strokeWidth"],["d","M1 1 L7 5 L1 9","fill","none","stroke","rgba(255,255,255,0.92)","stroke-width","1.4","stroke-linecap","round","stroke-linejoin","round"],["d","M44 74 A 220 220 0 0 0 232 16","fill","none","stroke","rgba(255,255,255,0.92)","stroke-width","8","stroke-linecap","round","marker-end","url(#wechatArrowHead)"],[1,"wechat-steps"],[1,"wechat-step"],["aria-hidden","true",1,"wechat-badge"],[1,"wechat-step-text"],["aria-hidden","true",1,"wechat-menu-preview"],[1,"wechat-menu-dots"],["aria-hidden","true",1,"wechat-open-pill"],[1,"wechat-open-icon"],["viewBox","0 0 24 24","focusable","false"],["d","M12 2a10 10 0 100 20 10 10 0 000-20zm7.93 9h-3.12a15.2 15.2 0 00-1.07-5.1A8.02 8.02 0 0119.93 11zM12 4c1.1 0 2.62 2.2 3.37 7H8.63C9.38 6.2 10.9 4 12 4zm-3.74 1.9A15.2 15.2 0 007.19 11H4.07a8.02 8.02 0 014.19-5.1zM4.07 13h3.12c.2 1.8.6 3.5 1.07 5.1A8.02 8.02 0 014.07 13zM12 20c-1.1 0-2.62-2.2-3.37-7h6.74C14.62 17.8 13.1 20 12 20zm3.74-1.9c.47-1.6.87-3.3 1.07-5.1h3.12a8.02 8.02 0 01-4.19 5.1z","fill","rgba(255,255,255,0.95)"],["width","20","height","20","viewBox","0 0 24 24","fill","currentColor"],["d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"],[1,"dismiss-btn",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","currentColor"],["d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"],[1,"spinner"],["viewBox","0 0 24 24","width","20","height","20",1,"google-icon"],["fill","#4285F4","d","M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"],["fill","#34A853","d","M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"],["fill","#FBBC05","d","M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"],["fill","#EA4335","d","M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"]],template:function(o,r){o&1&&(e(0,"div",0),p(1,L,27,0,"div",1),e(2,"div",2)(3,"div",3),a(4,"img",4),e(5,"h1"),n(6,"BerryFun Summer Camp"),t(),e(7,"p",5),n(8,"Sign in with Google"),t()(),p(9,A,8,1,"div",6),e(10,"button",7),f("click",function(){return r.onGoogleSignIn()}),p(11,B,2,0)(12,T,6,0),t(),e(13,"div",8)(14,"p"),n(15,"First-time login will automatically create an account"),t()()()()),o&2&&(s(),g(r.isWeChatBrowser?1:-1),s(8),g(r.authService.error()?9:-1),s(),_("disabled",r.authService.loading()||r.isWeChatBrowser),s(),g(r.authService.loading()?11:12))},dependencies:[M],styles:[".login-page[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:2rem;background:linear-gradient(135deg,#fff5f5,#fff)}.logo-icon[_ngcontent-%COMP%]{width:64px;height:64px}.login-container[_ngcontent-%COMP%]{width:100%;max-width:400px;background:#fff;border-radius:16px;box-shadow:0 4px 24px #0000001a;padding:2.5rem}.login-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.logo-icon[_ngcontent-%COMP%]{font-size:3.5rem;display:block;margin:0 auto .75rem}.login-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:var(--color-on-surface, #111);font-family:Georgia,Times New Roman,serif;letter-spacing:-.01em;font-weight:700}.login-subtitle[_ngcontent-%COMP%]{margin:.75rem 0 0;color:var(--sys-on-surface-variant, #666);font-size:.95rem}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;background:var(--sys-error-container, #ffebee);color:var(--sys-error, #c62828);border-radius:8px;margin-bottom:1.5rem;font-size:.875rem}.error-message[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]:first-child{flex-shrink:0}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1}.dismiss-btn[_ngcontent-%COMP%]{background:none;border:none;padding:4px;cursor:pointer;color:inherit;opacity:.7}.dismiss-btn[_ngcontent-%COMP%]:hover{opacity:1}.btn-google[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.75rem;width:100%;padding:.875rem 1.5rem;background:#fff;color:var(--sys-on-surface, #333);border:1px solid var(--sys-outline, #ddd);border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:all .2s ease}.btn-google[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-surface-variant, #f5f5f5);border-color:var(--sys-outline, #ccc);box-shadow:0 2px 8px #0000001a}.btn-google[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.google-icon[_ngcontent-%COMP%]{flex-shrink:0}.spinner[_ngcontent-%COMP%]{width:18px;height:18px;border:2px solid rgba(0,0,0,.1);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.login-info[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid var(--sys-outline-variant, #f0f0f0)}.login-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--sys-on-surface-variant, #999);font-size:.8125rem}.wechat-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:10000;background:#0e0e0ed6;display:grid;place-items:stretch;padding:0;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);overscroll-behavior:contain;touch-action:none}.wechat-guide[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;margin:0;padding:calc(env(safe-area-inset-top,0px) + 10px) 12px 14px;background:transparent}.wechat-arrow-row[_ngcontent-%COMP%], .wechat-steps[_ngcontent-%COMP%]{pointer-events:none}.wechat-arrow-row[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:2px 6px 6px}.wechat-arrow[_ngcontent-%COMP%]{width:min(200px,50vw);height:auto;filter:drop-shadow(0 10px 18px rgba(0,0,0,.55))}.wechat-steps[_ngcontent-%COMP%]{padding:0}.wechat-step[_ngcontent-%COMP%]{display:grid;grid-template-columns:28px 1fr auto;align-items:center;gap:10px;padding:10px;border-radius:12px;background:#121212ad}.wechat-step[_ngcontent-%COMP%] + .wechat-step[_ngcontent-%COMP%]{margin-top:10px}.wechat-badge[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:999px;background:#ff6a28;color:#fff;display:grid;place-items:center;font-weight:900;font-size:.9rem;box-shadow:0 8px 16px #00000059}.wechat-step-text[_ngcontent-%COMP%]{color:#ffffffeb;font-size:1.02rem;font-weight:700;letter-spacing:-.01em}.wechat-menu-preview[_ngcontent-%COMP%]{width:52px;height:38px;border-radius:10px;background:#191919f2;border:1px solid rgba(255,255,255,.12);display:grid;place-items:center;box-shadow:0 10px 22px #00000073}.wechat-menu-dots[_ngcontent-%COMP%]{width:4px;height:4px;border-radius:999px;background:#ffffffeb;box-shadow:0 -8px #ffffffeb,0 8px #ffffffeb}.wechat-open-pill[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:10px;padding:8px 12px;border-radius:12px;background:#222222f2;border:1px solid rgba(255,255,255,.14);color:#ffffffeb;font-weight:800;letter-spacing:-.01em;box-shadow:0 10px 22px #00000073}.wechat-open-icon[_ngcontent-%COMP%]{width:18px;height:18px;display:inline-block}.wechat-open-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:18px;height:18px;display:block}"]})};export{k as LoginComponent};
