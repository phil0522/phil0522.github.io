import{h as w,n as A,o as T,pa as L}from"./chunk-R7Y3ICY3.js";import{$a as p,Bb as P,Db as o,Ea as l,Eb as m,I as x,N as g,Qa as y,S as k,T as _,Tb as E,ab as u,da as b,db as C,eb as O,fb as h,gb as n,hb as i,ob as v,qb as d,sb as c,tb as M,ub as S}from"./chunk-CNMR2ZL6.js";var I="berryfun.breakglass.enabled";function D(){try{return globalThis.sessionStorage??null}catch{return null}}var f=class a{_enabled=b(!1);enabled=this._enabled.asReadonly();constructor(){let e=D()?.getItem(I);this._enabled.set(e==="true")}async enable(){let t=globalThis.confirm;t&&t(["Enable BREAKGLASS mode?","","- Direct Firestore writes (no backend validation)","- Can change balances and pricing","","Continue only if you understand the risk."].join(`
`))&&this.setEnabled(!0)}disable(){this.setEnabled(!1)}async toggle(){if(this._enabled()){this.disable();return}await this.enable()}setEnabled(t){this._enabled.set(t);let e=D();e&&e.setItem(I,t?"true":"false")}static \u0275fac=function(e){return new(e||a)};static \u0275prov=x({token:a,factory:a.\u0275fac,providedIn:"root"})};var R=["*"],j=(a,t)=>t.link;function V(a,t){if(a&1&&(n(0,"li")(1,"a",25)(2,"span",9),o(3),i(),n(4,"span",10),o(5),i()()()),a&2){let e=t.$implicit,r=c();l(),P("active",r.isActive(e.link,e.exactMatch)),h("routerLink",e.link),l(2),m(e.icon),l(2),m(e.label)}}function F(a,t){a&1&&(n(0,"span",11),o(1,"ON"),i())}function U(a,t){if(a&1){let e=v();n(0,"button",26),d("click",function(){k(e);let s=c();return _(s.disableBreakglass())}),o(1," Disable "),i()}}function G(a,t){if(a&1){let e=v();n(0,"button",27),d("click",function(){k(e);let s=c();return _(s.enableBreakglass())}),o(1," Enable "),i()}}function W(a,t){if(a&1&&(n(0,"p",23),o(1),i()),a&2){let e=c();l(),m(e.pageSubtitle)}}var z=class a{router=g(A);authService=g(L);breakglassService=g(f);pageTitle="";pageSubtitle="";navItems=[{label:"Dashboard",link:"/admin",icon:"dashboard",exactMatch:!0},{label:"All Orders",link:"/admin/orders",icon:"receipt_long"},{label:"Session Registrations",link:"/admin/sessions",icon:"event_available"},{label:"Catalog",link:"/admin/catalog",icon:"menu_book"},{label:"User Directory",link:"/admin/users",icon:"groups"},{label:"Coupons",link:"/admin/coupons",icon:"confirmation_number"},{label:"Content Editor",link:"/admin/content",icon:"edit_note"},{label:"Configuration",link:"/admin/config",icon:"settings",exactMatch:!0},{label:"Data Analysis Report",link:"/admin/reports/data-analysis",icon:"query_stats"},{label:"State Machine",link:"/admin/docs/state-machine",icon:"schema"}];breakglassSectionOpen=b(!1);breakglassEnabled=E(()=>this.breakglassService.enabled());isActive(t,e=!1){return e?this.router.url===t:this.router.url===t||this.router.url.startsWith(t+"/")||this.router.url.startsWith(t+"?")}onBreakglassToggle(t){let e=t.target;this.breakglassSectionOpen.set(!!e?.open)}async enableBreakglass(){await this.breakglassService.enable(),this.breakglassService.enabled()&&this.breakglassSectionOpen.set(!0)}disableBreakglass(){this.breakglassService.disable()}async signOut(){await this.authService.signOutUser(),this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=y({type:a,selectors:[["app-admin-layout"]],inputs:{pageTitle:"pageTitle",pageSubtitle:"pageSubtitle"},ngContentSelectors:R,decls:42,vars:5,consts:[[1,"admin-layout"],[1,"sidebar"],[1,"sidebar-header"],[1,"logo-badge"],[1,"logo-text"],[1,"sidebar-nav"],[1,"nav-list"],[1,"breakglass-details",3,"toggle","open"],[1,"breakglass-summary"],["aria-hidden","true",1,"nav-icon","material-symbols-rounded"],[1,"nav-label"],[1,"breakglass-pill"],[1,"breakglass-body"],[1,"breakglass-note"],[1,"breakglass-actions"],["type","button",1,"breakglass-btn","breakglass-btn-off"],["type","button",1,"breakglass-btn","breakglass-btn-on"],[1,"sidebar-footer"],["routerLink","/",1,"footer-link"],[1,"footer-link",3,"click"],[1,"main-content"],[1,"content-header"],[1,"page-title"],[1,"page-subtitle"],[1,"content-body"],[1,"nav-link",3,"routerLink"],["type","button",1,"breakglass-btn","breakglass-btn-off",3,"click"],["type","button",1,"breakglass-btn","breakglass-btn-on",3,"click"]],template:function(e,r){e&1&&(M(),n(0,"div",0)(1,"aside",1)(2,"div",2)(3,"div",3),o(4,"A"),i(),n(5,"span",4),o(6,"Admin"),i()(),n(7,"nav",5)(8,"ul",6),C(9,V,6,5,"li",null,j),i(),n(11,"details",7),d("toggle",function(B){return r.onBreakglassToggle(B)}),n(12,"summary",8)(13,"span",9),o(14,"warning"),i(),n(15,"span",10),o(16,"Breakglass"),i(),p(17,F,2,0,"span",11),i(),n(18,"div",12)(19,"p",13),o(20," Emergency mode for direct Firestore writes from the admin UI. No RPC validation. When enabled, breakglass editors appear on relevant admin pages (for example Order Details). "),i(),n(21,"div",14),p(22,U,2,0,"button",15)(23,G,2,0,"button",16),i()()()(),n(24,"div",17)(25,"a",18)(26,"span",9),o(27,"arrow_back"),i(),n(28,"span"),o(29,"View as User"),i()(),n(30,"button",19),d("click",function(){return r.signOut()}),n(31,"span",9),o(32,"logout"),i(),n(33,"span"),o(34,"Sign Out"),i()()()(),n(35,"main",20)(36,"div",21)(37,"h1",22),o(38),i(),p(39,W,2,1,"p",23),i(),n(40,"div",24),S(41),i()()()),e&2&&(l(9),O(r.navItems),l(2),h("open",r.breakglassSectionOpen()),l(6),u(r.breakglassEnabled()?17:-1),l(5),u(r.breakglassEnabled()?22:23),l(16),m(r.pageTitle),l(),u(r.pageSubtitle?39:-1))},dependencies:[w,T],styles:[".admin-layout[_ngcontent-%COMP%]{display:flex;min-height:100vh;background:#f8f9fa}.sidebar[_ngcontent-%COMP%]{width:240px;background:#fff;border-right:1px solid #eee;display:flex;flex-direction:column;position:sticky;top:0;height:100vh;flex-shrink:0}.sidebar-header[_ngcontent-%COMP%]{padding:1.25rem;border-bottom:1px solid #eee;display:flex;align-items:center;gap:.75rem}.logo-badge[_ngcontent-%COMP%]{width:32px;height:32px;background:linear-gradient(135deg,#c62828,#e53935);border-radius:8px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:1rem}.logo-text[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;color:#212121;letter-spacing:-.02em}.sidebar-nav[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:.75rem 0}.nav-list[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.nav-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1.25rem;color:#555;text-decoration:none;font-size:.875rem;font-weight:500;transition:all .15s ease;border-left:3px solid transparent}.nav-link[_ngcontent-%COMP%]:hover{background:#f8f8f8;color:#c62828}.nav-link.active[_ngcontent-%COMP%]{background:#fff5f5;color:#c62828;border-left-color:#c62828}.nav-icon[_ngcontent-%COMP%]{font-size:1rem;width:20px;text-align:center}.nav-label[_ngcontent-%COMP%]{flex:1}.breakglass-details[_ngcontent-%COMP%]{margin:.5rem 0 0;padding:.5rem 0 0;border-top:1px solid #eee}.breakglass-summary[_ngcontent-%COMP%]{list-style:none;cursor:pointer;display:flex;align-items:center;gap:.75rem;padding:.75rem 1.25rem;color:#7f0000;font-size:.875rem;font-weight:600;border-left:3px solid transparent;-webkit-user-select:none;user-select:none}.breakglass-summary[_ngcontent-%COMP%]::-webkit-details-marker{display:none}.breakglass-details[open][_ngcontent-%COMP%]   .breakglass-summary[_ngcontent-%COMP%]{background:#ffebee;border-left-color:#b71c1c}.breakglass-pill[_ngcontent-%COMP%]{font-size:.7rem;font-weight:800;letter-spacing:.06em;padding:2px 8px;border-radius:999px;background:#b71c1c;color:#fff}.breakglass-body[_ngcontent-%COMP%]{padding:.5rem 1.25rem .75rem 3rem}.breakglass-note[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.8rem;color:#7f0000;line-height:1.35}.breakglass-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.breakglass-btn[_ngcontent-%COMP%]{border:1px solid #b71c1c;border-radius:8px;padding:.4rem .6rem;font-size:.8rem;font-weight:700;cursor:pointer;background:#fff;color:#b71c1c}.breakglass-btn-on[_ngcontent-%COMP%]{background:#b71c1c;color:#fff}.breakglass-btn[_ngcontent-%COMP%]:hover{filter:brightness(.96)}.sidebar-footer[_ngcontent-%COMP%]{padding:1rem;border-top:1px solid #eee;display:flex;flex-direction:column;gap:.25rem}.footer-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.625rem .5rem;color:#666;text-decoration:none;font-size:.8rem;transition:color .15s ease;background:none;border:none;cursor:pointer;width:100%;text-align:left;font-family:inherit}.footer-link[_ngcontent-%COMP%]:hover{color:#c62828}.main-content[_ngcontent-%COMP%]{flex:1;min-height:100vh;display:flex;flex-direction:column;min-width:0}.content-header[_ngcontent-%COMP%]{padding:1.5rem 2rem 1rem;background:#fff;border-bottom:1px solid #eee}.page-title[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1.5rem;font-weight:600;color:#212121;letter-spacing:-.02em}.page-subtitle[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#666}.content-body[_ngcontent-%COMP%]{flex:1;padding:1.5rem 2rem}@media(max-width:768px){.admin-layout[_ngcontent-%COMP%]{flex-direction:column}.sidebar[_ngcontent-%COMP%]{width:100%;height:auto;position:relative;border-right:none;border-bottom:1px solid #eee}.sidebar-nav[_ngcontent-%COMP%]{max-height:200px}.sidebar-footer[_ngcontent-%COMP%]{flex-direction:row;gap:1rem}.content-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem .75rem}.content-body[_ngcontent-%COMP%]{padding:1rem 1.5rem}.page-title[_ngcontent-%COMP%]{font-size:1.25rem}}"]})};export{f as a,z as b};
