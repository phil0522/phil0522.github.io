import{b as re}from"./chunk-W52BTLNY.js";import{a as ae}from"./chunk-YPC3HQP2.js";import{a as J,b as K,c as Q,f as X,h as Z,i as $,j as ee,k as te,l as ne,m as ie,q as oe}from"./chunk-CAB6IJBE.js";import{d as G}from"./chunk-RYIKU5Y3.js";import{ga as j,h as N,la as R,n as q,na as U,oa as Y,ra as H}from"./chunk-OBNAGF5X.js";import"./chunk-ZEYGPIIR.js";import"./chunk-KBXPF7D4.js";import"./chunk-2PX3OE6K.js";import{$a as _,Bb as w,Db as l,Ea as s,Eb as h,Fb as S,Gb as O,Jb as u,Kb as f,Lb as x,N as E,Ob as z,Qa as I,S as m,T as p,Tb as L,ab as C,bb as D,da as y,db as M,eb as P,fb as v,gb as o,hb as n,ib as W,ob as b,qb as g,sb as c}from"./chunk-CNMR2ZL6.js";import{a as V,b as B}from"./chunk-Q7L6LLAK.js";function F(r){return`$${(r/100).toFixed(2)}`}var le=()=>[],T=(r,i)=>i.id,de=(r,i)=>i.minSessions;function ce(r,i){if(r&1&&(o(0,"option",17),l(1),n()),r&2){let e=i.$implicit;v("value",e.id),s(),h(e.name)}}function me(r,i){if(r&1){let e=b();o(0,"select",15),g("change",function(t){m(e);let d=c();return p(d.onSeasonFilterChange(t))}),o(1,"option",16),l(2,"All Seasons"),n(),M(3,ce,2,2,"option",17,T),n()}if(r&2){let e=c();v("value",e.selectedSeasonIdForFilter()),s(3),P(e.seasonService.seasons())}}function pe(r,i){r&1&&(o(0,"div",10),W(1,"div",18),o(2,"p"),l(3,"Loading catalog..."),n()())}function _e(r,i){if(r&1){let e=b();o(0,"div",11)(1,"div",19),l(2,"!"),n(),o(3,"p"),l(4),n(),o(5,"button",20),g("click",function(){m(e);let t=c();return p(t.loadCatalog())}),l(6,"Retry"),n()()}if(r&2){let e=c();s(4),h(e.seasonService.error())}}function Ce(r,i){if(r&1&&(o(0,"div",29),l(1),n()),r&2){let e=c().$implicit;s(),S(" ",e.description," ")}}function ge(r,i){if(r&1){let e=b();o(0,"div",23)(1,"div",24)(2,"div")(3,"h3"),l(4),n(),o(5,"p",25),l(6),n()(),o(7,"span",26),l(8),n()(),o(9,"div",27)(10,"div",28)(11,"span"),l(12,"Year:"),n(),o(13,"span"),l(14),n()(),o(15,"div",28)(16,"span"),l(17,"Classes:"),n(),o(18,"span"),l(19),n()(),_(20,Ce,2,1,"div",29),n(),o(21,"div",30)(22,"button",31),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.openEditSeasonDialog(t))}),l(23,"Edit"),n(),o(24,"button",31),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.openCouponDialog(t))}),l(25),n(),o(26,"button",32),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.toggleSeasonActive(t))}),l(27),n()()()}if(r&2){let e=i.$implicit,a=c(2);w("inactive",!e.isActive),s(4),h(e.name),s(2),S(" ",a.formatDateRange(e.startDate,e.endDate)," "),s(),w("active",e.isActive),s(),S(" ",e.isActive?"Active":"Inactive"," "),s(6),h(e.year),s(5),h(e.sessions.length),s(),C(e.description?20:-1),s(5),S(" Coupons (",e.coupons.length,") "),s(),w("btn-activate",!e.isActive),v("disabled",a.seasonService.actionLoading()),s(),S(" ",e.isActive?"Deactivate":"Activate"," ")}}function ue(r,i){if(r&1){let e=b();o(0,"div",22)(1,"p"),l(2),n(),o(3,"button",9),g("click",function(){m(e);let t=c(2);return p(t.openCreateDialog())}),l(4,"Create Season"),n()()}if(r&2){let e=c(2);s(2),S("No ",e.showActiveOnly()?"active":""," seasons found")}}function fe(r,i){if(r&1&&(o(0,"div",12),M(1,ge,28,15,"div",21,T),_(3,ue,5,1,"div",22),n()),r&2){let e=c();s(),P(e.displayedSeasons()),s(2),C(e.displayedSeasons().length===0?3:-1)}}function xe(r,i){if(r&1){let e=b();o(0,"tr")(1,"td"),l(2),n(),o(3,"td"),l(4),n(),o(5,"td"),l(6),n(),o(7,"td"),l(8),n(),o(9,"td")(10,"span"),l(11),n()(),o(12,"td"),l(13),n(),o(14,"td")(15,"span",26),l(16),n()(),o(17,"td")(18,"div",35)(19,"button",36),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.openEditClassDialog(t))}),l(20,"Edit"),n(),o(21,"button",37),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.resetClassPricingToSeasonDefaults(t))}),l(22," Use Season Default "),n(),o(23,"button",38),g("click",function(){let t=m(e).$implicit,d=c(2);return p(d.toggleClassActive(t))}),l(24),n()()()()}if(r&2){let e=i.$implicit,a=c(2);w("inactive",!e.isActive),s(2),h(e.name),s(2),h(a.getSeasonName(e.seasonId)),s(2),h(a.formatDateRange(e.startDate,e.endDate)),s(2),h(e.capacity),s(2),w("text-warning",a.getEnrolledCount(e.id)>=e.capacity),s(),S(" ",a.getEnrolledCount(e.id)," "),s(2),h(a.formatCurrency(e.basePrice)),s(2),w("active",e.isActive),s(),S(" ",e.isActive?"Active":"Inactive"," "),s(5),v("disabled",a.seasonService.actionLoading()),s(2),w("btn-activate",!e.isActive),v("disabled",a.seasonService.actionLoading()),s(),S(" ",e.isActive?"Hide":"Show"," ")}}function he(r,i){if(r&1){let e=b();o(0,"div",22)(1,"p"),l(2),n(),o(3,"button",9),g("click",function(){m(e);let t=c(2);return p(t.openCreateDialog())}),l(4,"Create Class"),n()()}if(r&2){let e=c(2);s(2),S("No ",e.showActiveOnly()?"active":""," classes found")}}function Se(r,i){if(r&1&&(o(0,"div",13)(1,"table",33)(2,"thead")(3,"tr")(4,"th"),l(5,"Name"),n(),o(6,"th"),l(7,"Season"),n(),o(8,"th"),l(9,"Dates"),n(),o(10,"th"),l(11,"Capacity"),n(),o(12,"th"),l(13,"Enrolled"),n(),o(14,"th"),l(15,"Price"),n(),o(16,"th"),l(17,"Status"),n(),o(18,"th"),l(19,"Actions"),n()()(),o(20,"tbody"),M(21,xe,25,18,"tr",34,T),n()(),_(23,he,5,1,"div",22),n()),r&2){let e=c();s(21),P(e.displayedClasses()),s(2),C(e.displayedClasses().length===0?23:-1)}}function be(r,i){r&1&&(o(0,"span",66),l(1,"Has content"),n())}function ve(r,i){if(r&1){let e=b();o(0,"div",67)(1,"textarea",71),x("ngModelChange",function(t){m(e);let d=c(3);return f(d.formSeason.description,t)||(d.formSeason.description=t),p(t)}),n()()}if(r&2){let e=c(3);s(),u("ngModel",e.formSeason.description)}}function ye(r,i){r&1&&(o(0,"span",66),l(1,"Configured"),n())}function Me(r,i){if(r&1&&(o(0,"span",79),l(1),n()),r&2){let e=i.$implicit;s(),O("",e.minSessions,"+: ","$"+(e.discountAmount/100).toFixed(2)," off")}}function Pe(r,i){if(r&1&&(o(0,"div",78),M(1,Me,2,2,"span",79,de),n()),r&2){let e=c();s(),P(e)}}function we(r,i){r&1&&_(0,Pe,3,0,"div",78),r&2&&C(i.length>0?0:-1)}function Ee(r,i){r&1&&(o(0,"div",77),l(1,"Invalid format"),n())}function Te(r,i){if(r&1&&_(0,we,1,1)(1,Ee,2,0,"div",77),r&2){let e,a=c(4);C((e=a.getParsedMultiSessionDiscounts())?0:1,e)}}function Ae(r,i){if(r&1){let e=b();o(0,"div",67)(1,"div",50)(2,"div",45)(3,"label",72),l(4,"Sibling Discount/Week ($)"),n(),o(5,"div",73)(6,"input",74),x("ngModelChange",function(t){m(e);let d=c(3);return f(d.formSeason.siblingDiscountPerWeek,t)||(d.formSeason.siblingDiscountPerWeek=t),p(t)}),n(),o(7,"span",56),l(8,"Per student when 2+ siblings"),n()()(),o(9,"div",45)(10,"label",75),l(11,"Multi-Session ($)"),n(),o(12,"div",73)(13,"input",76),x("ngModelChange",function(t){m(e);let d=c(3);return f(d.formSeason.multiSessionDiscountsText,t)||(d.formSeason.multiSessionDiscountsText=t),p(t)}),n(),o(14,"span",56),l(15,'sessions:discount (e.g., "2:10.00" = $10 off)'),n()()()(),_(16,Te,2,1),n()}if(r&2){let e=c(3);s(6),u("ngModel",e.formSeason.siblingDiscountPerWeek),s(7),u("ngModel",e.formSeason.multiSessionDiscountsText),s(3),C(e.formSeason.multiSessionDiscountsText?16:-1)}}function De(r,i){if(r&1&&(o(0,"span",66),l(1),n()),r&2){let e=c(3);s(),S("",e.formSeason.earlyBirdTiers.length," tier(s)")}}function Oe(r,i){if(r&1){let e=b();o(0,"div",81)(1,"input",83),x("ngModelChange",function(t){let d=m(e).$implicit;return f(d.deadline,t)||(d.deadline=t),p(t)}),n(),o(2,"input",84),x("ngModelChange",function(t){let d=m(e).$implicit;return f(d.price,t)||(d.price=t),p(t)}),n(),o(3,"span",85),l(4),n(),o(5,"button",86),g("click",function(){let t=m(e).$index,d=c(4);return p(d.removeSeasonEarlyBirdTier(t))}),l(6,"\xD7"),n()()}if(r&2){let e=i.$implicit;s(),u("ngModel",e.deadline),s(),u("ngModel",e.price),s(2),h("$"+e.price.toFixed(2))}}function Le(r,i){if(r&1){let e=b();o(0,"div",67)(1,"div",80),M(2,Oe,7,3,"div",81,D),o(4,"button",82),g("click",function(){m(e);let t=c(3);return p(t.addSeasonEarlyBirdTier())}),l(5," + Add Tier "),n(),o(6,"span",56),l(7),n()()()}if(r&2){let e=c(3);s(2),P(e.formSeason.earlyBirdTiers),s(5),S("Classes inherit these tiers. Base: ","$"+e.formSeason.basePrice.toFixed(2))}}function ke(r,i){if(r&1){let e=b();o(0,"div",40)(1,"div",41)(2,"div",42)(3,"label",43),l(4,"Season Name *"),n(),o(5,"input",44),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.name,t)||(d.formSeason.name=t),p(t)}),n()(),o(6,"div",45)(7,"label",46),l(8,"Year *"),n(),o(9,"input",47),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.year,t)||(d.formSeason.year=t),p(t)}),n()(),o(10,"div",48)(11,"label")(12,"input",49),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.isActive,t)||(d.formSeason.isActive=t),p(t)}),n(),l(13," Active "),n()()(),o(14,"div",50)(15,"div",45)(16,"label",51),l(17,"Start Date *"),n(),o(18,"input",52),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.startDate,t)||(d.formSeason.startDate=t),p(t)}),n()(),o(19,"div",45)(20,"label",53),l(21,"End Date *"),n(),o(22,"input",54),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.endDate,t)||(d.formSeason.endDate=t),p(t)}),n()()(),o(23,"div",55)(24,"h4"),l(25,"Pricing ($) *"),n(),o(26,"span",56),l(27,"Classes inherit these prices unless overridden"),n()(),o(28,"div",41)(29,"div",45)(30,"label",57),l(31,"Base ($)"),n(),o(32,"input",58),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.basePrice,t)||(d.formSeason.basePrice=t),p(t)}),n()(),o(33,"div",45)(34,"label",59),l(35,"Lunch ($)"),n(),o(36,"input",60),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.lunchPrice,t)||(d.formSeason.lunchPrice=t),p(t)}),n()(),o(37,"div",45)(38,"label",61),l(39,"Extended Care ($)"),n(),o(40,"input",62),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formSeason.extendedCarePrice,t)||(d.formSeason.extendedCarePrice=t),p(t)}),n()()(),o(41,"div",63)(42,"button",64),g("click",function(){m(e);let t=c(2);return p(t.toggleSection("description"))}),o(43,"span",65),l(44),n(),l(45," Description "),_(46,be,2,0,"span",66),n(),_(47,ve,2,1,"div",67),n(),o(48,"div",63)(49,"button",64),g("click",function(){m(e);let t=c(2);return p(t.toggleSection("discounts"))}),o(50,"span",65),l(51),n(),l(52," Discounts "),_(53,ye,2,0,"span",66),n(),_(54,Ae,17,3,"div",67),n(),o(55,"div",63)(56,"button",64),g("click",function(){m(e);let t=c(2);return p(t.toggleSection("earlybird"))}),o(57,"span",65),l(58),n(),l(59," Early Bird Pricing "),_(60,De,2,1,"span",66),n(),_(61,Le,8,1,"div",67),n(),o(62,"div",68)(63,"button",69),g("click",function(){m(e);let t=c(2);return p(t.closeDialog())}),l(64,"Cancel"),n(),o(65,"button",70),g("click",function(){m(e);let t=c(2);return p(t.saveSeason())}),l(66),n()()()}if(r&2){let e=c(2);s(5),u("ngModel",e.formSeason.name),s(4),u("ngModel",e.formSeason.year),v("disabled",e.dialogMode()==="edit-season"),s(3),u("ngModel",e.formSeason.isActive),s(6),u("ngModel",e.formSeason.startDate),s(4),u("ngModel",e.formSeason.endDate),s(10),u("ngModel",e.formSeason.basePrice),s(4),u("ngModel",e.formSeason.lunchPrice),s(4),u("ngModel",e.formSeason.extendedCarePrice),s(4),h(e.expandedSections().has("description")?"\u25BC":"\u25B6"),s(2),C(e.formSeason.description?46:-1),s(),C(e.expandedSections().has("description")?47:-1),s(4),h(e.expandedSections().has("discounts")?"\u25BC":"\u25B6"),s(2),C(e.formSeason.siblingDiscountPerWeek||e.formSeason.multiSessionDiscountsText?53:-1),s(),C(e.expandedSections().has("discounts")?54:-1),s(4),h(e.expandedSections().has("earlybird")?"\u25BC":"\u25B6"),s(2),C(e.formSeason.earlyBirdTiers.length>0?60:-1),s(),C(e.expandedSections().has("earlybird")?61:-1),s(4),v("disabled",!e.isSeasonFormValid()),s(),S(" ",e.dialogMode()==="create-season"?"Create":"Save"," ")}}function Ve(r,i){if(r&1&&(o(0,"option",17),l(1),n()),r&2){let e=i.$implicit;v("value",e.id),s(),h(e.name)}}function Be(r,i){if(r&1){let e=b();o(0,"div",45)(1,"label",106),l(2,"Season *"),n(),o(3,"select",107),x("ngModelChange",function(t){m(e);let d=c(3);return f(d.formClass.seasonId,t)||(d.formClass.seasonId=t),p(t)}),o(4,"option",16),l(5,"Select season..."),n(),M(6,Ve,2,2,"option",17,T),n()()}if(r&2){let e=c(3);s(3),u("ngModel",e.formClass.seasonId),s(3),P(e.seasonService.seasons())}}function Fe(r,i){if(r&1&&(o(0,"span",100),l(1),n()),r&2){let e=c(3);s(),S("Using season default: ",e.getSeasonPricingDisplay("basePrice"))}}function Ie(r,i){if(r&1&&(o(0,"span",100),l(1),n()),r&2){let e=c(3);s(),S("Using season default: ",e.getSeasonPricingDisplay("lunchPrice"))}}function We(r,i){if(r&1&&(o(0,"span",100),l(1),n()),r&2){let e=c(3);s(),S("Using season default: ",e.getSeasonPricingDisplay("extendedCarePrice"))}}function ze(r,i){if(r&1&&(o(0,"span",79),l(1),n()),r&2){let e=i.$implicit,a=c(4);s(),O("Before ",e.deadline,": ",a.formatCurrency(e.price))}}function Ne(r,i){r&1&&(o(0,"span",56),l(1,"No early bird tiers defined at season level"),n())}function qe(r,i){if(r&1){let e=b();o(0,"div",105)(1,"span",100),l(2,"Using season default tiers:"),n(),M(3,ze,2,2,"span",79,D),_(5,Ne,2,0,"span",56),o(6,"button",82),g("click",function(){m(e);let t=c(3);return p(t.initializeClassEarlyBirdTiers())}),l(7," + Override with custom tiers "),n()()}if(r&2){let e=c(3);s(3),P(e.getSeasonEarlyBirdTiers()),s(2),C(e.getSeasonEarlyBirdTiers().length===0?5:-1)}}function je(r,i){if(r&1){let e=b();o(0,"div",81)(1,"input",83),x("ngModelChange",function(t){let d=m(e).$implicit;return f(d.deadline,t)||(d.deadline=t),p(t)}),n(),o(2,"input",84),x("ngModelChange",function(t){let d=m(e).$implicit;return f(d.price,t)||(d.price=t),p(t)}),n(),o(3,"span",85),l(4),n(),o(5,"button",86),g("click",function(){let t=m(e).$index,d=c(4);return p(d.removeEarlyBirdTier(t))}),l(6,"\xD7"),n()()}if(r&2){let e=i.$implicit;s(),u("ngModel",e.deadline),s(),u("ngModel",e.price),s(2),h("$"+e.price.toFixed(2))}}function Re(r,i){if(r&1){let e=b();o(0,"button",109),g("click",function(){m(e);let t=c(4);return p(t.clearClassEarlyBirdTiers())}),l(1," Use season defaults instead "),n()}}function Ue(r,i){if(r&1){let e=b();M(0,je,7,3,"div",81,D),o(2,"button",82),g("click",function(){m(e);let t=c(3);return p(t.addEarlyBirdTier())}),l(3," + Add Early Bird Tier "),n(),_(4,Re,2,0,"button",108),o(5,"span",56),l(6),n()}if(r&2){let e=c(3);P(e.formClass.earlyBirdTiers??z(2,le)),s(4),C(e.formClass.earlyBirdTiers!==null?4:-1),s(2),S("Orders placed before deadline get discounted price. Base: ",e.getEffectiveBasePrice())}}function Ye(r,i){if(r&1){let e=b();o(0,"div",40)(1,"div",50)(2,"div",42)(3,"label",87),l(4,"Class Name *"),n(),o(5,"input",88),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.name,t)||(d.formClass.name=t),p(t)}),n()(),_(6,Be,8,1,"div",45),o(7,"div",48)(8,"label")(9,"input",49),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.isActive,t)||(d.formClass.isActive=t),p(t)}),n(),l(10," Active "),n()()(),o(11,"div",50)(12,"div",45)(13,"label",89),l(14,"Start Date *"),n(),o(15,"input",90),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.startDate,t)||(d.formClass.startDate=t),p(t)}),n()(),o(16,"div",45)(17,"label",91),l(18,"End Date *"),n(),o(19,"input",92),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.endDate,t)||(d.formClass.endDate=t),p(t)}),n()()(),o(20,"div",50)(21,"div",42)(22,"label",93),l(23,"Location"),n(),o(24,"input",94),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.location,t)||(d.formClass.location=t),p(t)}),n()()(),o(25,"div",45)(26,"label",95),l(27,"Capacity *"),n(),o(28,"input",96),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.capacity,t)||(d.formClass.capacity=t),p(t)}),n()(),o(29,"div",97)(30,"h4"),l(31,"Pricing (Optional - inherits from Season)"),n(),o(32,"span",56),l(33,"Leave empty to use Season default prices"),n()(),o(34,"div",50)(35,"div",45)(36,"label",98),l(37,"Base Price ($)"),n(),o(38,"div",73)(39,"input",99),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.basePrice,t)||(d.formClass.basePrice=t),p(t)}),n(),_(40,Fe,2,1,"span",100),n()(),o(41,"div",45)(42,"label",101),l(43,"Lunch Price ($)"),n(),o(44,"div",73)(45,"input",102),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.lunchPrice,t)||(d.formClass.lunchPrice=t),p(t)}),n(),_(46,Ie,2,1,"span",100),n()()(),o(47,"div",45)(48,"label",103),l(49,"Extended Care Price ($)"),n(),o(50,"div",73)(51,"input",104),x("ngModelChange",function(t){m(e);let d=c(2);return f(d.formClass.extendedCarePrice,t)||(d.formClass.extendedCarePrice=t),p(t)}),n(),_(52,We,2,1,"span",100),n()(),o(53,"div",45)(54,"label"),l(55,"Early Bird Pricing Tiers ($)"),n(),o(56,"div",80),_(57,qe,8,1,"div",105)(58,Ue,7,3),n()(),o(59,"div",68)(60,"button",69),g("click",function(){m(e);let t=c(2);return p(t.closeDialog())}),l(61,"Cancel"),n(),o(62,"button",70),g("click",function(){m(e);let t=c(2);return p(t.saveClass())}),l(63),n()()()}if(r&2){let e=c(2);s(5),u("ngModel",e.formClass.name),s(),C(e.dialogMode()==="create-class"?6:-1),s(3),u("ngModel",e.formClass.isActive),s(6),u("ngModel",e.formClass.startDate),s(4),u("ngModel",e.formClass.endDate),s(5),u("ngModel",e.formClass.location),s(4),u("ngModel",e.formClass.capacity),s(11),u("ngModel",e.formClass.basePrice),v("placeholder","Inherited: "+e.getSeasonPricingDisplay("basePrice")),s(),C(e.formClass.basePrice===null&&e.formClass.seasonId?40:-1),s(5),u("ngModel",e.formClass.lunchPrice),v("placeholder","Inherited: "+e.getSeasonPricingDisplay("lunchPrice")),s(),C(e.formClass.lunchPrice===null&&e.formClass.seasonId?46:-1),s(5),u("ngModel",e.formClass.extendedCarePrice),v("placeholder","Inherited: "+e.getSeasonPricingDisplay("extendedCarePrice")),s(),C(e.formClass.extendedCarePrice===null&&e.formClass.seasonId?52:-1),s(5),C(e.formClass.earlyBirdTiers===null&&e.formClass.seasonId?57:58),s(5),v("disabled",!e.isClassFormValid()),s(),S(" ",e.dialogMode()==="create-class"?"Create":"Save"," ")}}function He(r,i){if(r&1){let e=b();o(0,"div",116)(1,"div",117)(2,"span",118),l(3),n(),o(4,"span",119),l(5),n(),o(6,"span",120),l(7),n()(),o(8,"button",121),g("click",function(){let t=m(e).$implicit,d=c(4);return p(d.removeCouponFromSeason(t.id))}),l(9," Remove "),n()()}if(r&2){let e=i.$implicit,a=c(4);s(3),h(e.name),s(2),h(e.id),s(2),h(a.formatCurrency(e.maxCreditCents)),s(),v("disabled",a.couponActionLoading())}}function Ge(r,i){if(r&1&&(o(0,"div",111),M(1,He,10,4,"div",116,T),n()),r&2){let e=c(3);s(),P(e.selectedSeasonForCoupons().coupons)}}function Je(r,i){r&1&&(o(0,"div",112),l(1,"No coupons assigned to this season"),n())}function Ke(r,i){if(r&1&&(o(0,"option",17),l(1),n()),r&2){let e=i.$implicit,a=c(4);v("value",e.id),s(),O("",e.name," (",a.formatCurrency(e.maxCreditCents),")")}}function Qe(r,i){if(r&1){let e=b();o(0,"div",114)(1,"select",122),x("ngModelChange",function(t){m(e);let d=c(3);return f(d.selectedCouponToAdd,t)||(d.selectedCouponToAdd=t),p(t)}),o(2,"option",16),l(3,"Select a coupon..."),n(),M(4,Ke,2,3,"option",17,T),n(),o(6,"button",123),g("click",function(){m(e);let t=c(3);return p(t.addCouponToSeason())}),l(7," Add "),n()()}if(r&2){let e=c(3);s(),u("ngModel",e.selectedCouponToAdd),s(3),P(e.availableCouponsForSeason()),s(2),v("disabled",!e.selectedCouponToAdd||e.couponActionLoading())}}function Xe(r,i){r&1&&(o(0,"p",56),l(1,"No coupons exist. Create coupons in Coupon Management first."),n())}function Ze(r,i){r&1&&(o(0,"p",56),l(1,"All coupons are already assigned to this season."),n())}function $e(r,i){if(r&1&&(o(0,"div",115),l(1),n()),r&2){let e=c(3);s(),h(e.couponActionError())}}function et(r,i){if(r&1){let e=b();o(0,"div",40)(1,"div",110)(2,"h4"),l(3,"Season Coupons"),n(),o(4,"p",56),l(5,"Coupons added here will automatically apply to all orders for this season."),n(),_(6,Ge,3,0,"div",111),_(7,Je,2,0,"div",112),o(8,"div",113)(9,"h5"),l(10,"Add Coupon"),n(),_(11,Qe,8,2,"div",114),_(12,Xe,2,0,"p",56),_(13,Ze,2,0,"p",56),n(),_(14,$e,2,1,"div",115),n(),o(15,"div",68)(16,"button",69),g("click",function(){m(e);let t=c(2);return p(t.closeDialog())}),l(17,"Done"),n()()()}if(r&2){let e=c(2);s(6),C(e.selectedSeasonForCoupons().coupons&&e.selectedSeasonForCoupons().coupons.length>0?6:-1),s(),C(!e.selectedSeasonForCoupons().coupons||e.selectedSeasonForCoupons().coupons.length===0?7:-1),s(4),C(e.availableCouponsForSeason().length>0?11:-1),s(),C(e.availableCouponsForSeason().length===0&&e.allCoupons().length===0?12:-1),s(),C(e.availableCouponsForSeason().length===0&&e.allCoupons().length>0?13:-1),s(),C(e.couponActionError()?14:-1)}}function tt(r,i){if(r&1&&(o(0,"div",14)(1,"div",39)(2,"h3"),l(3),n(),_(4,ke,67,20,"div",40),_(5,Ye,64,19,"div",40),_(6,et,18,6,"div",40),n()()),r&2){let e=c();s(3),h(e.getDialogTitle()),s(),C(e.dialogMode()==="create-season"||e.dialogMode()==="edit-season"?4:-1),s(),C(e.dialogMode()==="create-class"||e.dialogMode()==="edit-class"?5:-1),s(),C(e.dialogMode()==="manage-coupons"&&e.selectedSeasonForCoupons()?6:-1)}}var se=class r{seasonService=E(Y);configService=E(U);userService=E(H);router=E(q);datastore=E(j);functions=E(R);notificationService=E(ae);_enrollmentMap=y(new Map);selectedSeasonForCoupons=y(null);allCoupons=y([]);couponActionLoading=y(!1);couponActionError=y(null);selectedCouponToAdd="";availableCouponsForSeason=L(()=>{let i=this.selectedSeasonForCoupons();if(!i)return[];let e=new Set((i.coupons||[]).map(a=>a.id));return this.allCoupons().filter(a=>!e.has(a.id))});formatCurrency=F;formatDateRange=G;centsToDollars(i){return i/100}dollarsToCents(i){return Math.round(i*100)}viewMode=y("seasons");showActiveOnly=y(!0);selectedSeasonIdForFilter=y("");dialogMode=y(null);expandedSections=y(new Set);formSeason={name:"",year:0,startDate:"",endDate:"",isActive:!0,description:"",siblingDiscountPerWeek:5,multiSessionDiscountsText:"",basePrice:500,lunchPrice:50,extendedCarePrice:100,earlyBirdTiers:[]};formClass={seasonId:"",name:"",startDate:"",endDate:"",location:"",capacity:20,basePrice:null,lunchPrice:null,extendedCarePrice:null,isActive:!0,earlyBirdTiers:null};displayedSeasons=L(()=>{let i=this.seasonService.seasons();return this.showActiveOnly()?i.filter(e=>e.isActive):i});displayedClasses=L(()=>{let i=this.seasonService.classes();this.showActiveOnly()&&(i=i.filter(a=>a.isActive));let e=this.selectedSeasonIdForFilter();return e&&(i=i.filter(a=>a.seasonId===e)),i});async ngOnInit(){if(!this.userService.isAuthenticated()){this.router.navigate(["/login"]);return}if(!this.userService.isAdmin()){this.router.navigate(["/"]);return}await this.loadCatalog()}async loadCatalog(){try{await Promise.all([this.seasonService.loadAllSeasons(),this.seasonService.loadAllClasses()]),await this.loadEnrollmentData()}catch(i){console.error("Failed to load catalog:",i)}}async loadEnrollmentData(){let i=this.seasonService.seasons(),e=new Map;for(let a of i)try{let t=await this.datastore.getRegistration(a.id);if(t?.classes)for(let[d,A]of Object.entries(t.classes))e.set(d,A.enrolledStudents?.length??0)}catch{}this._enrollmentMap.set(e)}getEnrolledCount(i){return this._enrollmentMap().get(i)??0}openCreateDialog(){this.viewMode()==="seasons"?(this.formSeason={name:"",year:this.configService.activeYear(),startDate:"",endDate:"",isActive:!0,description:"",siblingDiscountPerWeek:5,multiSessionDiscountsText:"",basePrice:500,lunchPrice:50,extendedCarePrice:100,earlyBirdTiers:[]},this.dialogMode.set("create-season")):(this.formClass={seasonId:"",name:"",startDate:"",endDate:"",location:"",capacity:20,basePrice:null,lunchPrice:null,extendedCarePrice:null,isActive:!0,earlyBirdTiers:null},this.dialogMode.set("create-class"))}openEditSeasonDialog(i){this.formSeason={id:i.id,name:i.name,year:i.year,startDate:i.startDate,endDate:i.endDate,isActive:i.isActive,description:i.description??"",siblingDiscountPerWeek:this.centsToDollars(i.siblingDiscountPerWeek??500),multiSessionDiscountsText:this.encodeMultiSessionDiscounts(i.multiSessionDiscounts??[]),basePrice:this.centsToDollars(i.basePrice),lunchPrice:this.centsToDollars(i.lunchPrice),extendedCarePrice:this.centsToDollars(i.extendedCarePrice),earlyBirdTiers:i.earlyBirdTiers?i.earlyBirdTiers.map(a=>({deadline:a.deadline,price:this.centsToDollars(a.price)})):[]};let e=new Set;i.description&&e.add("description"),(i.siblingDiscountPerWeek||(i.multiSessionDiscounts?.length??0)>0)&&e.add("discounts"),(i.earlyBirdTiers?.length??0)>0&&e.add("earlybird"),this.expandedSections.set(e),this.dialogMode.set("edit-season")}async openEditClassDialog(i){try{let e=await this.seasonService.getSessionRaw(i.id);this.formClass={id:e.id,seasonId:e.seasonId,name:e.name,startDate:e.startDate,endDate:e.endDate,location:e.location??"",capacity:e.capacity,basePrice:e.basePrice!=null?this.centsToDollars(e.basePrice):null,lunchPrice:e.lunchPrice!=null?this.centsToDollars(e.lunchPrice):null,extendedCarePrice:e.extendedCarePrice!=null?this.centsToDollars(e.extendedCarePrice):null,isActive:e.isActive,earlyBirdTiers:e.earlyBirdTiers?e.earlyBirdTiers.map(a=>({deadline:a.deadline,price:this.centsToDollars(a.price)})):null},this.dialogMode.set("edit-class")}catch(e){this.notificationService.error("Failed to load class for edit: "+(e instanceof Error?e.message:String(e)))}}closeDialog(){this.dialogMode.set(null),this.expandedSections.set(new Set)}toggleSection(i){let e=new Set(this.expandedSections());e.has(i)?e.delete(i):e.add(i),this.expandedSections.set(e)}getDialogTitle(){switch(this.dialogMode()){case"create-season":return"Create Season";case"edit-season":return"Edit Season";case"create-class":return"Create Class";case"edit-class":return"Edit Class";default:return""}}isSeasonFormValid(){return!!(this.formSeason.name&&this.formSeason.year&&this.formSeason.startDate&&this.formSeason.endDate&&this.formSeason.basePrice>0&&this.formSeason.lunchPrice>=0&&this.formSeason.extendedCarePrice>=0)}isClassFormValid(){return!!(this.formClass.name&&this.formClass.seasonId&&this.formClass.startDate&&this.formClass.endDate&&this.formClass.capacity>0)}async saveSeason(){if(!this.isSeasonFormValid())return;let i=this.parseMultiSessionDiscounts(this.formSeason.multiSessionDiscountsText);if(i===null){this.notificationService.warning("Invalid multi-session discount format. Use format: 2:10.00, 3:20.00");return}let e=[...this.formSeason.earlyBirdTiers].sort((a,t)=>a.deadline.localeCompare(t.deadline)).map(a=>({deadline:a.deadline,price:this.dollarsToCents(a.price)}));try{if(this.dialogMode()==="create-season"){let a={year:this.formSeason.year,name:this.formSeason.name,startDate:this.formSeason.startDate,endDate:this.formSeason.endDate,isActive:this.formSeason.isActive,description:this.formSeason.description??null,siblingDiscountPerWeek:this.dollarsToCents(this.formSeason.siblingDiscountPerWeek),multiSessionDiscounts:i,deprecatedRefundProcessingFee:2e3,basePrice:this.dollarsToCents(this.formSeason.basePrice),lunchPrice:this.dollarsToCents(this.formSeason.lunchPrice),extendedCarePrice:this.dollarsToCents(this.formSeason.extendedCarePrice),earlyBirdTiers:e,coupons:[],sessions:[]};await this.seasonService.createSeason(a)}else this.dialogMode()==="edit-season"&&this.formSeason.id&&await this.seasonService.updateSeason(this.formSeason.id,{name:this.formSeason.name,startDate:this.formSeason.startDate,endDate:this.formSeason.endDate,isActive:this.formSeason.isActive,description:this.formSeason.description,siblingDiscountPerWeek:this.dollarsToCents(this.formSeason.siblingDiscountPerWeek),multiSessionDiscounts:i,basePrice:this.dollarsToCents(this.formSeason.basePrice),lunchPrice:this.dollarsToCents(this.formSeason.lunchPrice),extendedCarePrice:this.dollarsToCents(this.formSeason.extendedCarePrice),earlyBirdTiers:e});this.closeDialog()}catch(a){this.notificationService.error("Failed to save season: "+a.message)}}async saveClass(){if(!this.isClassFormValid())return;let i=this.formClass.earlyBirdTiers?[...this.formClass.earlyBirdTiers].sort((e,a)=>e.deadline.localeCompare(a.deadline)).map(e=>({deadline:e.deadline,price:this.dollarsToCents(e.price)})):null;try{if(this.dialogMode()==="create-class"){let e={seasonId:this.formClass.seasonId,name:this.formClass.name,startDate:this.formClass.startDate,endDate:this.formClass.endDate,location:this.formClass.location.trim()?this.formClass.location.trim():null,capacity:this.formClass.capacity,basePrice:this.formClass.basePrice!=null?this.dollarsToCents(this.formClass.basePrice):null,lunchPrice:this.formClass.lunchPrice!=null?this.dollarsToCents(this.formClass.lunchPrice):null,extendedCarePrice:this.formClass.extendedCarePrice!=null?this.dollarsToCents(this.formClass.extendedCarePrice):null,isActive:this.formClass.isActive,earlyBirdTiers:i};await this.seasonService.createClass(e)}else this.dialogMode()==="edit-class"&&this.formClass.id&&await this.seasonService.updateClass(this.formClass.id,{name:this.formClass.name,startDate:this.formClass.startDate,endDate:this.formClass.endDate,location:this.formClass.location.trim()?this.formClass.location.trim():null,capacity:this.formClass.capacity,basePrice:this.formClass.basePrice!=null?this.dollarsToCents(this.formClass.basePrice):null,lunchPrice:this.formClass.lunchPrice!=null?this.dollarsToCents(this.formClass.lunchPrice):null,extendedCarePrice:this.formClass.extendedCarePrice!=null?this.dollarsToCents(this.formClass.extendedCarePrice):null,isActive:this.formClass.isActive,earlyBirdTiers:i});this.closeDialog()}catch(e){this.notificationService.error("Failed to save class: "+e.message)}}async resetClassPricingToSeasonDefaults(i){try{await this.seasonService.updateClass(i.id,{basePrice:null,lunchPrice:null,extendedCarePrice:null,earlyBirdTiers:null}),this.notificationService.success("Class pricing reset to Season defaults")}catch(e){this.notificationService.error("Failed to reset class pricing: "+(e instanceof Error?e.message:String(e)))}}async toggleSeasonActive(i){try{await this.seasonService.toggleSeasonActive(i.id)}catch(e){this.notificationService.error("Failed to toggle season status: "+e.message)}}async toggleClassActive(i){try{await this.seasonService.toggleClassActive(i.id)}catch(e){this.notificationService.error("Failed to toggle class status: "+e.message)}}addEarlyBirdTier(){this.formClass.earlyBirdTiers===null&&(this.formClass.earlyBirdTiers=[]);let i=new Date;i.setDate(i.getDate()+14);let e=i.toISOString().split("T")[0],a=this.formClass.basePrice??this.getSeasonBasePriceDollars(),t=Math.max(0,a-50);this.formClass.earlyBirdTiers.push({deadline:e,price:t})}removeEarlyBirdTier(i){this.formClass.earlyBirdTiers&&this.formClass.earlyBirdTiers.splice(i,1)}getSeasonBasePriceDollars(){if(!this.formClass.seasonId)return 500;let i=this.seasonService.seasons().find(e=>e.id===this.formClass.seasonId);return this.centsToDollars(i?.basePrice??5e4)}encodeMultiSessionDiscounts(i){return!i||i.length===0?"":i.sort((e,a)=>e.minSessions-a.minSessions).map(e=>`${e.minSessions}:${(e.discountAmount/100).toFixed(2)}`).join(", ")}parseMultiSessionDiscounts(i){if(!i.trim())return[];let e=[],a=i.split(",").map(t=>t.trim()).filter(t=>t);for(let t of a){let d=t.match(/^(\d+):(\d+(?:\.\d{1,2})?)$/);if(!d)return null;let A=parseInt(d[1],10),k=parseFloat(d[2]);if(A<1||isNaN(k)||k<0)return null;e.push({minSessions:A,discountAmount:Math.round(k*100)})}return e.sort((t,d)=>t.minSessions-d.minSessions)}getParsedMultiSessionDiscounts(){return this.parseMultiSessionDiscounts(this.formSeason.multiSessionDiscountsText)}getSeasonName(i){return this.seasonService.seasons().find(a=>a.id===i)?.name??i}onActiveOnlyChange(i){let e=i.target;this.showActiveOnly.set(e.checked)}onSeasonFilterChange(i){let e=i.target;this.selectedSeasonIdForFilter.set(e.value)}getSeasonPricingDisplay(i){if(!this.formClass.seasonId)return"Select a season";let e=this.seasonService.seasons().find(a=>a.id===this.formClass.seasonId);return e?F(e[i]??0):"Season not found"}getSeasonEarlyBirdTiers(){return this.formClass.seasonId?this.seasonService.seasons().find(e=>e.id===this.formClass.seasonId)?.earlyBirdTiers??[]:[]}getEffectiveBasePrice(){return this.formClass.basePrice!==null?`$${this.formClass.basePrice.toFixed(2)}`:this.getSeasonPricingDisplay("basePrice")}initializeClassEarlyBirdTiers(){this.formClass.earlyBirdTiers=[]}clearClassEarlyBirdTiers(){this.formClass.earlyBirdTiers=null}addSeasonEarlyBirdTier(){let i=new Date;i.setDate(i.getDate()+14);let e=i.toISOString().split("T")[0],a=Math.max(0,this.formSeason.basePrice-50);this.formSeason.earlyBirdTiers.push({deadline:e,price:a})}removeSeasonEarlyBirdTier(i){this.formSeason.earlyBirdTiers.splice(i,1)}async openCouponDialog(i){this.selectedSeasonForCoupons.set(i),this.couponActionError.set(null),this.selectedCouponToAdd="",this.dialogMode.set("manage-coupons");try{let e=await this.functions.callApi("listCoupons",{});this.allCoupons.set(e.coupons)}catch(e){console.error("Failed to load coupons:",e),this.allCoupons.set([])}}async addCouponToSeason(){let i=this.selectedSeasonForCoupons();if(!i||!this.selectedCouponToAdd)return;let e=this.allCoupons().find(a=>a.id===this.selectedCouponToAdd);if(e){this.couponActionLoading.set(!0),this.couponActionError.set(null);try{await this.functions.callApi("addCouponToSeason",{seasonId:i.id,coupon:e});let a=[...i.coupons||[],e];this.selectedSeasonForCoupons.set(B(V({},i),{coupons:a})),this.selectedCouponToAdd="",await this.seasonService.loadAllSeasons()}catch(a){console.error("Failed to add coupon to season:",a),this.couponActionError.set(a instanceof Error?a.message:"Failed to add coupon")}finally{this.couponActionLoading.set(!1)}}}async removeCouponFromSeason(i){let e=this.selectedSeasonForCoupons();if(e){this.couponActionLoading.set(!0),this.couponActionError.set(null);try{await this.functions.callApi("removeCouponFromSeason",{seasonId:e.id,couponId:i});let a=(e.coupons||[]).filter(t=>t.id!==i);this.selectedSeasonForCoupons.set(B(V({},e),{coupons:a})),await this.seasonService.loadAllSeasons()}catch(a){console.error("Failed to remove coupon from season:",a),this.couponActionError.set(a instanceof Error?a.message:"Failed to remove coupon")}finally{this.couponActionLoading.set(!1)}}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=I({type:r,selectors:[["app-admin-catalog-list"]],decls:21,vars:14,consts:[["pageTitle","Catalog Management","pageSubtitle","Manage seasons and classes"],[1,"admin-catalog"],[1,"tab-bar"],[1,"tab",3,"click"],[1,"filter-bar"],[1,"filter-controls"],[1,"toggle-filter"],["type","checkbox",3,"change","checked"],[1,"season-filter",3,"value"],[1,"btn-create",3,"click"],[1,"loading-container"],[1,"error-container"],[1,"seasons-grid"],[1,"classes-table-container"],[1,"dialog-overlay"],[1,"season-filter",3,"change","value"],["value",""],[3,"value"],[1,"spinner"],[1,"error-icon"],[1,"btn-retry",3,"click"],[1,"season-card",3,"inactive"],[1,"empty-state"],[1,"season-card"],[1,"card-header"],[1,"season-dates"],[1,"status-badge"],[1,"card-content"],[1,"info-row"],[1,"season-description"],[1,"card-actions"],[1,"btn-action",3,"click"],[1,"btn-action",3,"click","disabled"],[1,"classes-table"],[3,"inactive"],[1,"action-buttons"],[1,"btn-sm",3,"click"],["title","Set base/addon/early-bird prices to inherit from Season defaults",1,"btn-sm",3,"click","disabled"],[1,"btn-sm",3,"click","disabled"],[1,"dialog"],[1,"dialog-form"],[1,"form-row","form-row-3"],[1,"form-group","form-group-wide"],["for","seasonName"],["type","text","id","seasonName","required","",3,"ngModelChange","ngModel"],[1,"form-group"],["for","seasonYear"],["type","number","id","seasonYear","required","",3,"ngModelChange","ngModel","disabled"],[1,"form-group","form-group-checkbox"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"form-row"],["for","seasonStartDate"],["type","date","id","seasonStartDate","required","",3,"ngModelChange","ngModel"],["for","seasonEndDate"],["type","date","id","seasonEndDate","required","",3,"ngModelChange","ngModel"],[1,"form-section-header"],[1,"hint"],["for","seasonBasePrice"],["type","number","id","seasonBasePrice","step","0.01","min","0","required","",3,"ngModelChange","ngModel"],["for","seasonLunchPrice"],["type","number","id","seasonLunchPrice","step","0.01","min","0","required","",3,"ngModelChange","ngModel"],["for","seasonExtendedCarePrice"],["type","number","id","seasonExtendedCarePrice","step","0.01","min","0","required","",3,"ngModelChange","ngModel"],[1,"collapsible-section"],["type","button",1,"section-toggle",3,"click"],[1,"toggle-icon"],[1,"section-badge"],[1,"section-content"],[1,"dialog-actions"],[1,"btn-secondary",3,"click"],[1,"btn-primary",3,"click","disabled"],["id","seasonDescription","rows","3","placeholder","Optional description (supports Markdown)",3,"ngModelChange","ngModel"],["for","siblingDiscount"],[1,"input-with-hint"],["type","number","id","siblingDiscount","step","0.01","min","0",3,"ngModelChange","ngModel"],["for","multiSessionDiscounts"],["type","text","id","multiSessionDiscounts","placeholder","2:10.00, 3:20.00",3,"ngModelChange","ngModel"],[1,"discount-preview","error"],[1,"discount-preview"],[1,"discount-tier"],[1,"early-bird-tiers"],[1,"tier-row"],["type","button",1,"btn-add-tier",3,"click"],["type","date","placeholder","Deadline",3,"ngModelChange","ngModel"],["type","number","step","0.01","min","0","placeholder","Price ($)",3,"ngModelChange","ngModel"],[1,"tier-price-hint"],["type","button",1,"btn-remove",3,"click"],["for","className"],["type","text","id","className","required","",3,"ngModelChange","ngModel"],["for","classStartDate"],["type","date","id","classStartDate","required","",3,"ngModelChange","ngModel"],["for","classEndDate"],["type","date","id","classEndDate","required","",3,"ngModelChange","ngModel"],["for","classLocation"],["type","text","id","classLocation",3,"ngModelChange","ngModel"],["for","classCapacity"],["type","number","id","classCapacity","min","1","required","",3,"ngModelChange","ngModel"],[1,"form-section"],["for","classBasePrice"],["type","number","id","classBasePrice","step","0.01","min","0",3,"ngModelChange","ngModel","placeholder"],[1,"hint","inherited"],["for","classLunchPrice"],["type","number","id","classLunchPrice","step","0.01","min","0",3,"ngModelChange","ngModel","placeholder"],["for","classExtendedCarePrice"],["type","number","id","classExtendedCarePrice","step","0.01","min","0",3,"ngModelChange","ngModel","placeholder"],[1,"inherited-preview"],["for","classSeason"],["id","classSeason","required","",3,"ngModelChange","ngModel"],["type","button",1,"btn-inherit"],["type","button",1,"btn-inherit",3,"click"],[1,"coupon-section"],[1,"coupon-list"],[1,"no-coupons"],[1,"add-coupon-section"],[1,"coupon-select-row"],[1,"error-message"],[1,"coupon-item"],[1,"coupon-info"],[1,"coupon-name"],[1,"coupon-id"],[1,"coupon-credit"],[1,"btn-remove-coupon",3,"click","disabled"],[1,"coupon-select",3,"ngModelChange","ngModel"],[1,"btn-add-coupon",3,"click","disabled"]],template:function(e,a){e&1&&(o(0,"app-admin-layout",0)(1,"div",1)(2,"div",2)(3,"button",3),g("click",function(){return a.viewMode.set("seasons")}),l(4),n(),o(5,"button",3),g("click",function(){return a.viewMode.set("classes")}),l(6),n()(),o(7,"div",4)(8,"div",5)(9,"label",6)(10,"input",7),g("change",function(d){return a.onActiveOnlyChange(d)}),n(),o(11,"span"),l(12,"Active Only"),n()(),_(13,me,5,1,"select",8),n(),o(14,"button",9),g("click",function(){return a.openCreateDialog()}),l(15),n()(),_(16,pe,4,0,"div",10),_(17,_e,7,1,"div",11),_(18,fe,4,1,"div",12),_(19,Se,24,1,"div",13),_(20,tt,7,4,"div",14),n()()),e&2&&(s(3),w("active",a.viewMode()==="seasons"),s(),S(" Seasons (",a.seasonService.seasons().length,") "),s(),w("active",a.viewMode()==="classes"),s(),S(" Classes (",a.seasonService.classes().length,") "),s(4),v("checked",a.showActiveOnly()),s(3),C(a.viewMode()==="classes"?13:-1),s(2),S(" + Create ",a.viewMode()==="seasons"?"Season":"Class"," "),s(),C(a.seasonService.loading()?16:-1),s(),C(a.seasonService.error()?17:-1),s(),C(a.viewMode()==="seasons"&&!a.seasonService.loading()&&!a.seasonService.error()?18:-1),s(),C(a.viewMode()==="classes"&&!a.seasonService.loading()&&!a.seasonService.error()?19:-1),s(),C(a.dialogMode()?20:-1))},dependencies:[N,oe,ee,te,K,Z,J,$,Q,ie,ne,X,re],styles:[".admin-catalog[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:1.5rem}.tab-bar[_ngcontent-%COMP%]{display:flex;gap:.5rem;border-bottom:2px solid #e0e0e0;margin-bottom:1.5rem}.tab[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:none;border:none;border-bottom:3px solid transparent;cursor:pointer;font-size:1rem;font-weight:500;color:#666;transition:all .2s}.tab[_ngcontent-%COMP%]:hover{color:#333}.tab.active[_ngcontent-%COMP%]{color:var(--sys-primary, #c62828);border-bottom-color:var(--sys-primary, #c62828)}.filter-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding:1rem;background:#f5f5f5;border-radius:8px}.filter-controls[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}.toggle-filter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer}.season-filter[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem}.btn-create[_ngcontent-%COMP%]{padding:.75rem 1.25rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:6px;font-weight:500;cursor:pointer}.btn-create[_ngcontent-%COMP%]:hover{background:#a51c1c}.seasons-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:1.5rem}.season-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;padding:1.5rem;transition:box-shadow .2s}.season-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a}.season-card.inactive[_ngcontent-%COMP%]{opacity:.6}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:start;margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid #f0f0f0}.card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1.25rem}.season-dates[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:#666}.status-badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.75rem;font-weight:500;background:#e0e0e0;color:#666}.status-badge.active[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.card-content[_ngcontent-%COMP%]{margin-bottom:1rem}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;font-size:.875rem}.season-description[_ngcontent-%COMP%]{margin-top:.75rem;padding-top:.75rem;border-top:1px solid #f0f0f0;font-size:.875rem;color:#666;white-space:pre-wrap}.card-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn-action[_ngcontent-%COMP%]{flex:1;padding:.5rem;background:#fff;border:1px solid #ddd;border-radius:6px;cursor:pointer;font-size:.875rem}.btn-action[_ngcontent-%COMP%]:hover:not(:disabled){background:#f5f5f5}.btn-action.btn-activate[_ngcontent-%COMP%]{border-color:var(--sys-primary, #c62828);color:var(--sys-primary, #c62828)}.btn-action[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.classes-table-container[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:8px;overflow:hidden}.classes-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.classes-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f5f5f5}.classes-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .classes-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;text-align:left;border-bottom:1px solid #e0e0e0}.classes-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;font-size:.875rem;color:#666}.classes-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.875rem}.classes-table[_ngcontent-%COMP%]   tr.inactive[_ngcontent-%COMP%]{opacity:.6}.classes-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f9f9f9}.text-warning[_ngcontent-%COMP%]{color:#ff9800;font-weight:600}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;background:#fff;border:1px solid #ddd;border-radius:4px;font-size:.75rem;cursor:pointer}.btn-sm[_ngcontent-%COMP%]:hover:not(:disabled){background:#f5f5f5}.btn-sm.btn-activate[_ngcontent-%COMP%]{border-color:var(--sys-primary, #c62828);color:var(--sys-primary, #c62828)}.btn-sm[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.dialog[_ngcontent-%COMP%]{background:#fff;border-radius:8px;padding:2rem;max-width:600px;width:90%;max-height:90vh;overflow-y:auto;overflow-x:hidden;box-sizing:border-box}.dialog-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;overflow:hidden}.dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem;width:100%;box-sizing:border-box}.form-row-3[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr}.form-group-wide[_ngcontent-%COMP%]{grid-column:span 1}.form-group-checkbox[_ngcontent-%COMP%]{display:flex;align-items:flex-end;padding-bottom:.75rem}.form-section-header[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:.75rem;margin-top:.5rem;padding-bottom:.25rem;border-bottom:1px solid #e0e0e0}.form-section-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:.9rem;color:#333}.collapsible-section[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:6px;overflow:hidden}.section-toggle[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;width:100%;padding:.75rem 1rem;background:#f9f9f9;border:none;cursor:pointer;font-size:.875rem;font-weight:500;color:#333;text-align:left}.section-toggle[_ngcontent-%COMP%]:hover{background:#f0f0f0}.toggle-icon[_ngcontent-%COMP%]{font-size:.7rem;color:#666}.section-badge[_ngcontent-%COMP%]{margin-left:auto;padding:.125rem .5rem;background:#e8f5e9;color:#2e7d32;border-radius:10px;font-size:.7rem;font-weight:500}.section-content[_ngcontent-%COMP%]{padding:1rem;border-top:1px solid #e0e0e0}.section-content[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem;font-family:inherit;resize:vertical}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;font-size:.875rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem;font-family:inherit;box-sizing:border-box;max-width:100%}.form-group[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto;margin-right:.5rem}.input-with-hint[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.input-with-hint[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem;box-sizing:border-box;width:100%}.hint[_ngcontent-%COMP%]{font-size:.75rem;color:#666}.discount-preview[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem;margin-top:.5rem;padding:.5rem;background:#e8f5e9;border-radius:4px;font-size:.75rem}.discount-preview.error[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.discount-tier[_ngcontent-%COMP%]{background:#c8e6c9;padding:.25rem .5rem;border-radius:4px;color:#2e7d32}.early-bird-tiers[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.tier-row[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.tier-row[_ngcontent-%COMP%]   input[type=date][_ngcontent-%COMP%]{flex:1;padding:.5rem;border:1px solid #ddd;border-radius:4px;font-size:.875rem}.tier-row[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:120px;padding:.5rem;border:1px solid #ddd;border-radius:4px;font-size:.875rem}.tier-price-hint[_ngcontent-%COMP%]{font-size:.75rem;color:#666;min-width:60px}.btn-remove[_ngcontent-%COMP%]{background:#f44336;color:#fff;border:none;border-radius:4px;width:28px;height:28px;cursor:pointer;font-size:1.2rem;line-height:1;display:flex;align-items:center;justify-content:center}.btn-remove[_ngcontent-%COMP%]:hover{background:#d32f2f}.btn-add-tier[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32;border:1px dashed #4caf50;border-radius:4px;padding:.5rem 1rem;cursor:pointer;font-size:.875rem;align-self:flex-start}.btn-add-tier[_ngcontent-%COMP%]:hover{background:#c8e6c9}.btn-inherit[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2;border:1px dashed #2196f3;border-radius:4px;padding:.5rem 1rem;cursor:pointer;font-size:.875rem;align-self:flex-start;margin-left:.5rem}.btn-inherit[_ngcontent-%COMP%]:hover{background:#bbdefb}.form-section[_ngcontent-%COMP%]{margin-top:1rem;padding-top:1rem;border-top:1px solid #e0e0e0}.form-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1rem;color:#333}.hint.inherited[_ngcontent-%COMP%]{color:#1976d2;font-style:italic}.inherited-preview[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;padding:.75rem;background:#e3f2fd;border-radius:6px}.dialog-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end;margin-top:1.5rem}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:6px;font-weight:500;cursor:pointer}.btn-primary[_ngcontent-%COMP%]{background:var(--sys-primary, #c62828);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#a51c1c}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background:#f5f5f5;color:#333}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e0e0e0}.loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid #f3f3f3;border-top:3px solid var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-icon[_ngcontent-%COMP%]{width:60px;height:60px;background:#f44336;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:32px;font-weight:700;margin:0 auto 1rem}.btn-retry[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer;margin-top:1rem}.coupon-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.coupon-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1rem;color:#333}.coupon-section[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:.875rem;color:#666}.coupon-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.coupon-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#f5f5f5;border-radius:6px}.coupon-info[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}.coupon-name[_ngcontent-%COMP%]{font-weight:500}.coupon-id[_ngcontent-%COMP%]{font-size:.75rem;font-family:monospace;color:#666;background:#fff;padding:.125rem .375rem;border-radius:4px}.coupon-credit[_ngcontent-%COMP%]{color:#2e7d32;font-weight:500}.btn-remove-coupon[_ngcontent-%COMP%]{padding:.375rem .75rem;background:#f44336;color:#fff;border:none;border-radius:4px;font-size:.75rem;cursor:pointer}.btn-remove-coupon[_ngcontent-%COMP%]:hover:not(:disabled){background:#d32f2f}.btn-remove-coupon[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.no-coupons[_ngcontent-%COMP%]{padding:1rem;text-align:center;color:#666;background:#f9f9f9;border-radius:6px}.add-coupon-section[_ngcontent-%COMP%]{padding-top:1rem;border-top:1px solid #e0e0e0}.coupon-select-row[_ngcontent-%COMP%]{display:flex;gap:.5rem}.coupon-select[_ngcontent-%COMP%]{flex:1;padding:.5rem;border:1px solid #ddd;border-radius:6px;font-size:.875rem}.btn-add-coupon[_ngcontent-%COMP%]{padding:.5rem 1rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer}.btn-add-coupon[_ngcontent-%COMP%]:hover:not(:disabled){background:#a51c1c}.btn-add-coupon[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{padding:.75rem;background:#ffebee;color:#c62828;border-radius:6px;font-size:.875rem}@media(max-width:768px){.seasons-grid[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.filter-bar[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.filter-controls[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}"]})};export{se as AdminCatalogListComponent};
