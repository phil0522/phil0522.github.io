import{b as Je}from"./chunk-RWCIAQKD.js";import{c as Ge,f as Fe,i as je,j as Le,k as We,q as Be}from"./chunk-LW7CKVVA.js";import{c as Ue}from"./chunk-RYIKU5Y3.js";import{H as me,T as Re,Z as q,aa as De,ba as Te,ea as Oe,h as Ne,ia as x,n as Ie,na as Me,oa as $e,q as de,ra as ke,s as Ae,va as He}from"./chunk-TKIXSRNU.js";import"./chunk-ZEYGPIIR.js";import{Ba as G,C as V,R as ve,W as j,Y as Z,ba as ce,da as le,ha as Pe,t as U,v as D,ya as T}from"./chunk-KBXPF7D4.js";import{T as Y}from"./chunk-2PX3OE6K.js";import{$a as N,Ba as Se,Bb as be,Db as h,Ea as C,Eb as J,Fb as Ee,N as B,Qa as Ce,S as M,T as $,ab as I,da as b,db as ae,eb as ie,fb as R,gb as u,hb as g,ib as _e,ob as xe,qb as k,sb as E,zb as we}from"./chunk-CNMR2ZL6.js";import{a as oe,b as fe}from"./chunk-Q7L6LLAK.js";var at=50,it=30,H=class{constructor(t){this.firestore=t}getErrorCode(t){if(typeof t!="object"||t===null)return null;let e=t.code;return typeof e=="string"?e:null}async loadSeasonRaw(t){let e=D(this.firestore,`years/${2026}/seasons`,t),s=await T(e);if(!s.exists())throw new Error(`Season ${t} not found`);return s.data()}async loadSeason(t){let e=await this.loadSeasonRaw(t);return me(e)}async loadOrders(t,e,s=at){let o=[],r=U(this.firestore,`years/${2026}/seasons/${t}/orders`),a=null,i=0;for(;;){i++,e({step:"Loading orders...",detail:`batch ${i}`});let d=a?j(r,ce("userAuthId"),le(s),Pe(a)):j(r,ce("userAuthId"),le(s)),c=await G(d);for(let p of c.docs)o.push(p.data());if(c.size<s)break;a=c.docs[c.docs.length-1]}return o}async loadUsers(t,e,s=it){let o=new Map,r=[...new Set(t)];if(r.length===0)return o;let a=U(this.firestore,"users"),i=Math.ceil(r.length/s);for(let d=0;d<r.length;d+=s){let c=Math.floor(d/s)+1;e({step:"Loading user data...",detail:`batch ${c} of ${i}`});let p=r.slice(d,d+s),_=j(a,Z(ve(),"in",p)),m=await G(_);for(let y of m.docs){let S=y.data();o.set(S.uid,S)}}return o}async loadRegistration(t){let e=D(this.firestore,`years/${2026}/registrations`,t),s=await T(e);return s.exists()?s.data():null}async loadSystemConfig(){let t=D(this.firestore,"system","config"),e=await T(t);return e.exists()?e.data():null}async loadAdminUserCache(){let t=D(this.firestore,"admin","userCache"),e=await T(t);return e.exists()?e.data():null}async loadAdminEmailTemplates(){let t=D(this.firestore,"admin","email","templates","all_templates"),e=await T(t);return e.exists()?e.data():null}async loadAdminEmailSeasonTemplateStats(t){let e=U(this.firestore,"admin","email","season_template_stats"),s=j(e,Z("seasonId","==",t));return(await G(s)).docs.map(r=>r.data())}async loadAdminEmailBatchJobs(t){let e=U(this.firestore,"admin","email","batch_jobs"),s=j(e,Z("seasonId","==",t));return(await G(s)).docs.map(r=>r.data())}async loadCounters(){let t=U(this.firestore,"system","counters","entities"),e=await G(t);if(e.size>0)return e.docs.map(r=>({id:r.id,data:r.data()}));let s=D(this.firestore,"system","counters"),o=await T(s);return o.exists()?[{id:o.id,data:o.data()}]:[]}async loadCoupons(t,e){let s=[],o=U(this.firestore,"coupons"),r=await G(o);for(let d of r.docs)s.push(d.data());let a=new Set(s.map(d=>d.id));for(let d of t.coupons??[])a.has(d.id)||(s.push(d),a.add(d.id));let i=new Set;for(let d of e)for(let c of d.appliedCouponIds??[])a.has(c)||i.add(c);for(let d of i){let c=D(this.firestore,"coupons",d),p=await T(c);if(p.exists()){let _=p.data();a.has(_.id)||(s.push(_),a.add(_.id))}}return s}async loadAllData(t,e){e({step:"Loading season data..."});let s=await this.loadSeasonRaw(t),o=me(s),r=await this.loadOrders(t,e),a=r.map(l=>l.userAuthId),i=await this.loadUsers(a,e);e({step:"Loading registration data..."});let d=await this.loadRegistration(t);e({step:"Loading coupon data..."});let c=await this.loadCoupons(o,r);e({step:"Loading system config..."});let p=null;try{p=await this.loadSystemConfig()}catch(l){if(this.getErrorCode(l)!=="permission-denied")throw l;e({step:"Skipping system config (permission denied)"})}e({step:"Loading admin cache..."});let _=null;try{_=await this.loadAdminUserCache()}catch(l){if(this.getErrorCode(l)!=="permission-denied")throw l;e({step:"Skipping admin cache (permission denied)"})}e({step:"Loading system counters..."});let m=[];try{m=await this.loadCounters()}catch(l){if(this.getErrorCode(l)!=="permission-denied")throw l;e({step:"Skipping system counters (permission denied)"})}e({step:"Loading admin email templates..."});let y=null;try{y=await this.loadAdminEmailTemplates()}catch(l){if(this.getErrorCode(l)!=="permission-denied")throw l;e({step:"Skipping admin email templates (permission denied)"})}e({step:"Loading admin email season stats..."});let S=[];try{S=await this.loadAdminEmailSeasonTemplateStats(t)}catch(l){if(this.getErrorCode(l)!=="permission-denied")throw l;e({step:"Skipping admin email season stats (permission denied)"})}e({step:"Loading admin email batch jobs..."});let f=[];try{f=await this.loadAdminEmailBatchJobs(t)}catch(l){if(this.getErrorCode(l)!=="permission-denied")throw l;e({step:"Skipping admin email batch jobs (permission denied)"})}return{seasonRaw:s,season:o,orders:r,users:i,registration:d,coupons:c,systemConfig:p,adminUserCache:_,counters:m,adminEmailTemplates:y,adminEmailSeasonTemplateStats:S,adminEmailBatchJobs:f}}};var K="https://sheets.googleapis.com/v4/spreadsheets",X=null,Q=0,dt=3300*1e3;var ee=class{sheetIdCache=new Map;async acquireAccessToken(){if(X&&Date.now()<Q)return x("[GoogleSheets] Using cached access token (expires in",Math.round((Q-Date.now())/1e3/60),"minutes)"),X;x("[GoogleSheets] Acquiring new access token via OAuth popup...");let t=new de;t.addScope("https://www.googleapis.com/auth/spreadsheets"),x("[GoogleSheets] Opening sign-in popup...");let e=await Ae(He,t);x("[GoogleSheets] Sign-in popup completed, user:",e.user?.email);let s=de.credentialFromResult(e);if(x("[GoogleSheets] Credential extracted:",s?"success":"null"),!s)throw console.error("[GoogleSheets] Failed to obtain Google credentials from result:",e),new Error("Failed to obtain Google credentials");let o=s.accessToken;if(x("[GoogleSheets] Access token present:",!!o),!o)throw console.error("[GoogleSheets] Credential has no accessToken. Credential type:",s.providerId),new Error("Failed to obtain access token");return X=o,Q=Date.now()+dt,x("[GoogleSheets] Access token cached successfully"),o}clearCachedToken(){x("[GoogleSheets] Clearing cached access token"),X=null,Q=0}async createSpreadsheet(t,e,s){x("[GoogleSheets] Creating spreadsheet:",{title:t,sheetNames:e}),x("[GoogleSheets] Access token length:",s?.length||0);let o={properties:{title:t},sheets:e.map(i=>({properties:{title:i}}))};x("[GoogleSheets] Request body:",JSON.stringify(o));let r;try{r=await fetch(K,{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(o)})}catch(i){throw console.error("[GoogleSheets] Network error during createSpreadsheet:",i),new Error(`Network error creating spreadsheet: ${i instanceof Error?i.message:String(i)}`)}if(x("[GoogleSheets] createSpreadsheet response status:",r.status,r.statusText),!r.ok){let i=await r.text();throw console.error("[GoogleSheets] createSpreadsheet API error:",{status:r.status,statusText:r.statusText,errorText:i,headers:Object.fromEntries(r.headers.entries())}),(r.status===401||r.status===403)&&(x("[GoogleSheets] Auth error detected, clearing cached token"),this.clearCachedToken()),new Error(`Google Sheets API error (${r.status}): ${i}`)}let a=await r.json();return x("[GoogleSheets] Spreadsheet created successfully:",{spreadsheetId:a.spreadsheetId,spreadsheetUrl:a.spreadsheetUrl}),{spreadsheetId:a.spreadsheetId,spreadsheetUrl:a.spreadsheetUrl}}async writeSheetData(t,e,s,o){x("[GoogleSheets] Writing sheet data:",{spreadsheetId:t,sheetName:e,rowCount:s.length,columnCount:s[0]?.length||0});let r=encodeURIComponent(e),a=`${K}/${t}/values/${r}?valueInputOption=RAW`,i;try{i=await fetch(a,{method:"PUT",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({range:e,majorDimension:"ROWS",values:s})})}catch(d){throw console.error("[GoogleSheets] Network error during writeSheetData:",d),new Error(`Network error writing sheet data: ${d instanceof Error?d.message:String(d)}`)}if(x("[GoogleSheets] writeSheetData response status:",i.status,i.statusText),!i.ok){let d=await i.text();throw console.error("[GoogleSheets] writeSheetData API error:",{status:i.status,statusText:i.statusText,errorText:d,sheetName:e}),(i.status===401||i.status===403)&&(x("[GoogleSheets] Auth error detected, clearing cached token"),this.clearCachedToken()),new Error(`Google Sheets API error (${i.status}): ${d}`)}x("[GoogleSheets] Sheet data written successfully:",e)}async applyHeaderStyles(t,e,s,o){let r=[...new Set(s)].filter(c=>c>=0);if(r.length===0)return;let a=await this.resolveSheetId(t,e,o),i=r.map(c=>({repeatCell:{range:{sheetId:a,startRowIndex:c,endRowIndex:c+1},cell:{userEnteredFormat:{backgroundColor:{red:.68,green:.16,blue:.16},horizontalAlignment:"CENTER",textFormat:{bold:!0,foregroundColor:{red:1,green:1,blue:1}}}},fields:"userEnteredFormat(backgroundColor,textFormat,horizontalAlignment)"}})),d;try{d=await fetch(`${K}/${t}:batchUpdate`,{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({requests:i})})}catch(c){throw new Error(`Network error styling sheet: ${c instanceof Error?c.message:String(c)}`)}if(!d.ok){let c=await d.text();throw(d.status===401||d.status===403)&&this.clearCachedToken(),new Error(`Google Sheets API error (${d.status}): ${c}`)}}async resolveSheetId(t,e,s){let o=`${t}:${e}`,r=this.sheetIdCache.get(o);if(typeof r=="number")return r;let a;try{a=await fetch(`${K}/${t}?fields=sheets(properties(sheetId,title))`,{method:"GET",headers:{Authorization:`Bearer ${s}`}})}catch(c){throw new Error(`Network error resolving sheet id: ${c instanceof Error?c.message:String(c)}`)}if(!a.ok){let c=await a.text();throw(a.status===401||a.status===403)&&this.clearCachedToken(),new Error(`Google Sheets API error (${a.status}): ${c}`)}let d=(await a.json()).sheets?.find(c=>c.properties?.title===e)?.properties;if(typeof d?.sheetId!="number")throw new Error(`Unable to find sheet id for "${e}"`);return this.sheetIdCache.set(o,d.sheetId),d.sheetId}};function A(n){return`$${(n/100).toFixed(2)}`}function pe(n){return(n/100).toFixed(2)}function Ye(n,t,e){let s=n.get(t);return s?(s.students??[]).find(o=>o.id===e)??null:null}function ct(n,t){return n.sessions.find(e=>e.id===t)?.name??t}function ge(n){return JSON.stringify(n??null)}function z(n,t=", "){return n.filter(e=>typeof e=="string"&&e.trim().length>0).join(t)}function he(n,t){return z([n??"",t??""]," ").trim()}function lt(n){return n.lunch&&n.extendedCare?"Lunch + Extended Care":n.lunch?"Lunch":n.extendedCare?"Extended Care":"None"}function ne(n){let t=/^(\d{4})-(\d{2})-(\d{2})$/.exec(n);if(!t)return null;let e=Number(t[1]),s=Number(t[2]),o=Number(t[3]),r=new Date(Date.UTC(e,s-1,o));return r.getUTCFullYear()!==e||r.getUTCMonth()!==s-1||r.getUTCDate()!==o?null:r}function mt(n,t,e){let s=/^\d{4}-(\d{2})-(\d{2})$/.exec(n);if(!s)return!1;let o=Number(s[1]),r=Number(s[2]),a=ne(t),i=ne(e);if(!a||!i)return!1;let d=new Set([a.getUTCFullYear(),i.getUTCFullYear()]);for(let c of d){let p=new Date(Date.UTC(c,o-1,r));if(!(p.getUTCMonth()!==o-1||p.getUTCDate()!==r)&&p>=a&&p<=i)return!0}return!1}function pt(n,t){let e=ne(n),s=ne(t);if(!e||!s)return"";let o=s.getUTCFullYear()-e.getUTCFullYear(),r=s.getUTCMonth()-e.getUTCMonth(),a=s.getUTCDate()-e.getUTCDate();return(r<0||r===0&&a<0)&&(o-=1),String(Math.max(o,0))}var te="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function ut(n){let t=/week\s*(\d+)/i.exec(n);return t?Number(t[1]):Number.MAX_SAFE_INTEGER}function gt(n){let t=te.length;if(n<t)return te[n]??"Z";let e=Math.floor(n/t)-1,s=n%t,o=te[e]??"Z",r=te[s]??"Z";return`${o}${r}`}function Ve(n){let t=[...n.sessions].sort((s,o)=>s.name.localeCompare(o.name)),e=new Map;return t.map(s=>{let o=ut(s.name),r=e.get(o)??0,a=gt(r);e.set(o,r+1);let i=Number.isFinite(o)&&o!==Number.MAX_SAFE_INTEGER?`${o}${a}`:`X${a}`;return{sessionId:s.id,sessionName:s.name,weekNumber:o,suffix:a,code:i}})}function ht(n){let t=n.payments??[];return t.length===0?"":t.map(e=>z([e.recordedAt.slice(0,10),A(e.amount)]," ")).join("; ")}function yt(n){switch(n){case"sibling":return"SIB";case"returning_family":case"returning_student":return"RTN";case"multi_session":return"MULTI";case"coupon":return"CPN";case"manual":return"MAN";case"referral":return"REF";default:return n.toUpperCase()}}function ue(n){let t=A(Math.abs(n));return n<0?`-${t}`:t}function ft(n,t){let e=/-K(\d+)$/.exec(n);return e?`K${e[1]}`:`K${t+1}`}function St(n,t){let e=[];t.filter(r=>r.subtotalCents!==0).forEach((r,a)=>{e.push(`${ft(r.studentId,a)}: ${A(r.subtotalCents)}`)});for(let r of n.pricing?.discounts??[])r.amount!==0&&e.push(`${yt(r.type)}: ${ue(r.amount)}`);for(let r of n.processingFees??[]){if(r.amount===0)continue;let a=r.description.trim().length>0?r.description:r.type.toUpperCase();e.push(`${a}: ${ue(r.amount)}`)}for(let r of n.adjustments??[])r.amount!==0&&e.push(`${r.reason}: ${ue(r.amount)}`);let s=(n.processingFees??[]).reduce((r,a)=>r+a.amount,0)+(n.adjustments??[]).reduce((r,a)=>r+a.amount,0),o=(n.pricing?Re(n.pricing):0)+s;return o!==0&&e.push(`Total: ${A(o)}`),e.join(" | ")}function ze(n){let t=/^(\d+)([A-Z]+)$/.exec(n);return t?{week:Number(t[1]),suffix:t[2]??""}:null}function ye(n,t){let e=ze(n),s=ze(t);return!e&&!s?n.localeCompare(t):e?s?e.week!==s.week?e.week-s.week:e.suffix.localeCompare(s.suffix):-1:1}function Ct(n,t){if(n.length===0)return"None";let e=n.filter(r=>r.options.lunch).map(r=>t.get(r.sessionId)??r.sessionId).sort(ye),s=n.filter(r=>r.options.extendedCare).map(r=>t.get(r.sessionId)??r.sessionId).sort(ye),o=[];return e.length>0&&(e.length===n.length?o.push("Lunch"):o.push(`Lunch(${e.join(", ")})`)),s.length>0&&(s.length===n.length?o.push("EC"):o.push(`EC(${s.join(", ")})`)),o.length>0?o.join(" | "):"None"}function Ze(n){let t=["Session Code","Session Name","Session ID","Week Number","Suffix"],e=Ve(n).map(s=>[s.code,s.sessionName,s.sessionId,Number.isFinite(s.weekNumber)&&s.weekNumber!==Number.MAX_SAFE_INTEGER?String(s.weekNumber):"",s.suffix]);return[t,...e]}function qe(n,t,e){let s=["Student Display ID","Parent Name","Parent Email","Parent WeChat Name","Student Name","Student Birthday","Enrolled Classes","Enrolled Classes Count","Addons","Student Subtotal","Remaining Balance","Cash Balance","Payment History (First Student Only)","Pricing Details (First Student Only)"],o=Ve(e),r=new Map(o.map(i=>[i.sessionId,i.code])),a=[];for(let i of n){let d=t.get(i.userAuthId),c=i.items.filter(m=>m.cancelledAt==null&&(m.status==="submitted"||m.status==="secured"||m.status==="paid"));if(c.length===0)continue;let p=new Map;for(let m of c){let y=p.get(m.studentId)??[];y.push(m),p.set(m.studentId,y)}let _=[...p.keys()].sort((m,y)=>m.localeCompare(y));_.forEach((m,y)=>{let S=[...p.get(m)??[]].sort((w,W)=>{let re=r.get(w.sessionId)??w.sessionId,se=r.get(W.sessionId)??W.sessionId;return ye(re,se)}),f=Ye(t,i.userAuthId,m),l=f?`${f.firstName} ${f.lastName}`.trim():S[0]?.snapshot.studentName??m,v=S.map(w=>r.get(w.sessionId)??w.sessionId),P=S.reduce((w,W)=>w+W.snapshot.priceSnapshot.itemTotal,0),O=_.map(w=>{let re=(p.get(w)??[]).reduce((se,ot)=>se+ot.snapshot.priceSnapshot.itemTotal,0);return{studentId:w,subtotalCents:re}}),F=he(d?.primaryGuardian?.firstName??"",d?.primaryGuardian?.lastName??"");a.push({studentId:m,cells:[f?.id??m,F||d?.displayName||"",d?.email??"",d?.primaryGuardian?.wechatName??"",l,f?.dob??"",v.join(", "),String(S.length),Ct(S,r),pe(P),pe(q(i)),pe(Oe(q(i))),y===0?ht(i):"",y===0?St(i,O):""]})})}return a.sort((i,d)=>i.studentId.localeCompare(d.studentId)),[s,...a.map(i=>i.cells)]}function Ke(n,t){let e=["User Display ID","Parent Name","Parent Email","Order Total","Coupon Discount","Total Paid","Balance Due","Payment Count","Payment Details","Refund Total"],s=[];for(let o of n){if(!o.items.some(y=>y.status==="submitted"||y.status==="paid"))continue;let a=t.get(o.userAuthId),i=Te(o),d=o.couponDiscount??0,c=o.totalPaid??0,p=De(o),_=q(o),m=(o.payments??[]).map(y=>`${y.method} ${A(y.amount)} ${y.recordedAt}${y.reference?` ref:${y.reference}`:""}`).join("; ");s.push([o.userDisplayId,a?.displayName??"",a?.email??"",A(i),A(d),A(c),A(_),String((o.payments??[]).length),m,A(p)])}return[e,...s]}function Xe(n,t){let e=["Coupon ID","Name","Description","Type","Max Credit (cents)","Eligible Emails","Used By (Order Count)"],s=new Map;for(let r of t)for(let a of r.appliedCouponIds??[])s.set(a,(s.get(a)??0)+1);let o=n.map(r=>[r.id,r.name,r.description,r.coupon_type,String(r.maxCreditCents),(r.eligible_emails??[]).join(", "),String(s.get(r.id)??0)]);return[e,...o]}function Qe(n,t,e){let s=["User Display ID","Parent Name","Parent Email","Session ID","Session Name","Joined At"],o=[];for(let r of n){let a=t.get(r.userAuthId);for(let i of r.waitlist??[])o.push([r.userDisplayId,a?.displayName??"",a?.email??"",i.sessionId,ct(e,i.sessionId),i.joinedAt])}return[s,...o]}function et(n,t,e){let s=["ParentName","ParentPhone","Parent WeChat ID(s)","Parent WeChat Name(s)","Child","Student Birthday","Add-on","Allergies","Notes","Age"],o=new Map;for(let a of t){let i=e.get(a.userAuthId),d=he(i?.primaryGuardian?.firstName??"",i?.primaryGuardian?.lastName??"")||(i?.displayName??""),c=[];i?.primaryGuardian?.phone&&c.push(i.primaryGuardian.phone);let p=he(i?.secondaryGuardian?.firstName??"",i?.secondaryGuardian?.lastName??"");(p||i?.secondaryGuardian?.phone)&&(p&&i?.secondaryGuardian?.phone?c.push(`${p} (${i.secondaryGuardian.phone})`):p?c.push(p):i?.secondaryGuardian?.phone&&c.push(i.secondaryGuardian.phone)),(i?.emergencyContact?.name||i?.emergencyContact?.phone)&&(i?.emergencyContact?.name&&i?.emergencyContact?.phone?c.push(`${i.emergencyContact.name}(${i.emergencyContact.phone})`):i?.emergencyContact?.name?c.push(i.emergencyContact.name):i?.emergencyContact?.phone&&c.push(i.emergencyContact.phone));let _=c.join(", "),m=z([i?.primaryGuardian?.wechatId??"",i?.secondaryGuardian?.wechatId??""]," / "),y=z([i?.primaryGuardian?.wechatName??"",i?.secondaryGuardian?.wechatName??""]," / ");for(let S of a.items){if(S.cancelledAt!=null)continue;let f=n.sessions.find(w=>w.id===S.sessionId);if(!f)continue;let l=Ye(e,a.userAuthId,S.studentId),v=l?`${l.firstName} ${l.lastName}`.trim():S.snapshot.studentName??S.studentId,P=l?.dob?mt(l.dob,f.startDate,f.endDate):!1,O=z([l?.dietaryNotes?`Dietary: ${l.dietaryNotes}`:"",l?.medicalNotes?`Medical: ${l.medicalNotes}`:""]," | "),F=o.get(S.sessionId)??[];F.push({parentName:d,parentPhone:_,parentWeChatIds:m,parentWeChatNames:y,childName:`${v}${P?" \u{1F382}":""}`,birthday:l?.dob??"",addons:lt(S.options),allergies:l?.allergies??"",notes:O,age:l?.dob?pt(l.dob,f.startDate):""}),o.set(S.sessionId,F)}}let r=[];for(let a of n.sessions){r.push([`\u2728 ${a.name} \u2022 Weekly Student Table`]),r.push(["Session",a.name]),r.push(s);let i=(o.get(a.id)??[]).sort((d,c)=>d.childName.localeCompare(c.childName));if(i.length===0)r.push(["(No enrolled students)","","","","","","","","",""]);else for(let d of i)r.push([d.parentName,d.parentPhone,d.parentWeChatIds,d.parentWeChatNames,d.childName,d.birthday,d.addons,d.allergies,d.notes,d.age]);r.push([""])}return r}var _t={studentId:"Student ID",studentFirstName:"Student First Name",studentLastName:"Student Last Name",studentDob:"Student DOB",studentGender:"Student Gender",studentAllergies:"Student Allergies",studentDietaryNotes:"Student Dietary Notes",studentMedicalNotes:"Student Medical Notes",studentSchool:"Student School",studentLastCampYear:"Student Last Camp Year",studentGrade:"Student Grade",studentReferCode:"Student Refer Code",parentDisplayId:"Parent Display ID",parentEmail:"Parent Email",parentDisplayName:"Parent Display Name",primaryFirstName:"Primary First Name",primaryLastName:"Primary Last Name",primaryPhone:"Primary Phone",primaryWechatId:"Primary WeChat ID",primaryWechatName:"Primary WeChat Name",secondaryFirstName:"Secondary First Name",secondaryLastName:"Secondary Last Name",secondaryPhone:"Secondary Phone",emergencyName:"Emergency Contact Name",emergencyPhone:"Emergency Contact Phone",emergencyRelationship:"Emergency Contact Relationship"};function xt(n,t){return{studentId:n.id,studentFirstName:n.firstName,studentLastName:n.lastName,studentDob:n.dob,studentGender:n.gender,studentAllergies:n.allergies,studentDietaryNotes:n.dietaryNotes??"",studentMedicalNotes:n.medicalNotes??"",studentSchool:n.school??"",studentLastCampYear:n.lastCampYear??"",studentGrade:n.grade??"",studentReferCode:n.referCode??"",parentDisplayId:t.displayId,parentEmail:t.email,parentDisplayName:t.displayName,primaryFirstName:t.primaryGuardian?.firstName??"",primaryLastName:t.primaryGuardian?.lastName??"",primaryPhone:t.primaryGuardian?.phone??"",primaryWechatId:t.primaryGuardian?.wechatId??"",primaryWechatName:t.primaryGuardian?.wechatName??"",secondaryFirstName:t.secondaryGuardian?.firstName??"",secondaryLastName:t.secondaryGuardian?.lastName??"",secondaryPhone:t.secondaryGuardian?.phone??"",emergencyName:t.emergencyContact?.name??"",emergencyPhone:t.emergencyContact?.phone??"",emergencyRelationship:t.emergencyContact?.relationship??""}}function tt(n){let t=[];for(let o of n.values())for(let r of o.students??[])t.push({student:r,user:o});t.sort((o,r)=>{let a=o.user.displayId.localeCompare(r.user.displayId);return a!==0?a:o.student.id.localeCompare(r.student.id)});let e=Object.values(_t),s=t.map(({student:o,user:r})=>Object.values(xt(o,r)));return[e,...s]}var wt={isSystemInitialized:"System Initialized",currentDate:"Current Date",currentTime:"Current Time",allowEnrollment:"Allow Enrollment",maintenanceMode:"Maintenance Mode",financials:"Financials (JSON)",paymentInstructions:"Payment Instructions",returnInstructions:"Return Instructions",releaseAgreementContent:"Release Agreement Content",mediaPolicyContent:"Media Policy Content",formsPageContent:"Forms Page Content",contactEmail:"Contact Email",contactPhone:"Contact Phone",contactAddress:"Contact Address",waitlistLastRecalculationAt:"Waitlist Last Recalculation",waitlistRaw:"Waitlist Config (JSON)"};function bt(n){return{isSystemInitialized:n.isSystemInitialized?"Yes":"No",currentDate:n.currentDate,currentTime:n.currentTime,allowEnrollment:n.systemSwitch.allowEnrollment?"Yes":"No",maintenanceMode:n.systemSwitch.maintenanceMode?"Yes":"No",financials:ge(n.financials),paymentInstructions:n.paymentInstructions.content,returnInstructions:n.returnInstructions?.content??"",releaseAgreementContent:n.releaseAgreementContent?.content??"",mediaPolicyContent:n.mediaPolicyContent?.content??"",formsPageContent:n.formsPageContent?.content??"",contactEmail:n.contactInfo.email,contactPhone:n.contactInfo.phone,contactAddress:n.contactInfo.address??"",waitlistLastRecalculationAt:n.waitlist?.lastRecalculationAt??"",waitlistRaw:ge(n.waitlist??null)}}function nt(n){let t=Object.values(wt),e=Object.values(bt(n));return[t,e]}function rt(n){let t=["Key","Value"],e=[["exportedAt",n.exportedAt],["year",String(n.year)],["seasonId",n.seasonId],["seasonName",n.seasonName],["counts",ge(n.counts)]];return[t,...e]}var Et=(n,t)=>t.id,Nt=(n,t)=>t.label;function It(n,t){n&1&&(u(0,"div",3),_e(1,"div",4),u(2,"p"),h(3,"Loading seasons..."),g()())}function At(n,t){if(n&1&&(u(0,"option",10),h(1),g()),n&2){let e=t.$implicit;R("value",e.id),C(),J(e.name)}}function vt(n,t){n&1&&h(0," Exporting... ")}function Pt(n,t){n&1&&h(0," Download JSON File ")}function Rt(n,t){n&1&&h(0," Export to Google Sheets ")}function Dt(n,t){n&1&&h(0," \u25CB ")}function Tt(n,t){n&1&&h(0," \u25CC ")}function Ot(n,t){n&1&&h(0," \u2713 ")}function Mt(n,t){n&1&&h(0," \u2717 ")}function $t(n,t){if(n&1&&(u(0,"span",28),h(1),g()),n&2){let e=E().$implicit;C(),Ee("(",e.detail,")")}}function kt(n,t){if(n&1&&(u(0,"div",25)(1,"span",26),N(2,Dt,1,0)(3,Tt,1,0)(4,Ot,1,0)(5,Mt,1,0),g(),u(6,"span",27),h(7),g(),N(8,$t,2,1,"span",28),g()),n&2){let e,s=t.$implicit;be("step-pending",s.status==="pending")("step-in-progress",s.status==="in-progress")("step-completed",s.status==="completed")("step-error",s.status==="error"),C(2),I((e=s.status)==="pending"?2:e==="in-progress"?3:e==="completed"?4:e==="error"?5:-1),C(5),J(s.label),C(),I(s.detail?8:-1)}}function Ut(n,t){if(n&1&&(u(0,"div",17)(1,"h3"),h(2,"Export Progress"),g(),u(3,"div",23),ae(4,kt,9,11,"div",24,Nt),g()()),n&2){let e=E(2);C(4),ie(e.steps())}}function Gt(n,t){n&1&&h(0," Importing... ")}function Ft(n,t){n&1&&h(0," Select JSON File to Import ")}function jt(n,t){if(n&1&&(u(0,"div",21)(1,"div",29),h(2,"\u2713"),g(),u(3,"h3"),h(4,"Export Complete"),g(),u(5,"a",30),h(6," Open Spreadsheet \u2192 "),g()()),n&2){let e=E(2);C(5),R("href",e.spreadsheetUrl(),Se)}}function Lt(n,t){n&1&&(u(0,"div",21)(1,"div",29),h(2,"\u2713"),g(),u(3,"h3"),h(4,"JSON Export Complete"),g(),u(5,"p"),h(6,"The file has been downloaded to your device."),g()())}function Wt(n,t){if(n&1&&(u(0,"div",21)(1,"div",29),h(2,"\u2713"),g(),u(3,"h3"),h(4,"Import Complete"),g(),u(5,"p"),h(6),g()()),n&2){let e=E(2);C(6),J(e.importSummary())}}function Bt(n,t){if(n&1&&(u(0,"div",22)(1,"p",31),h(2),g()()),n&2){let e=E(2);C(2),J(e.error())}}function Jt(n,t){if(n&1){let e=xe();u(0,"div",5)(1,"h3"),h(2,"Export Season Data"),g(),u(3,"div",6)(4,"label",7),h(5,"Select Season"),g(),u(6,"select",8),k("ngModelChange",function(o){M(e);let r=E();return $(r.onSeasonChange(o))}),u(7,"option",9),h(8,"-- Select a season --"),g(),ae(9,At,2,2,"option",10,Et),g()(),u(11,"div",11)(12,"label"),h(13,"Export Format"),g(),u(14,"div",12)(15,"label",13)(16,"input",14),k("change",function(){M(e);let o=E();return $(o.onFormatChange("google-sheets"))}),g(),u(17,"span"),h(18,"Google Sheets"),g()(),u(19,"label",13)(20,"input",15),k("change",function(){M(e);let o=E();return $(o.onFormatChange("json"))}),g(),u(21,"span"),h(22,"JSON File"),g()()()(),u(23,"button",16),k("click",function(){M(e);let o=E();return $(o.startExport())}),N(24,vt,1,0)(25,Pt,1,0)(26,Rt,1,0),g()(),N(27,Ut,6,0,"div",17),u(28,"div",5)(29,"h3"),h(30,"Import from JSON"),g(),u(31,"p",18),h(32," Import season data from a previously exported JSON file. "),g(),u(33,"input",19,0),k("change",function(o){M(e);let r=E();return $(r.onFileSelected(o))}),g(),u(35,"button",20),k("click",function(){M(e);let o=we(34);return $(o.click())}),N(36,Gt,1,0)(37,Ft,1,0),g()(),N(38,jt,7,1,"div",21),N(39,Lt,7,0,"div",21),N(40,Wt,7,1,"div",21),N(41,Bt,3,1,"div",22)}if(n&2){let e=E();C(6),R("ngModel",e.selectedSeasonId()),C(3),ie(e.seasons()),C(7),R("checked",e.exportFormat()==="google-sheets"),C(4),R("checked",e.exportFormat()==="json"),C(3),R("disabled",!e.selectedSeasonId()||e.exporting()),C(),I(e.exporting()?24:e.exportFormat()==="json"?25:26),C(3),I(e.steps().length>0?27:-1),C(8),R("disabled",e.importing()),C(),I(e.importing()?36:37),C(2),I(e.spreadsheetUrl()?38:-1),C(),I(e.jsonExportComplete()?39:-1),C(),I(e.importComplete()?40:-1),C(),I(e.error()?41:-1)}}var st=class n{router=B(Ie);userService=B(ke);configService=B(Me);seasonService=B($e);_steps=b([]);_selectedSeasonId=b(null);_exporting=b(!1);_spreadsheetUrl=b(null);_error=b(null);_loadingSeasons=b(!1);_exportFormat=b("google-sheets");_jsonExportComplete=b(!1);_importing=b(!1);_importComplete=b(!1);_importSummary=b("");steps=this._steps.asReadonly();selectedSeasonId=this._selectedSeasonId.asReadonly();exporting=this._exporting.asReadonly();spreadsheetUrl=this._spreadsheetUrl.asReadonly();error=this._error.asReadonly();loadingSeasons=this._loadingSeasons.asReadonly();exportFormat=this._exportFormat.asReadonly();jsonExportComplete=this._jsonExportComplete.asReadonly();importing=this._importing.asReadonly();importComplete=this._importComplete.asReadonly();importSummary=this._importSummary.asReadonly();seasons=this.seasonService.seasons;async ngOnInit(){if(!this.userService.isAuthenticated()){this.router.navigate(["/login"]);return}if(!this.userService.isAdmin()){this.router.navigate(["/"]);return}this._loadingSeasons.set(!0);try{await this.seasonService.loadAllSeasons()}catch(t){this._error.set(t instanceof Error?t.message:"Failed to load seasons")}finally{this._loadingSeasons.set(!1)}}onSeasonChange(t){this._selectedSeasonId.set(t||null),this._spreadsheetUrl.set(null),this._error.set(null),this._steps.set([]),this._jsonExportComplete.set(!1)}onFormatChange(t){this._exportFormat.set(t),this._spreadsheetUrl.set(null),this._jsonExportComplete.set(!1),this._error.set(null),this._steps.set([])}async startExport(){return this._exportFormat()==="json"?this.startJsonExport():this.startGoogleSheetsExport()}async startJsonExport(){let t=this._selectedSeasonId();if(t){this._exporting.set(!0),this._jsonExportComplete.set(!1),this._error.set(null),this._steps.set([{label:"Loading data from Firestore",status:"pending"},{label:"Generating JSON file",status:"pending"}]);try{this.updateStep(0,"in-progress");let e=V(Y()),o=await new H(e).loadAllData(t,p=>{this.updateStep(0,"in-progress",p.detail??p.step)});this.updateStep(0,"completed"),this.updateStep(1,"in-progress");let r={exportedAt:new Date().toISOString(),year:2026,seasonId:t,season:o.season,orders:o.orders,users:Object.fromEntries(o.users),registration:o.registration,coupons:o.coupons,systemConfig:o.systemConfig,adminUserCache:o.adminUserCache,counters:o.counters,adminEmailTemplates:o.adminEmailTemplates,adminEmailSeasonTemplateStats:o.adminEmailSeasonTemplateStats,adminEmailBatchJobs:o.adminEmailBatchJobs},a=JSON.stringify(r,null,2),i=new Blob([a],{type:"application/json"}),d=URL.createObjectURL(i),c=document.createElement("a");c.href=d,c.download=`${o.season.name.replace(/[^a-zA-Z0-9]/g,"-")}-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(d),this.updateStep(1,"completed"),this._jsonExportComplete.set(!0)}catch(e){let s=this.formatExportError(e),o=this._steps().findIndex(r=>r.status==="in-progress");o>=0&&this.updateStep(o,"error",s),this._error.set(s),console.error("[AdminExport] JSON export failed",e)}finally{this._exporting.set(!1)}}}async startGoogleSheetsExport(){let t=this._selectedSeasonId();if(t){this._exporting.set(!0),this._spreadsheetUrl.set(null),this._error.set(null),this._steps.set([{label:"Authenticating with Google",status:"pending"},{label:"Loading data from Firestore",status:"pending"},{label:"Building spreadsheet data",status:"pending"},{label:"Creating Google Spreadsheet",status:"pending"},{label:"Writing sheet data",status:"pending"}]);try{this.updateStep(0,"in-progress");let e=new ee,s=await e.acquireAccessToken();this.updateStep(0,"completed"),this.updateStep(1,"in-progress");let o=V(Y()),a=await new H(o).loadAllData(t,m=>{this.updateStep(1,"in-progress",m.detail??m.step)});this.updateStep(1,"completed"),this.updateStep(2,"in-progress");let i=oe({Meta:rt({exportedAt:new Date().toISOString(),year:2026,seasonId:a.season.id,seasonName:a.season.name,counts:{orders:a.orders.length,users:a.users.size,coupons:a.coupons.length,counters:a.counters.length,hasRegistration:a.registration?1:0,hasSystemConfig:a.systemConfig?1:0,hasAdminUserCache:a.adminUserCache?1:0,hasAdminEmailTemplates:a.adminEmailTemplates?1:0,adminEmailSeasonTemplateStats:a.adminEmailSeasonTemplateStats.length,adminEmailBatchJobs:a.adminEmailBatchJobs.length}}),Order:qe(a.orders,a.users,a.season),Payments:Ke(a.orders,a.users),"Session Code Map":Ze(a.season),Coupons:Xe(a.coupons,a.orders),Waitlist:Qe(a.orders,a.users,a.season),"Weekly Student":et(a.season,a.orders,a.users),Students:tt(a.users)},a.systemConfig?{SystemConfig:nt(a.systemConfig)}:{}),d=i["Weekly Student"]?.reduce((m,y,S)=>{let f=y[0]??"";return(f.startsWith("\u2728 ")||f==="ParentName")&&m.push(S),m},[])??[];this.updateStep(2,"completed"),this.updateStep(3,"in-progress");let c=`${a.season.name} \u2014 Export ${Ue(new Date().toISOString())}`,p=Object.keys(i),_=await e.createSpreadsheet(c,p,s);this.updateStep(3,"completed"),this.updateStep(4,"in-progress");for(let[m,y]of Object.entries(i))this.updateStep(4,"in-progress",`Writing ${m}...`),await e.writeSheetData(_.spreadsheetId,m,y,s),m==="Weekly Student"&&await e.applyHeaderStyles(_.spreadsheetId,m,d,s);this.updateStep(4,"completed"),this._spreadsheetUrl.set(_.spreadsheetUrl)}catch(e){let s=this.formatExportError(e),o=this._steps().findIndex(r=>r.status==="in-progress");o>=0&&this.updateStep(o,"error",s),this._error.set(s),console.error("[AdminExport] Google Sheets export failed",e)}finally{this._exporting.set(!1)}}}updateStep(t,e,s){this._steps.update(o=>o.map((r,a)=>a===t?fe(oe({},r),{status:e,detail:s}):r))}formatExportError(t){if(t instanceof Error){let e=t.code;return typeof e=="string"&&e.length>0?`${e}: ${t.message}`:t.message}return"Export failed"}async onFileSelected(t){let e=t.target,s=e.files?.[0];if(s){this._importing.set(!0),this._importComplete.set(!1),this._error.set(null),this._steps.set([{label:"Reading JSON file",status:"pending"},{label:"Validating data structure",status:"pending"},{label:"Importing to Firestore",status:"pending"}]);try{this.updateStep(0,"in-progress");let o=await s.text(),r=JSON.parse(o);if(this.updateStep(0,"completed"),this.updateStep(1,"in-progress"),!r.season||!r.orders)throw new Error("Invalid export file: missing season or orders data");this.updateStep(1,"completed"),this.updateStep(2,"in-progress");let a=V(Y()),i=r.year??this.configService.activeYear(),{doc:d,setDoc:c,writeBatch:p}=await import("./chunk-OC4FARK5.js"),_=d(a,`years/${i}/seasons`,r.season.id);await c(_,r.season),this.updateStep(2,"in-progress","Season imported");let m=r.orders,y=500,S=0;for(let f=0;f<m.length;f+=y){let l=p(a),v=m.slice(f,f+y);for(let P of v){let O=d(a,`years/${i}/seasons/${r.season.id}/orders`,P.userAuthId);l.set(O,P)}await l.commit(),S+=v.length,this.updateStep(2,"in-progress",`Imported ${S}/${m.length} orders`)}if(r.users&&typeof r.users=="object"){let f=Object.entries(r.users);for(let l=0;l<f.length;l+=y){let v=p(a),P=f.slice(l,l+y);for(let[O,F]of P){let w=d(a,"users",O);v.set(w,F,{merge:!0})}await v.commit()}this.updateStep(2,"in-progress",`Imported ${f.length} users`)}if(r.registration){let f=d(a,`years/${i}/registrations`,r.season.id);await c(f,r.registration)}this.updateStep(2,"completed"),this._importComplete.set(!0),this._importSummary.set(`Imported season "${r.season.name}" with ${m.length} orders.`)}catch(o){let r=this._steps().findIndex(a=>a.status==="in-progress");r>=0&&this.updateStep(r,"error"),this._error.set(o instanceof Error?o.message:"Import failed")}finally{this._importing.set(!1),e.value=""}}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=Ce({type:n,selectors:[["app-admin-export"]],decls:4,vars:1,consts:[["fileInput",""],["pageTitle","Data Export","pageSubtitle","Export season data to spreadsheets"],[1,"admin-export"],[1,"loading-container"],[1,"spinner"],[1,"export-card"],[1,"form-group"],["for","season-select"],["id","season-select",1,"season-select",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"format-group"],[1,"format-options"],[1,"format-option"],["type","radio","name","format","value","google-sheets",3,"change","checked"],["type","radio","name","format","value","json",3,"change","checked"],[1,"btn-export",3,"click","disabled"],[1,"steps-card"],[1,"import-description"],["type","file","accept",".json",2,"display","none",3,"change"],[1,"btn-import",3,"click","disabled"],[1,"success-card"],[1,"error-card"],[1,"steps-list"],[1,"step",3,"step-pending","step-in-progress","step-completed","step-error"],[1,"step"],[1,"step-icon"],[1,"step-label"],[1,"step-detail"],[1,"success-icon"],["target","_blank","rel","noopener",1,"spreadsheet-link",3,"href"],[1,"error-message"]],template:function(e,s){e&1&&(u(0,"app-admin-layout",1)(1,"div",2),N(2,It,4,0,"div",3)(3,Jt,42,12),g()()),e&2&&(C(2),I(s.loadingSeasons()?2:3))},dependencies:[Ne,Be,Le,We,je,Ge,Fe,Je],styles:[".admin-export[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1.5rem}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:4rem 2rem}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.export-card[_ngcontent-%COMP%], .steps-card[_ngcontent-%COMP%], .success-card[_ngcontent-%COMP%], .error-card[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline-variant, #e0e0e0);border-radius:12px;padding:1.5rem;margin-bottom:1rem}.export-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem;color:var(--sys-on-surface, #212121)}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:var(--sys-on-surface, #212121)}.season-select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid var(--sys-outline-variant, #e0e0e0);border-radius:8px;font-size:1rem;background:#fff}.format-group[_ngcontent-%COMP%]{margin-bottom:1rem}.format-group[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;font-weight:600;color:var(--sys-on-surface, #212121)}.format-options[_ngcontent-%COMP%]{display:flex;gap:1.5rem}.format-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-weight:400}.format-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{cursor:pointer}.import-description[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-on-surface-variant, #666);font-size:.875rem}.btn-import[_ngcontent-%COMP%]{width:100%;padding:.75rem 1.25rem;background:var(--sys-tertiary, #1976d2);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s ease}.btn-import[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-tertiary-dark, #1565c0)}.btn-import[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-export[_ngcontent-%COMP%]{width:100%;padding:.75rem 1.25rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s ease}.btn-export[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-primary-dark, #a51c1c)}.btn-export[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.steps-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.125rem;color:var(--sys-on-surface, #212121)}.steps-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.step[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.5rem 0}.step-icon[_ngcontent-%COMP%]{font-size:1rem;width:1.25rem;text-align:center}.step-pending[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #999)}.step-in-progress[_ngcontent-%COMP%]{color:var(--sys-tertiary, #1976d2);font-weight:500}.step-completed[_ngcontent-%COMP%]{color:var(--sys-secondary, #2e7d32)}.step-error[_ngcontent-%COMP%]{color:var(--sys-error, #c62828)}.step-detail[_ngcontent-%COMP%]{font-size:.875rem;color:var(--sys-on-surface-variant, #666)}.success-card[_ngcontent-%COMP%]{text-align:center;border-color:var(--sys-secondary, #2e7d32)}.success-icon[_ngcontent-%COMP%]{font-size:2rem;color:var(--sys-secondary, #2e7d32);margin-bottom:.5rem}.success-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-secondary, #2e7d32)}.spreadsheet-link[_ngcontent-%COMP%]{display:inline-block;padding:.75rem 1.5rem;background:var(--sys-secondary, #2e7d32);color:#fff;border-radius:8px;text-decoration:none;font-weight:500}.spreadsheet-link[_ngcontent-%COMP%]:hover{opacity:.9}.error-card[_ngcontent-%COMP%]{border-color:var(--sys-error, #c62828);background:var(--sys-error-container, #ffebee)}.error-message[_ngcontent-%COMP%]{margin:0;color:var(--sys-error, #c62828);font-weight:500}"]})};export{st as AdminExportComponent};
