import{b as L}from"./chunk-RYIKU5Y3.js";import{h,n as z,oa as j,pa as B}from"./chunk-TKIXSRNU.js";import"./chunk-ZEYGPIIR.js";import"./chunk-KBXPF7D4.js";import"./chunk-2PX3OE6K.js";import{$a as g,Db as i,Ea as c,Eb as _,Fb as I,N as C,Qa as x,S as d,T as m,Tb as T,Vb as V,Wb as w,ab as p,da as b,db as E,ea as O,eb as k,fb as W,gb as a,hb as r,ib as N,jb as u,kb as f,ob as y,pb as D,qb as v,rb as R,sb as l}from"./chunk-CNMR2ZL6.js";import{a as S,b as P}from"./chunk-Q7L6LLAK.js";var M=class o{entry=w.required();sessionName=w.required();loading=w(!1);remove=V();onRemove(){this.remove.emit()}formatDate(e){return L(e,{month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=x({type:o,selectors:[["app-waitlist-entry-card"]],inputs:{entry:[1,"entry"],sessionName:[1,"sessionName"],loading:[1,"loading"]},outputs:{remove:"remove"},decls:15,vars:3,consts:[[1,"waitlist-card"],[1,"card-header"],[1,"class-info"],[1,"class-name"],[1,"class-dates"],[1,"status-indicator"],[1,"info-section"],[1,"info-text"],[1,"card-actions"],[1,"btn-secondary",3,"click","disabled"]],template:function(t,n){t&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),i(4),f(),u(5,"div",4),i(6),f()(),u(7,"div",5),i(8," On Waitlist "),f()(),u(9,"div",6)(10,"p",7),i(11,' When a spot opens, all waitlisted families will be notified by email within 24 hours and spots are filled on a first-come, first-served basis. Please click "Leave Waitlist" if you no longer wish to remain on the waiting list. '),f()(),u(12,"div",8)(13,"button",9),R("click",function(){return n.onRemove()}),i(14," Leave Waitlist "),f()()()),t&2&&(c(4),_(n.sessionName()),c(2),I("Joined: ",n.formatDate(n.entry().joinedAt)),c(7),D("disabled",n.loading()))},dependencies:[h],styles:[".waitlist-card[_ngcontent-%COMP%]{background:#fff;border:1px solid var(--sys-outline, #e0e0e0);border-radius:12px;padding:1.25rem;margin-bottom:1rem;transition:box-shadow .2s ease}.waitlist-card[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #00000014}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1rem}.class-info[_ngcontent-%COMP%]{flex:1}.class-name[_ngcontent-%COMP%]{margin:0 0 .25rem;font-size:1.1rem;color:var(--sys-on-surface, #212121)}.class-dates[_ngcontent-%COMP%]{font-size:.875rem;color:var(--sys-on-surface-variant, #666)}.status-indicator[_ngcontent-%COMP%]{background:var(--sys-surface-variant, #f5f5f5);color:var(--sys-on-surface-variant, #666);padding:.375rem .75rem;border-radius:16px;font-size:.875rem;font-weight:500}.info-section[_ngcontent-%COMP%]{margin-bottom:1rem}.info-text[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:var(--sys-on-surface-variant, #666)}.card-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem}.btn-secondary[_ngcontent-%COMP%]{padding:.75rem 1rem;background:#fff;color:var(--sys-on-surface-variant, #666);border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-size:.95rem;cursor:pointer;transition:all .2s ease}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--sys-surface-variant, #f5f5f5);border-color:var(--sys-on-surface-variant, #666)}.btn-secondary[_ngcontent-%COMP%]:disabled{color:var(--sys-outline, #ccc);cursor:not-allowed}"]})};var A=(o,e)=>e.sessionId;function J(o,e){o&1&&(a(0,"div",3),N(1,"div",8),a(2,"p"),i(3,"Loading..."),r()())}function G(o,e){if(o&1){let t=y();a(0,"div",4)(1,"div",9),i(2,"!"),r(),a(3,"p"),i(4),r(),a(5,"button",10),v("click",function(){d(t);let s=l();return m(s.orderService.clearError())}),i(6,"Retry"),r()()}if(o&2){let t=l();c(4),_(t.orderService.error())}}function H(o,e){if(o&1){let t=y();a(0,"div",5)(1,"div",11),i(2,"assignment"),r(),a(3,"h2"),i(4,"No Waitlist Entries"),r(),a(5,"p"),i(6,"You haven't joined the waitlist for any classes yet"),r(),a(7,"button",12),v("click",function(){d(t);let s=l();return m(s.goToCatalog())}),i(8,"Browse Classes"),r()()}}function K(o,e){if(o&1){let t=y();a(0,"app-waitlist-entry-card",16),v("remove",function(){let s=d(t).$implicit,F=l(2);return m(F.onRemove(s))}),r()}if(o&2){let t=e.$implicit,n=l(2);W("entry",t)("sessionName",n.getSessionName(t.sessionId))("loading",n.orderService.loading())}}function Q(o,e){if(o&1&&(a(0,"div",6)(1,"div",13)(2,"span",14),i(3),r()(),E(4,K,1,3,"app-waitlist-entry-card",15,A),r()),o&2){let t=l();c(3),_(t.waitlistSummary()),c(),k(t.orderService.waitlistEntries())}}function U(o,e){if(o&1){let t=y();a(0,"div",7)(1,"div",17)(2,"h3"),i(3,"Leave Waitlist"),r(),a(4,"p"),i(5,"Are you sure you want to leave the waitlist?"),r(),a(6,"p",18),i(7,"You will lose your current position in the queue."),r(),a(8,"div",19)(9,"button",20),v("click",function(){d(t);let s=l();return m(s.closeRemoveDialog())}),i(10,"Cancel"),r(),a(11,"button",21),v("click",function(){d(t);let s=l();return m(s.confirmRemove())}),i(12,"Leave Waitlist"),r()()()()}}var $=class o{orderService=C(B);seasonService=C(j);router=C(z);sessionNameById=b({});waitlistSummary=T(()=>{let e=this.orderService.waitlistCount();return`You have ${e} ${e===1?"class":"classes"} in the waitlist.`});_showRemoveDialog=b(!1);_selectedEntry=b(null);showRemoveDialog=this._showRemoveDialog.asReadonly();constructor(){O(()=>{let e=this.orderService.waitlistEntries(),t=this.sessionNameById();for(let n of e)t[n.sessionId]||this.loadSessionName(n.sessionId)})}goToCatalog(){this.router.navigate(["/catalog"])}getSessionName(e){return this.sessionNameById()[e]??e}onRemove(e){this._selectedEntry.set(e),this._showRemoveDialog.set(!0)}closeRemoveDialog(){this._showRemoveDialog.set(!1),this._selectedEntry.set(null)}async confirmRemove(){let e=this._selectedEntry();if(e){this.closeRemoveDialog();try{await this.orderService.leaveWaitlist(e.sessionId)}catch{}}}async loadSessionName(e){let n=(await this.seasonService.getClassById(e))?.name??e;this.sessionNameById.update(s=>s[e]?s:P(S({},s),{[e]:n}))}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=x({type:o,selectors:[["app-waitlist-status"]],decls:11,vars:5,consts:[[1,"waitlist-page"],[1,"page-header"],[1,"subtitle"],[1,"loading-container"],[1,"error-container"],[1,"empty-container"],[1,"entries-section"],[1,"dialog-overlay"],[1,"spinner"],[1,"error-icon"],[1,"btn-retry",3,"click"],["aria-hidden","true",1,"empty-icon","material-symbols-rounded"],[1,"btn-primary",3,"click"],[1,"summary-bar"],[1,"count"],[3,"entry","sessionName","loading"],[3,"remove","entry","sessionName","loading"],[1,"dialog"],[1,"dialog-warning"],[1,"dialog-actions"],[1,"btn-secondary",3,"click"],[1,"btn-danger",3,"click"]],template:function(t,n){t&1&&(a(0,"div",0)(1,"header",1)(2,"h1"),i(3,"Waitlist"),r(),a(4,"p",2),i(5,"View your waitlist entries"),r()(),g(6,J,4,0,"div",3),g(7,G,7,1,"div",4),g(8,H,9,0,"div",5),g(9,Q,6,1,"div",6),g(10,U,13,0,"div",7),r()),t&2&&(c(6),p(n.orderService.loading()?6:-1),c(),p(n.orderService.error()?7:-1),c(),p(!n.orderService.loading()&&!n.orderService.error()&&n.orderService.waitlistCount()===0?8:-1),c(),p(n.orderService.waitlistCount()>0?9:-1),c(),p(n.showRemoveDialog()?10:-1))},dependencies:[h,M],styles:[".waitlist-page[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:1.5rem}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.75rem;color:var(--sys-on-surface, #212121)}.page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;color:var(--sys-on-surface-variant, #666)}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;color:var(--sys-on-surface-variant, #666)}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid var(--sys-outline, #e0e0e0);border-top-color:var(--sys-primary, #c62828);border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-container[_ngcontent-%COMP%]{text-align:center;padding:3rem 2rem;background:var(--sys-error-container, #ffebee);border-radius:12px}.error-icon[_ngcontent-%COMP%]{width:48px;height:48px;background:var(--sys-error, #c62828);color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;margin:0 auto 1rem}.error-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--sys-on-error-container, #b71c1c);margin-bottom:1rem}.btn-retry[_ngcontent-%COMP%]{padding:.5rem 1.5rem;background:var(--sys-error, #c62828);color:#fff;border:none;border-radius:6px;cursor:pointer}.empty-container[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.empty-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem}.empty-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 .5rem;color:var(--sys-on-surface, #212121)}.empty-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #666);margin-bottom:1.5rem}.entries-section[_ngcontent-%COMP%]{margin-top:1rem}.summary-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:var(--sys-surface-variant, #f5f5f5);border-radius:8px;margin-bottom:1.5rem}.count[_ngcontent-%COMP%]{color:var(--sys-on-surface-variant, #666)}.btn-primary[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:var(--sys-primary, #c62828);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s ease}.btn-primary[_ngcontent-%COMP%]:hover{background:var(--sys-primary-dark, #a51c1c)}.dialog-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.dialog[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:1.5rem;max-width:400px;width:100%;box-shadow:0 8px 32px #0003}.dialog[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1rem;color:var(--sys-on-surface, #212121)}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 .75rem;color:var(--sys-on-surface-variant, #666)}.dialog-warning[_ngcontent-%COMP%]{font-size:.875rem;color:var(--sys-error, #c62828)}.dialog-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;margin-top:1.5rem}.btn-secondary[_ngcontent-%COMP%]{flex:1;padding:.75rem 1rem;background:#fff;color:var(--sys-on-surface-variant, #666);border:1px solid var(--sys-outline, #e0e0e0);border-radius:8px;font-size:.95rem;cursor:pointer}.btn-secondary[_ngcontent-%COMP%]:hover{background:var(--sys-surface-variant, #f5f5f5)}.btn-danger[_ngcontent-%COMP%]{flex:1;padding:.75rem 1rem;background:var(--sys-error, #c62828);color:#fff;border:none;border-radius:8px;font-size:.95rem;cursor:pointer}.btn-danger[_ngcontent-%COMP%]:hover{background:#a51c1c}"]})};export{$ as WaitlistStatusComponent};
